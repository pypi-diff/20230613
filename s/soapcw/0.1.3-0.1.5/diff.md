# Comparing `tmp/soapcw-0.1.3.tar.gz` & `tmp/soapcw-0.1.5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist/soapcw-0.1.3.tar", last modified: Tue Jun 22 09:32:11 2021, max compression
+gzip compressed data, was "soapcw-0.1.5.tar", last modified: Tue Jun 13 08:56:05 2023, max compression
```

## Comparing `soapcw-0.1.3.tar` & `soapcw-0.1.5.tar`

### file list

```diff
@@ -1,73 +1,90 @@
-drwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)        0 2021-06-22 09:32:11.000000 soapcw-0.1.3/
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     4507 2021-06-22 09:29:40.000000 soapcw-0.1.3/setup.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      387 2021-06-22 09:32:11.000000 soapcw-0.1.3/setup.cfg
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     2588 2021-06-22 09:32:11.000000 soapcw-0.1.3/PKG-INFO
-drwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)        0 2021-06-22 09:32:11.000000 soapcw-0.1.3/tests/
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)   445283 2021-01-20 15:39:13.000000 soapcw-0.1.3/tests/SNR_injections.ipynb
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      520 2020-05-19 16:37:46.000000 soapcw-0.1.3/tests/test_soap.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       59 2020-05-19 16:37:46.000000 soapcw-0.1.3/tests/__init__.py
-drwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)        0 2021-06-22 09:32:11.000000 soapcw-0.1.3/docs/
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      602 2021-05-26 16:54:18.000000 soapcw-0.1.3/docs/soapcw.cnn.pytorch.models.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       55 2021-05-26 16:58:05.000000 soapcw-0.1.3/docs/modules.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      766 2020-05-19 16:37:45.000000 soapcw-0.1.3/docs/make.bat
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     1062 2020-05-19 16:37:45.000000 soapcw-0.1.3/docs/installation.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     1040 2021-05-26 16:54:18.000000 soapcw-0.1.3/docs/soapcw.cw.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       28 2020-05-19 16:37:45.000000 soapcw-0.1.3/docs/history.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      716 2020-05-19 16:37:45.000000 soapcw-0.1.3/docs/index.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      231 2021-05-26 16:54:18.000000 soapcw-0.1.3/docs/soapcw.cnn.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      824 2021-05-26 16:54:18.000000 soapcw-0.1.3/docs/soapcw.line_aware_stat.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       27 2020-05-19 16:37:45.000000 soapcw-0.1.3/docs/readme.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       28 2020-05-19 16:37:45.000000 soapcw-0.1.3/docs/authors.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      466 2021-05-26 16:54:18.000000 soapcw-0.1.3/docs/soapcw.cnn.pytorch.rst
-drwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)        0 2021-06-22 09:32:11.000000 soapcw-0.1.3/docs/usage/
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      280 2021-01-20 15:39:13.000000 soapcw-0.1.3/docs/usage/index.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      536 2021-05-26 16:58:05.000000 soapcw-0.1.3/docs/soapcw.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      605 2020-05-19 16:37:45.000000 soapcw-0.1.3/docs/Makefile
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      468 2021-05-26 16:54:18.000000 soapcw-0.1.3/docs/soapcw.tools.rst
--rwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)     4930 2020-05-19 16:37:45.000000 soapcw-0.1.3/docs/conf.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       33 2020-05-19 16:37:45.000000 soapcw-0.1.3/docs/contributing.rst
-drwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)        0 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw/
-drwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)        0 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw/cw/
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     8566 2020-07-22 09:24:20.000000 soapcw-0.1.3/soapcw/cw/timeseries.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      128 2020-07-06 10:25:34.000000 soapcw-0.1.3/soapcw/cw/tools.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     9467 2021-04-12 09:28:38.000000 soapcw-0.1.3/soapcw/cw/sft.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)    40521 2021-05-28 20:04:45.000000 soapcw-0.1.3/soapcw/cw/generate_data.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      197 2021-03-22 10:57:23.000000 soapcw-0.1.3/soapcw/cw/__init__.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     8660 2020-07-22 09:24:20.000000 soapcw-0.1.3/soapcw/cw/make_sfts.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)    14650 2021-03-20 20:59:30.000000 soapcw-0.1.3/soapcw/cw/load_sfts.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)  2222244 2021-05-28 16:15:45.000000 soapcw-0.1.3/soapcw/soapcw.c
-drwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)        0 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw/cnn/
-drwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)        0 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw/cnn/pytorch/
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     3019 2021-05-25 13:42:57.000000 soapcw-0.1.3/soapcw/cnn/pytorch/load_models.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       43 2021-05-26 16:57:32.000000 soapcw-0.1.3/soapcw/cnn/pytorch/__init__.py
-drwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)        0 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw/cnn/pytorch/models/
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       45 2021-05-24 16:39:24.000000 soapcw-0.1.3/soapcw/cnn/pytorch/models/__init__.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     6338 2021-05-25 13:11:36.000000 soapcw-0.1.3/soapcw/cnn/pytorch/models/cnn.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     9628 2021-05-24 16:40:47.000000 soapcw-0.1.3/soapcw/cnn/pytorch/models/combined_cnn.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       39 2021-05-26 16:57:15.000000 soapcw-0.1.3/soapcw/cnn/__init__.py
-drwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)        0 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw/tools/
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     8977 2021-04-19 09:29:10.000000 soapcw-0.1.3/soapcw/tools/tools.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     2885 2021-01-20 15:39:13.000000 soapcw-0.1.3/soapcw/tools/plots.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)        0 2020-05-19 16:37:46.000000 soapcw-0.1.3/soapcw/tools/__init__.py
-drwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)        0 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw/line_aware_stat/
--rwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)     4597 2020-05-27 15:35:06.000000 soapcw-0.1.3/soapcw/line_aware_stat/save_lookup.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)    37876 2021-04-12 10:36:45.000000 soapcw-0.1.3/soapcw/line_aware_stat/gen_lookup_python.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)    10237 2020-05-27 15:35:06.000000 soapcw-0.1.3/soapcw/line_aware_stat/gen_lookup.pyx
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      123 2020-05-19 16:37:46.000000 soapcw-0.1.3/soapcw/line_aware_stat/__init__.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      406 2020-05-19 16:37:45.000000 soapcw-0.1.3/soapcw/cli.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      557 2021-05-24 15:37:27.000000 soapcw-0.1.3/soapcw/__init__.py
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)    63149 2021-05-28 16:15:17.000000 soapcw-0.1.3/soapcw/soapcw.pyx
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       89 2020-05-19 16:37:45.000000 soapcw-0.1.3/HISTORY.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      284 2020-05-19 16:37:45.000000 soapcw-0.1.3/MANIFEST.in
-drwxrwxr-x   0 joseph.bayley (44242) joseph.bayley (44242)        0 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw.egg-info/
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     2588 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw.egg-info/PKG-INFO
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       13 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw.egg-info/top_level.txt
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)        1 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw.egg-info/dependency_links.txt
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       51 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw.egg-info/requires.txt
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     1372 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw.egg-info/SOURCES.txt
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)        1 2021-05-28 19:41:31.000000 soapcw-0.1.3/soapcw.egg-info/not-zip-safe
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)       44 2021-06-22 09:32:11.000000 soapcw-0.1.3/soapcw.egg-info/entry_points.txt
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     1032 2020-05-19 16:37:45.000000 soapcw-0.1.3/README.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     3502 2020-05-19 16:37:45.000000 soapcw-0.1.3/CONTRIBUTING.rst
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)     1072 2020-05-19 16:37:45.000000 soapcw-0.1.3/LICENSE
--rw-rw-r--   0 joseph.bayley (44242) joseph.bayley (44242)      168 2020-05-19 16:37:45.000000 soapcw-0.1.3/AUTHORS.rst
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.439011 soapcw-0.1.5/
+-rw-rw-rw-   0 root         (0) root         (0)      166 2023-06-13 08:53:32.000000 soapcw-0.1.5/AUTHORS.rst
+-rw-rw-rw-   0 root         (0) root         (0)     3508 2023-06-13 08:53:32.000000 soapcw-0.1.5/CONTRIBUTING.rst
+-rw-rw-rw-   0 root         (0) root         (0)       89 2023-06-13 08:53:32.000000 soapcw-0.1.5/HISTORY.rst
+-rw-rw-rw-   0 root         (0) root         (0)     1072 2023-06-13 08:53:32.000000 soapcw-0.1.5/LICENSE
+-rw-rw-rw-   0 root         (0) root         (0)      361 2023-06-13 08:53:32.000000 soapcw-0.1.5/MANIFEST.in
+-rw-r--r--   0 root         (0) root         (0)     2394 2023-06-13 08:56:05.439011 soapcw-0.1.5/PKG-INFO
+-rw-rw-rw-   0 root         (0) root         (0)     1389 2023-06-13 08:53:32.000000 soapcw-0.1.5/README.rst
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.429011 soapcw-0.1.5/docs/
+-rw-rw-rw-   0 root         (0) root         (0)      605 2023-06-13 08:53:32.000000 soapcw-0.1.5/docs/Makefile
+-rw-rw-rw-   0 root         (0) root         (0)       28 2023-06-13 08:53:32.000000 soapcw-0.1.5/docs/authors.rst
+-rwxrwxrwx   0 root         (0) root         (0)     4930 2023-06-13 08:53:32.000000 soapcw-0.1.5/docs/conf.py
+-rw-rw-rw-   0 root         (0) root         (0)       33 2023-06-13 08:53:32.000000 soapcw-0.1.5/docs/contributing.rst
+-rw-rw-rw-   0 root         (0) root         (0)       28 2023-06-13 08:53:32.000000 soapcw-0.1.5/docs/history.rst
+-rw-rw-rw-   0 root         (0) root         (0)     1193 2023-06-13 08:53:32.000000 soapcw-0.1.5/docs/index.rst
+-rw-rw-rw-   0 root         (0) root         (0)     1062 2023-06-13 08:53:32.000000 soapcw-0.1.5/docs/installation.rst
+-rw-rw-rw-   0 root         (0) root         (0)      766 2023-06-13 08:53:32.000000 soapcw-0.1.5/docs/make.bat
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.429011 soapcw-0.1.5/docs/pipeline_usage/
+-rw-rw-rw-   0 root         (0) root         (0)      166 2023-06-13 08:53:32.000000 soapcw-0.1.5/docs/pipeline_usage/index.rst
+-rw-rw-rw-   0 root         (0) root         (0)     4690 2023-06-13 08:53:32.000000 soapcw-0.1.5/docs/pipeline_usage/run_pipeline.rst
+-rw-rw-rw-   0 root         (0) root         (0)       27 2023-06-13 08:53:32.000000 soapcw-0.1.5/docs/readme.rst
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.430011 soapcw-0.1.5/docs/usage/
+-rw-rw-rw-   0 root         (0) root         (0)      280 2023-06-13 08:53:32.000000 soapcw-0.1.5/docs/usage/index.rst
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.431011 soapcw-0.1.5/pipeline/
+-rw-rw-rw-   0 root         (0) root         (0)        0 2023-06-13 08:53:32.000000 soapcw-0.1.5/pipeline/__init__.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.431011 soapcw-0.1.5/pipeline/css/
+-rw-rw-rw-   0 root         (0) root         (0)     3022 2023-06-13 08:53:32.000000 soapcw-0.1.5/pipeline/css/general.css
+-rwxrwxrwx   0 root         (0) root         (0)     6999 2023-06-13 08:53:32.000000 soapcw-0.1.5/pipeline/make_dag_files_astro.py
+-rwxrwxrwx   0 root         (0) root         (0)     6963 2023-06-13 08:53:32.000000 soapcw-0.1.5/pipeline/make_dag_files_lines.py
+-rw-rw-rw-   0 root         (0) root         (0)    38221 2023-06-13 08:53:32.000000 soapcw-0.1.5/pipeline/make_html_page.py
+-rwxrwxrwx   0 root         (0) root         (0)    36446 2023-06-13 08:53:32.000000 soapcw-0.1.5/pipeline/run_full_soap_astro.py
+-rwxrwxrwx   0 root         (0) root         (0)    39626 2023-06-13 08:53:32.000000 soapcw-0.1.5/pipeline/run_full_soap_lines.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.431011 soapcw-0.1.5/pipeline/scripts/
+-rw-rw-rw-   0 root         (0) root         (0)    16899 2023-06-13 08:53:32.000000 soapcw-0.1.5/pipeline/scripts/table_scripts.js
+-rw-rw-rw-   0 root         (0) root         (0)     2156 2023-06-13 08:53:32.000000 soapcw-0.1.5/pipeline/soap_config_parser.py
+-rw-rw-rw-   0 root         (0) root         (0)      984 2023-06-13 08:56:05.440011 soapcw-0.1.5/setup.cfg
+-rw-rw-rw-   0 root         (0) root         (0)     4183 2023-06-13 08:53:32.000000 soapcw-0.1.5/setup.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.434011 soapcw-0.1.5/soapcw/
+-rw-rw-rw-   0 root         (0) root         (0)      556 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/__init__.py
+-rw-rw-rw-   0 root         (0) root         (0)      406 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cli.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.436011 soapcw-0.1.5/soapcw/cnn/
+-rw-rw-rw-   0 root         (0) root         (0)       26 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/__init__.py
+-rw-rw-rw-   0 root         (0) root         (0)     4682 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/cnn_data_dag_gen.py
+-rwxrwxrwx   0 root         (0) root         (0)    17315 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/cnn_data_gen.py
+-rw-rw-rw-   0 root         (0) root         (0)    13220 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/generate_gaussian_train_data.py
+-rw-rw-rw-   0 root         (0) root         (0)    11006 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/generate_test_data.py
+-rw-rw-rw-   0 root         (0) root         (0)    17031 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/generate_train_data.py
+-rwxrwxrwx   0 root         (0) root         (0)     5822 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/narrowband_sfts.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.436011 soapcw-0.1.5/soapcw/cnn/pytorch/
+-rw-rw-rw-   0 root         (0) root         (0)       43 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/pytorch/__init__.py
+-rw-rw-rw-   0 root         (0) root         (0)     3019 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/pytorch/load_models.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.437011 soapcw-0.1.5/soapcw/cnn/pytorch/models/
+-rw-rw-rw-   0 root         (0) root         (0)       45 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/pytorch/models/__init__.py
+-rw-rw-rw-   0 root         (0) root         (0)     6338 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/pytorch/models/cnn.py
+-rw-rw-rw-   0 root         (0) root         (0)     9628 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/pytorch/models/combined_cnn.py
+-rw-rw-rw-   0 root         (0) root         (0)     7893 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cnn/train_model.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.437011 soapcw-0.1.5/soapcw/cw/
+-rw-rw-rw-   0 root         (0) root         (0)      197 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cw/__init__.py
+-rw-rw-rw-   0 root         (0) root         (0)    42241 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cw/generate_data.py
+-rw-rw-rw-   0 root         (0) root         (0)    19576 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cw/load_sfts.py
+-rw-rw-rw-   0 root         (0) root         (0)     8660 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cw/make_sfts.py
+-rw-rw-rw-   0 root         (0) root         (0)     9450 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cw/sft.py
+-rw-rw-rw-   0 root         (0) root         (0)     8567 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cw/timeseries.py
+-rw-rw-rw-   0 root         (0) root         (0)     1687 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/cw/tools.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.438011 soapcw-0.1.5/soapcw/line_aware_stat/
+-rw-rw-rw-   0 root         (0) root         (0)      123 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/line_aware_stat/__init__.py
+-rw-rw-rw-   0 root         (0) root         (0)    11721 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/line_aware_stat/gen_lookup.pyx
+-rw-rw-rw-   0 root         (0) root         (0)    38004 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/line_aware_stat/gen_lookup_python.py
+-rwxrwxrwx   0 root         (0) root         (0)     6514 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/line_aware_stat/save_lookup.py
+-rw-rw-rw-   0 root         (0) root         (0)     3354 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/soap_config_parser.py
+-rw-r--r--   0 root         (0) root         (0)  2250446 2023-06-13 08:56:04.000000 soapcw-0.1.5/soapcw/soapcw.c
+-rw-rw-rw-   0 root         (0) root         (0)    63288 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/soapcw.pyx
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.438011 soapcw-0.1.5/soapcw/tools/
+-rw-rw-rw-   0 root         (0) root         (0)        0 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/tools/__init__.py
+-rw-rw-rw-   0 root         (0) root         (0)     2885 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/tools/plots.py
+-rw-rw-rw-   0 root         (0) root         (0)     9044 2023-06-13 08:53:32.000000 soapcw-0.1.5/soapcw/tools/tools.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.435011 soapcw-0.1.5/soapcw.egg-info/
+-rw-r--r--   0 root         (0) root         (0)     2394 2023-06-13 08:56:05.000000 soapcw-0.1.5/soapcw.egg-info/PKG-INFO
+-rw-r--r--   0 root         (0) root         (0)     1822 2023-06-13 08:56:05.000000 soapcw-0.1.5/soapcw.egg-info/SOURCES.txt
+-rw-r--r--   0 root         (0) root         (0)        1 2023-06-13 08:56:05.000000 soapcw-0.1.5/soapcw.egg-info/dependency_links.txt
+-rw-r--r--   0 root         (0) root         (0)      484 2023-06-13 08:56:05.000000 soapcw-0.1.5/soapcw.egg-info/entry_points.txt
+-rw-r--r--   0 root         (0) root         (0)        1 2023-06-13 08:56:05.000000 soapcw-0.1.5/soapcw.egg-info/not-zip-safe
+-rw-r--r--   0 root         (0) root         (0)       45 2023-06-13 08:56:05.000000 soapcw-0.1.5/soapcw.egg-info/requires.txt
+-rw-r--r--   0 root         (0) root         (0)       22 2023-06-13 08:56:05.000000 soapcw-0.1.5/soapcw.egg-info/top_level.txt
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-06-13 08:56:05.439011 soapcw-0.1.5/tests/
+-rw-rw-rw-   0 root         (0) root         (0)   445283 2023-06-13 08:53:32.000000 soapcw-0.1.5/tests/SNR_injections.ipynb
+-rw-rw-rw-   0 root         (0) root         (0)       59 2023-06-13 08:53:32.000000 soapcw-0.1.5/tests/__init__.py
+-rw-rw-rw-   0 root         (0) root         (0)     1130 2023-06-13 08:53:32.000000 soapcw-0.1.5/tests/test_cwload.py
+-rw-rw-rw-   0 root         (0) root         (0)     3602 2023-06-13 08:53:32.000000 soapcw-0.1.5/tests/test_line_aware_stat.py
+-rw-rw-rw-   0 root         (0) root         (0)     4290 2023-06-13 08:53:32.000000 soapcw-0.1.5/tests/test_soap.py
```

### filetype from file(1)

```diff
@@ -1 +1 @@
-POSIX tar archive (GNU)
+POSIX tar archive
```

### Comparing `soapcw-0.1.3/setup.py` & `soapcw-0.1.5/setup.py`

 * *Files 7% similar despite different names*

```diff
@@ -15,15 +15,14 @@
     return _build_ext(*args,**kwargs)
     
 def cythonize(*args,**kwargs):
     from Cython.Build import cythonize as _cythonize
     return _cythonize(*args,**kwargs)
 
 
-
 with open('README.rst') as readme_file:
     readme = readme_file.read()
 
 with open('HISTORY.rst') as history_file:
     history = history_file.read()
     
 class CustomInstall(install):
@@ -83,51 +82,41 @@
     ext_modules = [
     Extension("soapcw.soapcw",
               [ "soapcw/soapcw.pyx" ]),]
 
 
 cmdclass = { 'build_ext': build_ext , }
 
-setup_requirements = ["cython", "matplotlib", "numpy", "torch", "scipy","lalsuite","PyCBC"]
+setup_requirements = ["cython", "matplotlib", "numpy", "torch", "scipy", "lalsuite"]
 
 test_requirements = ["cython"]
 
 setup(
     author="Joe Bayley",
     author_email='joseph.bayley@glasgow.ac.uk',
     classifiers=[
         'Development Status :: 2 - Pre-Alpha',
         'Intended Audience :: Developers',
         'License :: OSI Approved :: MIT License',
         'Natural Language :: English',
-        "Programming Language :: Python :: 2",
-        'Programming Language :: Python :: 2.7',
-        'Programming Language :: Python :: 3',
-        'Programming Language :: Python :: 3.4',
-        'Programming Language :: Python :: 3.5',
-        'Programming Language :: Python :: 3.6',
         'Programming Language :: Python :: 3.7',
+        'Programming Language :: Python :: 3.8',
+        'Programming Language :: Python :: 3.9',
     ],
     description="SOAP is a rapid algorithm to search for continuous sources of gravitational waves, with a wider application to long duration narrowband signals.",
-    entry_points={
-        'console_scripts': [
-            'soapcw=soapcw.cli:main',
-        ],
-    },
     install_requires=setup_requirements,
     license="MIT license",
     long_description=readme + '\n\n' + history,
     include_package_data=True,
-    package_data = {"":['cnn/pytorch/trained_models/O3/*.ckpt','cnn/pytorch/trained_models/O3/*.ini']},
+    #package_data = {"":['cnn/pytorch/trained_models/O3/*.ckpt','cnn/pytorch/trained_models/O3/*.ini']},
     keywords=['soapcw','soap','gravitational waves','pulsars','neutron stars','continuous waves'],
     name='soapcw',
     packages=find_packages(),
     setup_requires=setup_requirements,
     test_suite='tests',
     tests_require=test_requirements,
     url='https://git.ligo.org/joseph.bayley/soapcw',
     download_url='https://git.ligo.org/joseph.bayley/soapcw/-/archive/0.1.2/soapcw-0.1.2.tar.gz',
-    version='0.1.3',
     zip_safe=False,
     ext_modules = cythonize(ext_modules),
     cmdclass=cmdclass,
 )
```

### Comparing `soapcw-0.1.3/tests/SNR_injections.ipynb` & `soapcw-0.1.5/tests/SNR_injections.ipynb`

 * *Files identical despite different names*

### Comparing `soapcw-0.1.3/docs/make.bat` & `soapcw-0.1.5/docs/make.bat`

 * *Files identical despite different names*

### Comparing `soapcw-0.1.3/docs/installation.rst` & `soapcw-0.1.5/docs/installation.rst`

 * *Files identical despite different names*

### Comparing `soapcw-0.1.3/docs/Makefile` & `soapcw-0.1.5/docs/Makefile`

 * *Files identical despite different names*

### Comparing `soapcw-0.1.3/docs/conf.py` & `soapcw-0.1.5/docs/conf.py`

 * *Files identical despite different names*

### Comparing `soapcw-0.1.3/soapcw/cw/timeseries.py` & `soapcw-0.1.5/soapcw/cw/timeseries.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 import numpy as np
-from pycbc.frame import read_frame as read_frame_pycbc
+#from pycbc.frame import read_frame as read_frame_pycbc
 from .sft import SFT
 
 class TimeSeries:
     
     def __init__(self):
         """ Class to contain timeseries"""
```

### Comparing `soapcw-0.1.3/soapcw/cw/sft.py` & `soapcw-0.1.5/soapcw/cw/sft.py`

 * *Files 1% similar despite different names*

```diff
@@ -40,15 +40,15 @@
             fraction of each day which contained real data
         '''
         data = getattr(self,sum_type)
         data_av1 = []
         dutycycle = []
         sum_epochs = []
         sum_rng_med = []
-
+        
         for i in np.arange(0,self.nsft,nsfts).astype(int):
             end = i+nsfts
             if end >= self.nsft:
                 data = np.vstack([data,gap_val*np.ones((end - self.nsft, len(data[0])))])
             chunk = data[int(i):int(end)]
             av = np.nansum(chunk.T,axis=1)
             if np.isnan(gap_val):
@@ -60,15 +60,14 @@
             dutycycle.append(fr)
             if hasattr(self, "rng_med"):
                 sum_rng_med.append(np.nanmedian(self.rng_med[int(i):int(end)]))
 
             if self.epochs is not None:
                 sum_epochs.append(self.epochs[int(i)] + 0.5*nsfts*self.tsft)
 
-                        
         setattr(self,"summed_{}".format(sum_type),np.array(data_av1))
         setattr(self,"summed_dutycycle",np.array(dutycycle))
         setattr(self,"summed_epochs",np.array(sum_epochs))
         if hasattr(self,"rng_med"):
             setattr(self, "summed_rng_med", np.array(sum_rng_med))
```

### Comparing `soapcw-0.1.3/soapcw/cw/generate_data.py` & `soapcw-0.1.5/soapcw/cw/generate_data.py`

 * *Files 6% similar despite different names*

```diff
@@ -8,21 +8,46 @@
 import scipy.stats as st
 import time
 import os
 import copy
 import subprocess
 from .sft import SFT
 from .timeseries import TimeSeries
+from .tools import download_ephemeris_file, LAL_EPHEMERIS_URL
 
 
 class GenerateSignal:
     
-    def __init__(self,alpha=None,delta=None,psi=None,phi0=None,cosi=None,h0=None,f0=None,earth_ephem=None,sun_ephem=None,snr=None):
+    def __init__(self,alpha=None,delta=None,psi=None,phi0=None,cosi=None,h0=None,f=None,tref=None,earth_ephem=None,sun_ephem=None,snr=None):
         """
         Set up parameters to generate a CW signal in noise
+        args
+        ---------
+        alpha: float
+            right ascencion for object, [0, 2pi]
+        delta: float
+            declination of object [-pi/2, pi/2]
+        psi: float
+            polarisation of object [0,2pi]
+        phi0: float
+            initial phase of signal
+        cosi: float
+            cosine of the inclination of star [0,1]
+        h0: float
+            Amplitude of the gravitational wave
+        f: list or array
+            2 component list of frequency parameters [f, fdot]
+        tref: float
+            reference time for phase (default tstart)
+        earth_ephem: string
+            path to earth ephemeris file
+        sun_ephem: string
+            path to sun ephemeris file
+        snr: float
+            SNR of signal, overwrites the h0 parameter
         """
         if earth_ephem is None:
             self.earth_ephem = "earth00-19-DE405.dat.gz"
         else:
             self.earth_ephem = earth_ephem
         if sun_ephem is None:
             self.sun_ephem = "sun00-19-DE405.dat.gz"
@@ -31,19 +56,20 @@
         
         self.alpha = alpha
         self.delta = delta
         self.psi   = psi
         self.phi0  = phi0
         self.cosi  = cosi
         self.h0    = h0
-        self.f0    = f0
+        self.f     = f
+        self.tref = None
         
         self.gaps = False
         self.snr = snr
-        
+        self.edat = None
         self.antenna_pattern = True
         
     def param_check(self):
         
         for i,v in enumerate(params[:-2]):
             if np.isnan(v):
                 raise Exception("parameter {} is not a valid value".format(params_names[i]))
@@ -100,25 +126,34 @@
         lalpulsar.BarycenterEarth(earth,epoch,edat)
 
         # transforms arrival time (epoch) into pulse emission time                                                                           
         lalpulsar.Barycenter(emit,baryinput,earth)
 
         return emit.vDetector
 
-    def get_detector_velocities(self,epochs,det,edat = None):
-
+    def get_detector_velocities(self,epochs: np.array,det: str,edat = None):
+        """
+        get the velocities of the detector
+        args
+        -------------
+        epochs: array or list
+            list of the epoch times you would like to get their velocities
+        det: detector
+            which detector you would like this data for
+        edat: LALEphemeris (optional)
+            ephemeris data for solar system (can be auto loaded with get_edat)
+        """
         if edat is not None:
             edat = edat
         elif self.edat is None:
             self.get_edat()
             edat = self.edat
         else:
             edat = self.edat
 
-
         self.det_vels = np.array(np.zeros((len(epochs),3))*np.nan)
         freqs = np.zeros(len(epochs))
         for i,epoch in enumerate(epochs):
             # get the detector velocity at certain epoch and ephemeris data                                                                  
             #epoch = lal.LIGOTimeGPS(epoch,0)                                                                                                
             vel = self.detector_velocity(edat,epoch,det)
             self.det_vels[i] = vel
@@ -305,21 +340,19 @@
     def get_edat(self):
         """
         Get the ephemeris data from supplied ephemeris files, if not defined will download filenames
         """
         try:
             self.edat_p = [self.sun_ephem,self.earth_ephem]
             self.edat = lalpulsar.InitBarycenter(earthEphemerisFile=self.earth_ephem,sunEphemerisFile=self.sun_ephem)
-        except RuntimeError:
+        except Exception as e:
+            print("Could not load ephemeris file: {} {}, {}".format(self.earth_ephem, self.sun_ephem, e))
             try:
-                # try downloading the ephemeris files
-                from astropy.utils.data import download_file
-                self.DOWNLOAD_URL = 'https://git.ligo.org/lscsoft/lalsuite/raw/master/lalpulsar/lib/{}'
-                self.earth_ephem = download_file(self.DOWNLOAD_URL.format(self.earth_ephem), cache=True)
-                self.sun_ephem = download_file(self.DOWNLOAD_URL.format(self.sun_ephem), cache=True)
+                self.earth_ephem = download_ephemeris_file(LAL_EPHEMERIS_URL.format(self.earth_ephem))
+                self.sun_ephem = download_ephemeris_file(LAL_EPHEMERIS_URL.format(self.sun_ephem))
                 self.edat_p = [self.sun_ephem,self.earth_ephem]
                 self.edat = lalpulsar.InitBarycenter(earthEphemerisFile=self.earth_ephem,sunEphemerisFile=self.sun_ephem)
             except Exception as e:
                 raise IOError("Could not read in ephemeris files: {}".format(e))
         
 
 
@@ -735,21 +768,26 @@
         dict: 
         {"spect_1","spect_2","freq_track_1","freq_track_2","fmin","fmax","h0","SNR_1","SNR_2","SSB_track_index","depth","freqs","tot_snr"}
         """
 
         # initialise the SFT
         sft = SFT(tsft=self.tsft)
 
+        #print("input minmaxf", self.fmin, self.fmax)
         # define the parameters of the sft
-        self.fmin = np.floor(self.fmin*self.tsft).astype(int)/float(self.tsft) # min frequency
-        self.fmax = np.floor(self.fmax*self.tsft).astype(int)/float(self.tsft) # max frequency
+        #print("multipl", self.fmin*self.tsft, np.round(self.fmin*self.tsft), np.round(self.fmin*self.tsft).astype(int))
+        #print("multipl2", self.fmax*self.tsft, np.round(self.fmax*self.tsft), np.round(self.fmax*self.tsft).astype(int))
+        self.fmin = np.round(self.fmin*self.tsft).astype(int)/float(self.tsft) # min frequency
+        self.fmax = np.round(self.fmax*self.tsft).astype(int)/float(self.tsft) # max frequency
+        #print("round minmaxf", self.fmin, self.fmax)
 
-        self.nbins = int((self.fmax-self.fmin)*self.tsft) # number of frequency bins
+        self.nbins = np.round((self.fmax-self.fmin)*self.tsft).astype(int) # number of frequency bins
+        #print("nbins:", self.fmin, self.fmax, self.fmax-self.fmin, (self.fmax-self.fmin)*self.tsft, np.round((self.fmax-self.fmin)*self.tsft))
         self.delta_f = 1./self.tsft # separation of bins in frequency
-        self.frequencies = np.arange(self.fmin,self.fmax,sft.delta_f)[:-1] # bin centers for each bin
+        self.frequencies = np.arange(self.fmin,self.fmax,sft.delta_f)#[:-1] # bin centers for each bin
 
         sft.fmin = self.fmin
         sft.fmax = self.fmax
         sft.frequencies = self.frequencies
         sft.nbins = self.nbins
         sft.delta_f = self.delta_f
         sft.nsft = len(epochs)
```

### Comparing `soapcw-0.1.3/soapcw/cw/make_sfts.py` & `soapcw-0.1.5/soapcw/cw/make_sfts.py`

 * *Files identical despite different names*

### Comparing `soapcw-0.1.3/soapcw/cw/load_sfts.py` & `soapcw-0.1.5/soapcw/cw/load_sfts.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,97 +1,113 @@
 import lalpulsar
 from .sft import SFT
 import lal
 import numpy as np
+import time
 
 class LoadSFT:
     
 
-    def __init__(self,sftpath,fmin=None,fmax=None,norm=False,summed=False,filled=False,remove_sft=True,save_rngmed=False,tmin=None,tmax=None,vetolist = None):
+    def __init__(self,sftpath,fmin=None,fmax=None,norm=False,summed=False,filled=False,remove_sft=True,save_rngmed=False,tmin=None,tmax=None,vetolist = None, verbose=False):
         """
         Load an SFT from multiple detectors
         args
         -----------------
-        sftpath: str
+        sftpath: str or np.ndarray
             path to the sft files, for multiple files separate by semicolon, 'filename1;filename2;.....' can input from multiple detectors
+            or input an np.ndarray of shape (Ndetectors, Ntimesteps, Nfreqbins)
         fmin: float
             minimum frequency to load from sft
         fmax: float
             maximum frequency to load from sft
         norm: bool or int
             normalise sft to running median, if integer running median of that many bins
         summed: bool or int
-            sum normalised spectrograms over number of bins (default 48 (1day of 1800s)) or set to value
+            sum normalised spectrograms over number of bins (if True default 48 (1day of 1800s)) or set to value
         filled: bool
             fill the gaps in the sfts with the expected value (2 for normalised sfts, nan for sfts)
         remove_sft: bool
             remove original sft after normalising to running median
         save_rndmed: bool
             save the running median as an estimate of noise floor
         tmin: float
             start time for sfts
         tmax: float
             end time for sfts
         vetolist: list
             list of frequency bins to set to expected value (2 or nan) (and +/- 3 bins of selected bin)
+        det_names: list
+            list of detector names (only necessary when using np.ndarray as input to sftpath)
         """
-        # load the sft
-        self.get_sft(sftpath,fmin=fmin,fmax=fmax,tmin=tmin,tmax=tmax)
+        self.verbose = verbose
+
+        if type(sftpath) is str:
+            # load the sft
+            self.get_sft(sftpath,fmin=fmin,fmax=fmax,tmin=tmin,tmax=tmax)
+        elif type(sftpath) is dict:
+            self.get_sft_from_array(sftpath, fmin=fmin, fmax=fmax, tmin=tmin, tmax=tmax)
+        else:
+            raise Exception(f"Please use a type str or np.ndarray for the input of sftpath, you used type {type(sftpath)}")
 
         # normalise sft to the running median
         if norm is not None:
             if norm == True:
                 # set number of bins to running median to 100 as default
                 norm = 100
                 self.norm_rngmed(med_width=norm, remove_sft = remove_sft,save_rngmed=save_rngmed)
             elif norm == False:
                 pass
             else:
                 # set the number of bins for running median
                 self.norm_rngmed(med_width=norm, remove_sft = remove_sft,save_rngmed=save_rngmed) 
 
+        print("rngmedshape",np.shape(self.H1.rng_med))
         # set the frequency bins to veto, i.e. set to mean of spectrogram
         if vetolist is not None:
             self.veto_freq_bins(vetolist)
 
-        # sum sfts over given range
-        if summed == False:
-            pass
-        elif summed:
-            if summed == True:
-                self.sum_sfts()
-            else:
-                self.sum_sfts(summed)
-
         # fill the gaps in the sfts
         if filled:
             # fills gaps with mean of chi2(2) distribution
             self.fill_gaps()
             # fills gaps at start and end of each detector to align sfts
             self.align_sfts()
 
+        # sum sfts over given range
+        if type(summed) is bool:
+            if summed:
+                self.sum_sfts()
+                self.n_summed_sfts = 48
+            else:
+                self.n_summed_sfts = 1
+        elif type(summed) is int:
+            self.sum_sfts(nsfts=summed)
+            self.n_summed_sfts = summed
+        else:
+            print(f"WARNING: Summed must be of type int, you have {type(summed)}")
+
+
     def get_sft(self,sftpath,fmin=None,fmax=None,tmin=None,tmax=None,vetolist = None):
         '''
         load an sft to a numpy array, 
         args
         -------
         sftpath : string
             path to the sft file
-        detector: string
-            which detector i.e 'H1'
         fmin    : float
             minimum frequency
         fmax    : float
             maximum frequency
         tmin    : float
             min time
         tmax    : float
             max time
         '''
-        
+        if self.verbose:
+            start_time = time.time()
         # set up contraints for data
         constraints = lalpulsar.SFTConstraints()
 
         # set fmin and fmax to all sfts as default
         if fmin is None:
             fmin = -1
         if fmax is None:
@@ -101,14 +117,16 @@
         if tmin is not None:
             self.tmin_gps = lal.LIGOTimeGPS(int(tmin),0)
             constraints.minStartTime=self.tmin_gps
         if tmax is not None:
             self.tmax_gps = lal.LIGOTimeGPS(int(tmax),0)
             constraints.maxStartTime=self.tmax_gps
 
+        if not type(sftpath) == str:
+            sftpath = ";".join([s.strip() for s in sftpath])
         # create cataologue of sfts under specified constraints
         catalogue = lalpulsar.SFTdataFind(sftpath,constraints)
 
         # load the sfts from the catalogue above (currently uses multi SFTs as there is a memory leak in LoadSFTs)
         # sfts = lalpulsar.LoadSFTs(catalogue,fmin,fmax)
         sfts = lalpulsar.LoadMultiSFTs(catalogue,fmin,fmax)
         # keep sft set
@@ -159,29 +177,111 @@
                 # fill sft with data
                 data.sft[i,:] = sft.data.data
                 # record epoch of each sft
                 data.epochs[i] = sft.epoch
                 
             # save sft for detector
             setattr(self,detname,data)
+        if self.verbose:
+            print("Load SFTs time: ", time.time() - start_time)
+
+    def get_sft_from_array(self,sftpath,fmin=None,fmax=None,tmin=None,tmax=None,vetolist = None):
+        '''
+        load an sft to a numpy array, 
+        args
+        -------
+        sftpath :dict
+            dict containing detector dicts
+        detector: string
+            which detector i.e 'H1'
+        fmin    : float
+            minimum frequency
+        fmax    : float
+            maximum frequency
+        tmin    : float
+            min time
+        tmax    : float
+            max time
+        '''
+        if self.verbose:
+            start_time = time.time()
+        temp_nsft = []
+        temp_nbin = []
+        self.det_names = []
+
+        for name,sdict in sftpath.items():
+            # get detectors name
+            detname = name
+            self.det_names.append(detname)
+
+            assert len(sdict["sft"]) == len(sdict["epochs"]), f'Timestamps (Epochs) should match the length of the SFT, sftlen:{len(sdict["sft"])}, epochlen:{len(sdict["epochs"])}'
+
+            # initialise SFT for detector
+            data = SFT()
 
+            sftshape = np.shape(sdict["sft"])
+            # set parameters of sft
+            data.nsft = sftshape[0]
+
+            #define range of frequency bin centers
+            if "frequencies" in sdict:
+                data.frequencies = sdict["frequencies"]
+                data.nbins = len(sdict["frequencies"])
+                data.f0 = sdict["frequencies"][0]
+                data.delta_f = sdict["frequencies"][1] - sdict["frequencies"][0]
+                data.tsft = 1.0/data.delta_f
+            elif "f0" in sdict and "delta_f" in sdict:
+                data.nbins = sftshape[1]
+                data.delta_f = sdict["delta_f"]
+                data.f0 = sdict["f0"]
+                data.tsft = 1.0/sdict["delta_f"]
+                data.frequencies = np.arange(data.nbins)*data.delta_f + data.f0
+            else:
+                raise Exception(f"Please define the frequencies or f0 and delta_f in the input dict, currently only {sdict.keys()}")
+            
+            temp_nbin.append(data.nbins)
+            temp_nsft.append(data.nsft)
+
+            if len(set(temp_nsft)) > 1:
+                print("Warning!: tsft not the same between detectors.")
+            
+            if len(set(temp_nbin)) > 1:
+                print("Warning!: different detectors do not have the same number of frequency bins")
+
+            # create empty arrays for likleyhoods and epochs
+            data.sft = np.zeros((data.nsft,data.nbins)).astype(np.complex_)
+            data.epochs = np.zeros(data.nsft)
+            # set fmin and fmax
+            data.fmin = data.f0
+            data.fmax = data.f0 + data.nbins/data.tsft
+
+
+            data.sft = sdict["sft"].astype(np.complex_)
+            data.epochs = sdict["epochs"]
+                
+            # save sft for detector
+            setattr(self,detname,data)
+        if self.verbose:
+            print("Load SFTs time: ", time.time() - start_time)
             
    
     def norm_rngmed(self,med_width=100,remove_sft = False, save_rngmed=False):
         """
         normalise the SFT to the running median and save the output power
         args
         ---------------
         med_width: int (optional)
             number of bins to use for running median, default 100
         remove_sft: bool
             remove the original complex sfts save only the normalised power, default false
         save_rngmed: bool
             save the running median to use as noise floor later, default false
         """
+        if self.verbose:
+            start_time = time.time()
 
         for det in self.det_names:
             # get sft for detector
             sfts = getattr(self,det)
             
             # create empty vectors for sft and normalised power
             sig2 = lal.CreateREAL8FrequencySeries(None,0,0,1./sfts.tsft,lal.SecondUnit,sfts.nbins)
@@ -198,14 +298,17 @@
                 if save_rngmed:
                     sfts.rng_med[i,:] = sig2.data.data
                 # fill likleyhood arrays with sft data normalised to running median (multiplied by two to be chi2 distribution)
                 sfts.norm_sft_power[i,:] = 2*np.abs(c_sft.data.data/np.sqrt(sig2.data.data))**2
 
             if remove_sft:
                 del sfts.sft
+
+        if self.verbose:
+            print("Normalise SFTs time: ", time.time() - start_time)
                 
                 
     def veto_freq_bins(self,vetolist):
         """
         If frequency bins to be vetoed, set to mean of nornalised chi2 for spectrogram power or nans for sfts
         Vetoes the input bin and +/- 2 bins 
         args
@@ -248,29 +351,30 @@
         returns
         ---------
         new_index : new likleyhood array with time gaps filled with twos
         sft_index : index of each sft
         new_epoch : epochs after data is filled
         '''
         
+        if self.verbose:
+            start_time = time.time()
 
         for det in self.det_names:
             sft = getattr(self,det)
             # set epochs index for each sft
             sft_index = np.floor((sft.epochs - sft.epochs[0])/sft.tsft).astype('int')
 
             if hasattr(sft,"sft"):
                 if sft.sft is not None:
                     # set equally spaced epochs from start time to end time
                     new_sft = np.array(np.ones((sft_index[-1]+1,sft.sft.shape[1]))*2).astype("complex")
                     # fill appropriate epochs with real data
                     for i,idx in enumerate(sft_index):
                         new_sft[idx,:] = sft.sft[i,:]
                     sft.sft = new_sft
-                    del new_sft
 
             if hasattr(sft,"norm_sft_power"):
                 if sft.norm_sft_power is not None:
                     new_sft = np.ones((sft_index[-1]+1,sft.norm_sft_power.shape[1]))*2
                     for i,idx in enumerate(sft_index):
                         new_sft[idx,:] = sft.norm_sft_power[i,:]
                     sft.norm_sft_power = new_sft
@@ -280,26 +384,31 @@
                     new_sft = np.ones((sft_index[-1]+1,sft.rng_med.shape[1]))*np.nan
                     for i,idx in enumerate(sft_index):
                         new_sft[idx,:] = sft.rng_med[i,:]
                     sft.rng_med = new_sft
 
             # rerun summing of sfts
             if hasattr(sft,"summed_norm_sft_power"):
-                sft.sum_sft()
+                sft.sum_sft(nsfts=self.n_summed_sfts)
 
             # define new epochs for filled data
             new_epoch = np.arange(len(new_sft))*sft.tsft + sft.epochs[0]
             sft.epochs = new_epoch
             sft.nsft = len(sft.epochs)
+        if self.verbose:
+            print("Fill gaps time: ", time.time() - start_time)
 
 
     def align_sfts(self):
         """
         fill the start and end portions of sfts such that each detector has the same length of data
         """
+        if self.verbose:
+            start_time = time.time()
+
         # define minimim and maximum epochs
         min_ep = np.inf
         max_ep = -np.inf
         min_det = None
         max_det = None
         tsft = None
         for det in self.det_names:
@@ -319,40 +428,44 @@
 
         for det in self.det_names:
             sft = getattr(self,det)
             # find epoch indicies
             sft_index = np.floor((sft.epochs - min_ep)/sft.tsft).astype('int')
 
             if hasattr(sft,"sft"):
-                new_sft = np.array(np.ones((num_ep+1,sft.sft.shape[1]))*2).astype("complex")
-                for i,idx in enumerate(sft_index):
-                    new_sft[idx,:] = sft.sft[i,:]
-                sft.sft = new_sft
-                del new_sft
+                if sft.sft is not None:
+                    new_sft = np.array(np.ones((num_ep+1,sft.sft.shape[1]))*2).astype("complex")
+                    for i,idx in enumerate(sft_index):
+                        new_sft[idx,:] = sft.sft[i,:]
+                    sft.sft = new_sft
 
             if hasattr(sft,"norm_sft_power"):
-                new_sft = np.ones((num_ep+1,sft.norm_sft_power.shape[1]))*2
-                for i,idx in enumerate(sft_index):
-                    new_sft[idx,:] = sft.norm_sft_power[i,:]
-                sft.norm_sft_power = new_sft
+                if sft.norm_sft_power is not None:
+                    new_sft = np.ones((num_ep+1,sft.norm_sft_power.shape[1]))*2
+                    for i,idx in enumerate(sft_index):
+                        new_sft[idx,:] = sft.norm_sft_power[i,:]
+                    sft.norm_sft_power = new_sft
 
             if hasattr(sft,"rng_med"):
-                new_rng = np.ones((num_ep+1,sft.rng_med.shape[1]))*2
-                for i,idx in enumerate(sft_index):
-                    new_rng[idx,:] = sft.rng_med[i,:]
-                sft.rng_med = new_rng
+                if sft.rng_med is not None:
+                    new_rng = np.ones((num_ep+1,sft.rng_med.shape[1]))*2
+                    for i,idx in enumerate(sft_index):
+                        new_rng[idx,:] = sft.rng_med[i,:]
+                    sft.rng_med = new_rng
 
 
             new_epoch = np.arange(len(new_sft))*sft.tsft + sft.epochs[0]
             sft.epochs = new_epoch
             sft.nsft = len(sft.epochs)
 
             if hasattr(sft,"summed_norm_sft_power"):
-                sft.sum_sft()
+                sft.sum_sft(nsfts=self.n_summed_sfts)
 
+        if self.verbose:
+            print("Align SFTs time: ", time.time() - start_time)
         
             
     def sum_sfts(self,sum_type="norm_sft_power",gap_val = 2,nsfts=48):
         '''
         takes input sfts with tsft=1800s and returns sum of 48 sfts, i.e summing over a day
         and returns fraction of real data in each sum.
         args
@@ -362,23 +475,35 @@
         returns
         -----------
         data_av: array
             data summed over every day
         fraction: array
             fraction of each day which contained real data
         '''
+        if self.verbose:
+            start_time = time.time()
+
         for dt in self.det_names:
             data = getattr(self,dt)
             data.sum_sft(sum_type=sum_type,gap_val=gap_val,nsfts=nsfts,remove_original=False)
 
+        if self.verbose:
+            print("Sum SFTs time: ", time.time() - start_time)
+
     def downsamp_frequency(self,data_type="summed_norm_sft_power",stride = 2,remove_original=False):
         '''
         downsample frequency of sfts by taking mean of a number (stride) of frequency bins starting from base of band
         args
         -------
         stride: int
             number of frequency bins to take mean of and downsample by
         '''
+        if self.verbose:
+            start_time = time.time()
+
         for dt in self.det_names:
             data = getattr(self,dt)
             data.downsamp_frequency(data_type=data_type,stride=stride,remove_original=remove_original)
 
+        if self.verbose:
+            print("Downsamp frequency time: ", time.time() - start_time)
+
```

### Comparing `soapcw-0.1.3/soapcw/soapcw.c` & `soapcw-0.1.5/soapcw/soapcw.c`

 * *Files 1% similar despite different names*

```diff
@@ -1,31 +1,33 @@
-/* Generated by Cython 0.29.14 */
+/* Generated by Cython 0.29.35 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [],
         "name": "soapcw.soapcw",
         "sources": [
             "soapcw/soapcw.pyx"
         ]
     },
     "module_name": "soapcw.soapcw"
 }
 END: Cython Metadata */
 
+#ifndef PY_SSIZE_T_CLEAN
 #define PY_SSIZE_T_CLEAN
+#endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_14"
-#define CYTHON_HEX_VERSION 0x001D0EF0
+#define CYTHON_ABI "0_29_35"
+#define CYTHON_HEX_VERSION 0x001D23F0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -56,14 +58,15 @@
 #ifndef Py_HUGE_VAL
   #define Py_HUGE_VAL HUGE_VAL
 #endif
 #ifdef PYPY_VERSION
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_PYSTON 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
+  #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
   #define CYTHON_USE_TYPE_SLOTS 0
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #if PY_VERSION_HEX < 0x03050000
     #undef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 0
@@ -84,26 +87,34 @@
   #define CYTHON_ASSUME_SAFE_MACROS 0
   #undef CYTHON_UNPACK_METHODS
   #define CYTHON_UNPACK_METHODS 0
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
-  #undef CYTHON_PEP489_MULTI_PHASE_INIT
-  #define CYTHON_PEP489_MULTI_PHASE_INIT 0
+  #if PY_VERSION_HEX < 0x03090000
+    #undef CYTHON_PEP489_MULTI_PHASE_INIT
+    #define CYTHON_PEP489_MULTI_PHASE_INIT 0
+  #elif !defined(CYTHON_PEP489_MULTI_PHASE_INIT)
+    #define CYTHON_PEP489_MULTI_PHASE_INIT 1
+  #endif
   #undef CYTHON_USE_TP_FINALIZE
   #define CYTHON_USE_TP_FINALIZE 0
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
+  #endif
 #elif defined(PYSTON_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_PYSTON 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
+  #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #undef CYTHON_USE_ASYNC_SLOTS
   #define CYTHON_USE_ASYNC_SLOTS 0
@@ -133,18 +144,67 @@
   #define CYTHON_PEP489_MULTI_PHASE_INIT 0
   #undef CYTHON_USE_TP_FINALIZE
   #define CYTHON_USE_TP_FINALIZE 0
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
+  #endif
+#elif defined(PY_NOGIL)
+  #define CYTHON_COMPILING_IN_PYPY 0
+  #define CYTHON_COMPILING_IN_PYSTON 0
+  #define CYTHON_COMPILING_IN_CPYTHON 0
+  #define CYTHON_COMPILING_IN_NOGIL 1
+  #ifndef CYTHON_USE_TYPE_SLOTS
+    #define CYTHON_USE_TYPE_SLOTS 1
+  #endif
+  #undef CYTHON_USE_PYTYPE_LOOKUP
+  #define CYTHON_USE_PYTYPE_LOOKUP 0
+  #ifndef CYTHON_USE_ASYNC_SLOTS
+    #define CYTHON_USE_ASYNC_SLOTS 1
+  #endif
+  #undef CYTHON_USE_PYLIST_INTERNALS
+  #define CYTHON_USE_PYLIST_INTERNALS 0
+  #ifndef CYTHON_USE_UNICODE_INTERNALS
+    #define CYTHON_USE_UNICODE_INTERNALS 1
+  #endif
+  #undef CYTHON_USE_UNICODE_WRITER
+  #define CYTHON_USE_UNICODE_WRITER 0
+  #undef CYTHON_USE_PYLONG_INTERNALS
+  #define CYTHON_USE_PYLONG_INTERNALS 0
+  #ifndef CYTHON_AVOID_BORROWED_REFS
+    #define CYTHON_AVOID_BORROWED_REFS 0
+  #endif
+  #ifndef CYTHON_ASSUME_SAFE_MACROS
+    #define CYTHON_ASSUME_SAFE_MACROS 1
+  #endif
+  #ifndef CYTHON_UNPACK_METHODS
+    #define CYTHON_UNPACK_METHODS 1
+  #endif
+  #undef CYTHON_FAST_THREAD_STATE
+  #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_PYCALL
+  #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
+    #define CYTHON_PEP489_MULTI_PHASE_INIT 1
+  #endif
+  #ifndef CYTHON_USE_TP_FINALIZE
+    #define CYTHON_USE_TP_FINALIZE 1
+  #endif
+  #undef CYTHON_USE_DICT_VERSIONS
+  #define CYTHON_USE_DICT_VERSIONS 0
+  #undef CYTHON_USE_EXC_INFO_STACK
+  #define CYTHON_USE_EXC_INFO_STACK 0
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_PYSTON 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
+  #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
   #if PY_VERSION_HEX < 0x02070000
     #undef CYTHON_USE_PYTYPE_LOOKUP
     #define CYTHON_USE_PYTYPE_LOOKUP 0
   #elif !defined(CYTHON_USE_PYTYPE_LOOKUP)
@@ -156,61 +216,72 @@
   #elif !defined(CYTHON_USE_ASYNC_SLOTS)
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
   #if PY_VERSION_HEX < 0x02070000
     #undef CYTHON_USE_PYLONG_INTERNALS
     #define CYTHON_USE_PYLONG_INTERNALS 0
   #elif !defined(CYTHON_USE_PYLONG_INTERNALS)
-    #define CYTHON_USE_PYLONG_INTERNALS 1
+    #define CYTHON_USE_PYLONG_INTERNALS (PY_VERSION_HEX < 0x030C00A5)
   #endif
   #ifndef CYTHON_USE_PYLIST_INTERNALS
     #define CYTHON_USE_PYLIST_INTERNALS 1
   #endif
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
-  #if PY_VERSION_HEX < 0x030300F0
+  #if PY_VERSION_HEX < 0x030300F0 || PY_VERSION_HEX >= 0x030B00A2
     #undef CYTHON_USE_UNICODE_WRITER
     #define CYTHON_USE_UNICODE_WRITER 0
   #elif !defined(CYTHON_USE_UNICODE_WRITER)
     #define CYTHON_USE_UNICODE_WRITER 1
   #endif
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
-  #ifndef CYTHON_FAST_THREAD_STATE
+  #if PY_VERSION_HEX >= 0x030B00A4
+    #undef CYTHON_FAST_THREAD_STATE
+    #define CYTHON_FAST_THREAD_STATE 0
+  #elif !defined(CYTHON_FAST_THREAD_STATE)
     #define CYTHON_FAST_THREAD_STATE 1
   #endif
   #ifndef CYTHON_FAST_PYCALL
-    #define CYTHON_FAST_PYCALL 1
+    #define CYTHON_FAST_PYCALL (PY_VERSION_HEX < 0x030A0000)
   #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
   #ifndef CYTHON_USE_DICT_VERSIONS
-    #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
+    #define CYTHON_USE_DICT_VERSIONS ((PY_VERSION_HEX >= 0x030600B1) && (PY_VERSION_HEX < 0x030C00A5))
   #endif
-  #ifndef CYTHON_USE_EXC_INFO_STACK
+  #if PY_VERSION_HEX >= 0x030B00A4
+    #undef CYTHON_USE_EXC_INFO_STACK
+    #define CYTHON_USE_EXC_INFO_STACK 0
+  #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if CYTHON_USE_PYLONG_INTERNALS
-  #include "longintrepr.h"
+  #if PY_MAJOR_VERSION < 3
+    #include "longintrepr.h"
+  #endif
   #undef SHIFT
   #undef BASE
   #undef MASK
   #ifdef SIZEOF_VOID_P
     enum { __pyx_check_sizeof_voidp = 1 / (int)(SIZEOF_VOID_P == sizeof(void*)) };
   #endif
 #endif
@@ -319,17 +390,76 @@
 #if PY_MAJOR_VERSION < 3
   #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
   #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
           PyCode_New(a+k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
   #define __Pyx_DefaultClassType PyClass_Type
 #else
   #define __Pyx_BUILTIN_MODULE_NAME "builtins"
-#if PY_VERSION_HEX >= 0x030800A4 && PY_VERSION_HEX < 0x030800B2
-  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
-          PyCode_New(a, 0, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
+  #define __Pyx_DefaultClassType PyType_Type
+#if PY_VERSION_HEX >= 0x030B00A1
+    static CYTHON_INLINE PyCodeObject* __Pyx_PyCode_New(int a, int k, int l, int s, int f,
+                                                    PyObject *code, PyObject *c, PyObject* n, PyObject *v,
+                                                    PyObject *fv, PyObject *cell, PyObject* fn,
+                                                    PyObject *name, int fline, PyObject *lnos) {
+        PyObject *kwds=NULL, *argcount=NULL, *posonlyargcount=NULL, *kwonlyargcount=NULL;
+        PyObject *nlocals=NULL, *stacksize=NULL, *flags=NULL, *replace=NULL, *call_result=NULL, *empty=NULL;
+        const char *fn_cstr=NULL;
+        const char *name_cstr=NULL;
+        PyCodeObject* co=NULL;
+        PyObject *type, *value, *traceback;
+        PyErr_Fetch(&type, &value, &traceback);
+        if (!(kwds=PyDict_New())) goto end;
+        if (!(argcount=PyLong_FromLong(a))) goto end;
+        if (PyDict_SetItemString(kwds, "co_argcount", argcount) != 0) goto end;
+        if (!(posonlyargcount=PyLong_FromLong(0))) goto end;
+        if (PyDict_SetItemString(kwds, "co_posonlyargcount", posonlyargcount) != 0) goto end;
+        if (!(kwonlyargcount=PyLong_FromLong(k))) goto end;
+        if (PyDict_SetItemString(kwds, "co_kwonlyargcount", kwonlyargcount) != 0) goto end;
+        if (!(nlocals=PyLong_FromLong(l))) goto end;
+        if (PyDict_SetItemString(kwds, "co_nlocals", nlocals) != 0) goto end;
+        if (!(stacksize=PyLong_FromLong(s))) goto end;
+        if (PyDict_SetItemString(kwds, "co_stacksize", stacksize) != 0) goto end;
+        if (!(flags=PyLong_FromLong(f))) goto end;
+        if (PyDict_SetItemString(kwds, "co_flags", flags) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_code", code) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_consts", c) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_names", n) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_varnames", v) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_freevars", fv) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_cellvars", cell) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_linetable", lnos) != 0) goto end;
+        if (!(fn_cstr=PyUnicode_AsUTF8AndSize(fn, NULL))) goto end;
+        if (!(name_cstr=PyUnicode_AsUTF8AndSize(name, NULL))) goto end;
+        if (!(co = PyCode_NewEmpty(fn_cstr, name_cstr, fline))) goto end;
+        if (!(replace = PyObject_GetAttrString((PyObject*)co, "replace"))) goto cleanup_code_too;
+        if (!(empty = PyTuple_New(0))) goto cleanup_code_too; // unfortunately __pyx_empty_tuple isn't available here
+        if (!(call_result = PyObject_Call(replace, empty, kwds))) goto cleanup_code_too;
+        Py_XDECREF((PyObject*)co);
+        co = (PyCodeObject*)call_result;
+        call_result = NULL;
+        if (0) {
+            cleanup_code_too:
+            Py_XDECREF((PyObject*)co);
+            co = NULL;
+        }
+        end:
+        Py_XDECREF(kwds);
+        Py_XDECREF(argcount);
+        Py_XDECREF(posonlyargcount);
+        Py_XDECREF(kwonlyargcount);
+        Py_XDECREF(nlocals);
+        Py_XDECREF(stacksize);
+        Py_XDECREF(replace);
+        Py_XDECREF(call_result);
+        Py_XDECREF(empty);
+        if (type) {
+            PyErr_Restore(type, value, traceback);
+        }
+        return co;
+    }
 #else
   #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
           PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
 #endif
   #define __Pyx_DefaultClassType PyType_Type
 #endif
 #ifndef Py_TPFLAGS_CHECKTYPES
@@ -435,24 +565,36 @@
 #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1 && CYTHON_USE_UNICODE_INTERNALS
 #define __Pyx_PyDict_GetItemStr(dict, name)  _PyDict_GetItem_KnownHash(dict, name, ((PyASCIIObject *) name)->hash)
 #else
 #define __Pyx_PyDict_GetItemStr(dict, name)  PyDict_GetItem(dict, name)
 #endif
 #if PY_VERSION_HEX > 0x03030000 && defined(PyUnicode_KIND)
   #define CYTHON_PEP393_ENABLED 1
-  #define __Pyx_PyUnicode_READY(op)       (likely(PyUnicode_IS_READY(op)) ?\
-                                              0 : _PyUnicode_Ready((PyObject *)(op)))
+  #if PY_VERSION_HEX >= 0x030C0000
+    #define __Pyx_PyUnicode_READY(op)       (0)
+  #else
+    #define __Pyx_PyUnicode_READY(op)       (likely(PyUnicode_IS_READY(op)) ?\
+                                                0 : _PyUnicode_Ready((PyObject *)(op)))
+  #endif
   #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_LENGTH(u)
   #define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_READ_CHAR(u, i)
   #define __Pyx_PyUnicode_MAX_CHAR_VALUE(u)   PyUnicode_MAX_CHAR_VALUE(u)
   #define __Pyx_PyUnicode_KIND(u)         PyUnicode_KIND(u)
   #define __Pyx_PyUnicode_DATA(u)         PyUnicode_DATA(u)
   #define __Pyx_PyUnicode_READ(k, d, i)   PyUnicode_READ(k, d, i)
   #define __Pyx_PyUnicode_WRITE(k, d, i, ch)  PyUnicode_WRITE(k, d, i, ch)
-  #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != (likely(PyUnicode_IS_READY(u)) ? PyUnicode_GET_LENGTH(u) : PyUnicode_GET_SIZE(u)))
+  #if PY_VERSION_HEX >= 0x030C0000
+    #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != PyUnicode_GET_LENGTH(u))
+  #else
+    #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x03090000
+    #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != (likely(PyUnicode_IS_READY(u)) ? PyUnicode_GET_LENGTH(u) : ((PyCompactUnicodeObject *)(u))->wstr_length))
+    #else
+    #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != (likely(PyUnicode_IS_READY(u)) ? PyUnicode_GET_LENGTH(u) : PyUnicode_GET_SIZE(u)))
+    #endif
+  #endif
 #else
   #define CYTHON_PEP393_ENABLED 0
   #define PyUnicode_1BYTE_KIND  1
   #define PyUnicode_2BYTE_KIND  2
   #define PyUnicode_4BYTE_KIND  4
   #define __Pyx_PyUnicode_READY(op)       (0)
   #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_SIZE(u)
@@ -493,26 +635,35 @@
 #endif
 #if PY_MAJOR_VERSION >= 3
   #define PyBaseString_Type            PyUnicode_Type
   #define PyStringObject               PyUnicodeObject
   #define PyString_Type                PyUnicode_Type
   #define PyString_Check               PyUnicode_Check
   #define PyString_CheckExact          PyUnicode_CheckExact
+#ifndef PyObject_Unicode
   #define PyObject_Unicode             PyObject_Str
 #endif
+#endif
 #if PY_MAJOR_VERSION >= 3
   #define __Pyx_PyBaseString_Check(obj) PyUnicode_Check(obj)
   #define __Pyx_PyBaseString_CheckExact(obj) PyUnicode_CheckExact(obj)
 #else
   #define __Pyx_PyBaseString_Check(obj) (PyString_Check(obj) || PyUnicode_Check(obj))
   #define __Pyx_PyBaseString_CheckExact(obj) (PyString_CheckExact(obj) || PyUnicode_CheckExact(obj))
 #endif
 #ifndef PySet_CheckExact
   #define PySet_CheckExact(obj)        (Py_TYPE(obj) == &PySet_Type)
 #endif
+#if PY_VERSION_HEX >= 0x030900A4
+  #define __Pyx_SET_REFCNT(obj, refcnt) Py_SET_REFCNT(obj, refcnt)
+  #define __Pyx_SET_SIZE(obj, size) Py_SET_SIZE(obj, size)
+#else
+  #define __Pyx_SET_REFCNT(obj, refcnt) Py_REFCNT(obj) = (refcnt)
+  #define __Pyx_SET_SIZE(obj, size) Py_SIZE(obj) = (size)
+#endif
 #if CYTHON_ASSUME_SAFE_MACROS
   #define __Pyx_PySequence_SIZE(seq)  Py_SIZE(seq)
 #else
   #define __Pyx_PySequence_SIZE(seq)  PySequence_Size(seq)
 #endif
 #if PY_MAJOR_VERSION >= 3
   #define PyIntObject                  PyLongObject
@@ -538,21 +689,21 @@
   #ifndef PyUnicode_InternFromString
     #define PyUnicode_InternFromString(s) PyUnicode_FromString(s)
   #endif
 #endif
 #if PY_VERSION_HEX < 0x030200A4
   typedef long Py_hash_t;
   #define __Pyx_PyInt_FromHash_t PyInt_FromLong
-  #define __Pyx_PyInt_AsHash_t   PyInt_AsLong
+  #define __Pyx_PyInt_AsHash_t   __Pyx_PyIndex_AsHash_t
 #else
   #define __Pyx_PyInt_FromHash_t PyInt_FromSsize_t
-  #define __Pyx_PyInt_AsHash_t   PyInt_AsSsize_t
+  #define __Pyx_PyInt_AsHash_t   __Pyx_PyIndex_AsSsize_t
 #endif
 #if PY_MAJOR_VERSION >= 3
-  #define __Pyx_PyMethod_New(func, self, klass) ((self) ? PyMethod_New(func, self) : (Py_INCREF(func), func))
+  #define __Pyx_PyMethod_New(func, self, klass) ((self) ? ((void)(klass), PyMethod_New(func, self)) : __Pyx_NewRef(func))
 #else
   #define __Pyx_PyMethod_New(func, self, klass) PyMethod_New(func, self, klass)
 #endif
 #if CYTHON_USE_ASYNC_SLOTS
   #if PY_VERSION_HEX >= 0x030500B1
     #define __Pyx_PyAsyncMethodsStruct PyAsyncMethods
     #define __Pyx_PyType_AsAsync(obj) (Py_TYPE(obj)->tp_as_async)
@@ -566,16 +717,18 @@
     typedef struct {
         unaryfunc am_await;
         unaryfunc am_aiter;
         unaryfunc am_anext;
     } __Pyx_PyAsyncMethodsStruct;
 #endif
 
-#if defined(WIN32) || defined(MS_WINDOWS)
-  #define _USE_MATH_DEFINES
+#if defined(_WIN32) || defined(WIN32) || defined(MS_WINDOWS)
+  #if !defined(_USE_MATH_DEFINES)
+    #define _USE_MATH_DEFINES
+  #endif
 #endif
 #include <math.h>
 #ifdef NAN
 #define __PYX_NAN() ((float) NAN)
 #else
 static CYTHON_INLINE float __PYX_NAN() {
   float value;
@@ -585,19 +738,18 @@
 #endif
 #if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
 #define __Pyx_truncl trunc
 #else
 #define __Pyx_truncl truncl
 #endif
 
-
+#define __PYX_MARK_ERR_POS(f_index, lineno) \
+    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__; (void)__pyx_clineno; }
 #define __PYX_ERR(f_index, lineno, Ln_error) \
-{ \
-  __pyx_filename = __pyx_f[f_index]; __pyx_lineno = lineno; __pyx_clineno = __LINE__; goto Ln_error; \
-}
+    { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }
 
 #ifndef __PYX_EXTERN_C
   #ifdef __cplusplus
     #define __PYX_EXTERN_C extern "C"
   #else
     #define __PYX_EXTERN_C extern
   #endif
@@ -704,14 +856,15 @@
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
 #define __Pyx_PySequence_Tuple(obj)\
     (likely(PyTuple_CheckExact(obj)) ? __Pyx_NewRef(obj) : PySequence_Tuple(obj))
 static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
 static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
+static CYTHON_INLINE Py_hash_t __Pyx_PyIndex_AsHash_t(PyObject*);
 #if CYTHON_ASSUME_SAFE_MACROS
 #define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))
 #else
 #define __pyx_PyFloat_AsDouble(x) PyFloat_AsDouble(x)
 #endif
 #define __pyx_PyFloat_AsFloat(x) ((float) __pyx_PyFloat_AsDouble(x))
 #if PY_MAJOR_VERSION >= 3
@@ -835,51 +988,47 @@
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* Atomics.proto */
 #include <pythread.h>
 #ifndef CYTHON_ATOMICS
     #define CYTHON_ATOMICS 1
 #endif
+#define __PYX_CYTHON_ATOMICS_ENABLED() CYTHON_ATOMICS
 #define __pyx_atomic_int_type int
-#if CYTHON_ATOMICS && __GNUC__ >= 4 && (__GNUC_MINOR__ > 1 ||\
-                    (__GNUC_MINOR__ == 1 && __GNUC_PATCHLEVEL >= 2)) &&\
-                    !defined(__i386__)
-    #define __pyx_atomic_incr_aligned(value, lock) __sync_fetch_and_add(value, 1)
-    #define __pyx_atomic_decr_aligned(value, lock) __sync_fetch_and_sub(value, 1)
+#if CYTHON_ATOMICS && (__GNUC__ >= 5 || (__GNUC__ == 4 &&\
+                    (__GNUC_MINOR__ > 1 ||\
+                    (__GNUC_MINOR__ == 1 && __GNUC_PATCHLEVEL__ >= 2))))
+    #define __pyx_atomic_incr_aligned(value) __sync_fetch_and_add(value, 1)
+    #define __pyx_atomic_decr_aligned(value) __sync_fetch_and_sub(value, 1)
     #ifdef __PYX_DEBUG_ATOMICS
         #warning "Using GNU atomics"
     #endif
-#elif CYTHON_ATOMICS && defined(_MSC_VER) && 0
-    #include <Windows.h>
+#elif CYTHON_ATOMICS && defined(_MSC_VER) && CYTHON_COMPILING_IN_NOGIL
+    #include <intrin.h>
     #undef __pyx_atomic_int_type
-    #define __pyx_atomic_int_type LONG
-    #define __pyx_atomic_incr_aligned(value, lock) InterlockedIncrement(value)
-    #define __pyx_atomic_decr_aligned(value, lock) InterlockedDecrement(value)
+    #define __pyx_atomic_int_type long
+    #pragma intrinsic (_InterlockedExchangeAdd)
+    #define __pyx_atomic_incr_aligned(value) _InterlockedExchangeAdd(value, 1)
+    #define __pyx_atomic_decr_aligned(value) _InterlockedExchangeAdd(value, -1)
     #ifdef __PYX_DEBUG_ATOMICS
         #pragma message ("Using MSVC atomics")
     #endif
-#elif CYTHON_ATOMICS && (defined(__ICC) || defined(__INTEL_COMPILER)) && 0
-    #define __pyx_atomic_incr_aligned(value, lock) _InterlockedIncrement(value)
-    #define __pyx_atomic_decr_aligned(value, lock) _InterlockedDecrement(value)
-    #ifdef __PYX_DEBUG_ATOMICS
-        #warning "Using Intel atomics"
-    #endif
 #else
     #undef CYTHON_ATOMICS
     #define CYTHON_ATOMICS 0
     #ifdef __PYX_DEBUG_ATOMICS
         #warning "Not using atomics"
     #endif
 #endif
 typedef volatile __pyx_atomic_int_type __pyx_atomic_int;
 #if CYTHON_ATOMICS
     #define __pyx_add_acquisition_count(memview)\
-             __pyx_atomic_incr_aligned(__pyx_get_slice_count_pointer(memview), memview->lock)
+             __pyx_atomic_incr_aligned(__pyx_get_slice_count_pointer(memview))
     #define __pyx_sub_acquisition_count(memview)\
-            __pyx_atomic_decr_aligned(__pyx_get_slice_count_pointer(memview), memview->lock)
+            __pyx_atomic_decr_aligned(__pyx_get_slice_count_pointer(memview))
 #else
     #define __pyx_add_acquisition_count(memview)\
             __pyx_add_acquisition_count_locked(__pyx_get_slice_count_pointer(memview), memview->lock)
     #define __pyx_sub_acquisition_count(memview)\
             __pyx_sub_acquisition_count_locked(__pyx_get_slice_count_pointer(memview), memview->lock)
 #endif
 
@@ -956,29 +1105,27 @@
 
 
 /* "soapcw/soapcw.pyx":169
  *                     pbar+=100./len(obs)
  * 
  *         cdef double max_end_prob = max(V[length-1][i] for i in range(width))             # <<<<<<<<<<<<<<
  *         cdef int previous
- *         cdef long[:] vit_track = np.zeros(length,dtype=np.int)
+ *         cdef int[:] vit_track = np.zeros(length,dtype=np.int32)
  */
 struct __pyx_obj_6soapcw_6soapcw___pyx_scope_struct_1_genexpr {
   PyObject_HEAD
   struct __pyx_obj_6soapcw_6soapcw___pyx_scope_struct__run *__pyx_outer_scope;
   int __pyx_v_i;
   int __pyx_t_0;
   int __pyx_t_1;
   int __pyx_t_2;
-  Py_ssize_t __pyx_t_3;
-  Py_ssize_t __pyx_t_4;
 };
 
 
-/* "View.MemoryView":105
+/* "View.MemoryView":106
  * 
  * @cname("__pyx_array")
  * cdef class array:             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
 struct __pyx_array_obj {
@@ -995,28 +1142,28 @@
   PyObject *_format;
   void (*callback_free_data)(void *);
   int free_data;
   int dtype_is_object;
 };
 
 
-/* "View.MemoryView":279
+/* "View.MemoryView":280
  * 
  * @cname('__pyx_MemviewEnum')
  * cdef class Enum(object):             # <<<<<<<<<<<<<<
  *     cdef object name
  *     def __init__(self, name):
  */
 struct __pyx_MemviewEnum_obj {
   PyObject_HEAD
   PyObject *name;
 };
 
 
-/* "View.MemoryView":330
+/* "View.MemoryView":331
  * 
  * @cname('__pyx_memoryview')
  * cdef class memoryview(object):             # <<<<<<<<<<<<<<
  * 
  *     cdef object obj
  */
 struct __pyx_memoryview_obj {
@@ -1031,15 +1178,15 @@
   Py_buffer view;
   int flags;
   int dtype_is_object;
   __Pyx_TypeInfo *typeinfo;
 };
 
 
-/* "View.MemoryView":965
+/* "View.MemoryView":967
  * 
  * @cname('__pyx_memoryviewslice')
  * cdef class _memoryviewslice(memoryview):             # <<<<<<<<<<<<<<
  *     "Internal class for passing memoryview slices to Python"
  * 
  */
 struct __pyx_memoryviewslice_obj {
@@ -1048,29 +1195,29 @@
   PyObject *from_object;
   PyObject *(*to_object_func)(char *);
   int (*to_dtype_func)(char *, PyObject *);
 };
 
 
 
-/* "View.MemoryView":105
+/* "View.MemoryView":106
  * 
  * @cname("__pyx_array")
  * cdef class array:             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
 
 struct __pyx_vtabstruct_array {
   PyObject *(*get_memview)(struct __pyx_array_obj *);
 };
 static struct __pyx_vtabstruct_array *__pyx_vtabptr_array;
 
 
-/* "View.MemoryView":330
+/* "View.MemoryView":331
  * 
  * @cname('__pyx_memoryview')
  * cdef class memoryview(object):             # <<<<<<<<<<<<<<
  * 
  *     cdef object obj
  */
 
@@ -1082,15 +1229,15 @@
   PyObject *(*setitem_indexed)(struct __pyx_memoryview_obj *, PyObject *, PyObject *);
   PyObject *(*convert_item_to_object)(struct __pyx_memoryview_obj *, char *);
   PyObject *(*assign_item_from_object)(struct __pyx_memoryview_obj *, char *, PyObject *);
 };
 static struct __pyx_vtabstruct_memoryview *__pyx_vtabptr_memoryview;
 
 
-/* "View.MemoryView":965
+/* "View.MemoryView":967
  * 
  * @cname('__pyx_memoryviewslice')
  * cdef class _memoryviewslice(memoryview):             # <<<<<<<<<<<<<<
  *     "Internal class for passing memoryview slices to Python"
  * 
  */
 
@@ -1218,26 +1365,26 @@
 #define __PYX_GET_DICT_VERSION(dict)  (0)
 #define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)
 #define __PYX_PY_DICT_LOOKUP_IF_MODIFIED(VAR, DICT, LOOKUP)  (VAR) = (LOOKUP);
 #endif
 
 /* GetModuleGlobalName.proto */
 #if CYTHON_USE_DICT_VERSIONS
-#define __Pyx_GetModuleGlobalName(var, name)  {\
+#define __Pyx_GetModuleGlobalName(var, name)  do {\
     static PY_UINT64_T __pyx_dict_version = 0;\
     static PyObject *__pyx_dict_cached_value = NULL;\
     (var) = (likely(__pyx_dict_version == __PYX_GET_DICT_VERSION(__pyx_d))) ?\
         (likely(__pyx_dict_cached_value) ? __Pyx_NewRef(__pyx_dict_cached_value) : __Pyx_GetBuiltinName(name)) :\
         __Pyx__GetModuleGlobalName(name, &__pyx_dict_version, &__pyx_dict_cached_value);\
-}
-#define __Pyx_GetModuleGlobalNameUncached(var, name)  {\
+} while(0)
+#define __Pyx_GetModuleGlobalNameUncached(var, name)  do {\
     PY_UINT64_T __pyx_dict_version;\
     PyObject *__pyx_dict_cached_value;\
     (var) = __Pyx__GetModuleGlobalName(name, &__pyx_dict_version, &__pyx_dict_cached_value);\
-}
+} while(0)
 static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value);
 #else
 #define __Pyx_GetModuleGlobalName(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
 #define __Pyx_GetModuleGlobalNameUncached(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
 static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name);
 #endif
 
@@ -1258,21 +1405,29 @@
 #define __Pyx_PyFunction_FastCallDict(func, args, nargs, kwargs) _PyFunction_FastCallDict(func, args, nargs, kwargs)
 #endif
 #define __Pyx_BUILD_ASSERT_EXPR(cond)\
     (sizeof(char [1 - 2*!(cond)]) - 1)
 #ifndef Py_MEMBER_SIZE
 #define Py_MEMBER_SIZE(type, member) sizeof(((type *)0)->member)
 #endif
+#if CYTHON_FAST_PYCALL
   static size_t __pyx_pyframe_localsplus_offset = 0;
   #include "frameobject.h"
+#if PY_VERSION_HEX >= 0x030b00a6
+  #ifndef Py_BUILD_CORE
+    #define Py_BUILD_CORE 1
+  #endif
+  #include "internal/pycore_frame.h"
+#endif
   #define __Pxy_PyFrame_Initialize_Offsets()\
     ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
      (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
   #define __Pyx_PyFrame_GetLocalsplus(frame)\
     (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
+#endif // CYTHON_FAST_PYCALL
 #endif
 
 /* PyObjectCall.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
 #else
 #define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
@@ -1339,15 +1494,15 @@
 #if CYTHON_USE_PYLIST_INTERNALS && CYTHON_ASSUME_SAFE_MACROS
 static CYTHON_INLINE int __Pyx_PyList_Append(PyObject* list, PyObject* x) {
     PyListObject* L = (PyListObject*) list;
     Py_ssize_t len = Py_SIZE(list);
     if (likely(L->allocated > len) & likely(len > (L->allocated >> 1))) {
         Py_INCREF(x);
         PyList_SET_ITEM(list, len, x);
-        Py_SIZE(list) = len+1;
+        __Pyx_SET_SIZE(list, len + 1);
         return 0;
     }
     return PyList_Append(list, x);
 }
 #else
 #define __Pyx_PyList_Append(L,x) PyList_Append(L,x)
 #endif
@@ -1524,15 +1679,15 @@
 #if CYTHON_USE_PYLIST_INTERNALS && CYTHON_ASSUME_SAFE_MACROS
 static CYTHON_INLINE int __Pyx_ListComp_Append(PyObject* list, PyObject* x) {
     PyListObject* L = (PyListObject*) list;
     Py_ssize_t len = Py_SIZE(list);
     if (likely(L->allocated > len)) {
         Py_INCREF(x);
         PyList_SET_ITEM(list, len, x);
-        Py_SIZE(list) = len+1;
+        __Pyx_SET_SIZE(list, len + 1);
         return 0;
     }
     return PyList_Append(list, x);
 }
 #else
 #define __Pyx_ListComp_Append(L,x) PyList_Append(L,x)
 #endif
@@ -1610,15 +1765,15 @@
 /* StrEquals.proto */
 #if PY_MAJOR_VERSION >= 3
 #define __Pyx_PyString_Equals __Pyx_PyUnicode_Equals
 #else
 #define __Pyx_PyString_Equals __Pyx_PyBytes_Equals
 #endif
 
-/* None.proto */
+/* DivInt[Py_ssize_t].proto */
 static CYTHON_INLINE Py_ssize_t __Pyx_div_Py_ssize_t(Py_ssize_t, Py_ssize_t);
 
 /* UnaryNegOverflows.proto */
 #define UNARY_NEG_WOULD_OVERFLOW(x)\
         (((x) < 0) & ((unsigned long)(x) == 0-(unsigned long)(x)))
 
 static CYTHON_UNUSED int __pyx_array_getbuffer(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /*proto*/
@@ -1684,17 +1839,23 @@
 #define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)
 #define __Pyx_PyErr_GivenExceptionMatches(err, type) PyErr_GivenExceptionMatches(err, type)
 #define __Pyx_PyErr_GivenExceptionMatches2(err, type1, type2) (PyErr_GivenExceptionMatches(err, type1) || PyErr_GivenExceptionMatches(err, type2))
 #endif
 #define __Pyx_PyException_Check(obj) __Pyx_TypeCheck(obj, PyExc_Exception)
 
 static CYTHON_UNUSED int __pyx_memoryview_getbuffer(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /*proto*/
-/* None.proto */
+/* DivInt[long].proto */
 static CYTHON_INLINE long __Pyx_div_long(long, long);
 
+/* PySequenceContains.proto */
+static CYTHON_INLINE int __Pyx_PySequence_ContainsTF(PyObject* item, PyObject* seq, int eq) {
+    int result = PySequence_Contains(seq, item);
+    return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
+}
+
 /* ImportFrom.proto */
 static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name);
 
 /* HasAttr.proto */
 static CYTHON_INLINE int __Pyx_HasAttr(PyObject *, PyObject *);
 
 /* PyObject_GenericGetAttrNoDict.proto */
@@ -1710,24 +1871,27 @@
 #else
 #define __Pyx_PyObject_GenericGetAttr PyObject_GenericGetAttr
 #endif
 
 /* SetVTable.proto */
 static int __Pyx_SetVtable(PyObject *dict, void *vtable);
 
+/* PyObjectGetAttrStrNoError.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStrNoError(PyObject* obj, PyObject* attr_name);
+
 /* SetupReduce.proto */
 static int __Pyx_setup_reduce(PyObject* type_obj);
 
 /* CalculateMetaclass.proto */
 static PyObject *__Pyx_CalculateMetaclass(PyTypeObject *metaclass, PyObject *bases);
 
 /* FetchCommonType.proto */
 static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type);
 
-/* CythonFunction.proto */
+/* CythonFunctionShared.proto */
 #define __Pyx_CyFunction_USED 1
 #define __Pyx_CYFUNCTION_STATICMETHOD  0x01
 #define __Pyx_CYFUNCTION_CLASSMETHOD   0x02
 #define __Pyx_CYFUNCTION_CCLASS        0x04
 #define __Pyx_CyFunction_GetClosure(f)\
     (((__pyx_CyFunctionObject *) (f))->func_closure)
 #define __Pyx_CyFunction_GetClassObj(f)\
@@ -1747,25 +1911,24 @@
     PyObject *func_doc;
     PyObject *func_globals;
     PyObject *func_code;
     PyObject *func_closure;
     PyObject *func_classobj;
     void *defaults;
     int defaults_pyobjects;
+    size_t defaults_size;  // used by FusedFunction for copying defaults
     int flags;
     PyObject *defaults_tuple;
     PyObject *defaults_kwdict;
     PyObject *(*defaults_getter)(PyObject *);
     PyObject *func_annotations;
 } __pyx_CyFunctionObject;
 static PyTypeObject *__pyx_CyFunctionType = 0;
 #define __Pyx_CyFunction_Check(obj)  (__Pyx_TypeCheck(obj, __pyx_CyFunctionType))
-#define __Pyx_CyFunction_NewEx(ml, flags, qualname, self, module, globals, code)\
-    __Pyx_CyFunction_New(__pyx_CyFunctionType, ml, flags, qualname, self, module, globals, code)
-static PyObject *__Pyx_CyFunction_New(PyTypeObject *, PyMethodDef *ml,
+static PyObject *__Pyx_CyFunction_Init(__pyx_CyFunctionObject* op, PyMethodDef *ml,
                                       int flags, PyObject* qualname,
                                       PyObject *self,
                                       PyObject *module, PyObject *globals,
                                       PyObject* code);
 static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *m,
                                                          size_t size,
                                                          int pyobjects);
@@ -1773,14 +1936,21 @@
                                                             PyObject *tuple);
 static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *m,
                                                              PyObject *dict);
 static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *m,
                                                               PyObject *dict);
 static int __pyx_CyFunction_init(void);
 
+/* CythonFunction.proto */
+static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml,
+                                      int flags, PyObject* qualname,
+                                      PyObject *closure,
+                                      PyObject *module, PyObject *globals,
+                                      PyObject* code);
+
 /* SetNameInClass.proto */
 #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1
 #define __Pyx_SetNameInClass(ns, name, value)\
     (likely(PyDict_CheckExact(ns)) ? _PyDict_SetItem_KnownHash(ns, name, value, ((PyASCIIObject *) name)->hash) : PyObject_SetItem(ns, name, value))
 #elif CYTHON_COMPILING_IN_CPYTHON
 #define __Pyx_SetNameInClass(ns, name, value)\
     (likely(PyDict_CheckExact(ns)) ? PyDict_SetItem(ns, name, value) : PyObject_SetItem(ns, name, value))
@@ -1879,38 +2049,62 @@
 
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_double(PyObject *, int writable_flag);
 
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_double(PyObject *, int writable_flag);
 
-/* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
+/* GCCDiagnostics.proto */
+#if defined(__GNUC__) && (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 6))
+#define __Pyx_HAS_GCC_DIAGNOSTIC
+#endif
 
 /* MemviewDtypeToObject.proto */
 static CYTHON_INLINE PyObject *__pyx_memview_get_double(const char *itemp);
 static CYTHON_INLINE int __pyx_memview_set_double(const char *itemp, PyObject *obj);
 
-/* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_int(PyObject *, int writable_flag);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_int(PyObject *, int writable_flag);
+
+/* MemviewDtypeToObject.proto */
+static CYTHON_INLINE PyObject *__pyx_memview_get_int(const char *itemp);
+static CYTHON_INLINE int __pyx_memview_set_int(const char *itemp, PyObject *obj);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(PyObject *, int writable_flag);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double(PyObject *, int writable_flag);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_long(PyObject *, int writable_flag);
 
 /* MemviewDtypeToObject.proto */
 static CYTHON_INLINE PyObject *__pyx_memview_get_long(const char *itemp);
 static CYTHON_INLINE int __pyx_memview_set_long(const char *itemp, PyObject *obj);
 
 /* MemviewSliceCopyTemplate.proto */
 static __Pyx_memviewslice
 __pyx_memoryview_copy_new_contig(const __Pyx_memviewslice *from_mvs,
                                  const char *mode, int ndim,
                                  size_t sizeof_dtype, int contig_flag,
                                  int dtype_is_object);
 
+/* CIntToPy.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
+
 /* CIntFromPy.proto */
 static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);
 
+/* CIntToPy.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
+
 /* CIntFromPy.proto */
 static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *);
 
 /* CoroutineBase.proto */
@@ -1932,14 +2126,15 @@
     PyObject *gi_weakreflist;
     PyObject *classobj;
     PyObject *yieldfrom;
     PyObject *gi_name;
     PyObject *gi_qualname;
     PyObject *gi_modulename;
     PyObject *gi_code;
+    PyObject *gi_frame;
     int resume_label;
     char is_running;
 } __pyx_CoroutineObject;
 static __pyx_CoroutineObject *__Pyx__Coroutine_New(
     PyTypeObject *type, __pyx_coroutine_body_t body, PyObject *code, PyObject *closure,
     PyObject *name, PyObject *qualname, PyObject *module_name);
 static __pyx_CoroutineObject *__Pyx__Coroutine_NewInit(
@@ -1984,29 +2179,14 @@
 static PyTypeObject *__pyx_GeneratorType = 0;
 #define __Pyx_Generator_CheckExact(obj) (Py_TYPE(obj) == __pyx_GeneratorType)
 #define __Pyx_Generator_New(body, code, closure, name, qualname, module_name)\
     __Pyx__Coroutine_New(__pyx_GeneratorType, body, code, closure, name, qualname, module_name)
 static PyObject *__Pyx_Generator_Next(PyObject *self);
 static int __pyx_Generator_init(void);
 
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_long(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_int(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_long(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double(PyObject *, int writable_flag);
-
 /* CheckBinaryVersion.proto */
 static int __Pyx_check_binary_version(void);
 
 /* InitStrings.proto */
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);
 
 static PyObject *__pyx_array_get_memview(struct __pyx_array_obj *__pyx_v_self); /* proto*/
@@ -2066,16 +2246,16 @@
 static void __pyx_memoryview_refcount_copying(__Pyx_memviewslice *, int, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice_with_gil(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_slice_assign_scalar(__Pyx_memviewslice *, int, size_t, void *, int); /*proto*/
 static void __pyx_memoryview__slice_assign_scalar(char *, Py_ssize_t *, Py_ssize_t *, int, size_t, void *); /*proto*/
 static PyObject *__pyx_unpickle_Enum__set_state(struct __pyx_MemviewEnum_obj *, PyObject *); /*proto*/
 static __Pyx_TypeInfo __Pyx_TypeInfo_double = { "double", NULL, sizeof(double), { 0 }, 0, 'R', 0, 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo_long = { "long", NULL, sizeof(long), { 0 }, 0, IS_UNSIGNED(long) ? 'U' : 'I', IS_UNSIGNED(long), 0 };
 static __Pyx_TypeInfo __Pyx_TypeInfo_int = { "int", NULL, sizeof(int), { 0 }, 0, IS_UNSIGNED(int) ? 'U' : 'I', IS_UNSIGNED(int), 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_long = { "long", NULL, sizeof(long), { 0 }, 0, IS_UNSIGNED(long) ? 'U' : 'I', IS_UNSIGNED(long), 0 };
 #define __Pyx_MODULE_NAME "soapcw.soapcw"
 extern int __pyx_module_is_main_soapcw__soapcw;
 int __pyx_module_is_main_soapcw__soapcw = 0;
 
 /* Implementation of 'soapcw.soapcw' */
 static PyObject *__pyx_builtin_object;
 static PyObject *__pyx_builtin_open;
@@ -2442,15 +2622,15 @@
 static const char __pyx_k_strided_and_direct_or_indirect[] = "<strided and direct or indirect>";
 static const char __pyx_k_Buffer_view_does_not_expose_stri[] = "Buffer view does not expose strides";
 static const char __pyx_k_Can_only_create_a_buffer_that_is[] = "Can only create a buffer that is contiguous in memory.";
 static const char __pyx_k_Cannot_assign_to_read_only_memor[] = "Cannot assign to read-only memoryview";
 static const char __pyx_k_Cannot_create_writable_memory_vi[] = "Cannot create writable memory view from read-only memoryview";
 static const char __pyx_k_ERROR_Please_use_a_transition_ma[] = "ERROR: Please use a transition matrix with dimensions larger than one";
 static const char __pyx_k_Empty_shape_tuple_for_cython_arr[] = "Empty shape tuple for cython.array";
-static const char __pyx_k_Incompatible_checksums_s_vs_0xb0[] = "Incompatible checksums (%s vs 0xb068931 = (name))";
+static const char __pyx_k_Incompatible_checksums_0x_x_vs_0[] = "Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))";
 static const char __pyx_k_Indirect_dimensions_not_supporte[] = "Indirect dimensions not supported";
 static const char __pyx_k_Invalid_mode_expected_c_or_fortr[] = "Invalid mode, expected 'c' or 'fortran', got %s";
 static const char __pyx_k_Out_of_bounds_on_buffer_access_a[] = "Out of bounds on buffer access (axis %d)";
 static const char __pyx_k_Please_input_2D_array_for_observ[] = "Please input 2D array for observation data";
 static const char __pyx_k_Please_make_sure_teh_two_input_d[] = "Please make sure teh two input data have the same dimensions";
 static const char __pyx_k_Unable_to_convert_item_to_object[] = "Unable to convert item to object";
 static const char __pyx_k_got_differing_extents_in_dimensi[] = "got differing extents in dimension %d (got %d and %d)";
@@ -2464,15 +2644,15 @@
 static PyObject *__pyx_kp_s_Can_only_create_a_buffer_that_is;
 static PyObject *__pyx_kp_s_Cannot_assign_to_read_only_memor;
 static PyObject *__pyx_kp_s_Cannot_create_writable_memory_vi;
 static PyObject *__pyx_kp_s_Cannot_index_with_type_s;
 static PyObject *__pyx_kp_u_ERROR_Please_use_a_transition_ma;
 static PyObject *__pyx_n_s_Ellipsis;
 static PyObject *__pyx_kp_s_Empty_shape_tuple_for_cython_arr;
-static PyObject *__pyx_kp_s_Incompatible_checksums_s_vs_0xb0;
+static PyObject *__pyx_kp_s_Incompatible_checksums_0x_x_vs_0;
 static PyObject *__pyx_n_s_IndexError;
 static PyObject *__pyx_kp_s_Indirect_dimensions_not_supporte;
 static PyObject *__pyx_kp_s_Invalid_mode_expected_c_or_fortr;
 static PyObject *__pyx_kp_s_Invalid_shape_in_axis_d_d;
 static PyObject *__pyx_n_s_MemoryError;
 static PyObject *__pyx_kp_s_MemoryView_of_r_at_0x_x;
 static PyObject *__pyx_kp_s_MemoryView_of_r_object;
@@ -2579,15 +2759,14 @@
 static PyObject *__pyx_n_s_idx;
 static PyObject *__pyx_n_s_import;
 static PyObject *__pyx_n_s_ind;
 static PyObject *__pyx_n_s_indicies;
 static PyObject *__pyx_n_s_inf;
 static PyObject *__pyx_n_s_init;
 static PyObject *__pyx_n_s_insert;
-static PyObject *__pyx_n_s_int;
 static PyObject *__pyx_n_u_int;
 static PyObject *__pyx_n_s_int32;
 static PyObject *__pyx_n_s_itemsize;
 static PyObject *__pyx_kp_s_itemsize_0_for_cython_array;
 static PyObject *__pyx_n_s_itertools;
 static PyObject *__pyx_n_s_j;
 static PyObject *__pyx_n_s_j1;
@@ -2904,14 +3083,16 @@
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_float_1_;
 static PyObject *__pyx_float_neg_1e6;
 static PyObject *__pyx_int_0;
 static PyObject *__pyx_int_1;
 static PyObject *__pyx_int_2;
+static PyObject *__pyx_int_112105877;
+static PyObject *__pyx_int_136983863;
 static PyObject *__pyx_int_184977713;
 static PyObject *__pyx_int_neg_1;
 static PyObject *__pyx_tuple_;
 static PyObject *__pyx_slice__8;
 static PyObject *__pyx_slice__9;
 static PyObject *__pyx_tuple__2;
 static PyObject *__pyx_tuple__3;
@@ -2935,82 +3116,83 @@
 static PyObject *__pyx_tuple__23;
 static PyObject *__pyx_tuple__24;
 static PyObject *__pyx_tuple__26;
 static PyObject *__pyx_tuple__27;
 static PyObject *__pyx_tuple__28;
 static PyObject *__pyx_tuple__29;
 static PyObject *__pyx_tuple__30;
-static PyObject *__pyx_tuple__32;
+static PyObject *__pyx_tuple__31;
 static PyObject *__pyx_tuple__33;
-static PyObject *__pyx_tuple__35;
+static PyObject *__pyx_tuple__34;
 static PyObject *__pyx_tuple__36;
-static PyObject *__pyx_tuple__38;
-static PyObject *__pyx_tuple__40;
+static PyObject *__pyx_tuple__37;
+static PyObject *__pyx_tuple__39;
 static PyObject *__pyx_tuple__41;
 static PyObject *__pyx_tuple__42;
-static PyObject *__pyx_tuple__44;
+static PyObject *__pyx_tuple__43;
 static PyObject *__pyx_tuple__45;
-static PyObject *__pyx_tuple__47;
+static PyObject *__pyx_tuple__46;
 static PyObject *__pyx_tuple__48;
-static PyObject *__pyx_tuple__50;
-static PyObject *__pyx_tuple__52;
-static PyObject *__pyx_tuple__54;
+static PyObject *__pyx_tuple__49;
+static PyObject *__pyx_tuple__51;
+static PyObject *__pyx_tuple__53;
 static PyObject *__pyx_tuple__55;
-static PyObject *__pyx_tuple__57;
+static PyObject *__pyx_tuple__56;
 static PyObject *__pyx_tuple__58;
-static PyObject *__pyx_tuple__60;
+static PyObject *__pyx_tuple__59;
 static PyObject *__pyx_tuple__61;
-static PyObject *__pyx_tuple__63;
+static PyObject *__pyx_tuple__62;
 static PyObject *__pyx_tuple__64;
-static PyObject *__pyx_tuple__66;
+static PyObject *__pyx_tuple__65;
 static PyObject *__pyx_tuple__67;
-static PyObject *__pyx_tuple__69;
+static PyObject *__pyx_tuple__68;
 static PyObject *__pyx_tuple__70;
-static PyObject *__pyx_tuple__72;
+static PyObject *__pyx_tuple__71;
 static PyObject *__pyx_tuple__73;
-static PyObject *__pyx_tuple__75;
+static PyObject *__pyx_tuple__74;
 static PyObject *__pyx_tuple__76;
-static PyObject *__pyx_tuple__78;
+static PyObject *__pyx_tuple__77;
 static PyObject *__pyx_tuple__79;
-static PyObject *__pyx_tuple__81;
-static PyObject *__pyx_tuple__83;
-static PyObject *__pyx_tuple__85;
-static PyObject *__pyx_tuple__87;
-static PyObject *__pyx_tuple__89;
-static PyObject *__pyx_tuple__91;
+static PyObject *__pyx_tuple__80;
+static PyObject *__pyx_tuple__82;
+static PyObject *__pyx_tuple__84;
+static PyObject *__pyx_tuple__86;
+static PyObject *__pyx_tuple__88;
+static PyObject *__pyx_tuple__90;
 static PyObject *__pyx_tuple__92;
 static PyObject *__pyx_tuple__93;
 static PyObject *__pyx_tuple__94;
 static PyObject *__pyx_tuple__95;
 static PyObject *__pyx_tuple__96;
 static PyObject *__pyx_tuple__97;
-static PyObject *__pyx_codeobj__31;
-static PyObject *__pyx_codeobj__34;
-static PyObject *__pyx_codeobj__37;
-static PyObject *__pyx_codeobj__39;
-static PyObject *__pyx_codeobj__43;
-static PyObject *__pyx_codeobj__46;
-static PyObject *__pyx_codeobj__49;
-static PyObject *__pyx_codeobj__51;
-static PyObject *__pyx_codeobj__53;
-static PyObject *__pyx_codeobj__56;
-static PyObject *__pyx_codeobj__59;
-static PyObject *__pyx_codeobj__62;
-static PyObject *__pyx_codeobj__65;
-static PyObject *__pyx_codeobj__68;
-static PyObject *__pyx_codeobj__71;
-static PyObject *__pyx_codeobj__74;
-static PyObject *__pyx_codeobj__77;
-static PyObject *__pyx_codeobj__80;
-static PyObject *__pyx_codeobj__82;
-static PyObject *__pyx_codeobj__84;
-static PyObject *__pyx_codeobj__86;
-static PyObject *__pyx_codeobj__88;
-static PyObject *__pyx_codeobj__90;
-static PyObject *__pyx_codeobj__98;
+static PyObject *__pyx_tuple__98;
+static PyObject *__pyx_codeobj__32;
+static PyObject *__pyx_codeobj__35;
+static PyObject *__pyx_codeobj__38;
+static PyObject *__pyx_codeobj__40;
+static PyObject *__pyx_codeobj__44;
+static PyObject *__pyx_codeobj__47;
+static PyObject *__pyx_codeobj__50;
+static PyObject *__pyx_codeobj__52;
+static PyObject *__pyx_codeobj__54;
+static PyObject *__pyx_codeobj__57;
+static PyObject *__pyx_codeobj__60;
+static PyObject *__pyx_codeobj__63;
+static PyObject *__pyx_codeobj__66;
+static PyObject *__pyx_codeobj__69;
+static PyObject *__pyx_codeobj__72;
+static PyObject *__pyx_codeobj__75;
+static PyObject *__pyx_codeobj__78;
+static PyObject *__pyx_codeobj__81;
+static PyObject *__pyx_codeobj__83;
+static PyObject *__pyx_codeobj__85;
+static PyObject *__pyx_codeobj__87;
+static PyObject *__pyx_codeobj__89;
+static PyObject *__pyx_codeobj__91;
+static PyObject *__pyx_codeobj__99;
 /* Late includes */
 
 /* "soapcw/soapcw.pyx":16
  * class single_detector(object):
  * 
  *     def __init__(self, tr, obs, prog = False, lookup_file=None, make_vitmap = True):             # <<<<<<<<<<<<<<
  *         '''
@@ -3024,14 +3206,17 @@
 static PyObject *__pyx_pw_6soapcw_6soapcw_15single_detector_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_tr = 0;
   PyObject *__pyx_v_obs = 0;
   PyObject *__pyx_v_prog = 0;
   PyObject *__pyx_v_lookup_file = 0;
   PyObject *__pyx_v_make_vitmap = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr,&__pyx_n_s_obs,&__pyx_n_s_prog,&__pyx_n_s_lookup_file,&__pyx_n_s_make_vitmap,0};
     PyObject* values[6] = {0,0,0,0,0,0};
     values[3] = ((PyObject *)((PyObject *)Py_False));
@@ -3138,14 +3323,17 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   Py_ssize_t __pyx_t_5;
   int __pyx_t_6;
   int __pyx_t_7;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
   __Pyx_INCREF(__pyx_v_tr);
   __Pyx_INCREF(__pyx_v_obs);
 
   /* "soapcw/soapcw.pyx":20
  *         initialising viterbi class
  *         '''
@@ -3500,14 +3688,17 @@
 /* Python wrapper */
 static PyObject *__pyx_pw_6soapcw_6soapcw_15single_detector_3get_vitmap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static char __pyx_doc_6soapcw_6soapcw_15single_detector_2get_vitmap[] = "\n        normalise the viterbi output such that the sum of eah column is 1\n        ";
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_15single_detector_3get_vitmap = {"get_vitmap", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_15single_detector_3get_vitmap, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6soapcw_6soapcw_15single_detector_2get_vitmap};
 static PyObject *__pyx_pw_6soapcw_6soapcw_15single_detector_3get_vitmap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_log = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("get_vitmap (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_log,0};
     PyObject* values[2] = {0,0};
     values[1] = ((PyObject *)((PyObject *)Py_False));
@@ -3576,14 +3767,17 @@
   Py_ssize_t __pyx_t_3;
   PyObject *(*__pyx_t_4)(PyObject *);
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   int __pyx_t_9;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_vitmap", 0);
 
   /* "soapcw/soapcw.pyx":45
  *         normalise the viterbi output such that the sum of eah column is 1
  *         """
  *         path_m = []             # <<<<<<<<<<<<<<
  *         for i in self.V:
@@ -3853,14 +4047,17 @@
 /* Python wrapper */
 static PyObject *__pyx_pw_6soapcw_6soapcw_15single_detector_5read_lookup(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static char __pyx_doc_6soapcw_6soapcw_15single_detector_4read_lookup[] = "\n        Read the lookup table for chosen statistic\n        ";
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_15single_detector_5read_lookup = {"read_lookup", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_15single_detector_5read_lookup, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6soapcw_6soapcw_15single_detector_4read_lookup};
 static PyObject *__pyx_pw_6soapcw_6soapcw_15single_detector_5read_lookup(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   CYTHON_UNUSED PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_filename = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_lookup (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_filename,0};
     PyObject* values[2] = {0,0};
     if (unlikely(__pyx_kwds)) {
@@ -3933,14 +4130,17 @@
   PyObject *__pyx_t_10 = NULL;
   int __pyx_t_11;
   int __pyx_t_12;
   PyObject *__pyx_t_13 = NULL;
   PyObject *__pyx_t_14 = NULL;
   int __pyx_t_15;
   PyObject *__pyx_t_16 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_lookup", 0);
 
   /* "soapcw/soapcw.pyx":64
  *         Read the lookup table for chosen statistic
  *         """
  *         with open(filename,'rb') as f1:             # <<<<<<<<<<<<<<
  *             likelihood, params = pickle.load(f1)
@@ -4332,14 +4532,17 @@
 static char __pyx_doc_6soapcw_6soapcw_15single_detector_6run[] = "\n        Run the viterbi algorithm for given single set of data and 3x1 transition matrix.\n        This returns the track through the data which gives the largest sum of power.\n        Args\n        ------\n        tr: array\n            transition matrix of sixe Kx1\n        obs: array\n            observation data of size NxM\n        Returns\n        -------\n        vit_track: array\n            index of the viterbi path found in data\n        max_end_prob: float\n            maximum probability at end of path\n        V: array\n           viterbi matrix\n        prev: array\n            previous positions of paths for each bin\n        ";
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_15single_detector_7run = {"run", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_15single_detector_7run, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6soapcw_6soapcw_15single_detector_6run};
 static PyObject *__pyx_pw_6soapcw_6soapcw_15single_detector_7run(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   __Pyx_memviewslice __pyx_v_tr = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_obs = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_lookup_file = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("run (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr,&__pyx_n_s_obs,&__pyx_n_s_lookup_file,0};
     PyObject* values[4] = {0,0,0,0};
     values[3] = ((PyObject *)((PyObject *)Py_None));
@@ -4418,21 +4621,24 @@
 static PyObject *__pyx_gb_6soapcw_6soapcw_15single_detector_3run_2generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
 /* "soapcw/soapcw.pyx":169
  *                     pbar+=100./len(obs)
  * 
  *         cdef double max_end_prob = max(V[length-1][i] for i in range(width))             # <<<<<<<<<<<<<<
  *         cdef int previous
- *         cdef long[:] vit_track = np.zeros(length,dtype=np.int)
+ *         cdef int[:] vit_track = np.zeros(length,dtype=np.int32)
  */
 
 static PyObject *__pyx_pf_6soapcw_6soapcw_15single_detector_3run_genexpr(PyObject *__pyx_self) {
   struct __pyx_obj_6soapcw_6soapcw___pyx_scope_struct_1_genexpr *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
   __pyx_cur_scope = (struct __pyx_obj_6soapcw_6soapcw___pyx_scope_struct_1_genexpr *)__pyx_tp_new_6soapcw_6soapcw___pyx_scope_struct_1_genexpr(__pyx_ptype_6soapcw_6soapcw___pyx_scope_struct_1_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_6soapcw_6soapcw___pyx_scope_struct_1_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
     __PYX_ERR(0, 169, __pyx_L1_error)
   } else {
@@ -4465,14 +4671,17 @@
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   Py_ssize_t __pyx_t_4;
   Py_ssize_t __pyx_t_5;
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("genexpr", 0);
   switch (__pyx_generator->resume_label) {
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L6_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
@@ -4503,28 +4712,24 @@
     __pyx_t_7 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_cur_scope->__pyx_outer_scope->__pyx_v_V.data + __pyx_t_4 * __pyx_cur_scope->__pyx_outer_scope->__pyx_v_V.strides[0]) ) + __pyx_t_5 * __pyx_cur_scope->__pyx_outer_scope->__pyx_v_V.strides[1]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 169, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_r = __pyx_t_7;
     __pyx_t_7 = 0;
     __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
     __pyx_cur_scope->__pyx_t_1 = __pyx_t_2;
     __pyx_cur_scope->__pyx_t_2 = __pyx_t_3;
-    __pyx_cur_scope->__pyx_t_3 = __pyx_t_4;
-    __pyx_cur_scope->__pyx_t_4 = __pyx_t_5;
     __Pyx_XGIVEREF(__pyx_r);
     __Pyx_RefNannyFinishContext();
     __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
     /* return from generator, yielding value */
     __pyx_generator->resume_label = 1;
     return __pyx_r;
     __pyx_L6_resume_from_yield:;
     __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
     __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
     __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
-    __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
-    __pyx_t_5 = __pyx_cur_scope->__pyx_t_4;
     if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 169, __pyx_L1_error)
   }
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
   goto __pyx_L0;
@@ -4568,14 +4773,15 @@
   PyObject *__pyx_v_obs_ind_arr = NULL;
   PyObject *__pyx_v_temp = NULL;
   PyObject *__pyx_v_o = NULL;
   PyObject *__pyx_v_value = NULL;
   double __pyx_v_max_end_prob;
   int __pyx_v_previous;
   __Pyx_memviewslice __pyx_v_vit_track = { 0, 0, { 0 }, { 0 }, { 0 } };
+  PyObject *__pyx_gb_6soapcw_6soapcw_15single_detector_3run_2generator = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   __Pyx_memviewslice __pyx_t_5 = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -4585,56 +4791,34 @@
   size_t __pyx_t_9;
   int __pyx_t_10;
   int __pyx_t_11;
   PyObject *(*__pyx_t_12)(PyObject *);
   __Pyx_memviewslice __pyx_t_13 = { 0, 0, { 0 }, { 0 }, { 0 } };
   double __pyx_t_14;
   Py_ssize_t __pyx_t_15;
-  __Pyx_memviewslice __pyx_t_16 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  PyObject *__pyx_t_16 = NULL;
   PyObject *__pyx_t_17 = NULL;
-  PyObject *__pyx_t_18 = NULL;
+  int __pyx_t_18;
   int __pyx_t_19;
-  int __pyx_t_20;
+  Py_ssize_t __pyx_t_20;
   Py_ssize_t __pyx_t_21;
-  Py_ssize_t __pyx_t_22;
-  int __pyx_t_23;
+  int __pyx_t_22;
+  Py_ssize_t __pyx_t_23;
   Py_ssize_t __pyx_t_24;
   Py_ssize_t __pyx_t_25;
-  Py_ssize_t __pyx_t_26;
-  Py_ssize_t __pyx_t_27;
-  Py_ssize_t __pyx_t_28;
+  int __pyx_t_26;
+  int __pyx_t_27;
+  int __pyx_t_28;
   int __pyx_t_29;
   int __pyx_t_30;
   int __pyx_t_31;
-  int __pyx_t_32;
-  int __pyx_t_33;
-  Py_ssize_t __pyx_t_34;
-  Py_ssize_t __pyx_t_35;
-  int __pyx_t_36;
-  Py_ssize_t __pyx_t_37;
-  Py_ssize_t __pyx_t_38;
-  Py_ssize_t __pyx_t_39;
-  Py_ssize_t __pyx_t_40;
-  Py_ssize_t __pyx_t_41;
-  Py_ssize_t __pyx_t_42;
-  Py_ssize_t __pyx_t_43;
-  Py_ssize_t __pyx_t_44;
-  Py_ssize_t __pyx_t_45;
-  Py_ssize_t __pyx_t_46;
-  Py_ssize_t __pyx_t_47;
-  Py_ssize_t __pyx_t_48;
-  __Pyx_memviewslice __pyx_t_49 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  Py_ssize_t __pyx_t_50;
-  Py_ssize_t __pyx_t_51;
-  Py_ssize_t __pyx_t_52;
-  Py_ssize_t __pyx_t_53;
-  Py_ssize_t __pyx_t_54;
-  Py_ssize_t __pyx_t_55;
-  Py_ssize_t __pyx_t_56;
-  Py_ssize_t __pyx_t_57;
+  __Pyx_memviewslice __pyx_t_32 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("run", 0);
   __pyx_cur_scope = (struct __pyx_obj_6soapcw_6soapcw___pyx_scope_struct__run *)__pyx_tp_new_6soapcw_6soapcw___pyx_scope_struct__run(__pyx_ptype_6soapcw_6soapcw___pyx_scope_struct__run, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_6soapcw_6soapcw___pyx_scope_struct__run *)Py_None);
     __Pyx_INCREF(Py_None);
     __PYX_ERR(0, 77, __pyx_L1_error)
   } else {
@@ -4642,15 +4826,15 @@
   }
 
   /* "soapcw/soapcw.pyx":100
  * 
  *         # find shape of the observation and create empty array for citerbi matrix and previous track positions
  *         shape = np.shape(obs)             # <<<<<<<<<<<<<<
  *         cdef double[:, :] V = np.zeros(shape)
- *         cdef long[:, :] prev = np.zeros(shape,dtype=np.int)
+ *         cdef int[:, :] prev = np.zeros(shape,dtype=np.int32)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 100, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 100, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_obs, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 100, __pyx_L1_error)
@@ -4674,15 +4858,15 @@
   __pyx_v_shape = __pyx_t_1;
   __pyx_t_1 = 0;
 
   /* "soapcw/soapcw.pyx":101
  *         # find shape of the observation and create empty array for citerbi matrix and previous track positions
  *         shape = np.shape(obs)
  *         cdef double[:, :] V = np.zeros(shape)             # <<<<<<<<<<<<<<
- *         cdef long[:, :] prev = np.zeros(shape,dtype=np.int)
+ *         cdef int[:, :] prev = np.zeros(shape,dtype=np.int32)
  * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 101, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 101, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -4706,15 +4890,15 @@
   __pyx_cur_scope->__pyx_v_V = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
   /* "soapcw/soapcw.pyx":102
  *         shape = np.shape(obs)
  *         cdef double[:, :] V = np.zeros(shape)
- *         cdef long[:, :] prev = np.zeros(shape,dtype=np.int)             # <<<<<<<<<<<<<<
+ *         cdef int[:, :] prev = np.zeros(shape,dtype=np.int32)             # <<<<<<<<<<<<<<
  * 
  *         # defining variables
  */
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 102, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
@@ -4724,25 +4908,25 @@
   __Pyx_INCREF(__pyx_v_shape);
   __Pyx_GIVEREF(__pyx_v_shape);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_shape);
   __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 102, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 102, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 102, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 102, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 102, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 102, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_long(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 102, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 102, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_prev = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
   /* "soapcw/soapcw.pyx":106
  *         # defining variables
@@ -4998,19 +5182,19 @@
     }
     __pyx_t_6 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 130, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 130, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 130, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_v_obs_ind = __pyx_t_16;
-    __pyx_t_16.memview = NULL;
-    __pyx_t_16.data = NULL;
+    __pyx_v_obs_ind = __pyx_t_7;
+    __pyx_t_7.memview = NULL;
+    __pyx_t_7.data = NULL;
 
     /* "soapcw/soapcw.pyx":131
  *             # save array to vector
  *             obs_ind = np.array(obs_ind_arr).astype(np.int32)
  *             del obs_ind_arr             # <<<<<<<<<<<<<<
  *         else:
  *             # if using the sum of power, set element of index to 2d array
@@ -5037,46 +5221,46 @@
  */
   /*else*/ {
     __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_arange); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_17, __pyx_n_s_np); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 134, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_16, __pyx_n_s_np); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 134, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_16);
+    __pyx_t_17 = __Pyx_PyObject_GetAttrStr(__pyx_t_16, __pyx_n_s_prod); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_17);
-    __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_17, __pyx_n_s_prod); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 134, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_18);
-    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
-    __pyx_t_17 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_18))) {
-      __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_18);
-      if (likely(__pyx_t_17)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
-        __Pyx_INCREF(__pyx_t_17);
+    __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
+    __pyx_t_16 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_17))) {
+      __pyx_t_16 = PyMethod_GET_SELF(__pyx_t_17);
+      if (likely(__pyx_t_16)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_17);
+        __Pyx_INCREF(__pyx_t_16);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_18, function);
+        __Pyx_DECREF_SET(__pyx_t_17, function);
       }
     }
-    __pyx_t_1 = (__pyx_t_17) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_17, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_v_shape);
-    __Pyx_XDECREF(__pyx_t_17); __pyx_t_17 = 0;
+    __pyx_t_1 = (__pyx_t_16) ? __Pyx_PyObject_Call2Args(__pyx_t_17, __pyx_t_16, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_17, __pyx_v_shape);
+    __Pyx_XDECREF(__pyx_t_16); __pyx_t_16 = 0;
     if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-    __pyx_t_18 = NULL;
+    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
+    __pyx_t_17 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
-      __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_4);
-      if (likely(__pyx_t_18)) {
+      __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_4);
+      if (likely(__pyx_t_17)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
-        __Pyx_INCREF(__pyx_t_18);
+        __Pyx_INCREF(__pyx_t_17);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
-    __pyx_t_2 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_18, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1);
-    __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
+    __pyx_t_2 = (__pyx_t_17) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_17, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1);
+    __Pyx_XDECREF(__pyx_t_17); __pyx_t_17 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_reshape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
@@ -5115,19 +5299,19 @@
     }
     __pyx_t_6 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 134, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 134, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_v_obs_ind = __pyx_t_16;
-    __pyx_t_16.memview = NULL;
-    __pyx_t_16.data = NULL;
+    __pyx_v_obs_ind = __pyx_t_7;
+    __pyx_t_7.memview = NULL;
+    __pyx_t_7.data = NULL;
 
     /* "soapcw/soapcw.pyx":136
  *             obs_ind = np.arange(np.prod(shape)).reshape(shape).astype(np.int32)
  *             # flatten input spectrogram for access in 1d
  *             logarr = np.ravel(obs)             # <<<<<<<<<<<<<<
  * 
  *         # run for first time index, i.e. fill with observation
@@ -5167,103 +5351,103 @@
  * 
  *         # run for first time index, i.e. fill with observation
  *         for i in range(width):             # <<<<<<<<<<<<<<
  *             V[0][i] = logarr[obs_ind[0][i]]
  *             prev[0][i] = 1
  */
   __pyx_t_8 = __pyx_cur_scope->__pyx_v_width;
-  __pyx_t_19 = __pyx_t_8;
-  for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
-    __pyx_v_i = __pyx_t_20;
+  __pyx_t_18 = __pyx_t_8;
+  for (__pyx_t_19 = 0; __pyx_t_19 < __pyx_t_18; __pyx_t_19+=1) {
+    __pyx_v_i = __pyx_t_19;
 
     /* "soapcw/soapcw.pyx":140
  *         # run for first time index, i.e. fill with observation
  *         for i in range(width):
  *             V[0][i] = logarr[obs_ind[0][i]]             # <<<<<<<<<<<<<<
  *             prev[0][i] = 1
  * 
  */
-    __pyx_t_21 = 0;
-    __pyx_t_22 = __pyx_v_i;
-    __pyx_t_23 = -1;
+    __pyx_t_20 = 0;
+    __pyx_t_21 = __pyx_v_i;
+    __pyx_t_22 = -1;
+    if (__pyx_t_20 < 0) {
+      __pyx_t_20 += __pyx_v_obs_ind.shape[0];
+      if (unlikely(__pyx_t_20 < 0)) __pyx_t_22 = 0;
+    } else if (unlikely(__pyx_t_20 >= __pyx_v_obs_ind.shape[0])) __pyx_t_22 = 0;
     if (__pyx_t_21 < 0) {
-      __pyx_t_21 += __pyx_v_obs_ind.shape[0];
-      if (unlikely(__pyx_t_21 < 0)) __pyx_t_23 = 0;
-    } else if (unlikely(__pyx_t_21 >= __pyx_v_obs_ind.shape[0])) __pyx_t_23 = 0;
-    if (__pyx_t_22 < 0) {
-      __pyx_t_22 += __pyx_v_obs_ind.shape[1];
-      if (unlikely(__pyx_t_22 < 0)) __pyx_t_23 = 1;
-    } else if (unlikely(__pyx_t_22 >= __pyx_v_obs_ind.shape[1])) __pyx_t_23 = 1;
-    if (unlikely(__pyx_t_23 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_23);
+      __pyx_t_21 += __pyx_v_obs_ind.shape[1];
+      if (unlikely(__pyx_t_21 < 0)) __pyx_t_22 = 1;
+    } else if (unlikely(__pyx_t_21 >= __pyx_v_obs_ind.shape[1])) __pyx_t_22 = 1;
+    if (unlikely(__pyx_t_22 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_22);
       __PYX_ERR(0, 140, __pyx_L1_error)
     }
-    __pyx_t_24 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs_ind.data + __pyx_t_21 * __pyx_v_obs_ind.strides[0]) ) + __pyx_t_22 * __pyx_v_obs_ind.strides[1]) )));
-    __pyx_t_23 = -1;
-    if (__pyx_t_24 < 0) {
-      __pyx_t_24 += __pyx_v_logarr.shape[0];
-      if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 0;
-    } else if (unlikely(__pyx_t_24 >= __pyx_v_logarr.shape[0])) __pyx_t_23 = 0;
-    if (unlikely(__pyx_t_23 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_23);
+    __pyx_t_23 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs_ind.data + __pyx_t_20 * __pyx_v_obs_ind.strides[0]) ) + __pyx_t_21 * __pyx_v_obs_ind.strides[1]) )));
+    __pyx_t_22 = -1;
+    if (__pyx_t_23 < 0) {
+      __pyx_t_23 += __pyx_v_logarr.shape[0];
+      if (unlikely(__pyx_t_23 < 0)) __pyx_t_22 = 0;
+    } else if (unlikely(__pyx_t_23 >= __pyx_v_logarr.shape[0])) __pyx_t_22 = 0;
+    if (unlikely(__pyx_t_22 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_22);
       __PYX_ERR(0, 140, __pyx_L1_error)
     }
-    __pyx_t_25 = 0;
-    __pyx_t_26 = __pyx_v_i;
-    __pyx_t_23 = -1;
+    __pyx_t_24 = 0;
+    __pyx_t_25 = __pyx_v_i;
+    __pyx_t_22 = -1;
+    if (__pyx_t_24 < 0) {
+      __pyx_t_24 += __pyx_cur_scope->__pyx_v_V.shape[0];
+      if (unlikely(__pyx_t_24 < 0)) __pyx_t_22 = 0;
+    } else if (unlikely(__pyx_t_24 >= __pyx_cur_scope->__pyx_v_V.shape[0])) __pyx_t_22 = 0;
     if (__pyx_t_25 < 0) {
-      __pyx_t_25 += __pyx_cur_scope->__pyx_v_V.shape[0];
-      if (unlikely(__pyx_t_25 < 0)) __pyx_t_23 = 0;
-    } else if (unlikely(__pyx_t_25 >= __pyx_cur_scope->__pyx_v_V.shape[0])) __pyx_t_23 = 0;
-    if (__pyx_t_26 < 0) {
-      __pyx_t_26 += __pyx_cur_scope->__pyx_v_V.shape[1];
-      if (unlikely(__pyx_t_26 < 0)) __pyx_t_23 = 1;
-    } else if (unlikely(__pyx_t_26 >= __pyx_cur_scope->__pyx_v_V.shape[1])) __pyx_t_23 = 1;
-    if (unlikely(__pyx_t_23 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_23);
+      __pyx_t_25 += __pyx_cur_scope->__pyx_v_V.shape[1];
+      if (unlikely(__pyx_t_25 < 0)) __pyx_t_22 = 1;
+    } else if (unlikely(__pyx_t_25 >= __pyx_cur_scope->__pyx_v_V.shape[1])) __pyx_t_22 = 1;
+    if (unlikely(__pyx_t_22 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_22);
       __PYX_ERR(0, 140, __pyx_L1_error)
     }
-    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_cur_scope->__pyx_v_V.data + __pyx_t_25 * __pyx_cur_scope->__pyx_v_V.strides[0]) ) + __pyx_t_26 * __pyx_cur_scope->__pyx_v_V.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_logarr.data + __pyx_t_24 * __pyx_v_logarr.strides[0]) )));
+    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_cur_scope->__pyx_v_V.data + __pyx_t_24 * __pyx_cur_scope->__pyx_v_V.strides[0]) ) + __pyx_t_25 * __pyx_cur_scope->__pyx_v_V.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_logarr.data + __pyx_t_23 * __pyx_v_logarr.strides[0]) )));
 
     /* "soapcw/soapcw.pyx":141
  *         for i in range(width):
  *             V[0][i] = logarr[obs_ind[0][i]]
  *             prev[0][i] = 1             # <<<<<<<<<<<<<<
  * 
  *         # run iterative part of algorithm
  */
-    __pyx_t_27 = 0;
-    __pyx_t_28 = __pyx_v_i;
-    __pyx_t_23 = -1;
-    if (__pyx_t_27 < 0) {
-      __pyx_t_27 += __pyx_v_prev.shape[0];
-      if (unlikely(__pyx_t_27 < 0)) __pyx_t_23 = 0;
-    } else if (unlikely(__pyx_t_27 >= __pyx_v_prev.shape[0])) __pyx_t_23 = 0;
-    if (__pyx_t_28 < 0) {
-      __pyx_t_28 += __pyx_v_prev.shape[1];
-      if (unlikely(__pyx_t_28 < 0)) __pyx_t_23 = 1;
-    } else if (unlikely(__pyx_t_28 >= __pyx_v_prev.shape[1])) __pyx_t_23 = 1;
-    if (unlikely(__pyx_t_23 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_23);
+    __pyx_t_21 = 0;
+    __pyx_t_20 = __pyx_v_i;
+    __pyx_t_22 = -1;
+    if (__pyx_t_21 < 0) {
+      __pyx_t_21 += __pyx_v_prev.shape[0];
+      if (unlikely(__pyx_t_21 < 0)) __pyx_t_22 = 0;
+    } else if (unlikely(__pyx_t_21 >= __pyx_v_prev.shape[0])) __pyx_t_22 = 0;
+    if (__pyx_t_20 < 0) {
+      __pyx_t_20 += __pyx_v_prev.shape[1];
+      if (unlikely(__pyx_t_20 < 0)) __pyx_t_22 = 1;
+    } else if (unlikely(__pyx_t_20 >= __pyx_v_prev.shape[1])) __pyx_t_22 = 1;
+    if (unlikely(__pyx_t_22 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_22);
       __PYX_ERR(0, 141, __pyx_L1_error)
     }
-    *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_27 * __pyx_v_prev.strides[0]) ) + __pyx_t_28 * __pyx_v_prev.strides[1]) )) = 1;
+    *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_21 * __pyx_v_prev.strides[0]) ) + __pyx_t_20 * __pyx_v_prev.strides[1]) )) = 1;
   }
 
   /* "soapcw/soapcw.pyx":144
  * 
  *         # run iterative part of algorithm
  *         for t in range(1,length):             # <<<<<<<<<<<<<<
  *             pt = t/(length)*100
  *             for i in range(width):
  */
   __pyx_t_8 = __pyx_cur_scope->__pyx_v_length;
-  __pyx_t_19 = __pyx_t_8;
-  for (__pyx_t_20 = 1; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
-    __pyx_v_t = __pyx_t_20;
+  __pyx_t_18 = __pyx_t_8;
+  for (__pyx_t_19 = 1; __pyx_t_19 < __pyx_t_18; __pyx_t_19+=1) {
+    __pyx_v_t = __pyx_t_19;
 
     /* "soapcw/soapcw.pyx":145
  *         # run iterative part of algorithm
  *         for t in range(1,length):
  *             pt = t/(length)*100             # <<<<<<<<<<<<<<
  *             for i in range(width):
  *                 temp = -1e6
@@ -5277,18 +5461,18 @@
     /* "soapcw/soapcw.pyx":146
  *         for t in range(1,length):
  *             pt = t/(length)*100
  *             for i in range(width):             # <<<<<<<<<<<<<<
  *                 temp = -1e6
  *                 for j in range(tr_length):
  */
-    __pyx_t_23 = __pyx_cur_scope->__pyx_v_width;
-    __pyx_t_29 = __pyx_t_23;
-    for (__pyx_t_30 = 0; __pyx_t_30 < __pyx_t_29; __pyx_t_30+=1) {
-      __pyx_v_i = __pyx_t_30;
+    __pyx_t_22 = __pyx_cur_scope->__pyx_v_width;
+    __pyx_t_26 = __pyx_t_22;
+    for (__pyx_t_27 = 0; __pyx_t_27 < __pyx_t_26; __pyx_t_27+=1) {
+      __pyx_v_i = __pyx_t_27;
 
       /* "soapcw/soapcw.pyx":147
  *             pt = t/(length)*100
  *             for i in range(width):
  *                 temp = -1e6             # <<<<<<<<<<<<<<
  *                 for j in range(tr_length):
  *                     if i+j-tr_width>=0 and i+j-tr_width<=width-1:
@@ -5299,18 +5483,18 @@
       /* "soapcw/soapcw.pyx":148
  *             for i in range(width):
  *                 temp = -1e6
  *                 for j in range(tr_length):             # <<<<<<<<<<<<<<
  *                     if i+j-tr_width>=0 and i+j-tr_width<=width-1:
  *                         o = obs_ind[t][i]
  */
-      __pyx_t_31 = __pyx_v_tr_length;
-      __pyx_t_32 = __pyx_t_31;
-      for (__pyx_t_33 = 0; __pyx_t_33 < __pyx_t_32; __pyx_t_33+=1) {
-        __pyx_v_j = __pyx_t_33;
+      __pyx_t_28 = __pyx_v_tr_length;
+      __pyx_t_29 = __pyx_t_28;
+      for (__pyx_t_30 = 0; __pyx_t_30 < __pyx_t_29; __pyx_t_30+=1) {
+        __pyx_v_j = __pyx_t_30;
 
         /* "soapcw/soapcw.pyx":149
  *                 temp = -1e6
  *                 for j in range(tr_length):
  *                     if i+j-tr_width>=0 and i+j-tr_width<=width-1:             # <<<<<<<<<<<<<<
  *                         o = obs_ind[t][i]
  *                         value = tr[j] + logarr[o] + V[t-1][i+j-tr_width]
@@ -5329,78 +5513,78 @@
           /* "soapcw/soapcw.pyx":150
  *                 for j in range(tr_length):
  *                     if i+j-tr_width>=0 and i+j-tr_width<=width-1:
  *                         o = obs_ind[t][i]             # <<<<<<<<<<<<<<
  *                         value = tr[j] + logarr[o] + V[t-1][i+j-tr_width]
  * 
  */
-          __pyx_t_34 = __pyx_v_t;
-          __pyx_t_35 = __pyx_v_i;
-          __pyx_t_36 = -1;
-          if (__pyx_t_34 < 0) {
-            __pyx_t_34 += __pyx_v_obs_ind.shape[0];
-            if (unlikely(__pyx_t_34 < 0)) __pyx_t_36 = 0;
-          } else if (unlikely(__pyx_t_34 >= __pyx_v_obs_ind.shape[0])) __pyx_t_36 = 0;
-          if (__pyx_t_35 < 0) {
-            __pyx_t_35 += __pyx_v_obs_ind.shape[1];
-            if (unlikely(__pyx_t_35 < 0)) __pyx_t_36 = 1;
-          } else if (unlikely(__pyx_t_35 >= __pyx_v_obs_ind.shape[1])) __pyx_t_36 = 1;
-          if (unlikely(__pyx_t_36 != -1)) {
-            __Pyx_RaiseBufferIndexError(__pyx_t_36);
+          __pyx_t_20 = __pyx_v_t;
+          __pyx_t_21 = __pyx_v_i;
+          __pyx_t_31 = -1;
+          if (__pyx_t_20 < 0) {
+            __pyx_t_20 += __pyx_v_obs_ind.shape[0];
+            if (unlikely(__pyx_t_20 < 0)) __pyx_t_31 = 0;
+          } else if (unlikely(__pyx_t_20 >= __pyx_v_obs_ind.shape[0])) __pyx_t_31 = 0;
+          if (__pyx_t_21 < 0) {
+            __pyx_t_21 += __pyx_v_obs_ind.shape[1];
+            if (unlikely(__pyx_t_21 < 0)) __pyx_t_31 = 1;
+          } else if (unlikely(__pyx_t_21 >= __pyx_v_obs_ind.shape[1])) __pyx_t_31 = 1;
+          if (unlikely(__pyx_t_31 != -1)) {
+            __Pyx_RaiseBufferIndexError(__pyx_t_31);
             __PYX_ERR(0, 150, __pyx_L1_error)
           }
-          __pyx_t_6 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs_ind.data + __pyx_t_34 * __pyx_v_obs_ind.strides[0]) ) + __pyx_t_35 * __pyx_v_obs_ind.strides[1]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 150, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs_ind.data + __pyx_t_20 * __pyx_v_obs_ind.strides[0]) ) + __pyx_t_21 * __pyx_v_obs_ind.strides[1]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 150, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_XDECREF_SET(__pyx_v_o, __pyx_t_6);
           __pyx_t_6 = 0;
 
           /* "soapcw/soapcw.pyx":151
  *                     if i+j-tr_width>=0 and i+j-tr_width<=width-1:
  *                         o = obs_ind[t][i]
  *                         value = tr[j] + logarr[o] + V[t-1][i+j-tr_width]             # <<<<<<<<<<<<<<
  * 
  *                         if value>temp:
  */
-          __pyx_t_37 = __pyx_v_j;
-          __pyx_t_36 = -1;
-          if (__pyx_t_37 < 0) {
-            __pyx_t_37 += __pyx_v_tr.shape[0];
-            if (unlikely(__pyx_t_37 < 0)) __pyx_t_36 = 0;
-          } else if (unlikely(__pyx_t_37 >= __pyx_v_tr.shape[0])) __pyx_t_36 = 0;
-          if (unlikely(__pyx_t_36 != -1)) {
-            __Pyx_RaiseBufferIndexError(__pyx_t_36);
+          __pyx_t_21 = __pyx_v_j;
+          __pyx_t_31 = -1;
+          if (__pyx_t_21 < 0) {
+            __pyx_t_21 += __pyx_v_tr.shape[0];
+            if (unlikely(__pyx_t_21 < 0)) __pyx_t_31 = 0;
+          } else if (unlikely(__pyx_t_21 >= __pyx_v_tr.shape[0])) __pyx_t_31 = 0;
+          if (unlikely(__pyx_t_31 != -1)) {
+            __Pyx_RaiseBufferIndexError(__pyx_t_31);
             __PYX_ERR(0, 151, __pyx_L1_error)
           }
           __pyx_t_15 = __Pyx_PyIndex_AsSsize_t(__pyx_v_o); if (unlikely((__pyx_t_15 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 151, __pyx_L1_error)
-          __pyx_t_38 = __pyx_t_15;
-          __pyx_t_36 = -1;
-          if (__pyx_t_38 < 0) {
-            __pyx_t_38 += __pyx_v_logarr.shape[0];
-            if (unlikely(__pyx_t_38 < 0)) __pyx_t_36 = 0;
-          } else if (unlikely(__pyx_t_38 >= __pyx_v_logarr.shape[0])) __pyx_t_36 = 0;
-          if (unlikely(__pyx_t_36 != -1)) {
-            __Pyx_RaiseBufferIndexError(__pyx_t_36);
+          __pyx_t_20 = __pyx_t_15;
+          __pyx_t_31 = -1;
+          if (__pyx_t_20 < 0) {
+            __pyx_t_20 += __pyx_v_logarr.shape[0];
+            if (unlikely(__pyx_t_20 < 0)) __pyx_t_31 = 0;
+          } else if (unlikely(__pyx_t_20 >= __pyx_v_logarr.shape[0])) __pyx_t_31 = 0;
+          if (unlikely(__pyx_t_31 != -1)) {
+            __Pyx_RaiseBufferIndexError(__pyx_t_31);
             __PYX_ERR(0, 151, __pyx_L1_error)
           }
-          __pyx_t_39 = (__pyx_v_t - 1);
-          __pyx_t_40 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_width);
-          __pyx_t_36 = -1;
-          if (__pyx_t_39 < 0) {
-            __pyx_t_39 += __pyx_cur_scope->__pyx_v_V.shape[0];
-            if (unlikely(__pyx_t_39 < 0)) __pyx_t_36 = 0;
-          } else if (unlikely(__pyx_t_39 >= __pyx_cur_scope->__pyx_v_V.shape[0])) __pyx_t_36 = 0;
-          if (__pyx_t_40 < 0) {
-            __pyx_t_40 += __pyx_cur_scope->__pyx_v_V.shape[1];
-            if (unlikely(__pyx_t_40 < 0)) __pyx_t_36 = 1;
-          } else if (unlikely(__pyx_t_40 >= __pyx_cur_scope->__pyx_v_V.shape[1])) __pyx_t_36 = 1;
-          if (unlikely(__pyx_t_36 != -1)) {
-            __Pyx_RaiseBufferIndexError(__pyx_t_36);
+          __pyx_t_23 = (__pyx_v_t - 1);
+          __pyx_t_25 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_width);
+          __pyx_t_31 = -1;
+          if (__pyx_t_23 < 0) {
+            __pyx_t_23 += __pyx_cur_scope->__pyx_v_V.shape[0];
+            if (unlikely(__pyx_t_23 < 0)) __pyx_t_31 = 0;
+          } else if (unlikely(__pyx_t_23 >= __pyx_cur_scope->__pyx_v_V.shape[0])) __pyx_t_31 = 0;
+          if (__pyx_t_25 < 0) {
+            __pyx_t_25 += __pyx_cur_scope->__pyx_v_V.shape[1];
+            if (unlikely(__pyx_t_25 < 0)) __pyx_t_31 = 1;
+          } else if (unlikely(__pyx_t_25 >= __pyx_cur_scope->__pyx_v_V.shape[1])) __pyx_t_31 = 1;
+          if (unlikely(__pyx_t_31 != -1)) {
+            __Pyx_RaiseBufferIndexError(__pyx_t_31);
             __PYX_ERR(0, 151, __pyx_L1_error)
           }
-          __pyx_t_6 = PyFloat_FromDouble((((*((double *) ( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_37 * __pyx_v_tr.strides[0]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr.data + __pyx_t_38 * __pyx_v_logarr.strides[0]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_cur_scope->__pyx_v_V.data + __pyx_t_39 * __pyx_cur_scope->__pyx_v_V.strides[0]) ) + __pyx_t_40 * __pyx_cur_scope->__pyx_v_V.strides[1]) ))))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 151, __pyx_L1_error)
+          __pyx_t_6 = PyFloat_FromDouble((((*((double *) ( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_21 * __pyx_v_tr.strides[0]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr.data + __pyx_t_20 * __pyx_v_logarr.strides[0]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_cur_scope->__pyx_v_V.data + __pyx_t_23 * __pyx_cur_scope->__pyx_v_V.strides[0]) ) + __pyx_t_25 * __pyx_cur_scope->__pyx_v_V.strides[1]) ))))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 151, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_XDECREF_SET(__pyx_v_value, __pyx_t_6);
           __pyx_t_6 = 0;
 
           /* "soapcw/soapcw.pyx":153
  *                         value = tr[j] + logarr[o] + V[t-1][i+j-tr_width]
  * 
@@ -5427,54 +5611,54 @@
  *                         if value>temp:
  *                             temp = value
  *                             V[t][i] = temp             # <<<<<<<<<<<<<<
  *                             prev[t][i] = i+j-tr_width
  *                         elif value == temp and j == int(tr_length/2.):
  */
             __pyx_t_14 = __pyx_PyFloat_AsDouble(__pyx_v_temp); if (unlikely((__pyx_t_14 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 155, __pyx_L1_error)
-            __pyx_t_41 = __pyx_v_t;
-            __pyx_t_42 = __pyx_v_i;
-            __pyx_t_36 = -1;
-            if (__pyx_t_41 < 0) {
-              __pyx_t_41 += __pyx_cur_scope->__pyx_v_V.shape[0];
-              if (unlikely(__pyx_t_41 < 0)) __pyx_t_36 = 0;
-            } else if (unlikely(__pyx_t_41 >= __pyx_cur_scope->__pyx_v_V.shape[0])) __pyx_t_36 = 0;
-            if (__pyx_t_42 < 0) {
-              __pyx_t_42 += __pyx_cur_scope->__pyx_v_V.shape[1];
-              if (unlikely(__pyx_t_42 < 0)) __pyx_t_36 = 1;
-            } else if (unlikely(__pyx_t_42 >= __pyx_cur_scope->__pyx_v_V.shape[1])) __pyx_t_36 = 1;
-            if (unlikely(__pyx_t_36 != -1)) {
-              __Pyx_RaiseBufferIndexError(__pyx_t_36);
+            __pyx_t_25 = __pyx_v_t;
+            __pyx_t_23 = __pyx_v_i;
+            __pyx_t_31 = -1;
+            if (__pyx_t_25 < 0) {
+              __pyx_t_25 += __pyx_cur_scope->__pyx_v_V.shape[0];
+              if (unlikely(__pyx_t_25 < 0)) __pyx_t_31 = 0;
+            } else if (unlikely(__pyx_t_25 >= __pyx_cur_scope->__pyx_v_V.shape[0])) __pyx_t_31 = 0;
+            if (__pyx_t_23 < 0) {
+              __pyx_t_23 += __pyx_cur_scope->__pyx_v_V.shape[1];
+              if (unlikely(__pyx_t_23 < 0)) __pyx_t_31 = 1;
+            } else if (unlikely(__pyx_t_23 >= __pyx_cur_scope->__pyx_v_V.shape[1])) __pyx_t_31 = 1;
+            if (unlikely(__pyx_t_31 != -1)) {
+              __Pyx_RaiseBufferIndexError(__pyx_t_31);
               __PYX_ERR(0, 155, __pyx_L1_error)
             }
-            *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_cur_scope->__pyx_v_V.data + __pyx_t_41 * __pyx_cur_scope->__pyx_v_V.strides[0]) ) + __pyx_t_42 * __pyx_cur_scope->__pyx_v_V.strides[1]) )) = __pyx_t_14;
+            *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_cur_scope->__pyx_v_V.data + __pyx_t_25 * __pyx_cur_scope->__pyx_v_V.strides[0]) ) + __pyx_t_23 * __pyx_cur_scope->__pyx_v_V.strides[1]) )) = __pyx_t_14;
 
             /* "soapcw/soapcw.pyx":156
  *                             temp = value
  *                             V[t][i] = temp
  *                             prev[t][i] = i+j-tr_width             # <<<<<<<<<<<<<<
  *                         elif value == temp and j == int(tr_length/2.):
  *                             temp = value
  */
-            __pyx_t_43 = __pyx_v_t;
-            __pyx_t_44 = __pyx_v_i;
-            __pyx_t_36 = -1;
-            if (__pyx_t_43 < 0) {
-              __pyx_t_43 += __pyx_v_prev.shape[0];
-              if (unlikely(__pyx_t_43 < 0)) __pyx_t_36 = 0;
-            } else if (unlikely(__pyx_t_43 >= __pyx_v_prev.shape[0])) __pyx_t_36 = 0;
-            if (__pyx_t_44 < 0) {
-              __pyx_t_44 += __pyx_v_prev.shape[1];
-              if (unlikely(__pyx_t_44 < 0)) __pyx_t_36 = 1;
-            } else if (unlikely(__pyx_t_44 >= __pyx_v_prev.shape[1])) __pyx_t_36 = 1;
-            if (unlikely(__pyx_t_36 != -1)) {
-              __Pyx_RaiseBufferIndexError(__pyx_t_36);
+            __pyx_t_23 = __pyx_v_t;
+            __pyx_t_25 = __pyx_v_i;
+            __pyx_t_31 = -1;
+            if (__pyx_t_23 < 0) {
+              __pyx_t_23 += __pyx_v_prev.shape[0];
+              if (unlikely(__pyx_t_23 < 0)) __pyx_t_31 = 0;
+            } else if (unlikely(__pyx_t_23 >= __pyx_v_prev.shape[0])) __pyx_t_31 = 0;
+            if (__pyx_t_25 < 0) {
+              __pyx_t_25 += __pyx_v_prev.shape[1];
+              if (unlikely(__pyx_t_25 < 0)) __pyx_t_31 = 1;
+            } else if (unlikely(__pyx_t_25 >= __pyx_v_prev.shape[1])) __pyx_t_31 = 1;
+            if (unlikely(__pyx_t_31 != -1)) {
+              __Pyx_RaiseBufferIndexError(__pyx_t_31);
               __PYX_ERR(0, 156, __pyx_L1_error)
             }
-            *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_43 * __pyx_v_prev.strides[0]) ) + __pyx_t_44 * __pyx_v_prev.strides[1]) )) = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_width);
+            *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_23 * __pyx_v_prev.strides[0]) ) + __pyx_t_25 * __pyx_v_prev.strides[1]) )) = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_width);
 
             /* "soapcw/soapcw.pyx":153
  *                         value = tr[j] + logarr[o] + V[t-1][i+j-tr_width]
  * 
  *                         if value>temp:             # <<<<<<<<<<<<<<
  *                             temp = value
  *                             V[t][i] = temp
@@ -5524,54 +5708,54 @@
  *                         elif value == temp and j == int(tr_length/2.):
  *                             temp = value
  *                             V[t][i] = temp             # <<<<<<<<<<<<<<
  *                             prev[t][i] = i+j-tr_width
  * 
  */
             __pyx_t_14 = __pyx_PyFloat_AsDouble(__pyx_v_temp); if (unlikely((__pyx_t_14 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 159, __pyx_L1_error)
-            __pyx_t_45 = __pyx_v_t;
-            __pyx_t_46 = __pyx_v_i;
-            __pyx_t_36 = -1;
-            if (__pyx_t_45 < 0) {
-              __pyx_t_45 += __pyx_cur_scope->__pyx_v_V.shape[0];
-              if (unlikely(__pyx_t_45 < 0)) __pyx_t_36 = 0;
-            } else if (unlikely(__pyx_t_45 >= __pyx_cur_scope->__pyx_v_V.shape[0])) __pyx_t_36 = 0;
-            if (__pyx_t_46 < 0) {
-              __pyx_t_46 += __pyx_cur_scope->__pyx_v_V.shape[1];
-              if (unlikely(__pyx_t_46 < 0)) __pyx_t_36 = 1;
-            } else if (unlikely(__pyx_t_46 >= __pyx_cur_scope->__pyx_v_V.shape[1])) __pyx_t_36 = 1;
-            if (unlikely(__pyx_t_36 != -1)) {
-              __Pyx_RaiseBufferIndexError(__pyx_t_36);
+            __pyx_t_25 = __pyx_v_t;
+            __pyx_t_23 = __pyx_v_i;
+            __pyx_t_31 = -1;
+            if (__pyx_t_25 < 0) {
+              __pyx_t_25 += __pyx_cur_scope->__pyx_v_V.shape[0];
+              if (unlikely(__pyx_t_25 < 0)) __pyx_t_31 = 0;
+            } else if (unlikely(__pyx_t_25 >= __pyx_cur_scope->__pyx_v_V.shape[0])) __pyx_t_31 = 0;
+            if (__pyx_t_23 < 0) {
+              __pyx_t_23 += __pyx_cur_scope->__pyx_v_V.shape[1];
+              if (unlikely(__pyx_t_23 < 0)) __pyx_t_31 = 1;
+            } else if (unlikely(__pyx_t_23 >= __pyx_cur_scope->__pyx_v_V.shape[1])) __pyx_t_31 = 1;
+            if (unlikely(__pyx_t_31 != -1)) {
+              __Pyx_RaiseBufferIndexError(__pyx_t_31);
               __PYX_ERR(0, 159, __pyx_L1_error)
             }
-            *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_cur_scope->__pyx_v_V.data + __pyx_t_45 * __pyx_cur_scope->__pyx_v_V.strides[0]) ) + __pyx_t_46 * __pyx_cur_scope->__pyx_v_V.strides[1]) )) = __pyx_t_14;
+            *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_cur_scope->__pyx_v_V.data + __pyx_t_25 * __pyx_cur_scope->__pyx_v_V.strides[0]) ) + __pyx_t_23 * __pyx_cur_scope->__pyx_v_V.strides[1]) )) = __pyx_t_14;
 
             /* "soapcw/soapcw.pyx":160
  *                             temp = value
  *                             V[t][i] = temp
  *                             prev[t][i] = i+j-tr_width             # <<<<<<<<<<<<<<
  * 
  * 
  */
-            __pyx_t_47 = __pyx_v_t;
-            __pyx_t_48 = __pyx_v_i;
-            __pyx_t_36 = -1;
-            if (__pyx_t_47 < 0) {
-              __pyx_t_47 += __pyx_v_prev.shape[0];
-              if (unlikely(__pyx_t_47 < 0)) __pyx_t_36 = 0;
-            } else if (unlikely(__pyx_t_47 >= __pyx_v_prev.shape[0])) __pyx_t_36 = 0;
-            if (__pyx_t_48 < 0) {
-              __pyx_t_48 += __pyx_v_prev.shape[1];
-              if (unlikely(__pyx_t_48 < 0)) __pyx_t_36 = 1;
-            } else if (unlikely(__pyx_t_48 >= __pyx_v_prev.shape[1])) __pyx_t_36 = 1;
-            if (unlikely(__pyx_t_36 != -1)) {
-              __Pyx_RaiseBufferIndexError(__pyx_t_36);
+            __pyx_t_23 = __pyx_v_t;
+            __pyx_t_25 = __pyx_v_i;
+            __pyx_t_31 = -1;
+            if (__pyx_t_23 < 0) {
+              __pyx_t_23 += __pyx_v_prev.shape[0];
+              if (unlikely(__pyx_t_23 < 0)) __pyx_t_31 = 0;
+            } else if (unlikely(__pyx_t_23 >= __pyx_v_prev.shape[0])) __pyx_t_31 = 0;
+            if (__pyx_t_25 < 0) {
+              __pyx_t_25 += __pyx_v_prev.shape[1];
+              if (unlikely(__pyx_t_25 < 0)) __pyx_t_31 = 1;
+            } else if (unlikely(__pyx_t_25 >= __pyx_v_prev.shape[1])) __pyx_t_31 = 1;
+            if (unlikely(__pyx_t_31 != -1)) {
+              __Pyx_RaiseBufferIndexError(__pyx_t_31);
               __PYX_ERR(0, 160, __pyx_L1_error)
             }
-            *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_47 * __pyx_v_prev.strides[0]) ) + __pyx_t_48 * __pyx_v_prev.strides[1]) )) = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_width);
+            *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_23 * __pyx_v_prev.strides[0]) ) + __pyx_t_25 * __pyx_v_prev.strides[1]) )) = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_width);
 
             /* "soapcw/soapcw.pyx":157
  *                             V[t][i] = temp
  *                             prev[t][i] = i+j-tr_width
  *                         elif value == temp and j == int(tr_length/2.):             # <<<<<<<<<<<<<<
  *                             temp = value
  *                             V[t][i] = temp
@@ -5627,30 +5811,30 @@
         __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_write); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 165, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u__4, __pyx_n_s_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 165, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __pyx_t_1 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 165, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_18 = __Pyx_PyObject_CallOneArg(__pyx_builtin_round, __pyx_t_1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 165, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_18);
+        __pyx_t_17 = __Pyx_PyObject_CallOneArg(__pyx_builtin_round, __pyx_t_1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 165, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_17);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_t_1 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_1)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
             __Pyx_INCREF(__pyx_t_1);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
-        __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_18) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_18);
+        __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_17) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_17);
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
+        __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
         if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 165, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_t_3 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
           __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
           if (likely(__pyx_t_3)) {
@@ -5731,29 +5915,29 @@
   }
 
   /* "soapcw/soapcw.pyx":169
  *                     pbar+=100./len(obs)
  * 
  *         cdef double max_end_prob = max(V[length-1][i] for i in range(width))             # <<<<<<<<<<<<<<
  *         cdef int previous
- *         cdef long[:] vit_track = np.zeros(length,dtype=np.int)
+ *         cdef int[:] vit_track = np.zeros(length,dtype=np.int32)
  */
   __pyx_t_2 = __pyx_pf_6soapcw_6soapcw_15single_detector_3run_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 169, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_max, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 169, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_14 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_14 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 169, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_max_end_prob = __pyx_t_14;
 
   /* "soapcw/soapcw.pyx":171
  *         cdef double max_end_prob = max(V[length-1][i] for i in range(width))
  *         cdef int previous
- *         cdef long[:] vit_track = np.zeros(length,dtype=np.int)             # <<<<<<<<<<<<<<
+ *         cdef int[:] vit_track = np.zeros(length,dtype=np.int32)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 171, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 171, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
@@ -5765,109 +5949,109 @@
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
   __pyx_t_4 = 0;
   __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 171, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 171, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_18);
+  __pyx_t_17 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int32); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_17);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_18) < 0) __PYX_ERR(0, 171, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-  __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 171, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_18);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_17) < 0) __PYX_ERR(0, 171, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
+  __pyx_t_17 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_17);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_49 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_18, PyBUF_WRITABLE); if (unlikely(!__pyx_t_49.memview)) __PYX_ERR(0, 171, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-  __pyx_v_vit_track = __pyx_t_49;
-  __pyx_t_49.memview = NULL;
-  __pyx_t_49.data = NULL;
+  __pyx_t_32 = __Pyx_PyObject_to_MemoryviewSlice_ds_int(__pyx_t_17, PyBUF_WRITABLE); if (unlikely(!__pyx_t_32.memview)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
+  __pyx_v_vit_track = __pyx_t_32;
+  __pyx_t_32.memview = NULL;
+  __pyx_t_32.data = NULL;
 
   /* "soapcw/soapcw.pyx":174
  * 
  * 
  *         for i in range(width):             # <<<<<<<<<<<<<<
  *             if V[length-1][i] == max_end_prob:
  *                 vit_track[length-1] = i # appends maximum path value from final step
  */
   __pyx_t_8 = __pyx_cur_scope->__pyx_v_width;
-  __pyx_t_19 = __pyx_t_8;
-  for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
-    __pyx_v_i = __pyx_t_20;
+  __pyx_t_18 = __pyx_t_8;
+  for (__pyx_t_19 = 0; __pyx_t_19 < __pyx_t_18; __pyx_t_19+=1) {
+    __pyx_v_i = __pyx_t_19;
 
     /* "soapcw/soapcw.pyx":175
  * 
  *         for i in range(width):
  *             if V[length-1][i] == max_end_prob:             # <<<<<<<<<<<<<<
  *                 vit_track[length-1] = i # appends maximum path value from final step
  *                 previous = prev[length-1][i]
  */
-    __pyx_t_50 = (__pyx_cur_scope->__pyx_v_length - 1);
-    __pyx_t_51 = __pyx_v_i;
-    __pyx_t_23 = -1;
-    if (__pyx_t_50 < 0) {
-      __pyx_t_50 += __pyx_cur_scope->__pyx_v_V.shape[0];
-      if (unlikely(__pyx_t_50 < 0)) __pyx_t_23 = 0;
-    } else if (unlikely(__pyx_t_50 >= __pyx_cur_scope->__pyx_v_V.shape[0])) __pyx_t_23 = 0;
-    if (__pyx_t_51 < 0) {
-      __pyx_t_51 += __pyx_cur_scope->__pyx_v_V.shape[1];
-      if (unlikely(__pyx_t_51 < 0)) __pyx_t_23 = 1;
-    } else if (unlikely(__pyx_t_51 >= __pyx_cur_scope->__pyx_v_V.shape[1])) __pyx_t_23 = 1;
-    if (unlikely(__pyx_t_23 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_23);
+    __pyx_t_25 = (__pyx_cur_scope->__pyx_v_length - 1);
+    __pyx_t_23 = __pyx_v_i;
+    __pyx_t_22 = -1;
+    if (__pyx_t_25 < 0) {
+      __pyx_t_25 += __pyx_cur_scope->__pyx_v_V.shape[0];
+      if (unlikely(__pyx_t_25 < 0)) __pyx_t_22 = 0;
+    } else if (unlikely(__pyx_t_25 >= __pyx_cur_scope->__pyx_v_V.shape[0])) __pyx_t_22 = 0;
+    if (__pyx_t_23 < 0) {
+      __pyx_t_23 += __pyx_cur_scope->__pyx_v_V.shape[1];
+      if (unlikely(__pyx_t_23 < 0)) __pyx_t_22 = 1;
+    } else if (unlikely(__pyx_t_23 >= __pyx_cur_scope->__pyx_v_V.shape[1])) __pyx_t_22 = 1;
+    if (unlikely(__pyx_t_22 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_22);
       __PYX_ERR(0, 175, __pyx_L1_error)
     }
-    __pyx_t_11 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_cur_scope->__pyx_v_V.data + __pyx_t_50 * __pyx_cur_scope->__pyx_v_V.strides[0]) ) + __pyx_t_51 * __pyx_cur_scope->__pyx_v_V.strides[1]) ))) == __pyx_v_max_end_prob) != 0);
+    __pyx_t_11 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_cur_scope->__pyx_v_V.data + __pyx_t_25 * __pyx_cur_scope->__pyx_v_V.strides[0]) ) + __pyx_t_23 * __pyx_cur_scope->__pyx_v_V.strides[1]) ))) == __pyx_v_max_end_prob) != 0);
     if (__pyx_t_11) {
 
       /* "soapcw/soapcw.pyx":176
  *         for i in range(width):
  *             if V[length-1][i] == max_end_prob:
  *                 vit_track[length-1] = i # appends maximum path value from final step             # <<<<<<<<<<<<<<
  *                 previous = prev[length-1][i]
  *                 break
  */
-      __pyx_t_52 = (__pyx_cur_scope->__pyx_v_length - 1);
-      __pyx_t_23 = -1;
-      if (__pyx_t_52 < 0) {
-        __pyx_t_52 += __pyx_v_vit_track.shape[0];
-        if (unlikely(__pyx_t_52 < 0)) __pyx_t_23 = 0;
-      } else if (unlikely(__pyx_t_52 >= __pyx_v_vit_track.shape[0])) __pyx_t_23 = 0;
-      if (unlikely(__pyx_t_23 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_23);
+      __pyx_t_23 = (__pyx_cur_scope->__pyx_v_length - 1);
+      __pyx_t_22 = -1;
+      if (__pyx_t_23 < 0) {
+        __pyx_t_23 += __pyx_v_vit_track.shape[0];
+        if (unlikely(__pyx_t_23 < 0)) __pyx_t_22 = 0;
+      } else if (unlikely(__pyx_t_23 >= __pyx_v_vit_track.shape[0])) __pyx_t_22 = 0;
+      if (unlikely(__pyx_t_22 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_22);
         __PYX_ERR(0, 176, __pyx_L1_error)
       }
-      *((long *) ( /* dim=0 */ (__pyx_v_vit_track.data + __pyx_t_52 * __pyx_v_vit_track.strides[0]) )) = __pyx_v_i;
+      *((int *) ( /* dim=0 */ (__pyx_v_vit_track.data + __pyx_t_23 * __pyx_v_vit_track.strides[0]) )) = __pyx_v_i;
 
       /* "soapcw/soapcw.pyx":177
  *             if V[length-1][i] == max_end_prob:
  *                 vit_track[length-1] = i # appends maximum path value from final step
  *                 previous = prev[length-1][i]             # <<<<<<<<<<<<<<
  *                 break
  * 
  */
-      __pyx_t_53 = (__pyx_cur_scope->__pyx_v_length - 1);
-      __pyx_t_54 = __pyx_v_i;
-      __pyx_t_23 = -1;
-      if (__pyx_t_53 < 0) {
-        __pyx_t_53 += __pyx_v_prev.shape[0];
-        if (unlikely(__pyx_t_53 < 0)) __pyx_t_23 = 0;
-      } else if (unlikely(__pyx_t_53 >= __pyx_v_prev.shape[0])) __pyx_t_23 = 0;
-      if (__pyx_t_54 < 0) {
-        __pyx_t_54 += __pyx_v_prev.shape[1];
-        if (unlikely(__pyx_t_54 < 0)) __pyx_t_23 = 1;
-      } else if (unlikely(__pyx_t_54 >= __pyx_v_prev.shape[1])) __pyx_t_23 = 1;
-      if (unlikely(__pyx_t_23 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_23);
+      __pyx_t_23 = (__pyx_cur_scope->__pyx_v_length - 1);
+      __pyx_t_25 = __pyx_v_i;
+      __pyx_t_22 = -1;
+      if (__pyx_t_23 < 0) {
+        __pyx_t_23 += __pyx_v_prev.shape[0];
+        if (unlikely(__pyx_t_23 < 0)) __pyx_t_22 = 0;
+      } else if (unlikely(__pyx_t_23 >= __pyx_v_prev.shape[0])) __pyx_t_22 = 0;
+      if (__pyx_t_25 < 0) {
+        __pyx_t_25 += __pyx_v_prev.shape[1];
+        if (unlikely(__pyx_t_25 < 0)) __pyx_t_22 = 1;
+      } else if (unlikely(__pyx_t_25 >= __pyx_v_prev.shape[1])) __pyx_t_22 = 1;
+      if (unlikely(__pyx_t_22 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_22);
         __PYX_ERR(0, 177, __pyx_L1_error)
       }
-      __pyx_v_previous = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_53 * __pyx_v_prev.strides[0]) ) + __pyx_t_54 * __pyx_v_prev.strides[1]) )));
+      __pyx_v_previous = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_23 * __pyx_v_prev.strides[0]) ) + __pyx_t_25 * __pyx_v_prev.strides[1]) )));
 
       /* "soapcw/soapcw.pyx":178
  *                 vit_track[length-1] = i # appends maximum path value from final step
  *                 previous = prev[length-1][i]
  *                 break             # <<<<<<<<<<<<<<
  * 
  *         for t in range(len(V)-2,-1,-1):
@@ -5899,95 +6083,95 @@
     /* "soapcw/soapcw.pyx":181
  * 
  *         for t in range(len(V)-2,-1,-1):
  *             vit_track[t] = previous # insert previous step             # <<<<<<<<<<<<<<
  *             previous = prev[t][previous]
  * 
  */
-    __pyx_t_55 = __pyx_v_t;
-    __pyx_t_19 = -1;
-    if (__pyx_t_55 < 0) {
-      __pyx_t_55 += __pyx_v_vit_track.shape[0];
-      if (unlikely(__pyx_t_55 < 0)) __pyx_t_19 = 0;
-    } else if (unlikely(__pyx_t_55 >= __pyx_v_vit_track.shape[0])) __pyx_t_19 = 0;
-    if (unlikely(__pyx_t_19 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_19);
+    __pyx_t_25 = __pyx_v_t;
+    __pyx_t_18 = -1;
+    if (__pyx_t_25 < 0) {
+      __pyx_t_25 += __pyx_v_vit_track.shape[0];
+      if (unlikely(__pyx_t_25 < 0)) __pyx_t_18 = 0;
+    } else if (unlikely(__pyx_t_25 >= __pyx_v_vit_track.shape[0])) __pyx_t_18 = 0;
+    if (unlikely(__pyx_t_18 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_18);
       __PYX_ERR(0, 181, __pyx_L1_error)
     }
-    *((long *) ( /* dim=0 */ (__pyx_v_vit_track.data + __pyx_t_55 * __pyx_v_vit_track.strides[0]) )) = __pyx_v_previous;
+    *((int *) ( /* dim=0 */ (__pyx_v_vit_track.data + __pyx_t_25 * __pyx_v_vit_track.strides[0]) )) = __pyx_v_previous;
 
     /* "soapcw/soapcw.pyx":182
  *         for t in range(len(V)-2,-1,-1):
  *             vit_track[t] = previous # insert previous step
  *             previous = prev[t][previous]             # <<<<<<<<<<<<<<
  * 
  *         self.vit_track = np.array(vit_track)
  */
-    __pyx_t_56 = __pyx_v_t;
-    __pyx_t_57 = __pyx_v_previous;
-    __pyx_t_19 = -1;
-    if (__pyx_t_56 < 0) {
-      __pyx_t_56 += __pyx_v_prev.shape[0];
-      if (unlikely(__pyx_t_56 < 0)) __pyx_t_19 = 0;
-    } else if (unlikely(__pyx_t_56 >= __pyx_v_prev.shape[0])) __pyx_t_19 = 0;
-    if (__pyx_t_57 < 0) {
-      __pyx_t_57 += __pyx_v_prev.shape[1];
-      if (unlikely(__pyx_t_57 < 0)) __pyx_t_19 = 1;
-    } else if (unlikely(__pyx_t_57 >= __pyx_v_prev.shape[1])) __pyx_t_19 = 1;
-    if (unlikely(__pyx_t_19 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_19);
+    __pyx_t_25 = __pyx_v_t;
+    __pyx_t_23 = __pyx_v_previous;
+    __pyx_t_18 = -1;
+    if (__pyx_t_25 < 0) {
+      __pyx_t_25 += __pyx_v_prev.shape[0];
+      if (unlikely(__pyx_t_25 < 0)) __pyx_t_18 = 0;
+    } else if (unlikely(__pyx_t_25 >= __pyx_v_prev.shape[0])) __pyx_t_18 = 0;
+    if (__pyx_t_23 < 0) {
+      __pyx_t_23 += __pyx_v_prev.shape[1];
+      if (unlikely(__pyx_t_23 < 0)) __pyx_t_18 = 1;
+    } else if (unlikely(__pyx_t_23 >= __pyx_v_prev.shape[1])) __pyx_t_18 = 1;
+    if (unlikely(__pyx_t_18 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_18);
       __PYX_ERR(0, 182, __pyx_L1_error)
     }
-    __pyx_v_previous = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_56 * __pyx_v_prev.strides[0]) ) + __pyx_t_57 * __pyx_v_prev.strides[1]) )));
+    __pyx_v_previous = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_25 * __pyx_v_prev.strides[0]) ) + __pyx_t_23 * __pyx_v_prev.strides[1]) )));
   }
 
   /* "soapcw/soapcw.pyx":184
  *             previous = prev[t][previous]
  * 
  *         self.vit_track = np.array(vit_track)             # <<<<<<<<<<<<<<
  *         self.max_end_prob = max_end_prob
  *         self.V = np.array(V)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 184, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 184, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_vit_track, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 184, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_vit_track, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 184, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
-  __pyx_t_18 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
+  __pyx_t_17 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 184, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_18);
+  if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 184, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_17);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track, __pyx_t_18) < 0) __PYX_ERR(0, 184, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track, __pyx_t_17) < 0) __PYX_ERR(0, 184, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
 
   /* "soapcw/soapcw.pyx":185
  * 
  *         self.vit_track = np.array(vit_track)
  *         self.max_end_prob = max_end_prob             # <<<<<<<<<<<<<<
  *         self.V = np.array(V)
  *         self.prev = np.array(prev)
  */
-  __pyx_t_18 = PyFloat_FromDouble(__pyx_v_max_end_prob); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 185, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_18);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_max_end_prob, __pyx_t_18) < 0) __PYX_ERR(0, 185, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
+  __pyx_t_17 = PyFloat_FromDouble(__pyx_v_max_end_prob); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 185, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_17);
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_max_end_prob, __pyx_t_17) < 0) __PYX_ERR(0, 185, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
 
   /* "soapcw/soapcw.pyx":186
  *         self.vit_track = np.array(vit_track)
  *         self.max_end_prob = max_end_prob
  *         self.V = np.array(V)             # <<<<<<<<<<<<<<
  *         self.prev = np.array(prev)
  * 
@@ -6005,55 +6189,55 @@
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
-  __pyx_t_18 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6);
+  __pyx_t_17 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 186, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_18);
+  if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 186, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_17);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_V, __pyx_t_18) < 0) __PYX_ERR(0, 186, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_V, __pyx_t_17) < 0) __PYX_ERR(0, 186, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
 
   /* "soapcw/soapcw.pyx":187
  *         self.max_end_prob = max_end_prob
  *         self.V = np.array(V)
  *         self.prev = np.array(prev)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 187, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 187, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_prev, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 187, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_prev, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 187, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
-  __pyx_t_18 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
+  __pyx_t_17 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 187, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_18);
+  if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 187, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_17);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prev, __pyx_t_18) < 0) __PYX_ERR(0, 187, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prev, __pyx_t_17) < 0) __PYX_ERR(0, 187, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
 
   /* "soapcw/soapcw.pyx":77
  * 
  * 
  *     def run(self,double[:] tr, double[:, :] obs, lookup_file = None):             # <<<<<<<<<<<<<<
  *         '''
  *         Run the viterbi algorithm for given single set of data and 3x1 transition matrix.
@@ -6067,31 +6251,31 @@
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __PYX_XDEC_MEMVIEW(&__pyx_t_5, 1);
   __Pyx_XDECREF(__pyx_t_6);
   __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_t_13, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_t_16, 1);
+  __Pyx_XDECREF(__pyx_t_16);
   __Pyx_XDECREF(__pyx_t_17);
-  __Pyx_XDECREF(__pyx_t_18);
-  __PYX_XDEC_MEMVIEW(&__pyx_t_49, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_32, 1);
   __Pyx_AddTraceback("soapcw.soapcw.single_detector.run", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_shape);
   __PYX_XDEC_MEMVIEW(&__pyx_v_prev, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_logarr, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_obs_ind, 1);
   __Pyx_XDECREF(__pyx_v_ranges);
   __Pyx_XDECREF(__pyx_v_obs_ind_arr);
   __Pyx_XDECREF(__pyx_v_temp);
   __Pyx_XDECREF(__pyx_v_o);
   __Pyx_XDECREF(__pyx_v_value);
   __PYX_XDEC_MEMVIEW(&__pyx_v_vit_track, 1);
+  __Pyx_XDECREF(__pyx_gb_6soapcw_6soapcw_15single_detector_3run_2generator);
   __PYX_XDEC_MEMVIEW(&__pyx_v_tr, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_obs, 1);
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
@@ -6102,26 +6286,29 @@
  *     def __init__(self, tr, obs1, obs2, lookup_file_2det = None, lookup_file_1det = None, prog = False,fractions=None, make_vitmap=True):             # <<<<<<<<<<<<<<
  *         '''
  *         viterbi algorithm for two detectors with an optional line aware statistic
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6soapcw_6soapcw_12two_detector_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_6soapcw_6soapcw_12two_detector___init__[] = "\n        viterbi algorithm for two detectors with an optional line aware statistic\n        uses S = \014rac{p(ss \\mid x)}{p(nn \\mid x)+p(ns \\mid x)+p(sn \\mid x)}\n        [currently configured for averaging over 48 SFT need to change to correctly use any]\n        Args\n        ---------\n        tr1: array\n            transition matrix\n        obs11: array\n            observation from detector 1\n        obs21: array\n            observation from detector 2 \n        lookup_file_1det: string (optional)\n            filepath of lookup table for the one detector case\n        lookup_file_2det: string ( optional)\n            filepath of lookup table for the two detector case\n        prog: bool (optional)\n            show progress bar if True \n        fractions: array (optional)\n            array of the ratio of the noise floor and amount of data between detectors\n        returns\n        -----------\n        vit_track1: array\n            path in detector 1\n        vit_track2: array\n            path in detector2\n        vit_track_ref: array\n            path in reference detector\n        V: array\n            viterbi values in reference detector\n        prev: array\n            previous positions before jump\n        max_prob: double\n            maximum end path probability\n\n        ";
+static char __pyx_doc_6soapcw_6soapcw_12two_detector___init__[] = "\n        viterbi algorithm for two detectors with an optional line aware statistic\n        uses S = \014rac{p(ss \\mid x)}{p(nn \\mid x)+p(ns \\mid x)+p(sn \\mid x)}\n        [currently configured for averaging over 48 SFT need to change to correctly use any]\n        Args\n        ---------\n        tr1: array\n            transition matrix\n        obs11: array\n            observation from detector 1 (float64 array)\n        obs21: array\n            observation from detector 2 (float64 array)\n        lookup_file_1det: string (optional)\n            filepath of lookup table for the one detector case\n        lookup_file_2det: string ( optional)\n            filepath of lookup table for the two detector case\n        prog: bool (optional)\n            show progress bar if True \n        fractions: array (optional)\n            array of the ratio of the noise floor and amount of data between detectors\n        returns\n        -----------\n        vit_track1: array\n            path in detector 1\n        vit_track2: array\n            path in detector2\n        vit_track_ref: array\n            path in reference detector\n        V: array\n            viterbi values in reference detector\n        prev: array\n            previous positions before jump\n        max_prob: double\n            maximum end path probability\n\n        ";
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_12two_detector_1__init__ = {"__init__", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_12two_detector_1__init__, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6soapcw_6soapcw_12two_detector___init__};
 static PyObject *__pyx_pw_6soapcw_6soapcw_12two_detector_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_tr = 0;
   PyObject *__pyx_v_obs1 = 0;
   PyObject *__pyx_v_obs2 = 0;
   PyObject *__pyx_v_lookup_file_2det = 0;
   PyObject *__pyx_v_lookup_file_1det = 0;
   PyObject *__pyx_v_prog = 0;
   PyObject *__pyx_v_fractions = 0;
   PyObject *__pyx_v_make_vitmap = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr,&__pyx_n_s_obs1,&__pyx_n_s_obs2,&__pyx_n_s_lookup_file_2det,&__pyx_n_s_lookup_file_1det,&__pyx_n_s_prog,&__pyx_n_s_fractions,&__pyx_n_s_make_vitmap,0};
     PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
     values[4] = ((PyObject *)((PyObject *)Py_None));
@@ -6263,16 +6450,21 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   Py_ssize_t __pyx_t_5;
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
   __Pyx_INCREF(__pyx_v_tr);
+  __Pyx_INCREF(__pyx_v_obs1);
+  __Pyx_INCREF(__pyx_v_obs2);
 
   /* "soapcw/soapcw.pyx":230
  *         '''
  * 
  *         if len(np.shape(obs1)) < 2 or len(np.shape(obs1)) < 2:             # <<<<<<<<<<<<<<
  *             raise Exception("Please input 2D array for observation data")
  *         if np.shape(obs1) != np.shape(obs2):
@@ -6430,16 +6622,16 @@
  */
   }
 
   /* "soapcw/soapcw.pyx":235
  *             raise Exception("Please make sure teh two input data have the same dimensions")
  * 
  *         tr = np.array(tr).astype('double')             # <<<<<<<<<<<<<<
- *         self.prog = prog
- * 
+ *         obs1 = np.array(obs1).astype('double')
+ *         obs2 = np.array(obs2).astype('double')
  */
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
@@ -6477,21 +6669,117 @@
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_tr, __pyx_t_7);
   __pyx_t_7 = 0;
 
   /* "soapcw/soapcw.pyx":236
  * 
  *         tr = np.array(tr).astype('double')
+ *         obs1 = np.array(obs1).astype('double')             # <<<<<<<<<<<<<<
+ *         obs2 = np.array(obs2).astype('double')
+ *         self.prog = prog
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
+    if (likely(__pyx_t_4)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+      __Pyx_INCREF(__pyx_t_4);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_2, function);
+    }
+  }
+  __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v_obs1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_obs1);
+  __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
+    if (likely(__pyx_t_3)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+      __Pyx_INCREF(__pyx_t_3);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_2, function);
+    }
+  }
+  __pyx_t_7 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_n_u_double) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_n_u_double);
+  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF_SET(__pyx_v_obs1, __pyx_t_7);
+  __pyx_t_7 = 0;
+
+  /* "soapcw/soapcw.pyx":237
+ *         tr = np.array(tr).astype('double')
+ *         obs1 = np.array(obs1).astype('double')
+ *         obs2 = np.array(obs2).astype('double')             # <<<<<<<<<<<<<<
+ *         self.prog = prog
+ * 
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
+    if (likely(__pyx_t_3)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+      __Pyx_INCREF(__pyx_t_3);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_4, function);
+    }
+  }
+  __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_obs2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_obs2);
+  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 237, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
+    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
+    if (likely(__pyx_t_2)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_4, function);
+    }
+  }
+  __pyx_t_7 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_n_u_double) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_n_u_double);
+  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 237, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF_SET(__pyx_v_obs2, __pyx_t_7);
+  __pyx_t_7 = 0;
+
+  /* "soapcw/soapcw.pyx":238
+ *         obs1 = np.array(obs1).astype('double')
+ *         obs2 = np.array(obs2).astype('double')
  *         self.prog = prog             # <<<<<<<<<<<<<<
  * 
  *         if fractions is not None and lookup_file_2det is not None:
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prog, __pyx_v_prog) < 0) __PYX_ERR(0, 236, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prog, __pyx_v_prog) < 0) __PYX_ERR(0, 238, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":238
+  /* "soapcw/soapcw.pyx":240
  *         self.prog = prog
  * 
  *         if fractions is not None and lookup_file_2det is not None:             # <<<<<<<<<<<<<<
  *             self.run_lookup_amp(tr, obs1, obs2,lookup_file=lookup_file_2det,fractions=fractions)
  *         else:
  */
   __pyx_t_6 = (__pyx_v_fractions != Py_None);
@@ -6503,152 +6791,152 @@
   }
   __pyx_t_8 = (__pyx_v_lookup_file_2det != Py_None);
   __pyx_t_6 = (__pyx_t_8 != 0);
   __pyx_t_1 = __pyx_t_6;
   __pyx_L8_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "soapcw/soapcw.pyx":239
+    /* "soapcw/soapcw.pyx":241
  * 
  *         if fractions is not None and lookup_file_2det is not None:
  *             self.run_lookup_amp(tr, obs1, obs2,lookup_file=lookup_file_2det,fractions=fractions)             # <<<<<<<<<<<<<<
  *         else:
  *             self.run(tr, obs1, obs2,lookup_file_1det=lookup_file_1det, lookup_file_2det=lookup_file_2det)
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_run_lookup_amp); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 239, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_run_lookup_amp); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 239, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 241, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_tr);
     __Pyx_GIVEREF(__pyx_v_tr);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_tr);
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_tr);
     __Pyx_INCREF(__pyx_v_obs1);
     __Pyx_GIVEREF(__pyx_v_obs1);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_obs1);
+    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_obs1);
     __Pyx_INCREF(__pyx_v_obs2);
     __Pyx_GIVEREF(__pyx_v_obs2);
-    PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_v_obs2);
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 239, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_lookup_file, __pyx_v_lookup_file_2det) < 0) __PYX_ERR(0, 239, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_fractions, __pyx_v_fractions) < 0) __PYX_ERR(0, 239, __pyx_L1_error)
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 239, __pyx_L1_error)
+    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_obs2);
+    __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_lookup_file, __pyx_v_lookup_file_2det) < 0) __PYX_ERR(0, 241, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_fractions, __pyx_v_fractions) < 0) __PYX_ERR(0, 241, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 241, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "soapcw/soapcw.pyx":238
+    /* "soapcw/soapcw.pyx":240
  *         self.prog = prog
  * 
  *         if fractions is not None and lookup_file_2det is not None:             # <<<<<<<<<<<<<<
  *             self.run_lookup_amp(tr, obs1, obs2,lookup_file=lookup_file_2det,fractions=fractions)
  *         else:
  */
     goto __pyx_L7;
   }
 
-  /* "soapcw/soapcw.pyx":241
+  /* "soapcw/soapcw.pyx":243
  *             self.run_lookup_amp(tr, obs1, obs2,lookup_file=lookup_file_2det,fractions=fractions)
  *         else:
  *             self.run(tr, obs1, obs2,lookup_file_1det=lookup_file_1det, lookup_file_2det=lookup_file_2det)             # <<<<<<<<<<<<<<
  * 
  *         self.get_track()
  */
   /*else*/ {
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_run); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 241, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_run); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 243, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 243, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 241, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_tr);
     __Pyx_GIVEREF(__pyx_v_tr);
-    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_tr);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_tr);
     __Pyx_INCREF(__pyx_v_obs1);
     __Pyx_GIVEREF(__pyx_v_obs1);
-    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_obs1);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_obs1);
     __Pyx_INCREF(__pyx_v_obs2);
     __Pyx_GIVEREF(__pyx_v_obs2);
-    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_obs2);
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 241, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_lookup_file_1det, __pyx_v_lookup_file_1det) < 0) __PYX_ERR(0, 241, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_lookup_file_2det, __pyx_v_lookup_file_2det) < 0) __PYX_ERR(0, 241, __pyx_L1_error)
-    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 241, __pyx_L1_error)
+    PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_obs2);
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 243, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_lookup_file_1det, __pyx_v_lookup_file_1det) < 0) __PYX_ERR(0, 243, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_lookup_file_2det, __pyx_v_lookup_file_2det) < 0) __PYX_ERR(0, 243, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 243, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
   __pyx_L7:;
 
-  /* "soapcw/soapcw.pyx":243
+  /* "soapcw/soapcw.pyx":245
  *             self.run(tr, obs1, obs2,lookup_file_1det=lookup_file_1det, lookup_file_2det=lookup_file_2det)
  * 
  *         self.get_track()             # <<<<<<<<<<<<<<
  *         if make_vitmap:
  *             self.get_vitmap()
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_track); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 243, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = NULL;
-  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
-    if (likely(__pyx_t_4)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-      __Pyx_INCREF(__pyx_t_4);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_track); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 245, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_2 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
+    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
+    if (likely(__pyx_t_2)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+      __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_3, function);
+      __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
-  __pyx_t_7 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 243, __pyx_L1_error)
+  __pyx_t_7 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 245, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "soapcw/soapcw.pyx":244
+  /* "soapcw/soapcw.pyx":246
  * 
  *         self.get_track()
  *         if make_vitmap:             # <<<<<<<<<<<<<<
  *             self.get_vitmap()
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_make_vitmap); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 244, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_make_vitmap); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 246, __pyx_L1_error)
   if (__pyx_t_1) {
 
-    /* "soapcw/soapcw.pyx":245
+    /* "soapcw/soapcw.pyx":247
  *         self.get_track()
  *         if make_vitmap:
  *             self.get_vitmap()             # <<<<<<<<<<<<<<
  * 
  *     #------------------------------------------------------------------------------------------------
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_vitmap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 245, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
-      if (likely(__pyx_t_4)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-        __Pyx_INCREF(__pyx_t_4);
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_vitmap); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 247, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_2 = NULL;
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
+      if (likely(__pyx_t_2)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+        __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_3, function);
+        __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
-    __pyx_t_7 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
-    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 245, __pyx_L1_error)
+    __pyx_t_7 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 247, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "soapcw/soapcw.pyx":244
+    /* "soapcw/soapcw.pyx":246
  * 
  *         self.get_track()
  *         if make_vitmap:             # <<<<<<<<<<<<<<
  *             self.get_vitmap()
  * 
  */
   }
@@ -6669,34 +6957,39 @@
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_AddTraceback("soapcw.soapcw.two_detector.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_tr);
+  __Pyx_XDECREF(__pyx_v_obs1);
+  __Pyx_XDECREF(__pyx_v_obs2);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":251
+/* "soapcw/soapcw.pyx":253
  *     #------------------------------------------------------------------------------------------------
  * 
  *     def get_vitmap(self,log=False):             # <<<<<<<<<<<<<<
  *         """
  *         normalise the viterbi output such that the sum of eah column is 1
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6soapcw_6soapcw_12two_detector_3get_vitmap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static char __pyx_doc_6soapcw_6soapcw_12two_detector_2get_vitmap[] = "\n        normalise the viterbi output such that the sum of eah column is 1\n        ";
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_12two_detector_3get_vitmap = {"get_vitmap", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_12two_detector_3get_vitmap, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6soapcw_6soapcw_12two_detector_2get_vitmap};
 static PyObject *__pyx_pw_6soapcw_6soapcw_12two_detector_3get_vitmap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_log = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("get_vitmap (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_log,0};
     PyObject* values[2] = {0,0};
     values[1] = ((PyObject *)((PyObject *)Py_False));
@@ -6720,15 +7013,15 @@
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_log);
           if (value) { values[1] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_vitmap") < 0)) __PYX_ERR(0, 251, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_vitmap") < 0)) __PYX_ERR(0, 253, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
@@ -6736,15 +7029,15 @@
       }
     }
     __pyx_v_self = values[0];
     __pyx_v_log = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_vitmap", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 251, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("get_vitmap", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 253, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.two_detector.get_vitmap", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_12two_detector_2get_vitmap(__pyx_self, __pyx_v_self, __pyx_v_log);
 
@@ -6765,248 +7058,251 @@
   Py_ssize_t __pyx_t_3;
   PyObject *(*__pyx_t_4)(PyObject *);
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   int __pyx_t_9;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_vitmap", 0);
 
-  /* "soapcw/soapcw.pyx":255
+  /* "soapcw/soapcw.pyx":257
  *         normalise the viterbi output such that the sum of eah column is 1
  *         """
  *         path_m = []             # <<<<<<<<<<<<<<
  *         for i in self.V:
  *             sump = logsumexp(i)
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 255, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_path_m = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":256
+  /* "soapcw/soapcw.pyx":258
  *         """
  *         path_m = []
  *         for i in self.V:             # <<<<<<<<<<<<<<
  *             sump = logsumexp(i)
  *             val = np.exp(i-sump)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_V); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_V); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 258, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 258, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 256, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 258, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 256, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 258, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 256, __pyx_L1_error)
+          else __PYX_ERR(0, 258, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":257
+    /* "soapcw/soapcw.pyx":259
  *         path_m = []
  *         for i in self.V:
  *             sump = logsumexp(i)             # <<<<<<<<<<<<<<
  *             val = np.exp(i-sump)
  *             path_m.append(val)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_logsumexp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_logsumexp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 259, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_v_i) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_i);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_XDECREF_SET(__pyx_v_sump, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":258
+    /* "soapcw/soapcw.pyx":260
  *         for i in self.V:
  *             sump = logsumexp(i)
  *             val = np.exp(i-sump)             # <<<<<<<<<<<<<<
  *             path_m.append(val)
  *         path_m = np.array(path_m)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 258, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_exp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 258, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_exp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Subtract(__pyx_v_i, __pyx_v_sump); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 258, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Subtract(__pyx_v_i, __pyx_v_sump); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_5);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_XDECREF_SET(__pyx_v_val, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":259
+    /* "soapcw/soapcw.pyx":261
  *             sump = logsumexp(i)
  *             val = np.exp(i-sump)
  *             path_m.append(val)             # <<<<<<<<<<<<<<
  *         path_m = np.array(path_m)
  *         if log:
  */
-    __pyx_t_8 = __Pyx_PyObject_Append(__pyx_v_path_m, __pyx_v_val); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Append(__pyx_v_path_m, __pyx_v_val); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 261, __pyx_L1_error)
 
-    /* "soapcw/soapcw.pyx":256
+    /* "soapcw/soapcw.pyx":258
  *         """
  *         path_m = []
  *         for i in self.V:             # <<<<<<<<<<<<<<
  *             sump = logsumexp(i)
  *             val = np.exp(i-sump)
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":260
+  /* "soapcw/soapcw.pyx":262
  *             val = np.exp(i-sump)
  *             path_m.append(val)
  *         path_m = np.array(path_m)             # <<<<<<<<<<<<<<
  *         if log:
  *             path_m = np.log(path_m)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 262, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_1)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_1);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_v_path_m) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_path_m);
   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 260, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 262, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF_SET(__pyx_v_path_m, __pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":261
+  /* "soapcw/soapcw.pyx":263
  *             path_m.append(val)
  *         path_m = np.array(path_m)
  *         if log:             # <<<<<<<<<<<<<<
  *             path_m = np.log(path_m)
  * 
  */
-  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_v_log); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 261, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_v_log); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 263, __pyx_L1_error)
   if (__pyx_t_9) {
 
-    /* "soapcw/soapcw.pyx":262
+    /* "soapcw/soapcw.pyx":264
  *         path_m = np.array(path_m)
  *         if log:
  *             path_m = np.log(path_m)             # <<<<<<<<<<<<<<
  * 
  *         self.vitmap = path_m
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 262, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 264, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_log); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_log); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 264, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_v_path_m) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_path_m);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 262, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 264, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_path_m, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":261
+    /* "soapcw/soapcw.pyx":263
  *             path_m.append(val)
  *         path_m = np.array(path_m)
  *         if log:             # <<<<<<<<<<<<<<
  *             path_m = np.log(path_m)
  * 
  */
   }
 
-  /* "soapcw/soapcw.pyx":264
+  /* "soapcw/soapcw.pyx":266
  *             path_m = np.log(path_m)
  * 
  *         self.vitmap = path_m             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vitmap, __pyx_v_path_m) < 0) __PYX_ERR(0, 264, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vitmap, __pyx_v_path_m) < 0) __PYX_ERR(0, 266, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":251
+  /* "soapcw/soapcw.pyx":253
  *     #------------------------------------------------------------------------------------------------
  * 
  *     def get_vitmap(self,log=False):             # <<<<<<<<<<<<<<
  *         """
  *         normalise the viterbi output such that the sum of eah column is 1
  */
 
@@ -7027,28 +7323,31 @@
   __Pyx_XDECREF(__pyx_v_sump);
   __Pyx_XDECREF(__pyx_v_val);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":271
+/* "soapcw/soapcw.pyx":273
  *     #--------------------------------------------------------
  * 
  *     def read_lookup(self,filename):             # <<<<<<<<<<<<<<
  * 
  *         with open(filename,'rb') as f1:
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6soapcw_6soapcw_12two_detector_5read_lookup(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_12two_detector_5read_lookup = {"read_lookup", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_12two_detector_5read_lookup, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_6soapcw_6soapcw_12two_detector_5read_lookup(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   CYTHON_UNUSED PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_filename = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_lookup (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_filename,0};
     PyObject* values[2] = {0,0};
     if (unlikely(__pyx_kwds)) {
@@ -7067,32 +7366,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_filename)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_lookup", 1, 2, 2, 1); __PYX_ERR(0, 271, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_lookup", 1, 2, 2, 1); __PYX_ERR(0, 273, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_lookup") < 0)) __PYX_ERR(0, 271, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_lookup") < 0)) __PYX_ERR(0, 273, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_filename = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_lookup", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 271, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_lookup", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 273, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.two_detector.read_lookup", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_12two_detector_4read_lookup(__pyx_self, __pyx_v_self, __pyx_v_filename);
 
@@ -7121,52 +7420,55 @@
   PyObject *__pyx_t_10 = NULL;
   int __pyx_t_11;
   int __pyx_t_12;
   PyObject *__pyx_t_13 = NULL;
   PyObject *__pyx_t_14 = NULL;
   int __pyx_t_15;
   PyObject *__pyx_t_16 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_lookup", 0);
 
-  /* "soapcw/soapcw.pyx":273
+  /* "soapcw/soapcw.pyx":275
  *     def read_lookup(self,filename):
  * 
  *         with open(filename,'rb') as f1:             # <<<<<<<<<<<<<<
  *             likelihood, params = pickle.load(f1)
  * 
  */
   /*with:*/ {
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 275, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_filename);
     __Pyx_GIVEREF(__pyx_v_filename);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_filename);
     __Pyx_INCREF(__pyx_n_u_rb);
     __Pyx_GIVEREF(__pyx_n_u_rb);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_n_u_rb);
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 275, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_3 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 275, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 273, __pyx_L3_error)
+    __pyx_t_4 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 275, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 273, __pyx_L3_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 275, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = __pyx_t_1;
     __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     /*try:*/ {
       {
@@ -7176,93 +7478,93 @@
         __Pyx_XGOTREF(__pyx_t_6);
         __Pyx_XGOTREF(__pyx_t_7);
         __Pyx_XGOTREF(__pyx_t_8);
         /*try:*/ {
           __pyx_v_f1 = __pyx_t_4;
           __pyx_t_4 = 0;
 
-          /* "soapcw/soapcw.pyx":274
+          /* "soapcw/soapcw.pyx":276
  * 
  *         with open(filename,'rb') as f1:
  *             likelihood, params = pickle.load(f1)             # <<<<<<<<<<<<<<
  * 
  *         ranges = np.linspace(params["power_ranges"][0],params["power_ranges"][1],int(params["power_ranges"][2]))
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_pickle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 274, __pyx_L7_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_pickle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_load); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L7_error)
+          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_load); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           __pyx_t_2 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
             __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
             if (likely(__pyx_t_2)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
               __Pyx_INCREF(__pyx_t_2);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_1, function);
             }
           }
           __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_v_f1) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_f1);
           __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-          if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 274, __pyx_L7_error)
+          if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
             PyObject* sequence = __pyx_t_4;
             Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
             if (unlikely(size != 2)) {
               if (size > 2) __Pyx_RaiseTooManyValuesError(2);
               else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-              __PYX_ERR(0, 274, __pyx_L7_error)
+              __PYX_ERR(0, 276, __pyx_L7_error)
             }
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
             if (likely(PyTuple_CheckExact(sequence))) {
               __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
               __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
             } else {
               __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
               __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
             }
             __Pyx_INCREF(__pyx_t_1);
             __Pyx_INCREF(__pyx_t_2);
             #else
-            __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L7_error)
+            __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
-            __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 274, __pyx_L7_error)
+            __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
             #endif
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           } else {
             Py_ssize_t index = -1;
-            __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 274, __pyx_L7_error)
+            __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
             __pyx_t_9 = Py_TYPE(__pyx_t_5)->tp_iternext;
             index = 0; __pyx_t_1 = __pyx_t_9(__pyx_t_5); if (unlikely(!__pyx_t_1)) goto __pyx_L13_unpacking_failed;
             __Pyx_GOTREF(__pyx_t_1);
             index = 1; __pyx_t_2 = __pyx_t_9(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L13_unpacking_failed;
             __Pyx_GOTREF(__pyx_t_2);
-            if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_5), 2) < 0) __PYX_ERR(0, 274, __pyx_L7_error)
+            if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_5), 2) < 0) __PYX_ERR(0, 276, __pyx_L7_error)
             __pyx_t_9 = NULL;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             goto __pyx_L14_unpacking_done;
             __pyx_L13_unpacking_failed:;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             __pyx_t_9 = NULL;
             if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-            __PYX_ERR(0, 274, __pyx_L7_error)
+            __PYX_ERR(0, 276, __pyx_L7_error)
             __pyx_L14_unpacking_done:;
           }
           __pyx_v_likelihood = __pyx_t_1;
           __pyx_t_1 = 0;
           __pyx_v_params = __pyx_t_2;
           __pyx_t_2 = 0;
 
-          /* "soapcw/soapcw.pyx":273
+          /* "soapcw/soapcw.pyx":275
  *     def read_lookup(self,filename):
  * 
  *         with open(filename,'rb') as f1:             # <<<<<<<<<<<<<<
  *             likelihood, params = pickle.load(f1)
  * 
  */
         }
@@ -7273,36 +7575,36 @@
         __pyx_L7_error:;
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("soapcw.soapcw.two_detector.read_lookup", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_2, &__pyx_t_1) < 0) __PYX_ERR(0, 273, __pyx_L9_except_error)
+          if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_2, &__pyx_t_1) < 0) __PYX_ERR(0, 275, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_5 = PyTuple_Pack(3, __pyx_t_4, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 273, __pyx_L9_except_error)
+          __pyx_t_5 = PyTuple_Pack(3, __pyx_t_4, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 275, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 273, __pyx_L9_except_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 275, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_10);
           __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          if (__pyx_t_11 < 0) __PYX_ERR(0, 273, __pyx_L9_except_error)
+          if (__pyx_t_11 < 0) __PYX_ERR(0, 275, __pyx_L9_except_error)
           __pyx_t_12 = ((!(__pyx_t_11 != 0)) != 0);
           if (__pyx_t_12) {
             __Pyx_GIVEREF(__pyx_t_4);
             __Pyx_GIVEREF(__pyx_t_2);
             __Pyx_XGIVEREF(__pyx_t_1);
             __Pyx_ErrRestoreWithState(__pyx_t_4, __pyx_t_2, __pyx_t_1);
             __pyx_t_4 = 0; __pyx_t_2 = 0; __pyx_t_1 = 0; 
-            __PYX_ERR(0, 273, __pyx_L9_except_error)
+            __PYX_ERR(0, 275, __pyx_L9_except_error)
           }
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           goto __pyx_L8_exception_handled;
         }
         __pyx_L9_except_error:;
@@ -7320,60 +7622,60 @@
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_3) {
           __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__3, NULL);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 273, __pyx_L1_error)
+          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 275, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
         goto __pyx_L6;
       }
       __pyx_L6:;
     }
     goto __pyx_L18;
     __pyx_L3_error:;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L1_error;
     __pyx_L18:;
   }
 
-  /* "soapcw/soapcw.pyx":276
+  /* "soapcw/soapcw.pyx":278
  *             likelihood, params = pickle.load(f1)
  * 
  *         ranges = np.linspace(params["power_ranges"][0],params["power_ranges"][1],int(params["power_ranges"][2]))             # <<<<<<<<<<<<<<
  *         fact = abs(1./(ranges[0] - ranges[1]))
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_linspace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_linspace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 276, __pyx_L1_error) }
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_power_ranges); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)
+  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 278, __pyx_L1_error) }
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_power_ranges); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 276, __pyx_L1_error) }
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_power_ranges); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)
+  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 278, __pyx_L1_error) }
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_power_ranges); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_13 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 276, __pyx_L1_error) }
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_power_ranges); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)
+  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 278, __pyx_L1_error) }
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_power_ranges); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_14 = __Pyx_GetItemInt(__pyx_t_2, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_GetItemInt(__pyx_t_2, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_14); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_14); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
   __pyx_t_14 = NULL;
   __pyx_t_15 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_14)) {
@@ -7383,105 +7685,105 @@
       __Pyx_DECREF_SET(__pyx_t_4, function);
       __pyx_t_15 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_4)) {
     PyObject *__pyx_temp[4] = {__pyx_t_14, __pyx_t_5, __pyx_t_13, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
     PyObject *__pyx_temp[4] = {__pyx_t_14, __pyx_t_5, __pyx_t_13, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   {
-    __pyx_t_16 = PyTuple_New(3+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __pyx_t_16 = PyTuple_New(3+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_16);
     if (__pyx_t_14) {
       __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_13);
     PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_13);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_2);
     __pyx_t_5 = 0;
     __pyx_t_13 = 0;
     __pyx_t_2 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_16, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_16, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
   }
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_ranges = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":277
+  /* "soapcw/soapcw.pyx":279
  * 
  *         ranges = np.linspace(params["power_ranges"][0],params["power_ranges"][1],int(params["power_ranges"][2]))
  *         fact = abs(1./(ranges[0] - ranges[1]))             # <<<<<<<<<<<<<<
  * 
  *         return likelihood, ranges, fact
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ranges, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ranges, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_ranges, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_ranges, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 279, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_16 = PyNumber_Subtract(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_t_16 = PyNumber_Subtract(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 279, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_16);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_16, 1., 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_16, 1., 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 279, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-  __pyx_t_16 = __Pyx_PyNumber_Absolute(__pyx_t_4); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_t_16 = __Pyx_PyNumber_Absolute(__pyx_t_4); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 279, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_16);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_fact = __pyx_t_16;
   __pyx_t_16 = 0;
 
-  /* "soapcw/soapcw.pyx":279
+  /* "soapcw/soapcw.pyx":281
  *         fact = abs(1./(ranges[0] - ranges[1]))
  * 
  *         return likelihood, ranges, fact             # <<<<<<<<<<<<<<
  * 
  *     def read_lookup_amp(self,filename):
  */
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_likelihood)) { __Pyx_RaiseUnboundLocalError("likelihood"); __PYX_ERR(0, 279, __pyx_L1_error) }
-  __pyx_t_16 = PyTuple_New(3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 279, __pyx_L1_error)
+  if (unlikely(!__pyx_v_likelihood)) { __Pyx_RaiseUnboundLocalError("likelihood"); __PYX_ERR(0, 281, __pyx_L1_error) }
+  __pyx_t_16 = PyTuple_New(3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 281, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_16);
   __Pyx_INCREF(__pyx_v_likelihood);
   __Pyx_GIVEREF(__pyx_v_likelihood);
   PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_v_likelihood);
   __Pyx_INCREF(__pyx_v_ranges);
   __Pyx_GIVEREF(__pyx_v_ranges);
   PyTuple_SET_ITEM(__pyx_t_16, 1, __pyx_v_ranges);
   __Pyx_INCREF(__pyx_v_fact);
   __Pyx_GIVEREF(__pyx_v_fact);
   PyTuple_SET_ITEM(__pyx_t_16, 2, __pyx_v_fact);
   __pyx_r = __pyx_t_16;
   __pyx_t_16 = 0;
   goto __pyx_L0;
 
-  /* "soapcw/soapcw.pyx":271
+  /* "soapcw/soapcw.pyx":273
  *     #--------------------------------------------------------
  * 
  *     def read_lookup(self,filename):             # <<<<<<<<<<<<<<
  * 
  *         with open(filename,'rb') as f1:
  */
 
@@ -7503,28 +7805,31 @@
   __Pyx_XDECREF(__pyx_v_ranges);
   __Pyx_XDECREF(__pyx_v_fact);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":281
+/* "soapcw/soapcw.pyx":283
  *         return likelihood, ranges, fact
  * 
  *     def read_lookup_amp(self,filename):             # <<<<<<<<<<<<<<
  * 
  *         with open(filename,'rb') as f1:
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6soapcw_6soapcw_12two_detector_7read_lookup_amp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_12two_detector_7read_lookup_amp = {"read_lookup_amp", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_12two_detector_7read_lookup_amp, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_6soapcw_6soapcw_12two_detector_7read_lookup_amp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   CYTHON_UNUSED PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_filename = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_lookup_amp (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_filename,0};
     PyObject* values[2] = {0,0};
     if (unlikely(__pyx_kwds)) {
@@ -7543,32 +7848,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_filename)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_lookup_amp", 1, 2, 2, 1); __PYX_ERR(0, 281, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_lookup_amp", 1, 2, 2, 1); __PYX_ERR(0, 283, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_lookup_amp") < 0)) __PYX_ERR(0, 281, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_lookup_amp") < 0)) __PYX_ERR(0, 283, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_filename = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_lookup_amp", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 281, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_lookup_amp", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 283, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.two_detector.read_lookup_amp", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_12two_detector_6read_lookup_amp(__pyx_self, __pyx_v_self, __pyx_v_filename);
 
@@ -7599,52 +7904,55 @@
   PyObject *__pyx_t_10 = NULL;
   int __pyx_t_11;
   int __pyx_t_12;
   PyObject *__pyx_t_13 = NULL;
   PyObject *__pyx_t_14 = NULL;
   int __pyx_t_15;
   PyObject *__pyx_t_16 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_lookup_amp", 0);
 
-  /* "soapcw/soapcw.pyx":283
+  /* "soapcw/soapcw.pyx":285
  *     def read_lookup_amp(self,filename):
  * 
  *         with open(filename,'rb') as f1:             # <<<<<<<<<<<<<<
  *             likelihood, params = pickle.load(f1)
  * 
  */
   /*with:*/ {
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_filename);
     __Pyx_GIVEREF(__pyx_v_filename);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_filename);
     __Pyx_INCREF(__pyx_n_u_rb);
     __Pyx_GIVEREF(__pyx_n_u_rb);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_n_u_rb);
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 285, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_3 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 285, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 283, __pyx_L3_error)
+    __pyx_t_4 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 285, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 283, __pyx_L3_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = __pyx_t_1;
     __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     /*try:*/ {
       {
@@ -7654,93 +7962,93 @@
         __Pyx_XGOTREF(__pyx_t_6);
         __Pyx_XGOTREF(__pyx_t_7);
         __Pyx_XGOTREF(__pyx_t_8);
         /*try:*/ {
           __pyx_v_f1 = __pyx_t_4;
           __pyx_t_4 = 0;
 
-          /* "soapcw/soapcw.pyx":284
+          /* "soapcw/soapcw.pyx":286
  * 
  *         with open(filename,'rb') as f1:
  *             likelihood, params = pickle.load(f1)             # <<<<<<<<<<<<<<
  * 
  *         pow_ranges = np.linspace(params["power_ranges"][0],params["power_ranges"][1],int(params["power_ranges"][2]))
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_pickle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 284, __pyx_L7_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_pickle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_load); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L7_error)
+          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_load); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           __pyx_t_2 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
             __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
             if (likely(__pyx_t_2)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
               __Pyx_INCREF(__pyx_t_2);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_1, function);
             }
           }
           __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_v_f1) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_f1);
           __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-          if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 284, __pyx_L7_error)
+          if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 286, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
             PyObject* sequence = __pyx_t_4;
             Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
             if (unlikely(size != 2)) {
               if (size > 2) __Pyx_RaiseTooManyValuesError(2);
               else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-              __PYX_ERR(0, 284, __pyx_L7_error)
+              __PYX_ERR(0, 286, __pyx_L7_error)
             }
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
             if (likely(PyTuple_CheckExact(sequence))) {
               __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
               __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
             } else {
               __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
               __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
             }
             __Pyx_INCREF(__pyx_t_1);
             __Pyx_INCREF(__pyx_t_2);
             #else
-            __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L7_error)
+            __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
-            __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 284, __pyx_L7_error)
+            __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
             #endif
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           } else {
             Py_ssize_t index = -1;
-            __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 284, __pyx_L7_error)
+            __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 286, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
             __pyx_t_9 = Py_TYPE(__pyx_t_5)->tp_iternext;
             index = 0; __pyx_t_1 = __pyx_t_9(__pyx_t_5); if (unlikely(!__pyx_t_1)) goto __pyx_L13_unpacking_failed;
             __Pyx_GOTREF(__pyx_t_1);
             index = 1; __pyx_t_2 = __pyx_t_9(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L13_unpacking_failed;
             __Pyx_GOTREF(__pyx_t_2);
-            if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_5), 2) < 0) __PYX_ERR(0, 284, __pyx_L7_error)
+            if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_5), 2) < 0) __PYX_ERR(0, 286, __pyx_L7_error)
             __pyx_t_9 = NULL;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             goto __pyx_L14_unpacking_done;
             __pyx_L13_unpacking_failed:;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             __pyx_t_9 = NULL;
             if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-            __PYX_ERR(0, 284, __pyx_L7_error)
+            __PYX_ERR(0, 286, __pyx_L7_error)
             __pyx_L14_unpacking_done:;
           }
           __pyx_v_likelihood = __pyx_t_1;
           __pyx_t_1 = 0;
           __pyx_v_params = __pyx_t_2;
           __pyx_t_2 = 0;
 
-          /* "soapcw/soapcw.pyx":283
+          /* "soapcw/soapcw.pyx":285
  *     def read_lookup_amp(self,filename):
  * 
  *         with open(filename,'rb') as f1:             # <<<<<<<<<<<<<<
  *             likelihood, params = pickle.load(f1)
  * 
  */
         }
@@ -7751,36 +8059,36 @@
         __pyx_L7_error:;
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("soapcw.soapcw.two_detector.read_lookup_amp", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_2, &__pyx_t_1) < 0) __PYX_ERR(0, 283, __pyx_L9_except_error)
+          if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_2, &__pyx_t_1) < 0) __PYX_ERR(0, 285, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_5 = PyTuple_Pack(3, __pyx_t_4, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 283, __pyx_L9_except_error)
+          __pyx_t_5 = PyTuple_Pack(3, __pyx_t_4, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 285, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 283, __pyx_L9_except_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 285, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_10);
           __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          if (__pyx_t_11 < 0) __PYX_ERR(0, 283, __pyx_L9_except_error)
+          if (__pyx_t_11 < 0) __PYX_ERR(0, 285, __pyx_L9_except_error)
           __pyx_t_12 = ((!(__pyx_t_11 != 0)) != 0);
           if (__pyx_t_12) {
             __Pyx_GIVEREF(__pyx_t_4);
             __Pyx_GIVEREF(__pyx_t_2);
             __Pyx_XGIVEREF(__pyx_t_1);
             __Pyx_ErrRestoreWithState(__pyx_t_4, __pyx_t_2, __pyx_t_1);
             __pyx_t_4 = 0; __pyx_t_2 = 0; __pyx_t_1 = 0; 
-            __PYX_ERR(0, 283, __pyx_L9_except_error)
+            __PYX_ERR(0, 285, __pyx_L9_except_error)
           }
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           goto __pyx_L8_exception_handled;
         }
         __pyx_L9_except_error:;
@@ -7798,60 +8106,60 @@
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_3) {
           __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__3, NULL);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 283, __pyx_L1_error)
+          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 285, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
         goto __pyx_L6;
       }
       __pyx_L6:;
     }
     goto __pyx_L18;
     __pyx_L3_error:;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L1_error;
     __pyx_L18:;
   }
 
-  /* "soapcw/soapcw.pyx":286
+  /* "soapcw/soapcw.pyx":288
  *             likelihood, params = pickle.load(f1)
  * 
  *         pow_ranges = np.linspace(params["power_ranges"][0],params["power_ranges"][1],int(params["power_ranges"][2]))             # <<<<<<<<<<<<<<
  *         frac_ranges = np.linspace(params["fraction_ranges"][0],params["fraction_ranges"][1],int(params["fraction_ranges"][2]))
  *         pow_fact = abs(1./(pow_ranges[0] - pow_ranges[1]))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_linspace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 286, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_linspace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 286, __pyx_L1_error) }
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_power_ranges); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
+  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 288, __pyx_L1_error) }
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_power_ranges); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 286, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 286, __pyx_L1_error) }
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_power_ranges); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
+  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 288, __pyx_L1_error) }
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_power_ranges); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_13 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 286, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 286, __pyx_L1_error) }
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_power_ranges); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
+  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 288, __pyx_L1_error) }
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_power_ranges); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_14 = __Pyx_GetItemInt(__pyx_t_2, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 286, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_GetItemInt(__pyx_t_2, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_14); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_14); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
   __pyx_t_14 = NULL;
   __pyx_t_15 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_14)) {
@@ -7861,87 +8169,87 @@
       __Pyx_DECREF_SET(__pyx_t_4, function);
       __pyx_t_15 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_4)) {
     PyObject *__pyx_temp[4] = {__pyx_t_14, __pyx_t_5, __pyx_t_13, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
     PyObject *__pyx_temp[4] = {__pyx_t_14, __pyx_t_5, __pyx_t_13, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   {
-    __pyx_t_16 = PyTuple_New(3+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __pyx_t_16 = PyTuple_New(3+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 288, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_16);
     if (__pyx_t_14) {
       __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_13);
     PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_13);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_2);
     __pyx_t_5 = 0;
     __pyx_t_13 = 0;
     __pyx_t_2 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_16, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_16, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
   }
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_pow_ranges = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":287
+  /* "soapcw/soapcw.pyx":289
  * 
  *         pow_ranges = np.linspace(params["power_ranges"][0],params["power_ranges"][1],int(params["power_ranges"][2]))
  *         frac_ranges = np.linspace(params["fraction_ranges"][0],params["fraction_ranges"][1],int(params["fraction_ranges"][2]))             # <<<<<<<<<<<<<<
  *         pow_fact = abs(1./(pow_ranges[0] - pow_ranges[1]))
  *         frac_fact = abs(1./(frac_ranges[0] - frac_ranges[1]))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 287, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_linspace); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 287, __pyx_L1_error)
+  __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_linspace); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_16);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 287, __pyx_L1_error) }
-  __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_fraction_ranges); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 287, __pyx_L1_error)
+  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 289, __pyx_L1_error) }
+  __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_fraction_ranges); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 287, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 287, __pyx_L1_error) }
-  __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_fraction_ranges); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 287, __pyx_L1_error)
+  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 289, __pyx_L1_error) }
+  __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_fraction_ranges); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_13 = __Pyx_GetItemInt(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 287, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_GetItemInt(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 287, __pyx_L1_error) }
-  __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_fraction_ranges); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 287, __pyx_L1_error)
+  if (unlikely(!__pyx_v_params)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 289, __pyx_L1_error) }
+  __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_params, __pyx_n_u_fraction_ranges); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_4, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 287, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_4, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyNumber_Int(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 287, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyNumber_Int(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   __pyx_t_15 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_16))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_16);
     if (likely(__pyx_t_5)) {
@@ -7951,116 +8259,116 @@
       __Pyx_DECREF_SET(__pyx_t_16, function);
       __pyx_t_15 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_16)) {
     PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_t_2, __pyx_t_13, __pyx_t_4};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_16, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_16, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_16)) {
     PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_t_2, __pyx_t_13, __pyx_t_4};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_16, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_16, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   {
-    __pyx_t_14 = PyTuple_New(3+__pyx_t_15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 287, __pyx_L1_error)
+    __pyx_t_14 = PyTuple_New(3+__pyx_t_15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 289, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     if (__pyx_t_5) {
       __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_5); __pyx_t_5 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_14, 0+__pyx_t_15, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_13);
     PyTuple_SET_ITEM(__pyx_t_14, 1+__pyx_t_15, __pyx_t_13);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_14, 2+__pyx_t_15, __pyx_t_4);
     __pyx_t_2 = 0;
     __pyx_t_13 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_16, __pyx_t_14, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_16, __pyx_t_14, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
   }
   __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
   __pyx_v_frac_ranges = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":288
+  /* "soapcw/soapcw.pyx":290
  *         pow_ranges = np.linspace(params["power_ranges"][0],params["power_ranges"][1],int(params["power_ranges"][2]))
  *         frac_ranges = np.linspace(params["fraction_ranges"][0],params["fraction_ranges"][1],int(params["fraction_ranges"][2]))
  *         pow_fact = abs(1./(pow_ranges[0] - pow_ranges[1]))             # <<<<<<<<<<<<<<
  *         frac_fact = abs(1./(frac_ranges[0] - frac_ranges[1]))
  * 
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pow_ranges, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pow_ranges, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_16 = __Pyx_GetItemInt(__pyx_v_pow_ranges, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 288, __pyx_L1_error)
+  __pyx_t_16 = __Pyx_GetItemInt(__pyx_v_pow_ranges, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_16);
-  __pyx_t_14 = PyNumber_Subtract(__pyx_t_1, __pyx_t_16); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 288, __pyx_L1_error)
+  __pyx_t_14 = PyNumber_Subtract(__pyx_t_1, __pyx_t_16); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-  __pyx_t_16 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_14, 1., 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 288, __pyx_L1_error)
+  __pyx_t_16 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_14, 1., 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_16);
   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-  __pyx_t_14 = __Pyx_PyNumber_Absolute(__pyx_t_16); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 288, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyNumber_Absolute(__pyx_t_16); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
   __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
   __pyx_v_pow_fact = __pyx_t_14;
   __pyx_t_14 = 0;
 
-  /* "soapcw/soapcw.pyx":289
+  /* "soapcw/soapcw.pyx":291
  *         frac_ranges = np.linspace(params["fraction_ranges"][0],params["fraction_ranges"][1],int(params["fraction_ranges"][2]))
  *         pow_fact = abs(1./(pow_ranges[0] - pow_ranges[1]))
  *         frac_fact = abs(1./(frac_ranges[0] - frac_ranges[1]))             # <<<<<<<<<<<<<<
  * 
  *         return likelihood.T, pow_ranges, frac_ranges, pow_fact, frac_fact
  */
-  __pyx_t_14 = __Pyx_GetItemInt(__pyx_v_frac_ranges, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 289, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_GetItemInt(__pyx_v_frac_ranges, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
-  __pyx_t_16 = __Pyx_GetItemInt(__pyx_v_frac_ranges, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 289, __pyx_L1_error)
+  __pyx_t_16 = __Pyx_GetItemInt(__pyx_v_frac_ranges, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_16);
-  __pyx_t_1 = PyNumber_Subtract(__pyx_t_14, __pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_t_14, __pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
   __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-  __pyx_t_16 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_1, 1., 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 289, __pyx_L1_error)
+  __pyx_t_16 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_1, 1., 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_16);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyNumber_Absolute(__pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyNumber_Absolute(__pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
   __pyx_v_frac_fact = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":291
+  /* "soapcw/soapcw.pyx":293
  *         frac_fact = abs(1./(frac_ranges[0] - frac_ranges[1]))
  * 
  *         return likelihood.T, pow_ranges, frac_ranges, pow_fact, frac_fact             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_likelihood)) { __Pyx_RaiseUnboundLocalError("likelihood"); __PYX_ERR(0, 291, __pyx_L1_error) }
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_likelihood, __pyx_n_s_T); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 291, __pyx_L1_error)
+  if (unlikely(!__pyx_v_likelihood)) { __Pyx_RaiseUnboundLocalError("likelihood"); __PYX_ERR(0, 293, __pyx_L1_error) }
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_likelihood, __pyx_n_s_T); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_16 = PyTuple_New(5); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __pyx_t_16 = PyTuple_New(5); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 293, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_16);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_1);
   __Pyx_INCREF(__pyx_v_pow_ranges);
   __Pyx_GIVEREF(__pyx_v_pow_ranges);
   PyTuple_SET_ITEM(__pyx_t_16, 1, __pyx_v_pow_ranges);
   __Pyx_INCREF(__pyx_v_frac_ranges);
@@ -8073,15 +8381,15 @@
   __Pyx_GIVEREF(__pyx_v_frac_fact);
   PyTuple_SET_ITEM(__pyx_t_16, 4, __pyx_v_frac_fact);
   __pyx_t_1 = 0;
   __pyx_r = __pyx_t_16;
   __pyx_t_16 = 0;
   goto __pyx_L0;
 
-  /* "soapcw/soapcw.pyx":281
+  /* "soapcw/soapcw.pyx":283
  *         return likelihood, ranges, fact
  * 
  *     def read_lookup_amp(self,filename):             # <<<<<<<<<<<<<<
  * 
  *         with open(filename,'rb') as f1:
  */
 
@@ -8105,15 +8413,15 @@
   __Pyx_XDECREF(__pyx_v_pow_fact);
   __Pyx_XDECREF(__pyx_v_frac_fact);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":298
+/* "soapcw/soapcw.pyx":300
  *     #--------------------------------------------------------
  * 
  *     def run(self,transition, obs1, obs2, lookup_file_1det = None,lookup_file_2det = None):             # <<<<<<<<<<<<<<
  *         """
  *         viterbi algorithm for two detectors with an lookup table for the line veto statistic
  */
 
@@ -8124,14 +8432,17 @@
 static PyObject *__pyx_pw_6soapcw_6soapcw_12two_detector_9run(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_transition = 0;
   PyObject *__pyx_v_obs1 = 0;
   PyObject *__pyx_v_obs2 = 0;
   PyObject *__pyx_v_lookup_file_1det = 0;
   PyObject *__pyx_v_lookup_file_2det = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("run (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_transition,&__pyx_n_s_obs1,&__pyx_n_s_obs2,&__pyx_n_s_lookup_file_1det,&__pyx_n_s_lookup_file_2det,0};
     PyObject* values[6] = {0,0,0,0,0,0};
     values[4] = ((PyObject *)((PyObject *)Py_None));
@@ -8160,27 +8471,27 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_transition)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run", 0, 4, 6, 1); __PYX_ERR(0, 298, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run", 0, 4, 6, 1); __PYX_ERR(0, 300, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run", 0, 4, 6, 2); __PYX_ERR(0, 298, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run", 0, 4, 6, 2); __PYX_ERR(0, 300, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run", 0, 4, 6, 3); __PYX_ERR(0, 298, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run", 0, 4, 6, 3); __PYX_ERR(0, 300, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_lookup_file_1det);
           if (value) { values[4] = value; kw_args--; }
         }
@@ -8188,15 +8499,15 @@
         case  5:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_lookup_file_2det);
           if (value) { values[5] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "run") < 0)) __PYX_ERR(0, 298, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "run") < 0)) __PYX_ERR(0, 300, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
@@ -8213,15 +8524,15 @@
     __pyx_v_obs1 = values[2];
     __pyx_v_obs2 = values[3];
     __pyx_v_lookup_file_1det = values[4];
     __pyx_v_lookup_file_2det = values[5];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("run", 0, 4, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 298, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("run", 0, 4, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 300, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.two_detector.run", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_12two_detector_8run(__pyx_self, __pyx_v_self, __pyx_v_transition, __pyx_v_obs1, __pyx_v_obs2, __pyx_v_lookup_file_1det, __pyx_v_lookup_file_2det);
 
@@ -8294,357 +8605,272 @@
   PyObject *__pyx_t_14 = NULL;
   PyObject *__pyx_t_15 = NULL;
   int __pyx_t_16;
   int __pyx_t_17;
   PyObject *(*__pyx_t_18)(PyObject *);
   __Pyx_memviewslice __pyx_t_19 = { 0, 0, { 0 }, { 0 }, { 0 } };
   double __pyx_t_20;
-  __Pyx_memviewslice __pyx_t_21 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_t_21;
   int __pyx_t_22;
   int __pyx_t_23;
   int __pyx_t_24;
   int __pyx_t_25;
   int __pyx_t_26;
   int __pyx_t_27;
   int __pyx_t_28;
   int __pyx_t_29;
   int __pyx_t_30;
-  int __pyx_t_31;
+  Py_ssize_t __pyx_t_31;
   Py_ssize_t __pyx_t_32;
   Py_ssize_t __pyx_t_33;
-  Py_ssize_t __pyx_t_34;
-  int __pyx_t_35;
+  int __pyx_t_34;
+  Py_ssize_t __pyx_t_35;
   Py_ssize_t __pyx_t_36;
-  Py_ssize_t __pyx_t_37;
-  Py_ssize_t __pyx_t_38;
-  Py_ssize_t __pyx_t_39;
-  Py_ssize_t __pyx_t_40;
-  Py_ssize_t __pyx_t_41;
-  Py_ssize_t __pyx_t_42;
+  int __pyx_t_37;
+  int __pyx_t_38;
+  int __pyx_t_39;
+  int __pyx_t_40;
+  int __pyx_t_41;
+  int __pyx_t_42;
   Py_ssize_t __pyx_t_43;
   Py_ssize_t __pyx_t_44;
-  Py_ssize_t __pyx_t_45;
-  Py_ssize_t __pyx_t_46;
-  Py_ssize_t __pyx_t_47;
-  Py_ssize_t __pyx_t_48;
-  Py_ssize_t __pyx_t_49;
-  Py_ssize_t __pyx_t_50;
-  Py_ssize_t __pyx_t_51;
-  Py_ssize_t __pyx_t_52;
-  Py_ssize_t __pyx_t_53;
-  Py_ssize_t __pyx_t_54;
-  Py_ssize_t __pyx_t_55;
-  Py_ssize_t __pyx_t_56;
-  Py_ssize_t __pyx_t_57;
-  Py_ssize_t __pyx_t_58;
-  Py_ssize_t __pyx_t_59;
-  Py_ssize_t __pyx_t_60;
-  Py_ssize_t __pyx_t_61;
-  Py_ssize_t __pyx_t_62;
-  Py_ssize_t __pyx_t_63;
-  Py_ssize_t __pyx_t_64;
-  Py_ssize_t __pyx_t_65;
-  Py_ssize_t __pyx_t_66;
-  Py_ssize_t __pyx_t_67;
-  Py_ssize_t __pyx_t_68;
-  Py_ssize_t __pyx_t_69;
-  Py_ssize_t __pyx_t_70;
-  Py_ssize_t __pyx_t_71;
-  Py_ssize_t __pyx_t_72;
-  Py_ssize_t __pyx_t_73;
-  Py_ssize_t __pyx_t_74;
-  int __pyx_t_75;
-  int __pyx_t_76;
-  int __pyx_t_77;
-  int __pyx_t_78;
-  int __pyx_t_79;
-  Py_ssize_t __pyx_t_80;
-  Py_ssize_t __pyx_t_81;
-  Py_ssize_t __pyx_t_82;
-  int __pyx_t_83;
-  Py_ssize_t __pyx_t_84;
-  Py_ssize_t __pyx_t_85;
-  Py_ssize_t __pyx_t_86;
-  Py_ssize_t __pyx_t_87;
-  Py_ssize_t __pyx_t_88;
-  Py_ssize_t __pyx_t_89;
-  Py_ssize_t __pyx_t_90;
-  Py_ssize_t __pyx_t_91;
-  Py_ssize_t __pyx_t_92;
-  Py_ssize_t __pyx_t_93;
-  Py_ssize_t __pyx_t_94;
-  Py_ssize_t __pyx_t_95;
-  Py_ssize_t __pyx_t_96;
-  Py_ssize_t __pyx_t_97;
-  Py_ssize_t __pyx_t_98;
-  Py_ssize_t __pyx_t_99;
-  Py_ssize_t __pyx_t_100;
-  Py_ssize_t __pyx_t_101;
-  Py_ssize_t __pyx_t_102;
-  Py_ssize_t __pyx_t_103;
-  Py_ssize_t __pyx_t_104;
-  Py_ssize_t __pyx_t_105;
-  Py_ssize_t __pyx_t_106;
-  Py_ssize_t __pyx_t_107;
-  Py_ssize_t __pyx_t_108;
-  Py_ssize_t __pyx_t_109;
-  Py_ssize_t __pyx_t_110;
-  Py_ssize_t __pyx_t_111;
-  Py_ssize_t __pyx_t_112;
-  Py_ssize_t __pyx_t_113;
-  Py_ssize_t __pyx_t_114;
-  Py_ssize_t __pyx_t_115;
-  Py_ssize_t __pyx_t_116;
-  Py_ssize_t __pyx_t_117;
-  Py_ssize_t __pyx_t_118;
-  Py_ssize_t __pyx_t_119;
-  Py_ssize_t __pyx_t_120;
-  Py_ssize_t __pyx_t_121;
-  Py_ssize_t __pyx_t_122;
-  Py_ssize_t __pyx_t_123;
-  Py_ssize_t __pyx_t_124;
-  Py_ssize_t __pyx_t_125;
-  Py_ssize_t __pyx_t_126;
-  Py_ssize_t __pyx_t_127;
-  Py_ssize_t __pyx_t_128;
-  Py_ssize_t __pyx_t_129;
-  Py_ssize_t __pyx_t_130;
-  Py_ssize_t __pyx_t_131;
-  Py_ssize_t __pyx_t_132;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("run", 0);
 
-  /* "soapcw/soapcw.pyx":321
+  /* "soapcw/soapcw.pyx":323
  *         """
  * 
  *         cdef double[:, :, :] tr = transition             # <<<<<<<<<<<<<<
  *         #cdef double[:, :] obs1 = obs11
  *         #cdef double[:, :] obs2 = obs21
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_v_transition, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 321, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_v_transition, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 323, __pyx_L1_error)
   __pyx_v_tr = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "soapcw/soapcw.pyx":325
+  /* "soapcw/soapcw.pyx":327
  *         #cdef double[:, :] obs2 = obs21
  * 
  *         shape = np.shape(obs1)             # <<<<<<<<<<<<<<
  * 
  *         cdef int length = min(len(obs1),len(obs2))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 325, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_obs1) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_obs1);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_shape = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":327
+  /* "soapcw/soapcw.pyx":329
  *         shape = np.shape(obs1)
  * 
  *         cdef int length = min(len(obs1),len(obs2))             # <<<<<<<<<<<<<<
  *         cdef int width = len(obs1[0])
  * 
  */
-  __pyx_t_5 = PyObject_Length(__pyx_v_obs2); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 327, __pyx_L1_error)
-  __pyx_t_6 = PyObject_Length(__pyx_v_obs1); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 327, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_v_obs2); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 329, __pyx_L1_error)
+  __pyx_t_6 = PyObject_Length(__pyx_v_obs1); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 329, __pyx_L1_error)
   if (((__pyx_t_5 < __pyx_t_6) != 0)) {
     __pyx_t_7 = __pyx_t_5;
   } else {
     __pyx_t_7 = __pyx_t_6;
   }
   __pyx_v_length = __pyx_t_7;
 
-  /* "soapcw/soapcw.pyx":328
+  /* "soapcw/soapcw.pyx":330
  * 
  *         cdef int length = min(len(obs1),len(obs2))
  *         cdef int width = len(obs1[0])             # <<<<<<<<<<<<<<
  * 
  *         cdef double[:, :] val = np.ones(shape)*-1e6
  */
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 328, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 330, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 328, __pyx_L1_error)
+  __pyx_t_7 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 330, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_width = __pyx_t_7;
 
-  /* "soapcw/soapcw.pyx":330
+  /* "soapcw/soapcw.pyx":332
  *         cdef int width = len(obs1[0])
  * 
  *         cdef double[:, :] val = np.ones(shape)*-1e6             # <<<<<<<<<<<<<<
- *         cdef long[:, :] prev = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
+ *         cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 330, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 330, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_shape);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 330, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_2, __pyx_float_neg_1e6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 330, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_2, __pyx_float_neg_1e6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 330, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 332, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_val = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "soapcw/soapcw.pyx":331
+  /* "soapcw/soapcw.pyx":333
  * 
  *         cdef double[:, :] val = np.ones(shape)*-1e6
- *         cdef long[:, :] prev = np.zeros(shape,dtype = np.int)             # <<<<<<<<<<<<<<
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)
+ *         cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)             # <<<<<<<<<<<<<<
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 331, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 331, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 331, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_shape);
   __Pyx_GIVEREF(__pyx_v_shape);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_shape);
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 331, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 331, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_int); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 331, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_int32); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_10) < 0) __PYX_ERR(0, 331, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_10) < 0) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 331, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_long(__pyx_t_10, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 331, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_10, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   __pyx_v_prev = __pyx_t_11;
   __pyx_t_11.memview = NULL;
   __pyx_t_11.data = NULL;
 
-  /* "soapcw/soapcw.pyx":332
+  /* "soapcw/soapcw.pyx":334
  *         cdef double[:, :] val = np.ones(shape)*-1e6
- *         cdef long[:, :] prev = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)             # <<<<<<<<<<<<<<
- *         cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)
+ *         cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)             # <<<<<<<<<<<<<<
+ *         cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 332, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 332, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 332, __pyx_L1_error)
+  __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_INCREF(__pyx_v_shape);
   __Pyx_GIVEREF(__pyx_v_shape);
   PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_shape);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 332, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 332, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) < 0) __PYX_ERR(0, 332, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) < 0) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_10, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 332, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_10, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_long(__pyx_t_9, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 332, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_9, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __pyx_v_det1 = __pyx_t_11;
   __pyx_t_11.memview = NULL;
   __pyx_t_11.data = NULL;
 
-  /* "soapcw/soapcw.pyx":333
- *         cdef long[:, :] prev = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)             # <<<<<<<<<<<<<<
+  /* "soapcw/soapcw.pyx":335
+ *         cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)             # <<<<<<<<<<<<<<
  * 
  *         cdef int tr_len = len(tr)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 333, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 333, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 333, __pyx_L1_error)
+  __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_INCREF(__pyx_v_shape);
   __Pyx_GIVEREF(__pyx_v_shape);
   PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_v_shape);
-  __pyx_t_10 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 333, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 333, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 333, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, __pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 333, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, __pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_long(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 333, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_det2 = __pyx_t_11;
   __pyx_t_11.memview = NULL;
   __pyx_t_11.data = NULL;
 
-  /* "soapcw/soapcw.pyx":335
- *         cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)
+  /* "soapcw/soapcw.pyx":337
+ *         cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)
  * 
  *         cdef int tr_len = len(tr)             # <<<<<<<<<<<<<<
  *         cdef int sep_len = len(tr[0])
  *         cdef int tr_dist = int(len(tr)/2. - 0.5)
  */
   __pyx_t_12 = __Pyx_MemoryView_Len(__pyx_v_tr); 
   __pyx_v_tr_len = __pyx_t_12;
 
-  /* "soapcw/soapcw.pyx":336
+  /* "soapcw/soapcw.pyx":338
  * 
  *         cdef int tr_len = len(tr)
  *         cdef int sep_len = len(tr[0])             # <<<<<<<<<<<<<<
  *         cdef int tr_dist = int(len(tr)/2. - 0.5)
  *         cdef int sep_dist = int(len(tr)/2. - 0.5)
  */
   __pyx_t_8.data = __pyx_v_tr.data;
@@ -8652,18 +8878,18 @@
   __PYX_INC_MEMVIEW(&__pyx_t_8, 0);
   {
     Py_ssize_t __pyx_tmp_idx = 0;
         Py_ssize_t __pyx_tmp_shape = __pyx_v_tr.shape[0];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_tr.strides[0];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
-        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
+        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 0)");
-            __PYX_ERR(0, 336, __pyx_L1_error)
+            __PYX_ERR(0, 338, __pyx_L1_error)
         }
         __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
 __pyx_t_8.shape[0] = __pyx_v_tr.shape[1];
 __pyx_t_8.strides[0] = __pyx_v_tr.strides[1];
     __pyx_t_8.suboffsets[0] = -1;
@@ -8674,124 +8900,124 @@
 
 __pyx_t_12 = __Pyx_MemoryView_Len(__pyx_t_8); 
   __PYX_XDEC_MEMVIEW(&__pyx_t_8, 1);
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
   __pyx_v_sep_len = __pyx_t_12;
 
-  /* "soapcw/soapcw.pyx":337
+  /* "soapcw/soapcw.pyx":339
  *         cdef int tr_len = len(tr)
  *         cdef int sep_len = len(tr[0])
  *         cdef int tr_dist = int(len(tr)/2. - 0.5)             # <<<<<<<<<<<<<<
  *         cdef int sep_dist = int(len(tr)/2. - 0.5)
  * 
  */
   __pyx_t_12 = __Pyx_MemoryView_Len(__pyx_v_tr); 
   __pyx_v_tr_dist = ((int)((((double)__pyx_t_12) / 2.) - 0.5));
 
-  /* "soapcw/soapcw.pyx":338
+  /* "soapcw/soapcw.pyx":340
  *         cdef int sep_len = len(tr[0])
  *         cdef int tr_dist = int(len(tr)/2. - 0.5)
  *         cdef int sep_dist = int(len(tr)/2. - 0.5)             # <<<<<<<<<<<<<<
  * 
  *         cdef int i
  */
   __pyx_t_12 = __Pyx_MemoryView_Len(__pyx_v_tr); 
   __pyx_v_sep_dist = ((int)((((double)__pyx_t_12) / 2.) - 0.5));
 
-  /* "soapcw/soapcw.pyx":355
+  /* "soapcw/soapcw.pyx":357
  *         cdef double value
  *         cdef double temp
  *         cdef int edge_range = 0             # <<<<<<<<<<<<<<
  * 
  *         # initialise and load lookuptable files for both line aware statistics
  */
   __pyx_v_edge_range = 0;
 
-  /* "soapcw/soapcw.pyx":365
+  /* "soapcw/soapcw.pyx":367
  *         cdef int[:,:] obs1_ind_2d
  * 
  *         obs1data = np.array([len(np.unique(obs1seg)) for obs1seg in obs1]) != 1             # <<<<<<<<<<<<<<
  *         obs2data = np.array([len(np.unique(obs2seg)) for obs2seg in obs2]) != 1
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 365, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 367, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_array); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 365, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_array); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 367, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   { /* enter inner scope */
-    __pyx_t_10 = PyList_New(0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 365, __pyx_L5_error)
+    __pyx_t_10 = PyList_New(0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 367, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_10);
     if (likely(PyList_CheckExact(__pyx_v_obs1)) || PyTuple_CheckExact(__pyx_v_obs1)) {
       __pyx_t_3 = __pyx_v_obs1; __Pyx_INCREF(__pyx_t_3); __pyx_t_7 = 0;
       __pyx_t_13 = NULL;
     } else {
-      __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_obs1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 365, __pyx_L5_error)
+      __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_obs1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 367, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 365, __pyx_L5_error)
+      __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 367, __pyx_L5_error)
     }
     for (;;) {
       if (likely(!__pyx_t_13)) {
         if (likely(PyList_CheckExact(__pyx_t_3))) {
           if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 365, __pyx_L5_error)
+          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 367, __pyx_L5_error)
           #else
-          __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 365, __pyx_L5_error)
+          __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 367, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_4);
           #endif
         } else {
           if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 365, __pyx_L5_error)
+          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 367, __pyx_L5_error)
           #else
-          __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 365, __pyx_L5_error)
+          __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 367, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_4);
           #endif
         }
       } else {
         __pyx_t_4 = __pyx_t_13(__pyx_t_3);
         if (unlikely(!__pyx_t_4)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 365, __pyx_L5_error)
+            else __PYX_ERR(0, 367, __pyx_L5_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_4);
       }
       __Pyx_XDECREF_SET(__pyx_8genexpr1__pyx_v_obs1seg, __pyx_t_4);
       __pyx_t_4 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 365, __pyx_L5_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 367, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_14);
-      __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_unique); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 365, __pyx_L5_error)
+      __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_unique); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 367, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_15);
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __pyx_t_14 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_15))) {
         __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_15);
         if (likely(__pyx_t_14)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_15);
           __Pyx_INCREF(__pyx_t_14);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_15, function);
         }
       }
       __pyx_t_4 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_15, __pyx_t_14, __pyx_8genexpr1__pyx_v_obs1seg) : __Pyx_PyObject_CallOneArg(__pyx_t_15, __pyx_8genexpr1__pyx_v_obs1seg);
       __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 365, __pyx_L5_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 367, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-      __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 365, __pyx_L5_error)
+      __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 367, __pyx_L5_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 365, __pyx_L5_error)
+      __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 367, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_10, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 365, __pyx_L5_error)
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_10, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 367, __pyx_L5_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_obs1seg); __pyx_8genexpr1__pyx_v_obs1seg = 0;
     goto __pyx_L8_exit_scope;
     __pyx_L5_error:;
     __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_obs1seg); __pyx_8genexpr1__pyx_v_obs1seg = 0;
@@ -8807,104 +9033,104 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_9, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_3, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_10);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 365, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 367, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_9 = __Pyx_PyInt_NeObjC(__pyx_t_2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 365, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyInt_NeObjC(__pyx_t_2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 367, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_obs1data = __pyx_t_9;
   __pyx_t_9 = 0;
 
-  /* "soapcw/soapcw.pyx":366
+  /* "soapcw/soapcw.pyx":368
  * 
  *         obs1data = np.array([len(np.unique(obs1seg)) for obs1seg in obs1]) != 1
  *         obs2data = np.array([len(np.unique(obs2seg)) for obs2seg in obs2]) != 1             # <<<<<<<<<<<<<<
  * 
  *         if lookup_file_1det is not None:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 368, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 368, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   { /* enter inner scope */
-    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 366, __pyx_L11_error)
+    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 368, __pyx_L11_error)
     __Pyx_GOTREF(__pyx_t_2);
     if (likely(PyList_CheckExact(__pyx_v_obs2)) || PyTuple_CheckExact(__pyx_v_obs2)) {
       __pyx_t_3 = __pyx_v_obs2; __Pyx_INCREF(__pyx_t_3); __pyx_t_7 = 0;
       __pyx_t_13 = NULL;
     } else {
-      __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_obs2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L11_error)
+      __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_obs2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 368, __pyx_L11_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 366, __pyx_L11_error)
+      __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 368, __pyx_L11_error)
     }
     for (;;) {
       if (likely(!__pyx_t_13)) {
         if (likely(PyList_CheckExact(__pyx_t_3))) {
           if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 366, __pyx_L11_error)
+          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 368, __pyx_L11_error)
           #else
-          __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L11_error)
+          __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 368, __pyx_L11_error)
           __Pyx_GOTREF(__pyx_t_4);
           #endif
         } else {
           if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 366, __pyx_L11_error)
+          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 368, __pyx_L11_error)
           #else
-          __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L11_error)
+          __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 368, __pyx_L11_error)
           __Pyx_GOTREF(__pyx_t_4);
           #endif
         }
       } else {
         __pyx_t_4 = __pyx_t_13(__pyx_t_3);
         if (unlikely(!__pyx_t_4)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 366, __pyx_L11_error)
+            else __PYX_ERR(0, 368, __pyx_L11_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_4);
       }
       __Pyx_XDECREF_SET(__pyx_8genexpr2__pyx_v_obs2seg, __pyx_t_4);
       __pyx_t_4 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 366, __pyx_L11_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 368, __pyx_L11_error)
       __Pyx_GOTREF(__pyx_t_15);
-      __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_unique); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 366, __pyx_L11_error)
+      __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_unique); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 368, __pyx_L11_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
       __pyx_t_15 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
         __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_14);
         if (likely(__pyx_t_15)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
           __Pyx_INCREF(__pyx_t_15);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_14, function);
         }
       }
       __pyx_t_4 = (__pyx_t_15) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_15, __pyx_8genexpr2__pyx_v_obs2seg) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_8genexpr2__pyx_v_obs2seg);
       __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L11_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 368, __pyx_L11_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-      __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 366, __pyx_L11_error)
+      __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 368, __pyx_L11_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L11_error)
+      __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 368, __pyx_L11_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 366, __pyx_L11_error)
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 368, __pyx_L11_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_obs2seg); __pyx_8genexpr2__pyx_v_obs2seg = 0;
     goto __pyx_L14_exit_scope;
     __pyx_L11_error:;
     __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_obs2seg); __pyx_8genexpr2__pyx_v_obs2seg = 0;
@@ -8920,65 +9146,65 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_10, function);
     }
   }
   __pyx_t_9 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 366, __pyx_L1_error)
+  if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 368, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __pyx_t_10 = __Pyx_PyInt_NeObjC(__pyx_t_9, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyInt_NeObjC(__pyx_t_9, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 368, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __pyx_v_obs2data = __pyx_t_10;
   __pyx_t_10 = 0;
 
-  /* "soapcw/soapcw.pyx":368
+  /* "soapcw/soapcw.pyx":370
  *         obs2data = np.array([len(np.unique(obs2seg)) for obs2seg in obs2]) != 1
  * 
  *         if lookup_file_1det is not None:             # <<<<<<<<<<<<<<
  *             logarr_1d, ranges_1d, fact_1d = self.read_lookup(lookup_file_1det)
  * 
  */
   __pyx_t_16 = (__pyx_v_lookup_file_1det != Py_None);
   __pyx_t_17 = (__pyx_t_16 != 0);
   if (__pyx_t_17) {
 
-    /* "soapcw/soapcw.pyx":369
+    /* "soapcw/soapcw.pyx":371
  * 
  *         if lookup_file_1det is not None:
  *             logarr_1d, ranges_1d, fact_1d = self.read_lookup(lookup_file_1det)             # <<<<<<<<<<<<<<
  * 
  *             obs1_ind_arr_1d = (obs1 - ranges_1d[0])*fact_1d
  */
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_read_lookup); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 369, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_read_lookup); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_9);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_9, function);
       }
     }
     __pyx_t_10 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_2, __pyx_v_lookup_file_1det) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_v_lookup_file_1det);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 369, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     if ((likely(PyTuple_CheckExact(__pyx_t_10))) || (PyList_CheckExact(__pyx_t_10))) {
       PyObject* sequence = __pyx_t_10;
       Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
       if (unlikely(size != 3)) {
         if (size > 3) __Pyx_RaiseTooManyValuesError(3);
         else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-        __PYX_ERR(0, 369, __pyx_L1_error)
+        __PYX_ERR(0, 371, __pyx_L1_error)
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
       if (likely(PyTuple_CheckExact(sequence))) {
         __pyx_t_9 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
         __pyx_t_3 = PyTuple_GET_ITEM(sequence, 2); 
       } else {
@@ -8986,140 +9212,140 @@
         __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
         __pyx_t_3 = PyList_GET_ITEM(sequence, 2); 
       }
       __Pyx_INCREF(__pyx_t_9);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       #else
-      __pyx_t_9 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 369, __pyx_L1_error)
+      __pyx_t_9 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 371, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 369, __pyx_L1_error)
+      __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 371, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_3 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 369, __pyx_L1_error)
+      __pyx_t_3 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 371, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       #endif
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_4 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 369, __pyx_L1_error)
+      __pyx_t_4 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 371, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __pyx_t_18 = Py_TYPE(__pyx_t_4)->tp_iternext;
       index = 0; __pyx_t_9 = __pyx_t_18(__pyx_t_4); if (unlikely(!__pyx_t_9)) goto __pyx_L16_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_9);
       index = 1; __pyx_t_2 = __pyx_t_18(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L16_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_2);
       index = 2; __pyx_t_3 = __pyx_t_18(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L16_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_3);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_18(__pyx_t_4), 3) < 0) __PYX_ERR(0, 369, __pyx_L1_error)
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_18(__pyx_t_4), 3) < 0) __PYX_ERR(0, 371, __pyx_L1_error)
       __pyx_t_18 = NULL;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       goto __pyx_L17_unpacking_done;
       __pyx_L16_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_18 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-      __PYX_ERR(0, 369, __pyx_L1_error)
+      __PYX_ERR(0, 371, __pyx_L1_error)
       __pyx_L17_unpacking_done:;
     }
-    __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_9, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 369, __pyx_L1_error)
+    __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_9, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 369, __pyx_L1_error)
+    __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_logarr_1d = __pyx_t_19;
     __pyx_t_19.memview = NULL;
     __pyx_t_19.data = NULL;
     __pyx_v_ranges_1d = __pyx_t_2;
     __pyx_t_2 = 0;
     __pyx_v_fact_1d = __pyx_t_20;
 
-    /* "soapcw/soapcw.pyx":371
+    /* "soapcw/soapcw.pyx":373
  *             logarr_1d, ranges_1d, fact_1d = self.read_lookup(lookup_file_1det)
  * 
  *             obs1_ind_arr_1d = (obs1 - ranges_1d[0])*fact_1d             # <<<<<<<<<<<<<<
  *             obs1_ind_arr_1d[obs1_ind_arr_1d >= len(ranges_1d)] = len(ranges_1d)-1
  *             obs1_ind_arr_1d[obs1_ind_arr_1d < 0] = 0
  */
-    __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_ranges_1d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 371, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_ranges_1d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_3 = PyNumber_Subtract(__pyx_v_obs1, __pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 371, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Subtract(__pyx_v_obs1, __pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = PyFloat_FromDouble(__pyx_v_fact_1d); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 371, __pyx_L1_error)
+    __pyx_t_10 = PyFloat_FromDouble(__pyx_v_fact_1d); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 371, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_v_obs1_ind_arr_1d = __pyx_t_2;
     __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":372
+    /* "soapcw/soapcw.pyx":374
  * 
  *             obs1_ind_arr_1d = (obs1 - ranges_1d[0])*fact_1d
  *             obs1_ind_arr_1d[obs1_ind_arr_1d >= len(ranges_1d)] = len(ranges_1d)-1             # <<<<<<<<<<<<<<
  *             obs1_ind_arr_1d[obs1_ind_arr_1d < 0] = 0
  *             obs1_ind_1d = np.array(obs1_ind_arr_1d).astype(np.int32)
  */
-    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_1d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 372, __pyx_L1_error)
-    __pyx_t_2 = PyInt_FromSsize_t((__pyx_t_7 - 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 372, __pyx_L1_error)
+    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_1d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 374, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t((__pyx_t_7 - 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_1d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 372, __pyx_L1_error)
-    __pyx_t_10 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 372, __pyx_L1_error)
+    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_1d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 374, __pyx_L1_error)
+    __pyx_t_10 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_obs1_ind_arr_1d, __pyx_t_10, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 372, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_v_obs1_ind_arr_1d, __pyx_t_10, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_v_obs1_ind_arr_1d, __pyx_t_3, __pyx_t_2) < 0)) __PYX_ERR(0, 372, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_obs1_ind_arr_1d, __pyx_t_3, __pyx_t_2) < 0)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":373
+    /* "soapcw/soapcw.pyx":375
  *             obs1_ind_arr_1d = (obs1 - ranges_1d[0])*fact_1d
  *             obs1_ind_arr_1d[obs1_ind_arr_1d >= len(ranges_1d)] = len(ranges_1d)-1
  *             obs1_ind_arr_1d[obs1_ind_arr_1d < 0] = 0             # <<<<<<<<<<<<<<
  *             obs1_ind_1d = np.array(obs1_ind_arr_1d).astype(np.int32)
  *             del obs1_ind_arr_1d
  */
-    __pyx_t_2 = PyObject_RichCompare(__pyx_v_obs1_ind_arr_1d, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 373, __pyx_L1_error)
-    if (unlikely(PyObject_SetItem(__pyx_v_obs1_ind_arr_1d, __pyx_t_2, __pyx_int_0) < 0)) __PYX_ERR(0, 373, __pyx_L1_error)
+    __pyx_t_2 = PyObject_RichCompare(__pyx_v_obs1_ind_arr_1d, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 375, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_obs1_ind_arr_1d, __pyx_t_2, __pyx_int_0) < 0)) __PYX_ERR(0, 375, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":374
+    /* "soapcw/soapcw.pyx":376
  *             obs1_ind_arr_1d[obs1_ind_arr_1d >= len(ranges_1d)] = len(ranges_1d)-1
  *             obs1_ind_arr_1d[obs1_ind_arr_1d < 0] = 0
  *             obs1_ind_1d = np.array(obs1_ind_arr_1d).astype(np.int32)             # <<<<<<<<<<<<<<
  *             del obs1_ind_arr_1d
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 374, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_array); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 374, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_array); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_9, function);
       }
     }
     __pyx_t_3 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_10, __pyx_v_obs1_ind_arr_1d) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_v_obs1_ind_arr_1d);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 374, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 374, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 374, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int32); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 374, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int32); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_9);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
@@ -9127,117 +9353,117 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_9, function);
       }
     }
     __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_3, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_10);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 374, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 374, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_v_obs1_ind_1d = __pyx_t_21;
-    __pyx_t_21.memview = NULL;
-    __pyx_t_21.data = NULL;
+    __pyx_v_obs1_ind_1d = __pyx_t_11;
+    __pyx_t_11.memview = NULL;
+    __pyx_t_11.data = NULL;
 
-    /* "soapcw/soapcw.pyx":375
+    /* "soapcw/soapcw.pyx":377
  *             obs1_ind_arr_1d[obs1_ind_arr_1d < 0] = 0
  *             obs1_ind_1d = np.array(obs1_ind_arr_1d).astype(np.int32)
  *             del obs1_ind_arr_1d             # <<<<<<<<<<<<<<
  * 
  *             obs2_ind_arr_1d = (obs2-ranges_1d[0])*fact_1d
  */
     __Pyx_DECREF(__pyx_v_obs1_ind_arr_1d);
     __pyx_v_obs1_ind_arr_1d = NULL;
 
-    /* "soapcw/soapcw.pyx":377
+    /* "soapcw/soapcw.pyx":379
  *             del obs1_ind_arr_1d
  * 
  *             obs2_ind_arr_1d = (obs2-ranges_1d[0])*fact_1d             # <<<<<<<<<<<<<<
  *             obs2_ind_arr_1d[obs2_ind_arr_1d >= len(ranges_1d)] = len(ranges_1d)-1
  *             obs2_ind_arr_1d[obs2_ind_arr_1d < 0] = 0
  */
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_ranges_1d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 377, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_ranges_1d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 379, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_9 = PyNumber_Subtract(__pyx_v_obs2, __pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 377, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Subtract(__pyx_v_obs2, __pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 379, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyFloat_FromDouble(__pyx_v_fact_1d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 377, __pyx_L1_error)
+    __pyx_t_2 = PyFloat_FromDouble(__pyx_v_fact_1d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 379, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_10 = PyNumber_Multiply(__pyx_t_9, __pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 377, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Multiply(__pyx_t_9, __pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 379, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_obs2_ind_arr_1d = __pyx_t_10;
     __pyx_t_10 = 0;
 
-    /* "soapcw/soapcw.pyx":378
+    /* "soapcw/soapcw.pyx":380
  * 
  *             obs2_ind_arr_1d = (obs2-ranges_1d[0])*fact_1d
  *             obs2_ind_arr_1d[obs2_ind_arr_1d >= len(ranges_1d)] = len(ranges_1d)-1             # <<<<<<<<<<<<<<
  *             obs2_ind_arr_1d[obs2_ind_arr_1d < 0] = 0
  *             obs2_ind_1d = np.array(obs2_ind_arr_1d).astype(np.int32)
  */
-    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_1d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 378, __pyx_L1_error)
-    __pyx_t_10 = PyInt_FromSsize_t((__pyx_t_7 - 1)); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_1d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 380, __pyx_L1_error)
+    __pyx_t_10 = PyInt_FromSsize_t((__pyx_t_7 - 1)); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 380, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_1d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 378, __pyx_L1_error)
-    __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_1d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 380, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 380, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_9 = PyObject_RichCompare(__pyx_v_obs2_ind_arr_1d, __pyx_t_2, Py_GE); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __pyx_t_9 = PyObject_RichCompare(__pyx_v_obs2_ind_arr_1d, __pyx_t_2, Py_GE); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 380, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_v_obs2_ind_arr_1d, __pyx_t_9, __pyx_t_10) < 0)) __PYX_ERR(0, 378, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_obs2_ind_arr_1d, __pyx_t_9, __pyx_t_10) < 0)) __PYX_ERR(0, 380, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "soapcw/soapcw.pyx":379
+    /* "soapcw/soapcw.pyx":381
  *             obs2_ind_arr_1d = (obs2-ranges_1d[0])*fact_1d
  *             obs2_ind_arr_1d[obs2_ind_arr_1d >= len(ranges_1d)] = len(ranges_1d)-1
  *             obs2_ind_arr_1d[obs2_ind_arr_1d < 0] = 0             # <<<<<<<<<<<<<<
  *             obs2_ind_1d = np.array(obs2_ind_arr_1d).astype(np.int32)
  *             del obs2_ind_arr_1d
  */
-    __pyx_t_10 = PyObject_RichCompare(__pyx_v_obs2_ind_arr_1d, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 379, __pyx_L1_error)
-    if (unlikely(PyObject_SetItem(__pyx_v_obs2_ind_arr_1d, __pyx_t_10, __pyx_int_0) < 0)) __PYX_ERR(0, 379, __pyx_L1_error)
+    __pyx_t_10 = PyObject_RichCompare(__pyx_v_obs2_ind_arr_1d, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 381, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_obs2_ind_arr_1d, __pyx_t_10, __pyx_int_0) < 0)) __PYX_ERR(0, 381, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "soapcw/soapcw.pyx":380
+    /* "soapcw/soapcw.pyx":382
  *             obs2_ind_arr_1d[obs2_ind_arr_1d >= len(ranges_1d)] = len(ranges_1d)-1
  *             obs2_ind_arr_1d[obs2_ind_arr_1d < 0] = 0
  *             obs2_ind_1d = np.array(obs2_ind_arr_1d).astype(np.int32)             # <<<<<<<<<<<<<<
  *             del obs2_ind_arr_1d
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 380, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 382, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 380, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 382, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_9 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_obs2_ind_arr_1d) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_obs2_ind_arr_1d);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 380, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 382, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 380, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 382, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 380, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 382, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_int32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 380, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_int32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 382, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_9 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -9245,81 +9471,81 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_10 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_9, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 380, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 382, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_obs2_ind_1d = __pyx_t_10;
     __pyx_t_10 = 0;
 
-    /* "soapcw/soapcw.pyx":381
+    /* "soapcw/soapcw.pyx":383
  *             obs2_ind_arr_1d[obs2_ind_arr_1d < 0] = 0
  *             obs2_ind_1d = np.array(obs2_ind_arr_1d).astype(np.int32)
  *             del obs2_ind_arr_1d             # <<<<<<<<<<<<<<
  * 
  *         if lookup_file_2det is not None:
  */
     __Pyx_DECREF(__pyx_v_obs2_ind_arr_1d);
     __pyx_v_obs2_ind_arr_1d = NULL;
 
-    /* "soapcw/soapcw.pyx":368
+    /* "soapcw/soapcw.pyx":370
  *         obs2data = np.array([len(np.unique(obs2seg)) for obs2seg in obs2]) != 1
  * 
  *         if lookup_file_1det is not None:             # <<<<<<<<<<<<<<
  *             logarr_1d, ranges_1d, fact_1d = self.read_lookup(lookup_file_1det)
  * 
  */
   }
 
-  /* "soapcw/soapcw.pyx":383
+  /* "soapcw/soapcw.pyx":385
  *             del obs2_ind_arr_1d
  * 
  *         if lookup_file_2det is not None:             # <<<<<<<<<<<<<<
  *             logarr, ranges_2d, fact_2d = self.read_lookup(lookup_file_2det)
  *             diag = copy.copy(np.diag(logarr))
  */
   __pyx_t_17 = (__pyx_v_lookup_file_2det != Py_None);
   __pyx_t_16 = (__pyx_t_17 != 0);
   if (__pyx_t_16) {
 
-    /* "soapcw/soapcw.pyx":384
+    /* "soapcw/soapcw.pyx":386
  * 
  *         if lookup_file_2det is not None:
  *             logarr, ranges_2d, fact_2d = self.read_lookup(lookup_file_2det)             # <<<<<<<<<<<<<<
  *             diag = copy.copy(np.diag(logarr))
  *             logarr_2d = logarr
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_read_lookup); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 384, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_read_lookup); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 386, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_10 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_lookup_file_2det) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_lookup_file_2det);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 384, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 386, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if ((likely(PyTuple_CheckExact(__pyx_t_10))) || (PyList_CheckExact(__pyx_t_10))) {
       PyObject* sequence = __pyx_t_10;
       Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
       if (unlikely(size != 3)) {
         if (size > 3) __Pyx_RaiseTooManyValuesError(3);
         else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-        __PYX_ERR(0, 384, __pyx_L1_error)
+        __PYX_ERR(0, 386, __pyx_L1_error)
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
       if (likely(PyTuple_CheckExact(sequence))) {
         __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
         __pyx_t_9 = PyTuple_GET_ITEM(sequence, 2); 
       } else {
@@ -9327,83 +9553,83 @@
         __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
         __pyx_t_9 = PyList_GET_ITEM(sequence, 2); 
       }
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_9);
       #else
-      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 384, __pyx_L1_error)
+      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 386, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 384, __pyx_L1_error)
+      __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 386, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_9 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 384, __pyx_L1_error)
+      __pyx_t_9 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 386, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       #endif
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_4 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 384, __pyx_L1_error)
+      __pyx_t_4 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 386, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __pyx_t_18 = Py_TYPE(__pyx_t_4)->tp_iternext;
       index = 0; __pyx_t_3 = __pyx_t_18(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L19_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_3);
       index = 1; __pyx_t_2 = __pyx_t_18(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L19_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_2);
       index = 2; __pyx_t_9 = __pyx_t_18(__pyx_t_4); if (unlikely(!__pyx_t_9)) goto __pyx_L19_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_9);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_18(__pyx_t_4), 3) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_18(__pyx_t_4), 3) < 0) __PYX_ERR(0, 386, __pyx_L1_error)
       __pyx_t_18 = NULL;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       goto __pyx_L20_unpacking_done;
       __pyx_L19_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_18 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-      __PYX_ERR(0, 384, __pyx_L1_error)
+      __PYX_ERR(0, 386, __pyx_L1_error)
       __pyx_L20_unpacking_done:;
     }
-    __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_9); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 384, __pyx_L1_error)
+    __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_9); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 386, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_v_logarr = __pyx_t_3;
     __pyx_t_3 = 0;
     __pyx_v_ranges_2d = __pyx_t_2;
     __pyx_t_2 = 0;
     __pyx_v_fact_2d = __pyx_t_20;
 
-    /* "soapcw/soapcw.pyx":385
+    /* "soapcw/soapcw.pyx":387
  *         if lookup_file_2det is not None:
  *             logarr, ranges_2d, fact_2d = self.read_lookup(lookup_file_2det)
  *             diag = copy.copy(np.diag(logarr))             # <<<<<<<<<<<<<<
  *             logarr_2d = logarr
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_copy); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 385, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_copy); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 387, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_copy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 385, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_copy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 387, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 385, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 387, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_diag); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 385, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_diag); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 387, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_9 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_logarr) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_logarr);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 385, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 387, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -9411,116 +9637,116 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_10 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_9);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 385, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 387, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_diag = __pyx_t_10;
     __pyx_t_10 = 0;
 
-    /* "soapcw/soapcw.pyx":386
+    /* "soapcw/soapcw.pyx":388
  *             logarr, ranges_2d, fact_2d = self.read_lookup(lookup_file_2det)
  *             diag = copy.copy(np.diag(logarr))
  *             logarr_2d = logarr             # <<<<<<<<<<<<<<
  * 
  *             # normalise the input powers to the ranges of lookup table so they are now indices
  */
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_logarr, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 386, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_logarr, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 388, __pyx_L1_error)
     __pyx_v_logarr_2d = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "soapcw/soapcw.pyx":389
+    /* "soapcw/soapcw.pyx":391
  * 
  *             # normalise the input powers to the ranges of lookup table so they are now indices
  *             obs1_ind_arr_2d = (obs1 - ranges_2d[0])*fact_2d             # <<<<<<<<<<<<<<
  *             # set powers outside range to end index
  *             obs1_ind_arr_2d[obs1_ind_arr_2d >= len(ranges_2d)] = len(ranges_2d)-1
  */
-    __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_ranges_2d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 389, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_ranges_2d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_2 = PyNumber_Subtract(__pyx_v_obs1, __pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 389, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Subtract(__pyx_v_obs1, __pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = PyFloat_FromDouble(__pyx_v_fact_2d); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 389, __pyx_L1_error)
+    __pyx_t_10 = PyFloat_FromDouble(__pyx_v_fact_2d); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_9 = PyNumber_Multiply(__pyx_t_2, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 389, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_t_2, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_v_obs1_ind_arr_2d = __pyx_t_9;
     __pyx_t_9 = 0;
 
-    /* "soapcw/soapcw.pyx":391
+    /* "soapcw/soapcw.pyx":393
  *             obs1_ind_arr_2d = (obs1 - ranges_2d[0])*fact_2d
  *             # set powers outside range to end index
  *             obs1_ind_arr_2d[obs1_ind_arr_2d >= len(ranges_2d)] = len(ranges_2d)-1             # <<<<<<<<<<<<<<
  *             obs1_ind_arr_2d[obs1_ind_arr_2d < 0] = 0
  *             obs1_ind_2d = np.array(obs1_ind_arr_2d).astype(np.int32)
  */
-    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_2d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 391, __pyx_L1_error)
-    __pyx_t_9 = PyInt_FromSsize_t((__pyx_t_7 - 1)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 391, __pyx_L1_error)
+    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_2d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 393, __pyx_L1_error)
+    __pyx_t_9 = PyInt_FromSsize_t((__pyx_t_7 - 1)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 393, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_2d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 391, __pyx_L1_error)
-    __pyx_t_10 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 391, __pyx_L1_error)
+    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_2d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 393, __pyx_L1_error)
+    __pyx_t_10 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 393, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_2 = PyObject_RichCompare(__pyx_v_obs1_ind_arr_2d, __pyx_t_10, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 391, __pyx_L1_error)
+    __pyx_t_2 = PyObject_RichCompare(__pyx_v_obs1_ind_arr_2d, __pyx_t_10, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 393, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_v_obs1_ind_arr_2d, __pyx_t_2, __pyx_t_9) < 0)) __PYX_ERR(0, 391, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_obs1_ind_arr_2d, __pyx_t_2, __pyx_t_9) < 0)) __PYX_ERR(0, 393, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "soapcw/soapcw.pyx":392
+    /* "soapcw/soapcw.pyx":394
  *             # set powers outside range to end index
  *             obs1_ind_arr_2d[obs1_ind_arr_2d >= len(ranges_2d)] = len(ranges_2d)-1
  *             obs1_ind_arr_2d[obs1_ind_arr_2d < 0] = 0             # <<<<<<<<<<<<<<
  *             obs1_ind_2d = np.array(obs1_ind_arr_2d).astype(np.int32)
  * 
  */
-    __pyx_t_9 = PyObject_RichCompare(__pyx_v_obs1_ind_arr_2d, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 392, __pyx_L1_error)
-    if (unlikely(PyObject_SetItem(__pyx_v_obs1_ind_arr_2d, __pyx_t_9, __pyx_int_0) < 0)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __pyx_t_9 = PyObject_RichCompare(__pyx_v_obs1_ind_arr_2d, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 394, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_obs1_ind_arr_2d, __pyx_t_9, __pyx_int_0) < 0)) __PYX_ERR(0, 394, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "soapcw/soapcw.pyx":393
+    /* "soapcw/soapcw.pyx":395
  *             obs1_ind_arr_2d[obs1_ind_arr_2d >= len(ranges_2d)] = len(ranges_2d)-1
  *             obs1_ind_arr_2d[obs1_ind_arr_2d < 0] = 0
  *             obs1_ind_2d = np.array(obs1_ind_arr_2d).astype(np.int32)             # <<<<<<<<<<<<<<
  * 
  *             # same for second detector
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 393, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 393, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_2 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_10, __pyx_v_obs1_ind_arr_2d) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_obs1_ind_arr_2d);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 393, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 393, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 393, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 393, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -9528,107 +9754,107 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_9 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_10);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 393, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_9, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 393, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_9, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_v_obs1_ind_2d = __pyx_t_21;
-    __pyx_t_21.memview = NULL;
-    __pyx_t_21.data = NULL;
+    __pyx_v_obs1_ind_2d = __pyx_t_11;
+    __pyx_t_11.memview = NULL;
+    __pyx_t_11.data = NULL;
 
-    /* "soapcw/soapcw.pyx":396
+    /* "soapcw/soapcw.pyx":398
  * 
  *             # same for second detector
  *             obs2_ind_arr_2d = (obs2-ranges_2d[0])*fact_2d             # <<<<<<<<<<<<<<
  *             obs2_ind_arr_2d[obs2_ind_arr_2d >= len(ranges_2d)] = len(ranges_2d)-1
  *             obs2_ind_arr_2d[obs2_ind_arr_2d < 0] = 0
  */
-    __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_ranges_2d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 396, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_ranges_2d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 398, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_4 = PyNumber_Subtract(__pyx_v_obs2, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 396, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Subtract(__pyx_v_obs2, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 398, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyFloat_FromDouble(__pyx_v_fact_2d); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 396, __pyx_L1_error)
+    __pyx_t_9 = PyFloat_FromDouble(__pyx_v_fact_2d); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 398, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_10 = PyNumber_Multiply(__pyx_t_4, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 396, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Multiply(__pyx_t_4, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 398, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_v_obs2_ind_arr_2d = __pyx_t_10;
     __pyx_t_10 = 0;
 
-    /* "soapcw/soapcw.pyx":397
+    /* "soapcw/soapcw.pyx":399
  *             # same for second detector
  *             obs2_ind_arr_2d = (obs2-ranges_2d[0])*fact_2d
  *             obs2_ind_arr_2d[obs2_ind_arr_2d >= len(ranges_2d)] = len(ranges_2d)-1             # <<<<<<<<<<<<<<
  *             obs2_ind_arr_2d[obs2_ind_arr_2d < 0] = 0
  *             obs2_ind_2d = np.array(obs2_ind_arr_2d).astype(np.int32)
  */
-    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_2d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 397, __pyx_L1_error)
-    __pyx_t_10 = PyInt_FromSsize_t((__pyx_t_7 - 1)); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 397, __pyx_L1_error)
+    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_2d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_10 = PyInt_FromSsize_t((__pyx_t_7 - 1)); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 399, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_2d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 397, __pyx_L1_error)
-    __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 397, __pyx_L1_error)
+    __pyx_t_7 = PyObject_Length(__pyx_v_ranges_2d); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 399, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_4 = PyObject_RichCompare(__pyx_v_obs2_ind_arr_2d, __pyx_t_9, Py_GE); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 397, __pyx_L1_error)
+    __pyx_t_4 = PyObject_RichCompare(__pyx_v_obs2_ind_arr_2d, __pyx_t_9, Py_GE); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 399, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_v_obs2_ind_arr_2d, __pyx_t_4, __pyx_t_10) < 0)) __PYX_ERR(0, 397, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_obs2_ind_arr_2d, __pyx_t_4, __pyx_t_10) < 0)) __PYX_ERR(0, 399, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "soapcw/soapcw.pyx":398
+    /* "soapcw/soapcw.pyx":400
  *             obs2_ind_arr_2d = (obs2-ranges_2d[0])*fact_2d
  *             obs2_ind_arr_2d[obs2_ind_arr_2d >= len(ranges_2d)] = len(ranges_2d)-1
  *             obs2_ind_arr_2d[obs2_ind_arr_2d < 0] = 0             # <<<<<<<<<<<<<<
  *             obs2_ind_2d = np.array(obs2_ind_arr_2d).astype(np.int32)
  * 
  */
-    __pyx_t_10 = PyObject_RichCompare(__pyx_v_obs2_ind_arr_2d, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 398, __pyx_L1_error)
-    if (unlikely(PyObject_SetItem(__pyx_v_obs2_ind_arr_2d, __pyx_t_10, __pyx_int_0) < 0)) __PYX_ERR(0, 398, __pyx_L1_error)
+    __pyx_t_10 = PyObject_RichCompare(__pyx_v_obs2_ind_arr_2d, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 400, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_obs2_ind_arr_2d, __pyx_t_10, __pyx_int_0) < 0)) __PYX_ERR(0, 400, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "soapcw/soapcw.pyx":399
+    /* "soapcw/soapcw.pyx":401
  *             obs2_ind_arr_2d[obs2_ind_arr_2d >= len(ranges_2d)] = len(ranges_2d)-1
  *             obs2_ind_arr_2d[obs2_ind_arr_2d < 0] = 0
  *             obs2_ind_2d = np.array(obs2_ind_arr_2d).astype(np.int32)             # <<<<<<<<<<<<<<
  * 
  *             if lookup_file_1det is None:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 401, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 401, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_9 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_9);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_4 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_9, __pyx_v_obs2_ind_arr_2d) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_obs2_ind_arr_2d);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 399, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 401, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 401, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 401, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 401, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -9636,64 +9862,64 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_10 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_9);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 399, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 401, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_obs2_ind_2d = __pyx_t_10;
     __pyx_t_10 = 0;
 
-    /* "soapcw/soapcw.pyx":401
+    /* "soapcw/soapcw.pyx":403
  *             obs2_ind_2d = np.array(obs2_ind_arr_2d).astype(np.int32)
  * 
  *             if lookup_file_1det is None:             # <<<<<<<<<<<<<<
  *                 obs1_ind_1d = np.array(obs1_ind_arr_2d).astype(np.int32)
  *                 obs2_ind_1d = np.array(obs2_ind_arr_2d).astype(np.int32)
  */
     __pyx_t_16 = (__pyx_v_lookup_file_1det == Py_None);
     __pyx_t_17 = (__pyx_t_16 != 0);
     if (__pyx_t_17) {
 
-      /* "soapcw/soapcw.pyx":402
+      /* "soapcw/soapcw.pyx":404
  * 
  *             if lookup_file_1det is None:
  *                 obs1_ind_1d = np.array(obs1_ind_arr_2d).astype(np.int32)             # <<<<<<<<<<<<<<
  *                 obs2_ind_1d = np.array(obs2_ind_arr_2d).astype(np.int32)
  *                 logarr_1d = diag
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 404, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 404, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __pyx_t_9 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_9)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
       __pyx_t_2 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_9, __pyx_v_obs1_ind_arr_2d) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_obs1_ind_arr_2d);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 402, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 404, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 404, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 404, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 404, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_2)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -9701,57 +9927,57 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
       __pyx_t_10 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_9);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 402, __pyx_L1_error)
+      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 404, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_10, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_10, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 404, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __PYX_XDEC_MEMVIEW(&__pyx_v_obs1_ind_1d, 1);
-      __pyx_v_obs1_ind_1d = __pyx_t_21;
-      __pyx_t_21.memview = NULL;
-      __pyx_t_21.data = NULL;
+      __pyx_v_obs1_ind_1d = __pyx_t_11;
+      __pyx_t_11.memview = NULL;
+      __pyx_t_11.data = NULL;
 
-      /* "soapcw/soapcw.pyx":403
+      /* "soapcw/soapcw.pyx":405
  *             if lookup_file_1det is None:
  *                 obs1_ind_1d = np.array(obs1_ind_arr_2d).astype(np.int32)
  *                 obs2_ind_1d = np.array(obs2_ind_arr_2d).astype(np.int32)             # <<<<<<<<<<<<<<
  *                 logarr_1d = diag
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 403, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 405, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 403, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 405, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __pyx_t_9 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
         __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_9)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
       __pyx_t_4 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_9, __pyx_v_obs2_ind_arr_2d) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_obs2_ind_arr_2d);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 403, __pyx_L1_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 405, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 403, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 405, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 403, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 405, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 403, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 405, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -9759,140 +9985,140 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
       __pyx_t_10 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_9);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 403, __pyx_L1_error)
+      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 405, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_XDECREF_SET(__pyx_v_obs2_ind_1d, __pyx_t_10);
       __pyx_t_10 = 0;
 
-      /* "soapcw/soapcw.pyx":404
+      /* "soapcw/soapcw.pyx":406
  *                 obs1_ind_1d = np.array(obs1_ind_arr_2d).astype(np.int32)
  *                 obs2_ind_1d = np.array(obs2_ind_arr_2d).astype(np.int32)
  *                 logarr_1d = diag             # <<<<<<<<<<<<<<
  * 
  *             del diag
  */
-      __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_diag, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 404, __pyx_L1_error)
+      __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_diag, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 406, __pyx_L1_error)
       __PYX_XDEC_MEMVIEW(&__pyx_v_logarr_1d, 1);
       __pyx_v_logarr_1d = __pyx_t_19;
       __pyx_t_19.memview = NULL;
       __pyx_t_19.data = NULL;
 
-      /* "soapcw/soapcw.pyx":401
+      /* "soapcw/soapcw.pyx":403
  *             obs2_ind_2d = np.array(obs2_ind_arr_2d).astype(np.int32)
  * 
  *             if lookup_file_1det is None:             # <<<<<<<<<<<<<<
  *                 obs1_ind_1d = np.array(obs1_ind_arr_2d).astype(np.int32)
  *                 obs2_ind_1d = np.array(obs2_ind_arr_2d).astype(np.int32)
  */
     }
 
-    /* "soapcw/soapcw.pyx":406
+    /* "soapcw/soapcw.pyx":408
  *                 logarr_1d = diag
  * 
  *             del diag             # <<<<<<<<<<<<<<
  *             del obs2_ind_arr_2d
  *             del obs1_ind_arr_2d
  */
     __Pyx_DECREF(__pyx_v_diag);
     __pyx_v_diag = NULL;
 
-    /* "soapcw/soapcw.pyx":407
+    /* "soapcw/soapcw.pyx":409
  * 
  *             del diag
  *             del obs2_ind_arr_2d             # <<<<<<<<<<<<<<
  *             del obs1_ind_arr_2d
  * 
  */
     __Pyx_DECREF(__pyx_v_obs2_ind_arr_2d);
     __pyx_v_obs2_ind_arr_2d = NULL;
 
-    /* "soapcw/soapcw.pyx":408
+    /* "soapcw/soapcw.pyx":410
  *             del diag
  *             del obs2_ind_arr_2d
  *             del obs1_ind_arr_2d             # <<<<<<<<<<<<<<
  * 
  *         sumv = False
  */
     __Pyx_DECREF(__pyx_v_obs1_ind_arr_2d);
     __pyx_v_obs1_ind_arr_2d = NULL;
 
-    /* "soapcw/soapcw.pyx":383
+    /* "soapcw/soapcw.pyx":385
  *             del obs2_ind_arr_1d
  * 
  *         if lookup_file_2det is not None:             # <<<<<<<<<<<<<<
  *             logarr, ranges_2d, fact_2d = self.read_lookup(lookup_file_2det)
  *             diag = copy.copy(np.diag(logarr))
  */
   }
 
-  /* "soapcw/soapcw.pyx":410
+  /* "soapcw/soapcw.pyx":412
  *             del obs1_ind_arr_2d
  * 
  *         sumv = False             # <<<<<<<<<<<<<<
  * 	# if no lookup tables provided then use the sum of the powers
  *         if lookup_file_1det is None and lookup_file_2det is None:
  */
   __pyx_v_sumv = 0;
 
-  /* "soapcw/soapcw.pyx":412
+  /* "soapcw/soapcw.pyx":414
  *         sumv = False
  * 	# if no lookup tables provided then use the sum of the powers
  *         if lookup_file_1det is None and lookup_file_2det is None:             # <<<<<<<<<<<<<<
  *             # if using the sum of power, set element of index to 2d array
  *             obs1_ind_1d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32)
  */
   __pyx_t_16 = (__pyx_v_lookup_file_1det == Py_None);
-  __pyx_t_22 = (__pyx_t_16 != 0);
-  if (__pyx_t_22) {
+  __pyx_t_21 = (__pyx_t_16 != 0);
+  if (__pyx_t_21) {
   } else {
-    __pyx_t_17 = __pyx_t_22;
+    __pyx_t_17 = __pyx_t_21;
     goto __pyx_L23_bool_binop_done;
   }
-  __pyx_t_22 = (__pyx_v_lookup_file_2det == Py_None);
-  __pyx_t_16 = (__pyx_t_22 != 0);
+  __pyx_t_21 = (__pyx_v_lookup_file_2det == Py_None);
+  __pyx_t_16 = (__pyx_t_21 != 0);
   __pyx_t_17 = __pyx_t_16;
   __pyx_L23_bool_binop_done:;
   if (__pyx_t_17) {
 
-    /* "soapcw/soapcw.pyx":414
+    /* "soapcw/soapcw.pyx":416
  *         if lookup_file_1det is None and lookup_file_2det is None:
  *             # if using the sum of power, set element of index to 2d array
  *             obs1_ind_1d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32)             # <<<<<<<<<<<<<<
  *             obs1_ind_2d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32)
  *             obs2_ind_1d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32) + np.prod(shape)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_prod); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_prod); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __pyx_t_14 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_15))) {
       __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_15);
       if (likely(__pyx_t_14)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_15);
         __Pyx_INCREF(__pyx_t_14);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_15, function);
       }
     }
     __pyx_t_4 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_15, __pyx_t_14, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_15, __pyx_v_shape);
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 414, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     __pyx_t_15 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_15)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -9900,41 +10126,41 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_9 = (__pyx_t_15) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_15, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 414, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_reshape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_reshape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_9 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_9);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_2 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_9, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_shape);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 414, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -9942,54 +10168,54 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_10 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_9);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 414, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_10, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_10, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_obs1_ind_1d, 1);
-    __pyx_v_obs1_ind_1d = __pyx_t_21;
-    __pyx_t_21.memview = NULL;
-    __pyx_t_21.data = NULL;
+    __pyx_v_obs1_ind_1d = __pyx_t_11;
+    __pyx_t_11.memview = NULL;
+    __pyx_t_11.data = NULL;
 
-    /* "soapcw/soapcw.pyx":415
+    /* "soapcw/soapcw.pyx":417
  *             # if using the sum of power, set element of index to 2d array
  *             obs1_ind_1d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32)
  *             obs1_ind_2d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32)             # <<<<<<<<<<<<<<
  *             obs2_ind_1d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32) + np.prod(shape)
  *             obs2_ind_2d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32) + np.prod(shape)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_arange); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 415, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_arange); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 415, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
-    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_prod); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 415, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_prod); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     __pyx_t_15 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
       __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_14);
       if (likely(__pyx_t_15)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
         __Pyx_INCREF(__pyx_t_15);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_14, function);
       }
     }
     __pyx_t_2 = (__pyx_t_15) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_15, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_v_shape);
     __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __pyx_t_14 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_14)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -9997,41 +10223,41 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_9 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_14, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 415, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_reshape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 415, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_reshape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_9 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_9);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_3 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_9, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_shape);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 415, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 415, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 415, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 415, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -10039,54 +10265,54 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_10 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_9);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 415, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_10, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 415, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_10, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_obs1_ind_2d, 1);
-    __pyx_v_obs1_ind_2d = __pyx_t_21;
-    __pyx_t_21.memview = NULL;
-    __pyx_t_21.data = NULL;
+    __pyx_v_obs1_ind_2d = __pyx_t_11;
+    __pyx_t_11.memview = NULL;
+    __pyx_t_11.data = NULL;
 
-    /* "soapcw/soapcw.pyx":416
+    /* "soapcw/soapcw.pyx":418
  *             obs1_ind_1d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32)
  *             obs1_ind_2d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32)
  *             obs2_ind_1d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32) + np.prod(shape)             # <<<<<<<<<<<<<<
  *             obs2_ind_2d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32) + np.prod(shape)
  *             # flatten input spectrogram for access in 1d
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 416, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_arange); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_arange); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 416, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_prod); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 416, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_prod); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __pyx_t_14 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_15))) {
       __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_15);
       if (likely(__pyx_t_14)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_15);
         __Pyx_INCREF(__pyx_t_14);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_15, function);
       }
     }
     __pyx_t_3 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_15, __pyx_t_14, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_15, __pyx_v_shape);
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 416, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     __pyx_t_15 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_15)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -10094,41 +10320,41 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_9 = (__pyx_t_15) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_15, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 416, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_reshape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_reshape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_9 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_9);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_4 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_9, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_shape);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 416, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 416, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 416, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -10136,74 +10362,74 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_10 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_9);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 416, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 416, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_prod); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 416, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_prod); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_9 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_9);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_2 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_9, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_shape);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Add(__pyx_t_10, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 416, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Add(__pyx_t_10, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF_SET(__pyx_v_obs2_ind_1d, __pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "soapcw/soapcw.pyx":417
+    /* "soapcw/soapcw.pyx":419
  *             obs1_ind_2d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32)
  *             obs2_ind_1d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32) + np.prod(shape)
  *             obs2_ind_2d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32) + np.prod(shape)             # <<<<<<<<<<<<<<
  *             # flatten input spectrogram for access in 1d
  *             logarr_1d = np.ravel([obs1,obs2])
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
-    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_prod); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_prod); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     __pyx_t_15 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
       __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_14);
       if (likely(__pyx_t_15)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
         __Pyx_INCREF(__pyx_t_15);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_14, function);
       }
     }
     __pyx_t_9 = (__pyx_t_15) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_15, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_v_shape);
     __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 417, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __pyx_t_14 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_14)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -10211,41 +10437,41 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_10 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_14, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_9);
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 417, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_reshape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_reshape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_2 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_10, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_shape);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -10253,57 +10479,57 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_10);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 417, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_prod); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_prod); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_3 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_10, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_shape);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 417, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF_SET(__pyx_v_obs2_ind_2d, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":419
+    /* "soapcw/soapcw.pyx":421
  *             obs2_ind_2d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32) + np.prod(shape)
  *             # flatten input spectrogram for access in 1d
  *             logarr_1d = np.ravel([obs1,obs2])             # <<<<<<<<<<<<<<
  *             sumv = True
  *             #logarr_2d = np.ravel([obs1,obs2])
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 419, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 421, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ravel); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 419, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ravel); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 421, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 419, __pyx_L1_error)
+    __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 421, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_obs1);
     __Pyx_GIVEREF(__pyx_v_obs1);
     PyList_SET_ITEM(__pyx_t_3, 0, __pyx_v_obs1);
     __Pyx_INCREF(__pyx_v_obs2);
     __Pyx_GIVEREF(__pyx_v_obs2);
     PyList_SET_ITEM(__pyx_t_3, 1, __pyx_v_obs2);
@@ -10316,100 +10542,100 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_2 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_10, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 419, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 421, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 419, __pyx_L1_error)
+    __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 421, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_logarr_1d, 1);
     __pyx_v_logarr_1d = __pyx_t_19;
     __pyx_t_19.memview = NULL;
     __pyx_t_19.data = NULL;
 
-    /* "soapcw/soapcw.pyx":420
+    /* "soapcw/soapcw.pyx":422
  *             # flatten input spectrogram for access in 1d
  *             logarr_1d = np.ravel([obs1,obs2])
  *             sumv = True             # <<<<<<<<<<<<<<
  *             #logarr_2d = np.ravel([obs1,obs2])
  * 
  */
     __pyx_v_sumv = 1;
 
-    /* "soapcw/soapcw.pyx":412
+    /* "soapcw/soapcw.pyx":414
  *         sumv = False
  * 	# if no lookup tables provided then use the sum of the powers
  *         if lookup_file_1det is None and lookup_file_2det is None:             # <<<<<<<<<<<<<<
  *             # if using the sum of power, set element of index to 2d array
  *             obs1_ind_1d = np.arange(np.prod(shape)).reshape(shape).astype(np.int32)
  */
   }
 
-  /* "soapcw/soapcw.pyx":424
+  /* "soapcw/soapcw.pyx":426
  * 
  *         # initial viterbi loop for first time segment
  *         for i in range(width):             # <<<<<<<<<<<<<<
  *             temp = -1e6
  *             if obs1data[0] and obs2data[0]:
  */
-  __pyx_t_23 = __pyx_v_width;
-  __pyx_t_24 = __pyx_t_23;
-  for (__pyx_t_25 = 0; __pyx_t_25 < __pyx_t_24; __pyx_t_25+=1) {
-    __pyx_v_i = __pyx_t_25;
+  __pyx_t_22 = __pyx_v_width;
+  __pyx_t_23 = __pyx_t_22;
+  for (__pyx_t_24 = 0; __pyx_t_24 < __pyx_t_23; __pyx_t_24+=1) {
+    __pyx_v_i = __pyx_t_24;
 
-    /* "soapcw/soapcw.pyx":425
+    /* "soapcw/soapcw.pyx":427
  *         # initial viterbi loop for first time segment
  *         for i in range(width):
  *             temp = -1e6             # <<<<<<<<<<<<<<
  *             if obs1data[0] and obs2data[0]:
  *                 # if data in both detectors
  */
     __pyx_v_temp = -1e6;
 
-    /* "soapcw/soapcw.pyx":426
+    /* "soapcw/soapcw.pyx":428
  *         for i in range(width):
  *             temp = -1e6
  *             if obs1data[0] and obs2data[0]:             # <<<<<<<<<<<<<<
  *                 # if data in both detectors
  *                 for k in range(sep_len):
  */
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs1data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 426, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs1data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 428, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 426, __pyx_L1_error)
+    __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 428, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (__pyx_t_16) {
     } else {
       __pyx_t_17 = __pyx_t_16;
       goto __pyx_L28_bool_binop_done;
     }
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs2data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 426, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs2data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 428, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 426, __pyx_L1_error)
+    __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 428, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_17 = __pyx_t_16;
     __pyx_L28_bool_binop_done:;
     if (__pyx_t_17) {
 
-      /* "soapcw/soapcw.pyx":428
+      /* "soapcw/soapcw.pyx":430
  *             if obs1data[0] and obs2data[0]:
  *                 # if data in both detectors
  *                 for k in range(sep_len):             # <<<<<<<<<<<<<<
  *                     if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                         for m in range(sep_len):
  */
-      __pyx_t_26 = __pyx_v_sep_len;
-      __pyx_t_27 = __pyx_t_26;
-      for (__pyx_t_28 = 0; __pyx_t_28 < __pyx_t_27; __pyx_t_28+=1) {
-        __pyx_v_k = __pyx_t_28;
+      __pyx_t_25 = __pyx_v_sep_len;
+      __pyx_t_26 = __pyx_t_25;
+      for (__pyx_t_27 = 0; __pyx_t_27 < __pyx_t_26; __pyx_t_27+=1) {
+        __pyx_v_k = __pyx_t_27;
 
-        /* "soapcw/soapcw.pyx":429
+        /* "soapcw/soapcw.pyx":431
  *                 # if data in both detectors
  *                 for k in range(sep_len):
  *                     if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                         for m in range(sep_len):
  *                             if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  */
         __pyx_t_16 = ((((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist) >= (0 + __pyx_v_edge_range)) != 0);
@@ -10419,27 +10645,27 @@
           goto __pyx_L33_bool_binop_done;
         }
         __pyx_t_16 = ((((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist) < (__pyx_v_width - __pyx_v_edge_range)) != 0);
         __pyx_t_17 = __pyx_t_16;
         __pyx_L33_bool_binop_done:;
         if (__pyx_t_17) {
 
-          /* "soapcw/soapcw.pyx":430
+          /* "soapcw/soapcw.pyx":432
  *                 for k in range(sep_len):
  *                     if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                         for m in range(sep_len):             # <<<<<<<<<<<<<<
  *                             if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                                 if sumv:
  */
-          __pyx_t_29 = __pyx_v_sep_len;
-          __pyx_t_30 = __pyx_t_29;
-          for (__pyx_t_31 = 0; __pyx_t_31 < __pyx_t_30; __pyx_t_31+=1) {
-            __pyx_v_m = __pyx_t_31;
+          __pyx_t_28 = __pyx_v_sep_len;
+          __pyx_t_29 = __pyx_t_28;
+          for (__pyx_t_30 = 0; __pyx_t_30 < __pyx_t_29; __pyx_t_30+=1) {
+            __pyx_v_m = __pyx_t_30;
 
-            /* "soapcw/soapcw.pyx":431
+            /* "soapcw/soapcw.pyx":433
  *                     if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                         for m in range(sep_len):
  *                             if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                                 if sumv:
  *                                     value = tr[1][k][m] + obs1[0][i+k-sep_dist] + obs2[0][i+k-sep_dist]
  */
             __pyx_t_16 = ((((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist) >= (0 + __pyx_v_edge_range)) != 0);
@@ -10449,893 +10675,893 @@
               goto __pyx_L38_bool_binop_done;
             }
             __pyx_t_16 = ((((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist) < (__pyx_v_width - __pyx_v_edge_range)) != 0);
             __pyx_t_17 = __pyx_t_16;
             __pyx_L38_bool_binop_done:;
             if (__pyx_t_17) {
 
-              /* "soapcw/soapcw.pyx":432
+              /* "soapcw/soapcw.pyx":434
  *                         for m in range(sep_len):
  *                             if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                                 if sumv:             # <<<<<<<<<<<<<<
  *                                     value = tr[1][k][m] + obs1[0][i+k-sep_dist] + obs2[0][i+k-sep_dist]
  *                                 else:
  */
               __pyx_t_17 = (__pyx_v_sumv != 0);
               if (__pyx_t_17) {
 
-                /* "soapcw/soapcw.pyx":433
+                /* "soapcw/soapcw.pyx":435
  *                             if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                                 if sumv:
  *                                     value = tr[1][k][m] + obs1[0][i+k-sep_dist] + obs2[0][i+k-sep_dist]             # <<<<<<<<<<<<<<
  *                                 else:
  *                                     o1 = obs1_ind_2d[0][i+k-sep_dist]
  */
-                __pyx_t_32 = 1;
-                __pyx_t_33 = __pyx_v_k;
-                __pyx_t_34 = __pyx_v_m;
-                __pyx_t_35 = -1;
+                __pyx_t_31 = 1;
+                __pyx_t_32 = __pyx_v_k;
+                __pyx_t_33 = __pyx_v_m;
+                __pyx_t_34 = -1;
+                if (__pyx_t_31 < 0) {
+                  __pyx_t_31 += __pyx_v_tr.shape[0];
+                  if (unlikely(__pyx_t_31 < 0)) __pyx_t_34 = 0;
+                } else if (unlikely(__pyx_t_31 >= __pyx_v_tr.shape[0])) __pyx_t_34 = 0;
                 if (__pyx_t_32 < 0) {
-                  __pyx_t_32 += __pyx_v_tr.shape[0];
-                  if (unlikely(__pyx_t_32 < 0)) __pyx_t_35 = 0;
-                } else if (unlikely(__pyx_t_32 >= __pyx_v_tr.shape[0])) __pyx_t_35 = 0;
+                  __pyx_t_32 += __pyx_v_tr.shape[1];
+                  if (unlikely(__pyx_t_32 < 0)) __pyx_t_34 = 1;
+                } else if (unlikely(__pyx_t_32 >= __pyx_v_tr.shape[1])) __pyx_t_34 = 1;
                 if (__pyx_t_33 < 0) {
-                  __pyx_t_33 += __pyx_v_tr.shape[1];
-                  if (unlikely(__pyx_t_33 < 0)) __pyx_t_35 = 1;
-                } else if (unlikely(__pyx_t_33 >= __pyx_v_tr.shape[1])) __pyx_t_35 = 1;
-                if (__pyx_t_34 < 0) {
-                  __pyx_t_34 += __pyx_v_tr.shape[2];
-                  if (unlikely(__pyx_t_34 < 0)) __pyx_t_35 = 2;
-                } else if (unlikely(__pyx_t_34 >= __pyx_v_tr.shape[2])) __pyx_t_35 = 2;
-                if (unlikely(__pyx_t_35 != -1)) {
-                  __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                  __PYX_ERR(0, 433, __pyx_L1_error)
+                  __pyx_t_33 += __pyx_v_tr.shape[2];
+                  if (unlikely(__pyx_t_33 < 0)) __pyx_t_34 = 2;
+                } else if (unlikely(__pyx_t_33 >= __pyx_v_tr.shape[2])) __pyx_t_34 = 2;
+                if (unlikely(__pyx_t_34 != -1)) {
+                  __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                  __PYX_ERR(0, 435, __pyx_L1_error)
                 }
-                __pyx_t_2 = PyFloat_FromDouble((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_32 * __pyx_v_tr.strides[0]) ) + __pyx_t_33 * __pyx_v_tr.strides[1]) ) + __pyx_t_34 * __pyx_v_tr.strides[2]) )))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 433, __pyx_L1_error)
+                __pyx_t_2 = PyFloat_FromDouble((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_31 * __pyx_v_tr.strides[0]) ) + __pyx_t_32 * __pyx_v_tr.strides[1]) ) + __pyx_t_33 * __pyx_v_tr.strides[2]) )))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 435, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_2);
-                __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_obs1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 433, __pyx_L1_error)
+                __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_obs1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 435, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_4);
-                __pyx_t_35 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
-                __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, __pyx_t_35, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 433, __pyx_L1_error)
+                __pyx_t_34 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
+                __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, __pyx_t_34, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_3);
                 __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                __pyx_t_4 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 433, __pyx_L1_error)
+                __pyx_t_4 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 435, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_4);
                 __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                 __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 433, __pyx_L1_error)
+                __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_3);
-                __pyx_t_35 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
-                __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_35, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 433, __pyx_L1_error)
+                __pyx_t_34 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
+                __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_34, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 435, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_2);
                 __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                __pyx_t_3 = PyNumber_Add(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 433, __pyx_L1_error)
+                __pyx_t_3 = PyNumber_Add(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_3);
                 __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                 __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-                __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 433, __pyx_L1_error)
+                __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 435, __pyx_L1_error)
                 __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                 __pyx_v_value = __pyx_t_20;
 
-                /* "soapcw/soapcw.pyx":432
+                /* "soapcw/soapcw.pyx":434
  *                         for m in range(sep_len):
  *                             if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                                 if sumv:             # <<<<<<<<<<<<<<
  *                                     value = tr[1][k][m] + obs1[0][i+k-sep_dist] + obs2[0][i+k-sep_dist]
  *                                 else:
  */
                 goto __pyx_L40;
               }
 
-              /* "soapcw/soapcw.pyx":435
+              /* "soapcw/soapcw.pyx":437
  *                                     value = tr[1][k][m] + obs1[0][i+k-sep_dist] + obs2[0][i+k-sep_dist]
  *                                 else:
  *                                     o1 = obs1_ind_2d[0][i+k-sep_dist]             # <<<<<<<<<<<<<<
  *                                     o2 = obs2_ind_2d[0][i+m-sep_dist]
  *                                     value = tr[1][k][m] + logarr_2d[o1,o2]
  */
               /*else*/ {
-                if (unlikely(!__pyx_v_obs1_ind_2d.memview)) { __Pyx_RaiseUnboundLocalError("obs1_ind_2d"); __PYX_ERR(0, 435, __pyx_L1_error) }
-                __pyx_t_36 = 0;
-                __pyx_t_37 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
-                __pyx_t_35 = -1;
-                if (__pyx_t_36 < 0) {
-                  __pyx_t_36 += __pyx_v_obs1_ind_2d.shape[0];
-                  if (unlikely(__pyx_t_36 < 0)) __pyx_t_35 = 0;
-                } else if (unlikely(__pyx_t_36 >= __pyx_v_obs1_ind_2d.shape[0])) __pyx_t_35 = 0;
-                if (__pyx_t_37 < 0) {
-                  __pyx_t_37 += __pyx_v_obs1_ind_2d.shape[1];
-                  if (unlikely(__pyx_t_37 < 0)) __pyx_t_35 = 1;
-                } else if (unlikely(__pyx_t_37 >= __pyx_v_obs1_ind_2d.shape[1])) __pyx_t_35 = 1;
-                if (unlikely(__pyx_t_35 != -1)) {
-                  __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                  __PYX_ERR(0, 435, __pyx_L1_error)
+                if (unlikely(!__pyx_v_obs1_ind_2d.memview)) { __Pyx_RaiseUnboundLocalError("obs1_ind_2d"); __PYX_ERR(0, 437, __pyx_L1_error) }
+                __pyx_t_33 = 0;
+                __pyx_t_32 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
+                __pyx_t_34 = -1;
+                if (__pyx_t_33 < 0) {
+                  __pyx_t_33 += __pyx_v_obs1_ind_2d.shape[0];
+                  if (unlikely(__pyx_t_33 < 0)) __pyx_t_34 = 0;
+                } else if (unlikely(__pyx_t_33 >= __pyx_v_obs1_ind_2d.shape[0])) __pyx_t_34 = 0;
+                if (__pyx_t_32 < 0) {
+                  __pyx_t_32 += __pyx_v_obs1_ind_2d.shape[1];
+                  if (unlikely(__pyx_t_32 < 0)) __pyx_t_34 = 1;
+                } else if (unlikely(__pyx_t_32 >= __pyx_v_obs1_ind_2d.shape[1])) __pyx_t_34 = 1;
+                if (unlikely(__pyx_t_34 != -1)) {
+                  __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                  __PYX_ERR(0, 437, __pyx_L1_error)
                 }
-                __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind_2d.data + __pyx_t_36 * __pyx_v_obs1_ind_2d.strides[0]) ) + __pyx_t_37 * __pyx_v_obs1_ind_2d.strides[1]) )));
+                __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind_2d.data + __pyx_t_33 * __pyx_v_obs1_ind_2d.strides[0]) ) + __pyx_t_32 * __pyx_v_obs1_ind_2d.strides[1]) )));
 
-                /* "soapcw/soapcw.pyx":436
+                /* "soapcw/soapcw.pyx":438
  *                                 else:
  *                                     o1 = obs1_ind_2d[0][i+k-sep_dist]
  *                                     o2 = obs2_ind_2d[0][i+m-sep_dist]             # <<<<<<<<<<<<<<
  *                                     value = tr[1][k][m] + logarr_2d[o1,o2]
  *                                 if value > temp:
  */
-                if (unlikely(!__pyx_v_obs2_ind_2d)) { __Pyx_RaiseUnboundLocalError("obs2_ind_2d"); __PYX_ERR(0, 436, __pyx_L1_error) }
-                __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2_ind_2d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 436, __pyx_L1_error)
+                if (unlikely(!__pyx_v_obs2_ind_2d)) { __Pyx_RaiseUnboundLocalError("obs2_ind_2d"); __PYX_ERR(0, 438, __pyx_L1_error) }
+                __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2_ind_2d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 438, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_3);
-                __pyx_t_35 = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
-                __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_35, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 436, __pyx_L1_error)
+                __pyx_t_34 = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
+                __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_34, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 438, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_2);
                 __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                __pyx_t_35 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_35 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 436, __pyx_L1_error)
+                __pyx_t_34 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_34 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 438, __pyx_L1_error)
                 __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-                __pyx_v_o2 = __pyx_t_35;
+                __pyx_v_o2 = __pyx_t_34;
 
-                /* "soapcw/soapcw.pyx":437
+                /* "soapcw/soapcw.pyx":439
  *                                     o1 = obs1_ind_2d[0][i+k-sep_dist]
  *                                     o2 = obs2_ind_2d[0][i+m-sep_dist]
  *                                     value = tr[1][k][m] + logarr_2d[o1,o2]             # <<<<<<<<<<<<<<
  *                                 if value > temp:
  *                                     temp = value
  */
-                __pyx_t_38 = 1;
-                __pyx_t_39 = __pyx_v_k;
-                __pyx_t_40 = __pyx_v_m;
-                __pyx_t_35 = -1;
-                if (__pyx_t_38 < 0) {
-                  __pyx_t_38 += __pyx_v_tr.shape[0];
-                  if (unlikely(__pyx_t_38 < 0)) __pyx_t_35 = 0;
-                } else if (unlikely(__pyx_t_38 >= __pyx_v_tr.shape[0])) __pyx_t_35 = 0;
-                if (__pyx_t_39 < 0) {
-                  __pyx_t_39 += __pyx_v_tr.shape[1];
-                  if (unlikely(__pyx_t_39 < 0)) __pyx_t_35 = 1;
-                } else if (unlikely(__pyx_t_39 >= __pyx_v_tr.shape[1])) __pyx_t_35 = 1;
-                if (__pyx_t_40 < 0) {
-                  __pyx_t_40 += __pyx_v_tr.shape[2];
-                  if (unlikely(__pyx_t_40 < 0)) __pyx_t_35 = 2;
-                } else if (unlikely(__pyx_t_40 >= __pyx_v_tr.shape[2])) __pyx_t_35 = 2;
-                if (unlikely(__pyx_t_35 != -1)) {
-                  __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                  __PYX_ERR(0, 437, __pyx_L1_error)
+                __pyx_t_32 = 1;
+                __pyx_t_33 = __pyx_v_k;
+                __pyx_t_31 = __pyx_v_m;
+                __pyx_t_34 = -1;
+                if (__pyx_t_32 < 0) {
+                  __pyx_t_32 += __pyx_v_tr.shape[0];
+                  if (unlikely(__pyx_t_32 < 0)) __pyx_t_34 = 0;
+                } else if (unlikely(__pyx_t_32 >= __pyx_v_tr.shape[0])) __pyx_t_34 = 0;
+                if (__pyx_t_33 < 0) {
+                  __pyx_t_33 += __pyx_v_tr.shape[1];
+                  if (unlikely(__pyx_t_33 < 0)) __pyx_t_34 = 1;
+                } else if (unlikely(__pyx_t_33 >= __pyx_v_tr.shape[1])) __pyx_t_34 = 1;
+                if (__pyx_t_31 < 0) {
+                  __pyx_t_31 += __pyx_v_tr.shape[2];
+                  if (unlikely(__pyx_t_31 < 0)) __pyx_t_34 = 2;
+                } else if (unlikely(__pyx_t_31 >= __pyx_v_tr.shape[2])) __pyx_t_34 = 2;
+                if (unlikely(__pyx_t_34 != -1)) {
+                  __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                  __PYX_ERR(0, 439, __pyx_L1_error)
                 }
-                if (unlikely(!__pyx_v_logarr_2d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_2d"); __PYX_ERR(0, 437, __pyx_L1_error) }
-                __pyx_t_41 = __pyx_v_o1;
-                __pyx_t_42 = __pyx_v_o2;
-                __pyx_t_35 = -1;
-                if (__pyx_t_41 < 0) {
-                  __pyx_t_41 += __pyx_v_logarr_2d.shape[0];
-                  if (unlikely(__pyx_t_41 < 0)) __pyx_t_35 = 0;
-                } else if (unlikely(__pyx_t_41 >= __pyx_v_logarr_2d.shape[0])) __pyx_t_35 = 0;
-                if (__pyx_t_42 < 0) {
-                  __pyx_t_42 += __pyx_v_logarr_2d.shape[1];
-                  if (unlikely(__pyx_t_42 < 0)) __pyx_t_35 = 1;
-                } else if (unlikely(__pyx_t_42 >= __pyx_v_logarr_2d.shape[1])) __pyx_t_35 = 1;
-                if (unlikely(__pyx_t_35 != -1)) {
-                  __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                  __PYX_ERR(0, 437, __pyx_L1_error)
+                if (unlikely(!__pyx_v_logarr_2d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_2d"); __PYX_ERR(0, 439, __pyx_L1_error) }
+                __pyx_t_35 = __pyx_v_o1;
+                __pyx_t_36 = __pyx_v_o2;
+                __pyx_t_34 = -1;
+                if (__pyx_t_35 < 0) {
+                  __pyx_t_35 += __pyx_v_logarr_2d.shape[0];
+                  if (unlikely(__pyx_t_35 < 0)) __pyx_t_34 = 0;
+                } else if (unlikely(__pyx_t_35 >= __pyx_v_logarr_2d.shape[0])) __pyx_t_34 = 0;
+                if (__pyx_t_36 < 0) {
+                  __pyx_t_36 += __pyx_v_logarr_2d.shape[1];
+                  if (unlikely(__pyx_t_36 < 0)) __pyx_t_34 = 1;
+                } else if (unlikely(__pyx_t_36 >= __pyx_v_logarr_2d.shape[1])) __pyx_t_34 = 1;
+                if (unlikely(__pyx_t_34 != -1)) {
+                  __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                  __PYX_ERR(0, 439, __pyx_L1_error)
                 }
-                __pyx_v_value = ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_38 * __pyx_v_tr.strides[0]) ) + __pyx_t_39 * __pyx_v_tr.strides[1]) ) + __pyx_t_40 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_logarr_2d.data + __pyx_t_41 * __pyx_v_logarr_2d.strides[0]) ) + __pyx_t_42 * __pyx_v_logarr_2d.strides[1]) ))));
+                __pyx_v_value = ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_32 * __pyx_v_tr.strides[0]) ) + __pyx_t_33 * __pyx_v_tr.strides[1]) ) + __pyx_t_31 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_logarr_2d.data + __pyx_t_35 * __pyx_v_logarr_2d.strides[0]) ) + __pyx_t_36 * __pyx_v_logarr_2d.strides[1]) ))));
               }
               __pyx_L40:;
 
-              /* "soapcw/soapcw.pyx":438
+              /* "soapcw/soapcw.pyx":440
  *                                     o2 = obs2_ind_2d[0][i+m-sep_dist]
  *                                     value = tr[1][k][m] + logarr_2d[o1,o2]
  *                                 if value > temp:             # <<<<<<<<<<<<<<
  *                                     temp = value
  *                                     val[0][i] = temp
  */
               __pyx_t_17 = ((__pyx_v_value > __pyx_v_temp) != 0);
               if (__pyx_t_17) {
 
-                /* "soapcw/soapcw.pyx":439
+                /* "soapcw/soapcw.pyx":441
  *                                     value = tr[1][k][m] + logarr_2d[o1,o2]
  *                                 if value > temp:
  *                                     temp = value             # <<<<<<<<<<<<<<
  *                                     val[0][i] = temp
  *                                     prev[0][i] =  i
  */
                 __pyx_v_temp = __pyx_v_value;
 
-                /* "soapcw/soapcw.pyx":440
+                /* "soapcw/soapcw.pyx":442
  *                                 if value > temp:
  *                                     temp = value
  *                                     val[0][i] = temp             # <<<<<<<<<<<<<<
  *                                     prev[0][i] =  i
  *                                     det1[0][i] =  i+k-1
  */
-                __pyx_t_43 = 0;
-                __pyx_t_44 = __pyx_v_i;
-                __pyx_t_35 = -1;
-                if (__pyx_t_43 < 0) {
-                  __pyx_t_43 += __pyx_v_val.shape[0];
-                  if (unlikely(__pyx_t_43 < 0)) __pyx_t_35 = 0;
-                } else if (unlikely(__pyx_t_43 >= __pyx_v_val.shape[0])) __pyx_t_35 = 0;
-                if (__pyx_t_44 < 0) {
-                  __pyx_t_44 += __pyx_v_val.shape[1];
-                  if (unlikely(__pyx_t_44 < 0)) __pyx_t_35 = 1;
-                } else if (unlikely(__pyx_t_44 >= __pyx_v_val.shape[1])) __pyx_t_35 = 1;
-                if (unlikely(__pyx_t_35 != -1)) {
-                  __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                  __PYX_ERR(0, 440, __pyx_L1_error)
+                __pyx_t_36 = 0;
+                __pyx_t_35 = __pyx_v_i;
+                __pyx_t_34 = -1;
+                if (__pyx_t_36 < 0) {
+                  __pyx_t_36 += __pyx_v_val.shape[0];
+                  if (unlikely(__pyx_t_36 < 0)) __pyx_t_34 = 0;
+                } else if (unlikely(__pyx_t_36 >= __pyx_v_val.shape[0])) __pyx_t_34 = 0;
+                if (__pyx_t_35 < 0) {
+                  __pyx_t_35 += __pyx_v_val.shape[1];
+                  if (unlikely(__pyx_t_35 < 0)) __pyx_t_34 = 1;
+                } else if (unlikely(__pyx_t_35 >= __pyx_v_val.shape[1])) __pyx_t_34 = 1;
+                if (unlikely(__pyx_t_34 != -1)) {
+                  __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                  __PYX_ERR(0, 442, __pyx_L1_error)
                 }
-                *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_43 * __pyx_v_val.strides[0]) ) + __pyx_t_44 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
+                *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_36 * __pyx_v_val.strides[0]) ) + __pyx_t_35 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
 
-                /* "soapcw/soapcw.pyx":441
+                /* "soapcw/soapcw.pyx":443
  *                                     temp = value
  *                                     val[0][i] = temp
  *                                     prev[0][i] =  i             # <<<<<<<<<<<<<<
  *                                     det1[0][i] =  i+k-1
  *                                     det2[0][i] =  i+m-1
  */
-                __pyx_t_45 = 0;
-                __pyx_t_46 = __pyx_v_i;
-                __pyx_t_35 = -1;
-                if (__pyx_t_45 < 0) {
-                  __pyx_t_45 += __pyx_v_prev.shape[0];
-                  if (unlikely(__pyx_t_45 < 0)) __pyx_t_35 = 0;
-                } else if (unlikely(__pyx_t_45 >= __pyx_v_prev.shape[0])) __pyx_t_35 = 0;
-                if (__pyx_t_46 < 0) {
-                  __pyx_t_46 += __pyx_v_prev.shape[1];
-                  if (unlikely(__pyx_t_46 < 0)) __pyx_t_35 = 1;
-                } else if (unlikely(__pyx_t_46 >= __pyx_v_prev.shape[1])) __pyx_t_35 = 1;
-                if (unlikely(__pyx_t_35 != -1)) {
-                  __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                  __PYX_ERR(0, 441, __pyx_L1_error)
+                __pyx_t_35 = 0;
+                __pyx_t_36 = __pyx_v_i;
+                __pyx_t_34 = -1;
+                if (__pyx_t_35 < 0) {
+                  __pyx_t_35 += __pyx_v_prev.shape[0];
+                  if (unlikely(__pyx_t_35 < 0)) __pyx_t_34 = 0;
+                } else if (unlikely(__pyx_t_35 >= __pyx_v_prev.shape[0])) __pyx_t_34 = 0;
+                if (__pyx_t_36 < 0) {
+                  __pyx_t_36 += __pyx_v_prev.shape[1];
+                  if (unlikely(__pyx_t_36 < 0)) __pyx_t_34 = 1;
+                } else if (unlikely(__pyx_t_36 >= __pyx_v_prev.shape[1])) __pyx_t_34 = 1;
+                if (unlikely(__pyx_t_34 != -1)) {
+                  __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                  __PYX_ERR(0, 443, __pyx_L1_error)
                 }
-                *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_45 * __pyx_v_prev.strides[0]) ) + __pyx_t_46 * __pyx_v_prev.strides[1]) )) = __pyx_v_i;
+                *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_35 * __pyx_v_prev.strides[0]) ) + __pyx_t_36 * __pyx_v_prev.strides[1]) )) = __pyx_v_i;
 
-                /* "soapcw/soapcw.pyx":442
+                /* "soapcw/soapcw.pyx":444
  *                                     val[0][i] = temp
  *                                     prev[0][i] =  i
  *                                     det1[0][i] =  i+k-1             # <<<<<<<<<<<<<<
  *                                     det2[0][i] =  i+m-1
  *                                 else:
  */
-                __pyx_t_47 = 0;
-                __pyx_t_48 = __pyx_v_i;
-                __pyx_t_35 = -1;
-                if (__pyx_t_47 < 0) {
-                  __pyx_t_47 += __pyx_v_det1.shape[0];
-                  if (unlikely(__pyx_t_47 < 0)) __pyx_t_35 = 0;
-                } else if (unlikely(__pyx_t_47 >= __pyx_v_det1.shape[0])) __pyx_t_35 = 0;
-                if (__pyx_t_48 < 0) {
-                  __pyx_t_48 += __pyx_v_det1.shape[1];
-                  if (unlikely(__pyx_t_48 < 0)) __pyx_t_35 = 1;
-                } else if (unlikely(__pyx_t_48 >= __pyx_v_det1.shape[1])) __pyx_t_35 = 1;
-                if (unlikely(__pyx_t_35 != -1)) {
-                  __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                  __PYX_ERR(0, 442, __pyx_L1_error)
+                __pyx_t_36 = 0;
+                __pyx_t_35 = __pyx_v_i;
+                __pyx_t_34 = -1;
+                if (__pyx_t_36 < 0) {
+                  __pyx_t_36 += __pyx_v_det1.shape[0];
+                  if (unlikely(__pyx_t_36 < 0)) __pyx_t_34 = 0;
+                } else if (unlikely(__pyx_t_36 >= __pyx_v_det1.shape[0])) __pyx_t_34 = 0;
+                if (__pyx_t_35 < 0) {
+                  __pyx_t_35 += __pyx_v_det1.shape[1];
+                  if (unlikely(__pyx_t_35 < 0)) __pyx_t_34 = 1;
+                } else if (unlikely(__pyx_t_35 >= __pyx_v_det1.shape[1])) __pyx_t_34 = 1;
+                if (unlikely(__pyx_t_34 != -1)) {
+                  __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                  __PYX_ERR(0, 444, __pyx_L1_error)
                 }
-                *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_47 * __pyx_v_det1.strides[0]) ) + __pyx_t_48 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - 1);
+                *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_36 * __pyx_v_det1.strides[0]) ) + __pyx_t_35 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - 1);
 
-                /* "soapcw/soapcw.pyx":443
+                /* "soapcw/soapcw.pyx":445
  *                                     prev[0][i] =  i
  *                                     det1[0][i] =  i+k-1
  *                                     det2[0][i] =  i+m-1             # <<<<<<<<<<<<<<
  *                                 else:
  *                                     continue
  */
-                __pyx_t_49 = 0;
-                __pyx_t_50 = __pyx_v_i;
-                __pyx_t_35 = -1;
-                if (__pyx_t_49 < 0) {
-                  __pyx_t_49 += __pyx_v_det2.shape[0];
-                  if (unlikely(__pyx_t_49 < 0)) __pyx_t_35 = 0;
-                } else if (unlikely(__pyx_t_49 >= __pyx_v_det2.shape[0])) __pyx_t_35 = 0;
-                if (__pyx_t_50 < 0) {
-                  __pyx_t_50 += __pyx_v_det2.shape[1];
-                  if (unlikely(__pyx_t_50 < 0)) __pyx_t_35 = 1;
-                } else if (unlikely(__pyx_t_50 >= __pyx_v_det2.shape[1])) __pyx_t_35 = 1;
-                if (unlikely(__pyx_t_35 != -1)) {
-                  __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                  __PYX_ERR(0, 443, __pyx_L1_error)
+                __pyx_t_35 = 0;
+                __pyx_t_36 = __pyx_v_i;
+                __pyx_t_34 = -1;
+                if (__pyx_t_35 < 0) {
+                  __pyx_t_35 += __pyx_v_det2.shape[0];
+                  if (unlikely(__pyx_t_35 < 0)) __pyx_t_34 = 0;
+                } else if (unlikely(__pyx_t_35 >= __pyx_v_det2.shape[0])) __pyx_t_34 = 0;
+                if (__pyx_t_36 < 0) {
+                  __pyx_t_36 += __pyx_v_det2.shape[1];
+                  if (unlikely(__pyx_t_36 < 0)) __pyx_t_34 = 1;
+                } else if (unlikely(__pyx_t_36 >= __pyx_v_det2.shape[1])) __pyx_t_34 = 1;
+                if (unlikely(__pyx_t_34 != -1)) {
+                  __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                  __PYX_ERR(0, 445, __pyx_L1_error)
                 }
-                *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_49 * __pyx_v_det2.strides[0]) ) + __pyx_t_50 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - 1);
+                *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_35 * __pyx_v_det2.strides[0]) ) + __pyx_t_36 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - 1);
 
-                /* "soapcw/soapcw.pyx":438
+                /* "soapcw/soapcw.pyx":440
  *                                     o2 = obs2_ind_2d[0][i+m-sep_dist]
  *                                     value = tr[1][k][m] + logarr_2d[o1,o2]
  *                                 if value > temp:             # <<<<<<<<<<<<<<
  *                                     temp = value
  *                                     val[0][i] = temp
  */
                 goto __pyx_L41;
               }
 
-              /* "soapcw/soapcw.pyx":445
+              /* "soapcw/soapcw.pyx":447
  *                                     det2[0][i] =  i+m-1
  *                                 else:
  *                                     continue             # <<<<<<<<<<<<<<
  * 
  *             elif obs1data[0] and not obs2data[0]:
  */
               /*else*/ {
                 goto __pyx_L35_continue;
               }
               __pyx_L41:;
 
-              /* "soapcw/soapcw.pyx":431
+              /* "soapcw/soapcw.pyx":433
  *                     if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                         for m in range(sep_len):
  *                             if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                                 if sumv:
  *                                     value = tr[1][k][m] + obs1[0][i+k-sep_dist] + obs2[0][i+k-sep_dist]
  */
             }
             __pyx_L35_continue:;
           }
 
-          /* "soapcw/soapcw.pyx":429
+          /* "soapcw/soapcw.pyx":431
  *                 # if data in both detectors
  *                 for k in range(sep_len):
  *                     if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                         for m in range(sep_len):
  *                             if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  */
         }
       }
 
-      /* "soapcw/soapcw.pyx":426
+      /* "soapcw/soapcw.pyx":428
  *         for i in range(width):
  *             temp = -1e6
  *             if obs1data[0] and obs2data[0]:             # <<<<<<<<<<<<<<
  *                 # if data in both detectors
  *                 for k in range(sep_len):
  */
       goto __pyx_L27;
     }
 
-    /* "soapcw/soapcw.pyx":447
+    /* "soapcw/soapcw.pyx":449
  *                                     continue
  * 
  *             elif obs1data[0] and not obs2data[0]:             # <<<<<<<<<<<<<<
  *                 o1 = obs1_ind_1d[0][i]
  *                 k,m = 1,1
  */
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs1data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 447, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs1data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 449, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 447, __pyx_L1_error)
+    __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 449, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (__pyx_t_16) {
     } else {
       __pyx_t_17 = __pyx_t_16;
       goto __pyx_L42_bool_binop_done;
     }
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs2data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 447, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs2data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 449, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 447, __pyx_L1_error)
+    __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 449, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_22 = ((!__pyx_t_16) != 0);
-    __pyx_t_17 = __pyx_t_22;
+    __pyx_t_21 = ((!__pyx_t_16) != 0);
+    __pyx_t_17 = __pyx_t_21;
     __pyx_L42_bool_binop_done:;
     if (__pyx_t_17) {
 
-      /* "soapcw/soapcw.pyx":448
+      /* "soapcw/soapcw.pyx":450
  * 
  *             elif obs1data[0] and not obs2data[0]:
  *                 o1 = obs1_ind_1d[0][i]             # <<<<<<<<<<<<<<
  *                 k,m = 1,1
  *                 value = tr[1][k][m] + logarr_1d[o1]
  */
-      if (unlikely(!__pyx_v_obs1_ind_1d.memview)) { __Pyx_RaiseUnboundLocalError("obs1_ind_1d"); __PYX_ERR(0, 448, __pyx_L1_error) }
-      __pyx_t_51 = 0;
-      __pyx_t_52 = __pyx_v_i;
-      __pyx_t_26 = -1;
-      if (__pyx_t_51 < 0) {
-        __pyx_t_51 += __pyx_v_obs1_ind_1d.shape[0];
-        if (unlikely(__pyx_t_51 < 0)) __pyx_t_26 = 0;
-      } else if (unlikely(__pyx_t_51 >= __pyx_v_obs1_ind_1d.shape[0])) __pyx_t_26 = 0;
-      if (__pyx_t_52 < 0) {
-        __pyx_t_52 += __pyx_v_obs1_ind_1d.shape[1];
-        if (unlikely(__pyx_t_52 < 0)) __pyx_t_26 = 1;
-      } else if (unlikely(__pyx_t_52 >= __pyx_v_obs1_ind_1d.shape[1])) __pyx_t_26 = 1;
-      if (unlikely(__pyx_t_26 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_26);
-        __PYX_ERR(0, 448, __pyx_L1_error)
+      if (unlikely(!__pyx_v_obs1_ind_1d.memview)) { __Pyx_RaiseUnboundLocalError("obs1_ind_1d"); __PYX_ERR(0, 450, __pyx_L1_error) }
+      __pyx_t_36 = 0;
+      __pyx_t_35 = __pyx_v_i;
+      __pyx_t_25 = -1;
+      if (__pyx_t_36 < 0) {
+        __pyx_t_36 += __pyx_v_obs1_ind_1d.shape[0];
+        if (unlikely(__pyx_t_36 < 0)) __pyx_t_25 = 0;
+      } else if (unlikely(__pyx_t_36 >= __pyx_v_obs1_ind_1d.shape[0])) __pyx_t_25 = 0;
+      if (__pyx_t_35 < 0) {
+        __pyx_t_35 += __pyx_v_obs1_ind_1d.shape[1];
+        if (unlikely(__pyx_t_35 < 0)) __pyx_t_25 = 1;
+      } else if (unlikely(__pyx_t_35 >= __pyx_v_obs1_ind_1d.shape[1])) __pyx_t_25 = 1;
+      if (unlikely(__pyx_t_25 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_25);
+        __PYX_ERR(0, 450, __pyx_L1_error)
       }
-      __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind_1d.data + __pyx_t_51 * __pyx_v_obs1_ind_1d.strides[0]) ) + __pyx_t_52 * __pyx_v_obs1_ind_1d.strides[1]) )));
+      __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind_1d.data + __pyx_t_36 * __pyx_v_obs1_ind_1d.strides[0]) ) + __pyx_t_35 * __pyx_v_obs1_ind_1d.strides[1]) )));
 
-      /* "soapcw/soapcw.pyx":449
+      /* "soapcw/soapcw.pyx":451
  *             elif obs1data[0] and not obs2data[0]:
  *                 o1 = obs1_ind_1d[0][i]
  *                 k,m = 1,1             # <<<<<<<<<<<<<<
  *                 value = tr[1][k][m] + logarr_1d[o1]
  *             elif obs2data[0] and not obs1data[0]:
  */
+      __pyx_t_25 = 1;
       __pyx_t_26 = 1;
-      __pyx_t_27 = 1;
-      __pyx_v_k = __pyx_t_26;
-      __pyx_v_m = __pyx_t_27;
+      __pyx_v_k = __pyx_t_25;
+      __pyx_v_m = __pyx_t_26;
 
-      /* "soapcw/soapcw.pyx":450
+      /* "soapcw/soapcw.pyx":452
  *                 o1 = obs1_ind_1d[0][i]
  *                 k,m = 1,1
  *                 value = tr[1][k][m] + logarr_1d[o1]             # <<<<<<<<<<<<<<
  *             elif obs2data[0] and not obs1data[0]:
  *                 o2 = obs2_ind_1d[0][i]
  */
-      __pyx_t_53 = 1;
-      __pyx_t_54 = __pyx_v_k;
-      __pyx_t_55 = __pyx_v_m;
-      __pyx_t_27 = -1;
-      if (__pyx_t_53 < 0) {
-        __pyx_t_53 += __pyx_v_tr.shape[0];
-        if (unlikely(__pyx_t_53 < 0)) __pyx_t_27 = 0;
-      } else if (unlikely(__pyx_t_53 >= __pyx_v_tr.shape[0])) __pyx_t_27 = 0;
-      if (__pyx_t_54 < 0) {
-        __pyx_t_54 += __pyx_v_tr.shape[1];
-        if (unlikely(__pyx_t_54 < 0)) __pyx_t_27 = 1;
-      } else if (unlikely(__pyx_t_54 >= __pyx_v_tr.shape[1])) __pyx_t_27 = 1;
-      if (__pyx_t_55 < 0) {
-        __pyx_t_55 += __pyx_v_tr.shape[2];
-        if (unlikely(__pyx_t_55 < 0)) __pyx_t_27 = 2;
-      } else if (unlikely(__pyx_t_55 >= __pyx_v_tr.shape[2])) __pyx_t_27 = 2;
-      if (unlikely(__pyx_t_27 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_27);
-        __PYX_ERR(0, 450, __pyx_L1_error)
+      __pyx_t_35 = 1;
+      __pyx_t_36 = __pyx_v_k;
+      __pyx_t_31 = __pyx_v_m;
+      __pyx_t_26 = -1;
+      if (__pyx_t_35 < 0) {
+        __pyx_t_35 += __pyx_v_tr.shape[0];
+        if (unlikely(__pyx_t_35 < 0)) __pyx_t_26 = 0;
+      } else if (unlikely(__pyx_t_35 >= __pyx_v_tr.shape[0])) __pyx_t_26 = 0;
+      if (__pyx_t_36 < 0) {
+        __pyx_t_36 += __pyx_v_tr.shape[1];
+        if (unlikely(__pyx_t_36 < 0)) __pyx_t_26 = 1;
+      } else if (unlikely(__pyx_t_36 >= __pyx_v_tr.shape[1])) __pyx_t_26 = 1;
+      if (__pyx_t_31 < 0) {
+        __pyx_t_31 += __pyx_v_tr.shape[2];
+        if (unlikely(__pyx_t_31 < 0)) __pyx_t_26 = 2;
+      } else if (unlikely(__pyx_t_31 >= __pyx_v_tr.shape[2])) __pyx_t_26 = 2;
+      if (unlikely(__pyx_t_26 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_26);
+        __PYX_ERR(0, 452, __pyx_L1_error)
       }
-      if (unlikely(!__pyx_v_logarr_1d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_1d"); __PYX_ERR(0, 450, __pyx_L1_error) }
-      __pyx_t_56 = __pyx_v_o1;
-      __pyx_t_27 = -1;
-      if (__pyx_t_56 < 0) {
-        __pyx_t_56 += __pyx_v_logarr_1d.shape[0];
-        if (unlikely(__pyx_t_56 < 0)) __pyx_t_27 = 0;
-      } else if (unlikely(__pyx_t_56 >= __pyx_v_logarr_1d.shape[0])) __pyx_t_27 = 0;
-      if (unlikely(__pyx_t_27 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_27);
-        __PYX_ERR(0, 450, __pyx_L1_error)
+      if (unlikely(!__pyx_v_logarr_1d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_1d"); __PYX_ERR(0, 452, __pyx_L1_error) }
+      __pyx_t_33 = __pyx_v_o1;
+      __pyx_t_26 = -1;
+      if (__pyx_t_33 < 0) {
+        __pyx_t_33 += __pyx_v_logarr_1d.shape[0];
+        if (unlikely(__pyx_t_33 < 0)) __pyx_t_26 = 0;
+      } else if (unlikely(__pyx_t_33 >= __pyx_v_logarr_1d.shape[0])) __pyx_t_26 = 0;
+      if (unlikely(__pyx_t_26 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_26);
+        __PYX_ERR(0, 452, __pyx_L1_error)
       }
-      __pyx_v_value = ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_53 * __pyx_v_tr.strides[0]) ) + __pyx_t_54 * __pyx_v_tr.strides[1]) ) + __pyx_t_55 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr_1d.data + __pyx_t_56 * __pyx_v_logarr_1d.strides[0]) ))));
+      __pyx_v_value = ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_35 * __pyx_v_tr.strides[0]) ) + __pyx_t_36 * __pyx_v_tr.strides[1]) ) + __pyx_t_31 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr_1d.data + __pyx_t_33 * __pyx_v_logarr_1d.strides[0]) ))));
 
-      /* "soapcw/soapcw.pyx":447
+      /* "soapcw/soapcw.pyx":449
  *                                     continue
  * 
  *             elif obs1data[0] and not obs2data[0]:             # <<<<<<<<<<<<<<
  *                 o1 = obs1_ind_1d[0][i]
  *                 k,m = 1,1
  */
       goto __pyx_L27;
     }
 
-    /* "soapcw/soapcw.pyx":451
+    /* "soapcw/soapcw.pyx":453
  *                 k,m = 1,1
  *                 value = tr[1][k][m] + logarr_1d[o1]
  *             elif obs2data[0] and not obs1data[0]:             # <<<<<<<<<<<<<<
  *                 o2 = obs2_ind_1d[0][i]
  *                 k,m = 1,1
  */
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs2data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 451, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs2data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 451, __pyx_L1_error)
+    __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 453, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (__pyx_t_22) {
+    if (__pyx_t_21) {
     } else {
-      __pyx_t_17 = __pyx_t_22;
+      __pyx_t_17 = __pyx_t_21;
       goto __pyx_L44_bool_binop_done;
     }
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs1data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 451, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs1data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 451, __pyx_L1_error)
+    __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 453, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_16 = ((!__pyx_t_22) != 0);
+    __pyx_t_16 = ((!__pyx_t_21) != 0);
     __pyx_t_17 = __pyx_t_16;
     __pyx_L44_bool_binop_done:;
     if (__pyx_t_17) {
 
-      /* "soapcw/soapcw.pyx":452
+      /* "soapcw/soapcw.pyx":454
  *                 value = tr[1][k][m] + logarr_1d[o1]
  *             elif obs2data[0] and not obs1data[0]:
  *                 o2 = obs2_ind_1d[0][i]             # <<<<<<<<<<<<<<
  *                 k,m = 1,1
  *                 value = tr[1][k][m] + logarr_1d[o2]
  */
-      if (unlikely(!__pyx_v_obs2_ind_1d)) { __Pyx_RaiseUnboundLocalError("obs2_ind_1d"); __PYX_ERR(0, 452, __pyx_L1_error) }
-      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs2_ind_1d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 452, __pyx_L1_error)
+      if (unlikely(!__pyx_v_obs2_ind_1d)) { __Pyx_RaiseUnboundLocalError("obs2_ind_1d"); __PYX_ERR(0, 454, __pyx_L1_error) }
+      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs2_ind_1d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 454, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 454, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_27 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_27 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 452, __pyx_L1_error)
+      __pyx_t_26 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_26 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 454, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_v_o2 = __pyx_t_27;
+      __pyx_v_o2 = __pyx_t_26;
 
-      /* "soapcw/soapcw.pyx":453
+      /* "soapcw/soapcw.pyx":455
  *             elif obs2data[0] and not obs1data[0]:
  *                 o2 = obs2_ind_1d[0][i]
  *                 k,m = 1,1             # <<<<<<<<<<<<<<
  *                 value = tr[1][k][m] + logarr_1d[o2]
  *             elif not obs2data[0] and not obs1data[0]:
  */
-      __pyx_t_27 = 1;
       __pyx_t_26 = 1;
-      __pyx_v_k = __pyx_t_27;
-      __pyx_v_m = __pyx_t_26;
+      __pyx_t_25 = 1;
+      __pyx_v_k = __pyx_t_26;
+      __pyx_v_m = __pyx_t_25;
 
-      /* "soapcw/soapcw.pyx":454
+      /* "soapcw/soapcw.pyx":456
  *                 o2 = obs2_ind_1d[0][i]
  *                 k,m = 1,1
  *                 value = tr[1][k][m] + logarr_1d[o2]             # <<<<<<<<<<<<<<
  *             elif not obs2data[0] and not obs1data[0]:
  *                 o1 = obs1_ind_2d[0][i]
  */
-      __pyx_t_57 = 1;
-      __pyx_t_58 = __pyx_v_k;
-      __pyx_t_59 = __pyx_v_m;
-      __pyx_t_26 = -1;
-      if (__pyx_t_57 < 0) {
-        __pyx_t_57 += __pyx_v_tr.shape[0];
-        if (unlikely(__pyx_t_57 < 0)) __pyx_t_26 = 0;
-      } else if (unlikely(__pyx_t_57 >= __pyx_v_tr.shape[0])) __pyx_t_26 = 0;
-      if (__pyx_t_58 < 0) {
-        __pyx_t_58 += __pyx_v_tr.shape[1];
-        if (unlikely(__pyx_t_58 < 0)) __pyx_t_26 = 1;
-      } else if (unlikely(__pyx_t_58 >= __pyx_v_tr.shape[1])) __pyx_t_26 = 1;
-      if (__pyx_t_59 < 0) {
-        __pyx_t_59 += __pyx_v_tr.shape[2];
-        if (unlikely(__pyx_t_59 < 0)) __pyx_t_26 = 2;
-      } else if (unlikely(__pyx_t_59 >= __pyx_v_tr.shape[2])) __pyx_t_26 = 2;
-      if (unlikely(__pyx_t_26 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_26);
-        __PYX_ERR(0, 454, __pyx_L1_error)
+      __pyx_t_33 = 1;
+      __pyx_t_31 = __pyx_v_k;
+      __pyx_t_36 = __pyx_v_m;
+      __pyx_t_25 = -1;
+      if (__pyx_t_33 < 0) {
+        __pyx_t_33 += __pyx_v_tr.shape[0];
+        if (unlikely(__pyx_t_33 < 0)) __pyx_t_25 = 0;
+      } else if (unlikely(__pyx_t_33 >= __pyx_v_tr.shape[0])) __pyx_t_25 = 0;
+      if (__pyx_t_31 < 0) {
+        __pyx_t_31 += __pyx_v_tr.shape[1];
+        if (unlikely(__pyx_t_31 < 0)) __pyx_t_25 = 1;
+      } else if (unlikely(__pyx_t_31 >= __pyx_v_tr.shape[1])) __pyx_t_25 = 1;
+      if (__pyx_t_36 < 0) {
+        __pyx_t_36 += __pyx_v_tr.shape[2];
+        if (unlikely(__pyx_t_36 < 0)) __pyx_t_25 = 2;
+      } else if (unlikely(__pyx_t_36 >= __pyx_v_tr.shape[2])) __pyx_t_25 = 2;
+      if (unlikely(__pyx_t_25 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_25);
+        __PYX_ERR(0, 456, __pyx_L1_error)
       }
-      if (unlikely(!__pyx_v_logarr_1d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_1d"); __PYX_ERR(0, 454, __pyx_L1_error) }
-      __pyx_t_60 = __pyx_v_o2;
-      __pyx_t_26 = -1;
-      if (__pyx_t_60 < 0) {
-        __pyx_t_60 += __pyx_v_logarr_1d.shape[0];
-        if (unlikely(__pyx_t_60 < 0)) __pyx_t_26 = 0;
-      } else if (unlikely(__pyx_t_60 >= __pyx_v_logarr_1d.shape[0])) __pyx_t_26 = 0;
-      if (unlikely(__pyx_t_26 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_26);
-        __PYX_ERR(0, 454, __pyx_L1_error)
+      if (unlikely(!__pyx_v_logarr_1d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_1d"); __PYX_ERR(0, 456, __pyx_L1_error) }
+      __pyx_t_35 = __pyx_v_o2;
+      __pyx_t_25 = -1;
+      if (__pyx_t_35 < 0) {
+        __pyx_t_35 += __pyx_v_logarr_1d.shape[0];
+        if (unlikely(__pyx_t_35 < 0)) __pyx_t_25 = 0;
+      } else if (unlikely(__pyx_t_35 >= __pyx_v_logarr_1d.shape[0])) __pyx_t_25 = 0;
+      if (unlikely(__pyx_t_25 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_25);
+        __PYX_ERR(0, 456, __pyx_L1_error)
       }
-      __pyx_v_value = ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_57 * __pyx_v_tr.strides[0]) ) + __pyx_t_58 * __pyx_v_tr.strides[1]) ) + __pyx_t_59 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr_1d.data + __pyx_t_60 * __pyx_v_logarr_1d.strides[0]) ))));
+      __pyx_v_value = ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_33 * __pyx_v_tr.strides[0]) ) + __pyx_t_31 * __pyx_v_tr.strides[1]) ) + __pyx_t_36 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr_1d.data + __pyx_t_35 * __pyx_v_logarr_1d.strides[0]) ))));
 
-      /* "soapcw/soapcw.pyx":451
+      /* "soapcw/soapcw.pyx":453
  *                 k,m = 1,1
  *                 value = tr[1][k][m] + logarr_1d[o1]
  *             elif obs2data[0] and not obs1data[0]:             # <<<<<<<<<<<<<<
  *                 o2 = obs2_ind_1d[0][i]
  *                 k,m = 1,1
  */
       goto __pyx_L27;
     }
 
-    /* "soapcw/soapcw.pyx":455
+    /* "soapcw/soapcw.pyx":457
  *                 k,m = 1,1
  *                 value = tr[1][k][m] + logarr_1d[o2]
  *             elif not obs2data[0] and not obs1data[0]:             # <<<<<<<<<<<<<<
  *                 o1 = obs1_ind_2d[0][i]
  *                 k,m = 1,1
  */
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 455, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 457, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 455, __pyx_L1_error)
+    __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 457, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_22 = ((!__pyx_t_16) != 0);
-    if (__pyx_t_22) {
+    __pyx_t_21 = ((!__pyx_t_16) != 0);
+    if (__pyx_t_21) {
     } else {
-      __pyx_t_17 = __pyx_t_22;
+      __pyx_t_17 = __pyx_t_21;
       goto __pyx_L46_bool_binop_done;
     }
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs1data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 455, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs1data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 457, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 455, __pyx_L1_error)
+    __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 457, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_16 = ((!__pyx_t_22) != 0);
+    __pyx_t_16 = ((!__pyx_t_21) != 0);
     __pyx_t_17 = __pyx_t_16;
     __pyx_L46_bool_binop_done:;
     if (__pyx_t_17) {
 
-      /* "soapcw/soapcw.pyx":456
+      /* "soapcw/soapcw.pyx":458
  *                 value = tr[1][k][m] + logarr_1d[o2]
  *             elif not obs2data[0] and not obs1data[0]:
  *                 o1 = obs1_ind_2d[0][i]             # <<<<<<<<<<<<<<
  *                 k,m = 1,1
  *                 value = tr[1][k][m] + logarr_1d[o1]
  */
-      if (unlikely(!__pyx_v_obs1_ind_2d.memview)) { __Pyx_RaiseUnboundLocalError("obs1_ind_2d"); __PYX_ERR(0, 456, __pyx_L1_error) }
-      __pyx_t_61 = 0;
-      __pyx_t_62 = __pyx_v_i;
-      __pyx_t_26 = -1;
-      if (__pyx_t_61 < 0) {
-        __pyx_t_61 += __pyx_v_obs1_ind_2d.shape[0];
-        if (unlikely(__pyx_t_61 < 0)) __pyx_t_26 = 0;
-      } else if (unlikely(__pyx_t_61 >= __pyx_v_obs1_ind_2d.shape[0])) __pyx_t_26 = 0;
-      if (__pyx_t_62 < 0) {
-        __pyx_t_62 += __pyx_v_obs1_ind_2d.shape[1];
-        if (unlikely(__pyx_t_62 < 0)) __pyx_t_26 = 1;
-      } else if (unlikely(__pyx_t_62 >= __pyx_v_obs1_ind_2d.shape[1])) __pyx_t_26 = 1;
-      if (unlikely(__pyx_t_26 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_26);
-        __PYX_ERR(0, 456, __pyx_L1_error)
+      if (unlikely(!__pyx_v_obs1_ind_2d.memview)) { __Pyx_RaiseUnboundLocalError("obs1_ind_2d"); __PYX_ERR(0, 458, __pyx_L1_error) }
+      __pyx_t_35 = 0;
+      __pyx_t_36 = __pyx_v_i;
+      __pyx_t_25 = -1;
+      if (__pyx_t_35 < 0) {
+        __pyx_t_35 += __pyx_v_obs1_ind_2d.shape[0];
+        if (unlikely(__pyx_t_35 < 0)) __pyx_t_25 = 0;
+      } else if (unlikely(__pyx_t_35 >= __pyx_v_obs1_ind_2d.shape[0])) __pyx_t_25 = 0;
+      if (__pyx_t_36 < 0) {
+        __pyx_t_36 += __pyx_v_obs1_ind_2d.shape[1];
+        if (unlikely(__pyx_t_36 < 0)) __pyx_t_25 = 1;
+      } else if (unlikely(__pyx_t_36 >= __pyx_v_obs1_ind_2d.shape[1])) __pyx_t_25 = 1;
+      if (unlikely(__pyx_t_25 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_25);
+        __PYX_ERR(0, 458, __pyx_L1_error)
       }
-      __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind_2d.data + __pyx_t_61 * __pyx_v_obs1_ind_2d.strides[0]) ) + __pyx_t_62 * __pyx_v_obs1_ind_2d.strides[1]) )));
+      __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind_2d.data + __pyx_t_35 * __pyx_v_obs1_ind_2d.strides[0]) ) + __pyx_t_36 * __pyx_v_obs1_ind_2d.strides[1]) )));
 
-      /* "soapcw/soapcw.pyx":457
+      /* "soapcw/soapcw.pyx":459
  *             elif not obs2data[0] and not obs1data[0]:
  *                 o1 = obs1_ind_2d[0][i]
  *                 k,m = 1,1             # <<<<<<<<<<<<<<
  *                 value = tr[1][k][m] + logarr_1d[o1]
  * 
  */
+      __pyx_t_25 = 1;
       __pyx_t_26 = 1;
-      __pyx_t_27 = 1;
-      __pyx_v_k = __pyx_t_26;
-      __pyx_v_m = __pyx_t_27;
+      __pyx_v_k = __pyx_t_25;
+      __pyx_v_m = __pyx_t_26;
 
-      /* "soapcw/soapcw.pyx":458
+      /* "soapcw/soapcw.pyx":460
  *                 o1 = obs1_ind_2d[0][i]
  *                 k,m = 1,1
  *                 value = tr[1][k][m] + logarr_1d[o1]             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __pyx_t_63 = 1;
-      __pyx_t_64 = __pyx_v_k;
-      __pyx_t_65 = __pyx_v_m;
-      __pyx_t_27 = -1;
-      if (__pyx_t_63 < 0) {
-        __pyx_t_63 += __pyx_v_tr.shape[0];
-        if (unlikely(__pyx_t_63 < 0)) __pyx_t_27 = 0;
-      } else if (unlikely(__pyx_t_63 >= __pyx_v_tr.shape[0])) __pyx_t_27 = 0;
-      if (__pyx_t_64 < 0) {
-        __pyx_t_64 += __pyx_v_tr.shape[1];
-        if (unlikely(__pyx_t_64 < 0)) __pyx_t_27 = 1;
-      } else if (unlikely(__pyx_t_64 >= __pyx_v_tr.shape[1])) __pyx_t_27 = 1;
-      if (__pyx_t_65 < 0) {
-        __pyx_t_65 += __pyx_v_tr.shape[2];
-        if (unlikely(__pyx_t_65 < 0)) __pyx_t_27 = 2;
-      } else if (unlikely(__pyx_t_65 >= __pyx_v_tr.shape[2])) __pyx_t_27 = 2;
-      if (unlikely(__pyx_t_27 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_27);
-        __PYX_ERR(0, 458, __pyx_L1_error)
+      __pyx_t_36 = 1;
+      __pyx_t_35 = __pyx_v_k;
+      __pyx_t_31 = __pyx_v_m;
+      __pyx_t_26 = -1;
+      if (__pyx_t_36 < 0) {
+        __pyx_t_36 += __pyx_v_tr.shape[0];
+        if (unlikely(__pyx_t_36 < 0)) __pyx_t_26 = 0;
+      } else if (unlikely(__pyx_t_36 >= __pyx_v_tr.shape[0])) __pyx_t_26 = 0;
+      if (__pyx_t_35 < 0) {
+        __pyx_t_35 += __pyx_v_tr.shape[1];
+        if (unlikely(__pyx_t_35 < 0)) __pyx_t_26 = 1;
+      } else if (unlikely(__pyx_t_35 >= __pyx_v_tr.shape[1])) __pyx_t_26 = 1;
+      if (__pyx_t_31 < 0) {
+        __pyx_t_31 += __pyx_v_tr.shape[2];
+        if (unlikely(__pyx_t_31 < 0)) __pyx_t_26 = 2;
+      } else if (unlikely(__pyx_t_31 >= __pyx_v_tr.shape[2])) __pyx_t_26 = 2;
+      if (unlikely(__pyx_t_26 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_26);
+        __PYX_ERR(0, 460, __pyx_L1_error)
       }
-      if (unlikely(!__pyx_v_logarr_1d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_1d"); __PYX_ERR(0, 458, __pyx_L1_error) }
-      __pyx_t_66 = __pyx_v_o1;
-      __pyx_t_27 = -1;
-      if (__pyx_t_66 < 0) {
-        __pyx_t_66 += __pyx_v_logarr_1d.shape[0];
-        if (unlikely(__pyx_t_66 < 0)) __pyx_t_27 = 0;
-      } else if (unlikely(__pyx_t_66 >= __pyx_v_logarr_1d.shape[0])) __pyx_t_27 = 0;
-      if (unlikely(__pyx_t_27 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_27);
-        __PYX_ERR(0, 458, __pyx_L1_error)
+      if (unlikely(!__pyx_v_logarr_1d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_1d"); __PYX_ERR(0, 460, __pyx_L1_error) }
+      __pyx_t_33 = __pyx_v_o1;
+      __pyx_t_26 = -1;
+      if (__pyx_t_33 < 0) {
+        __pyx_t_33 += __pyx_v_logarr_1d.shape[0];
+        if (unlikely(__pyx_t_33 < 0)) __pyx_t_26 = 0;
+      } else if (unlikely(__pyx_t_33 >= __pyx_v_logarr_1d.shape[0])) __pyx_t_26 = 0;
+      if (unlikely(__pyx_t_26 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_26);
+        __PYX_ERR(0, 460, __pyx_L1_error)
       }
-      __pyx_v_value = ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_63 * __pyx_v_tr.strides[0]) ) + __pyx_t_64 * __pyx_v_tr.strides[1]) ) + __pyx_t_65 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr_1d.data + __pyx_t_66 * __pyx_v_logarr_1d.strides[0]) ))));
+      __pyx_v_value = ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_36 * __pyx_v_tr.strides[0]) ) + __pyx_t_35 * __pyx_v_tr.strides[1]) ) + __pyx_t_31 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr_1d.data + __pyx_t_33 * __pyx_v_logarr_1d.strides[0]) ))));
 
-      /* "soapcw/soapcw.pyx":455
+      /* "soapcw/soapcw.pyx":457
  *                 k,m = 1,1
  *                 value = tr[1][k][m] + logarr_1d[o2]
  *             elif not obs2data[0] and not obs1data[0]:             # <<<<<<<<<<<<<<
  *                 o1 = obs1_ind_2d[0][i]
  *                 k,m = 1,1
  */
     }
     __pyx_L27:;
 
-    /* "soapcw/soapcw.pyx":461
+    /* "soapcw/soapcw.pyx":463
  * 
  * 
  *             if value > temp:             # <<<<<<<<<<<<<<
  *                 temp = value
  *                 val[0][i] = temp
  */
     __pyx_t_17 = ((__pyx_v_value > __pyx_v_temp) != 0);
     if (__pyx_t_17) {
 
-      /* "soapcw/soapcw.pyx":462
+      /* "soapcw/soapcw.pyx":464
  * 
  *             if value > temp:
  *                 temp = value             # <<<<<<<<<<<<<<
  *                 val[0][i] = temp
  *                 prev[0][i] =  i
  */
       __pyx_v_temp = __pyx_v_value;
 
-      /* "soapcw/soapcw.pyx":463
+      /* "soapcw/soapcw.pyx":465
  *             if value > temp:
  *                 temp = value
  *                 val[0][i] = temp             # <<<<<<<<<<<<<<
  *                 prev[0][i] =  i
  *                 det1[0][i] =  i+k-1
  */
-      __pyx_t_67 = 0;
-      __pyx_t_68 = __pyx_v_i;
-      __pyx_t_27 = -1;
-      if (__pyx_t_67 < 0) {
-        __pyx_t_67 += __pyx_v_val.shape[0];
-        if (unlikely(__pyx_t_67 < 0)) __pyx_t_27 = 0;
-      } else if (unlikely(__pyx_t_67 >= __pyx_v_val.shape[0])) __pyx_t_27 = 0;
-      if (__pyx_t_68 < 0) {
-        __pyx_t_68 += __pyx_v_val.shape[1];
-        if (unlikely(__pyx_t_68 < 0)) __pyx_t_27 = 1;
-      } else if (unlikely(__pyx_t_68 >= __pyx_v_val.shape[1])) __pyx_t_27 = 1;
-      if (unlikely(__pyx_t_27 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_27);
-        __PYX_ERR(0, 463, __pyx_L1_error)
+      __pyx_t_33 = 0;
+      __pyx_t_31 = __pyx_v_i;
+      __pyx_t_26 = -1;
+      if (__pyx_t_33 < 0) {
+        __pyx_t_33 += __pyx_v_val.shape[0];
+        if (unlikely(__pyx_t_33 < 0)) __pyx_t_26 = 0;
+      } else if (unlikely(__pyx_t_33 >= __pyx_v_val.shape[0])) __pyx_t_26 = 0;
+      if (__pyx_t_31 < 0) {
+        __pyx_t_31 += __pyx_v_val.shape[1];
+        if (unlikely(__pyx_t_31 < 0)) __pyx_t_26 = 1;
+      } else if (unlikely(__pyx_t_31 >= __pyx_v_val.shape[1])) __pyx_t_26 = 1;
+      if (unlikely(__pyx_t_26 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_26);
+        __PYX_ERR(0, 465, __pyx_L1_error)
       }
-      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_67 * __pyx_v_val.strides[0]) ) + __pyx_t_68 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
+      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_33 * __pyx_v_val.strides[0]) ) + __pyx_t_31 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
 
-      /* "soapcw/soapcw.pyx":464
+      /* "soapcw/soapcw.pyx":466
  *                 temp = value
  *                 val[0][i] = temp
  *                 prev[0][i] =  i             # <<<<<<<<<<<<<<
  *                 det1[0][i] =  i+k-1
  *                 det2[0][i] =  i+m-1
  */
-      __pyx_t_69 = 0;
-      __pyx_t_70 = __pyx_v_i;
-      __pyx_t_27 = -1;
-      if (__pyx_t_69 < 0) {
-        __pyx_t_69 += __pyx_v_prev.shape[0];
-        if (unlikely(__pyx_t_69 < 0)) __pyx_t_27 = 0;
-      } else if (unlikely(__pyx_t_69 >= __pyx_v_prev.shape[0])) __pyx_t_27 = 0;
-      if (__pyx_t_70 < 0) {
-        __pyx_t_70 += __pyx_v_prev.shape[1];
-        if (unlikely(__pyx_t_70 < 0)) __pyx_t_27 = 1;
-      } else if (unlikely(__pyx_t_70 >= __pyx_v_prev.shape[1])) __pyx_t_27 = 1;
-      if (unlikely(__pyx_t_27 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_27);
-        __PYX_ERR(0, 464, __pyx_L1_error)
+      __pyx_t_31 = 0;
+      __pyx_t_33 = __pyx_v_i;
+      __pyx_t_26 = -1;
+      if (__pyx_t_31 < 0) {
+        __pyx_t_31 += __pyx_v_prev.shape[0];
+        if (unlikely(__pyx_t_31 < 0)) __pyx_t_26 = 0;
+      } else if (unlikely(__pyx_t_31 >= __pyx_v_prev.shape[0])) __pyx_t_26 = 0;
+      if (__pyx_t_33 < 0) {
+        __pyx_t_33 += __pyx_v_prev.shape[1];
+        if (unlikely(__pyx_t_33 < 0)) __pyx_t_26 = 1;
+      } else if (unlikely(__pyx_t_33 >= __pyx_v_prev.shape[1])) __pyx_t_26 = 1;
+      if (unlikely(__pyx_t_26 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_26);
+        __PYX_ERR(0, 466, __pyx_L1_error)
       }
-      *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_69 * __pyx_v_prev.strides[0]) ) + __pyx_t_70 * __pyx_v_prev.strides[1]) )) = __pyx_v_i;
+      *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_31 * __pyx_v_prev.strides[0]) ) + __pyx_t_33 * __pyx_v_prev.strides[1]) )) = __pyx_v_i;
 
-      /* "soapcw/soapcw.pyx":465
+      /* "soapcw/soapcw.pyx":467
  *                 val[0][i] = temp
  *                 prev[0][i] =  i
  *                 det1[0][i] =  i+k-1             # <<<<<<<<<<<<<<
  *                 det2[0][i] =  i+m-1
  *             else:
  */
-      __pyx_t_71 = 0;
-      __pyx_t_72 = __pyx_v_i;
-      __pyx_t_27 = -1;
-      if (__pyx_t_71 < 0) {
-        __pyx_t_71 += __pyx_v_det1.shape[0];
-        if (unlikely(__pyx_t_71 < 0)) __pyx_t_27 = 0;
-      } else if (unlikely(__pyx_t_71 >= __pyx_v_det1.shape[0])) __pyx_t_27 = 0;
-      if (__pyx_t_72 < 0) {
-        __pyx_t_72 += __pyx_v_det1.shape[1];
-        if (unlikely(__pyx_t_72 < 0)) __pyx_t_27 = 1;
-      } else if (unlikely(__pyx_t_72 >= __pyx_v_det1.shape[1])) __pyx_t_27 = 1;
-      if (unlikely(__pyx_t_27 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_27);
-        __PYX_ERR(0, 465, __pyx_L1_error)
+      __pyx_t_33 = 0;
+      __pyx_t_31 = __pyx_v_i;
+      __pyx_t_26 = -1;
+      if (__pyx_t_33 < 0) {
+        __pyx_t_33 += __pyx_v_det1.shape[0];
+        if (unlikely(__pyx_t_33 < 0)) __pyx_t_26 = 0;
+      } else if (unlikely(__pyx_t_33 >= __pyx_v_det1.shape[0])) __pyx_t_26 = 0;
+      if (__pyx_t_31 < 0) {
+        __pyx_t_31 += __pyx_v_det1.shape[1];
+        if (unlikely(__pyx_t_31 < 0)) __pyx_t_26 = 1;
+      } else if (unlikely(__pyx_t_31 >= __pyx_v_det1.shape[1])) __pyx_t_26 = 1;
+      if (unlikely(__pyx_t_26 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_26);
+        __PYX_ERR(0, 467, __pyx_L1_error)
       }
-      *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_71 * __pyx_v_det1.strides[0]) ) + __pyx_t_72 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - 1);
+      *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_33 * __pyx_v_det1.strides[0]) ) + __pyx_t_31 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - 1);
 
-      /* "soapcw/soapcw.pyx":466
+      /* "soapcw/soapcw.pyx":468
  *                 prev[0][i] =  i
  *                 det1[0][i] =  i+k-1
  *                 det2[0][i] =  i+m-1             # <<<<<<<<<<<<<<
  *             else:
  *                 continue
  */
-      __pyx_t_73 = 0;
-      __pyx_t_74 = __pyx_v_i;
-      __pyx_t_27 = -1;
-      if (__pyx_t_73 < 0) {
-        __pyx_t_73 += __pyx_v_det2.shape[0];
-        if (unlikely(__pyx_t_73 < 0)) __pyx_t_27 = 0;
-      } else if (unlikely(__pyx_t_73 >= __pyx_v_det2.shape[0])) __pyx_t_27 = 0;
-      if (__pyx_t_74 < 0) {
-        __pyx_t_74 += __pyx_v_det2.shape[1];
-        if (unlikely(__pyx_t_74 < 0)) __pyx_t_27 = 1;
-      } else if (unlikely(__pyx_t_74 >= __pyx_v_det2.shape[1])) __pyx_t_27 = 1;
-      if (unlikely(__pyx_t_27 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_27);
-        __PYX_ERR(0, 466, __pyx_L1_error)
+      __pyx_t_31 = 0;
+      __pyx_t_33 = __pyx_v_i;
+      __pyx_t_26 = -1;
+      if (__pyx_t_31 < 0) {
+        __pyx_t_31 += __pyx_v_det2.shape[0];
+        if (unlikely(__pyx_t_31 < 0)) __pyx_t_26 = 0;
+      } else if (unlikely(__pyx_t_31 >= __pyx_v_det2.shape[0])) __pyx_t_26 = 0;
+      if (__pyx_t_33 < 0) {
+        __pyx_t_33 += __pyx_v_det2.shape[1];
+        if (unlikely(__pyx_t_33 < 0)) __pyx_t_26 = 1;
+      } else if (unlikely(__pyx_t_33 >= __pyx_v_det2.shape[1])) __pyx_t_26 = 1;
+      if (unlikely(__pyx_t_26 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_26);
+        __PYX_ERR(0, 468, __pyx_L1_error)
       }
-      *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_73 * __pyx_v_det2.strides[0]) ) + __pyx_t_74 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - 1);
+      *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_31 * __pyx_v_det2.strides[0]) ) + __pyx_t_33 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - 1);
 
-      /* "soapcw/soapcw.pyx":461
+      /* "soapcw/soapcw.pyx":463
  * 
  * 
  *             if value > temp:             # <<<<<<<<<<<<<<
  *                 temp = value
  *                 val[0][i] = temp
  */
       goto __pyx_L48;
     }
 
-    /* "soapcw/soapcw.pyx":468
+    /* "soapcw/soapcw.pyx":470
  *                 det2[0][i] =  i+m-1
  *             else:
  *                 continue             # <<<<<<<<<<<<<<
  * 
  *         # i is current frequency position
  */
     /*else*/ {
       goto __pyx_L25_continue;
     }
     __pyx_L48:;
     __pyx_L25_continue:;
   }
 
-  /* "soapcw/soapcw.pyx":476
+  /* "soapcw/soapcw.pyx":478
  * 
  *         # run main loop
  *         pbar = 0 # progressbar             # <<<<<<<<<<<<<<
  *         for t in range(1,length):
  *             pt = t/(float(length))*100. # progress bar status
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_v_pbar = __pyx_int_0;
 
-  /* "soapcw/soapcw.pyx":477
+  /* "soapcw/soapcw.pyx":479
  *         # run main loop
  *         pbar = 0 # progressbar
  *         for t in range(1,length):             # <<<<<<<<<<<<<<
  *             pt = t/(float(length))*100. # progress bar status
  *             for i in range(width):
  */
-  __pyx_t_23 = __pyx_v_length;
-  __pyx_t_24 = __pyx_t_23;
-  for (__pyx_t_25 = 1; __pyx_t_25 < __pyx_t_24; __pyx_t_25+=1) {
-    __pyx_v_t = __pyx_t_25;
+  __pyx_t_22 = __pyx_v_length;
+  __pyx_t_23 = __pyx_t_22;
+  for (__pyx_t_24 = 1; __pyx_t_24 < __pyx_t_23; __pyx_t_24+=1) {
+    __pyx_v_t = __pyx_t_24;
 
-    /* "soapcw/soapcw.pyx":478
+    /* "soapcw/soapcw.pyx":480
  *         pbar = 0 # progressbar
  *         for t in range(1,length):
  *             pt = t/(float(length))*100. # progress bar status             # <<<<<<<<<<<<<<
  *             for i in range(width):
  *                 temp = -np.inf
  */
     if (unlikely(((double)__pyx_v_length) == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-      __PYX_ERR(0, 478, __pyx_L1_error)
+      __PYX_ERR(0, 480, __pyx_L1_error)
     }
     __pyx_v_pt = ((((double)__pyx_v_t) / ((double)__pyx_v_length)) * 100.);
 
-    /* "soapcw/soapcw.pyx":479
+    /* "soapcw/soapcw.pyx":481
  *         for t in range(1,length):
  *             pt = t/(float(length))*100. # progress bar status
  *             for i in range(width):             # <<<<<<<<<<<<<<
  *                 temp = -np.inf
  *                 for j in range(tr_len):
  */
-    __pyx_t_27 = __pyx_v_width;
-    __pyx_t_26 = __pyx_t_27;
-    for (__pyx_t_28 = 0; __pyx_t_28 < __pyx_t_26; __pyx_t_28+=1) {
-      __pyx_v_i = __pyx_t_28;
+    __pyx_t_26 = __pyx_v_width;
+    __pyx_t_25 = __pyx_t_26;
+    for (__pyx_t_27 = 0; __pyx_t_27 < __pyx_t_25; __pyx_t_27+=1) {
+      __pyx_v_i = __pyx_t_27;
 
-      /* "soapcw/soapcw.pyx":480
+      /* "soapcw/soapcw.pyx":482
  *             pt = t/(float(length))*100. # progress bar status
  *             for i in range(width):
  *                 temp = -np.inf             # <<<<<<<<<<<<<<
  *                 for j in range(tr_len):
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 482, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_inf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 480, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_inf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 482, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Negative(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Negative(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 482, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 480, __pyx_L1_error)
+      __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 482, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_v_temp = __pyx_t_20;
 
-      /* "soapcw/soapcw.pyx":481
+      /* "soapcw/soapcw.pyx":483
  *             for i in range(width):
  *                 temp = -np.inf
  *                 for j in range(tr_len):             # <<<<<<<<<<<<<<
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:
  *                         if obs1data[t] and obs2data[t]:
  */
-      __pyx_t_29 = __pyx_v_tr_len;
-      __pyx_t_30 = __pyx_t_29;
-      for (__pyx_t_31 = 0; __pyx_t_31 < __pyx_t_30; __pyx_t_31+=1) {
-        __pyx_v_j = __pyx_t_31;
+      __pyx_t_28 = __pyx_v_tr_len;
+      __pyx_t_29 = __pyx_t_28;
+      for (__pyx_t_30 = 0; __pyx_t_30 < __pyx_t_29; __pyx_t_30+=1) {
+        __pyx_v_j = __pyx_t_30;
 
-        /* "soapcw/soapcw.pyx":482
+        /* "soapcw/soapcw.pyx":484
  *                 temp = -np.inf
  *                 for j in range(tr_len):
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:             # <<<<<<<<<<<<<<
  *                         if obs1data[t] and obs2data[t]:
  *                             for k in range(sep_len):
  */
         __pyx_t_16 = ((((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist) >= 0) != 0);
@@ -11345,51 +11571,51 @@
           goto __pyx_L56_bool_binop_done;
         }
         __pyx_t_16 = ((((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist) < __pyx_v_width) != 0);
         __pyx_t_17 = __pyx_t_16;
         __pyx_L56_bool_binop_done:;
         if (__pyx_t_17) {
 
-          /* "soapcw/soapcw.pyx":483
+          /* "soapcw/soapcw.pyx":485
  *                 for j in range(tr_len):
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:
  *                         if obs1data[t] and obs2data[t]:             # <<<<<<<<<<<<<<
  *                             for k in range(sep_len):
  *                                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  */
-          __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs1data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 483, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs1data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 485, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 483, __pyx_L1_error)
+          __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 485, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           if (__pyx_t_16) {
           } else {
             __pyx_t_17 = __pyx_t_16;
             goto __pyx_L59_bool_binop_done;
           }
-          __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 483, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 485, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 483, __pyx_L1_error)
+          __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 485, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __pyx_t_17 = __pyx_t_16;
           __pyx_L59_bool_binop_done:;
           if (__pyx_t_17) {
 
-            /* "soapcw/soapcw.pyx":484
+            /* "soapcw/soapcw.pyx":486
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:
  *                         if obs1data[t] and obs2data[t]:
  *                             for k in range(sep_len):             # <<<<<<<<<<<<<<
  *                                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                                     for m in range(sep_len):
  */
-            __pyx_t_35 = __pyx_v_sep_len;
-            __pyx_t_75 = __pyx_t_35;
-            for (__pyx_t_76 = 0; __pyx_t_76 < __pyx_t_75; __pyx_t_76+=1) {
-              __pyx_v_k = __pyx_t_76;
+            __pyx_t_34 = __pyx_v_sep_len;
+            __pyx_t_37 = __pyx_t_34;
+            for (__pyx_t_38 = 0; __pyx_t_38 < __pyx_t_37; __pyx_t_38+=1) {
+              __pyx_v_k = __pyx_t_38;
 
-              /* "soapcw/soapcw.pyx":485
+              /* "soapcw/soapcw.pyx":487
  *                         if obs1data[t] and obs2data[t]:
  *                             for k in range(sep_len):
  *                                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                                     for m in range(sep_len):
  *                                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  */
               __pyx_t_16 = ((((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist) >= (0 + __pyx_v_edge_range)) != 0);
@@ -11399,27 +11625,27 @@
                 goto __pyx_L64_bool_binop_done;
               }
               __pyx_t_16 = ((((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist) < (__pyx_v_width - __pyx_v_edge_range)) != 0);
               __pyx_t_17 = __pyx_t_16;
               __pyx_L64_bool_binop_done:;
               if (__pyx_t_17) {
 
-                /* "soapcw/soapcw.pyx":486
+                /* "soapcw/soapcw.pyx":488
  *                             for k in range(sep_len):
  *                                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                                     for m in range(sep_len):             # <<<<<<<<<<<<<<
  *                                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                                             if sumv:
  */
-                __pyx_t_77 = __pyx_v_sep_len;
-                __pyx_t_78 = __pyx_t_77;
-                for (__pyx_t_79 = 0; __pyx_t_79 < __pyx_t_78; __pyx_t_79+=1) {
-                  __pyx_v_m = __pyx_t_79;
+                __pyx_t_39 = __pyx_v_sep_len;
+                __pyx_t_40 = __pyx_t_39;
+                for (__pyx_t_41 = 0; __pyx_t_41 < __pyx_t_40; __pyx_t_41+=1) {
+                  __pyx_v_m = __pyx_t_41;
 
-                  /* "soapcw/soapcw.pyx":487
+                  /* "soapcw/soapcw.pyx":489
  *                                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                                     for m in range(sep_len):
  *                                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                                             if sumv:
  *                                                 value = tr[j][k][m] + obs1[t][i+k-sep_dist] + obs2[t][i+k-sep_dist] + val[t-1][i+j-tr_dist]
  */
                   __pyx_t_16 = ((((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist) >= (0 + __pyx_v_edge_range)) != 0);
@@ -11429,955 +11655,955 @@
                     goto __pyx_L69_bool_binop_done;
                   }
                   __pyx_t_16 = ((((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist) < (__pyx_v_width - __pyx_v_edge_range)) != 0);
                   __pyx_t_17 = __pyx_t_16;
                   __pyx_L69_bool_binop_done:;
                   if (__pyx_t_17) {
 
-                    /* "soapcw/soapcw.pyx":488
+                    /* "soapcw/soapcw.pyx":490
  *                                     for m in range(sep_len):
  *                                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                                             if sumv:             # <<<<<<<<<<<<<<
  *                                                 value = tr[j][k][m] + obs1[t][i+k-sep_dist] + obs2[t][i+k-sep_dist] + val[t-1][i+j-tr_dist]
  *                                             else:
  */
                     __pyx_t_17 = (__pyx_v_sumv != 0);
                     if (__pyx_t_17) {
 
-                      /* "soapcw/soapcw.pyx":489
+                      /* "soapcw/soapcw.pyx":491
  *                                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                                             if sumv:
  *                                                 value = tr[j][k][m] + obs1[t][i+k-sep_dist] + obs2[t][i+k-sep_dist] + val[t-1][i+j-tr_dist]             # <<<<<<<<<<<<<<
  *                                             else:
  *                                                 o1 = obs1_ind_2d[t][i+k-sep_dist]
  */
-                      __pyx_t_80 = __pyx_v_j;
-                      __pyx_t_81 = __pyx_v_k;
-                      __pyx_t_82 = __pyx_v_m;
-                      __pyx_t_83 = -1;
-                      if (__pyx_t_80 < 0) {
-                        __pyx_t_80 += __pyx_v_tr.shape[0];
-                        if (unlikely(__pyx_t_80 < 0)) __pyx_t_83 = 0;
-                      } else if (unlikely(__pyx_t_80 >= __pyx_v_tr.shape[0])) __pyx_t_83 = 0;
-                      if (__pyx_t_81 < 0) {
-                        __pyx_t_81 += __pyx_v_tr.shape[1];
-                        if (unlikely(__pyx_t_81 < 0)) __pyx_t_83 = 1;
-                      } else if (unlikely(__pyx_t_81 >= __pyx_v_tr.shape[1])) __pyx_t_83 = 1;
-                      if (__pyx_t_82 < 0) {
-                        __pyx_t_82 += __pyx_v_tr.shape[2];
-                        if (unlikely(__pyx_t_82 < 0)) __pyx_t_83 = 2;
-                      } else if (unlikely(__pyx_t_82 >= __pyx_v_tr.shape[2])) __pyx_t_83 = 2;
-                      if (unlikely(__pyx_t_83 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_83);
-                        __PYX_ERR(0, 489, __pyx_L1_error)
+                      __pyx_t_33 = __pyx_v_j;
+                      __pyx_t_31 = __pyx_v_k;
+                      __pyx_t_35 = __pyx_v_m;
+                      __pyx_t_42 = -1;
+                      if (__pyx_t_33 < 0) {
+                        __pyx_t_33 += __pyx_v_tr.shape[0];
+                        if (unlikely(__pyx_t_33 < 0)) __pyx_t_42 = 0;
+                      } else if (unlikely(__pyx_t_33 >= __pyx_v_tr.shape[0])) __pyx_t_42 = 0;
+                      if (__pyx_t_31 < 0) {
+                        __pyx_t_31 += __pyx_v_tr.shape[1];
+                        if (unlikely(__pyx_t_31 < 0)) __pyx_t_42 = 1;
+                      } else if (unlikely(__pyx_t_31 >= __pyx_v_tr.shape[1])) __pyx_t_42 = 1;
+                      if (__pyx_t_35 < 0) {
+                        __pyx_t_35 += __pyx_v_tr.shape[2];
+                        if (unlikely(__pyx_t_35 < 0)) __pyx_t_42 = 2;
+                      } else if (unlikely(__pyx_t_35 >= __pyx_v_tr.shape[2])) __pyx_t_42 = 2;
+                      if (unlikely(__pyx_t_42 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_42);
+                        __PYX_ERR(0, 491, __pyx_L1_error)
                       }
-                      __pyx_t_3 = PyFloat_FromDouble((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_80 * __pyx_v_tr.strides[0]) ) + __pyx_t_81 * __pyx_v_tr.strides[1]) ) + __pyx_t_82 * __pyx_v_tr.strides[2]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 489, __pyx_L1_error)
+                      __pyx_t_3 = PyFloat_FromDouble((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_33 * __pyx_v_tr.strides[0]) ) + __pyx_t_31 * __pyx_v_tr.strides[1]) ) + __pyx_t_35 * __pyx_v_tr.strides[2]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs1, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 489, __pyx_L1_error)
+                      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs1, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 491, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_2);
-                      __pyx_t_83 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
-                      __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_2, __pyx_t_83, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 489, __pyx_L1_error)
+                      __pyx_t_42 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
+                      __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_2, __pyx_t_42, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 491, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_4);
                       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-                      __pyx_t_2 = PyNumber_Add(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 489, __pyx_L1_error)
+                      __pyx_t_2 = PyNumber_Add(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 491, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_2);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                      __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_obs2, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 489, __pyx_L1_error)
+                      __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_obs2, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 491, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_4);
-                      __pyx_t_83 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
-                      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, __pyx_t_83, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 489, __pyx_L1_error)
+                      __pyx_t_42 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
+                      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, __pyx_t_42, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                      __pyx_t_4 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 489, __pyx_L1_error)
+                      __pyx_t_4 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 491, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_4);
                       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      __pyx_t_84 = (__pyx_v_t - 1);
-                      __pyx_t_85 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
-                      __pyx_t_83 = -1;
-                      if (__pyx_t_84 < 0) {
-                        __pyx_t_84 += __pyx_v_val.shape[0];
-                        if (unlikely(__pyx_t_84 < 0)) __pyx_t_83 = 0;
-                      } else if (unlikely(__pyx_t_84 >= __pyx_v_val.shape[0])) __pyx_t_83 = 0;
-                      if (__pyx_t_85 < 0) {
-                        __pyx_t_85 += __pyx_v_val.shape[1];
-                        if (unlikely(__pyx_t_85 < 0)) __pyx_t_83 = 1;
-                      } else if (unlikely(__pyx_t_85 >= __pyx_v_val.shape[1])) __pyx_t_83 = 1;
-                      if (unlikely(__pyx_t_83 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_83);
-                        __PYX_ERR(0, 489, __pyx_L1_error)
+                      __pyx_t_35 = (__pyx_v_t - 1);
+                      __pyx_t_31 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
+                      __pyx_t_42 = -1;
+                      if (__pyx_t_35 < 0) {
+                        __pyx_t_35 += __pyx_v_val.shape[0];
+                        if (unlikely(__pyx_t_35 < 0)) __pyx_t_42 = 0;
+                      } else if (unlikely(__pyx_t_35 >= __pyx_v_val.shape[0])) __pyx_t_42 = 0;
+                      if (__pyx_t_31 < 0) {
+                        __pyx_t_31 += __pyx_v_val.shape[1];
+                        if (unlikely(__pyx_t_31 < 0)) __pyx_t_42 = 1;
+                      } else if (unlikely(__pyx_t_31 >= __pyx_v_val.shape[1])) __pyx_t_42 = 1;
+                      if (unlikely(__pyx_t_42 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_42);
+                        __PYX_ERR(0, 491, __pyx_L1_error)
                       }
-                      __pyx_t_3 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_84 * __pyx_v_val.strides[0]) ) + __pyx_t_85 * __pyx_v_val.strides[1]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 489, __pyx_L1_error)
+                      __pyx_t_3 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_35 * __pyx_v_val.strides[0]) ) + __pyx_t_31 * __pyx_v_val.strides[1]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 489, __pyx_L1_error)
+                      __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 491, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_2);
                       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 489, __pyx_L1_error)
+                      __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 491, __pyx_L1_error)
                       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                       __pyx_v_value = __pyx_t_20;
 
-                      /* "soapcw/soapcw.pyx":488
+                      /* "soapcw/soapcw.pyx":490
  *                                     for m in range(sep_len):
  *                                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                                             if sumv:             # <<<<<<<<<<<<<<
  *                                                 value = tr[j][k][m] + obs1[t][i+k-sep_dist] + obs2[t][i+k-sep_dist] + val[t-1][i+j-tr_dist]
  *                                             else:
  */
                       goto __pyx_L71;
                     }
 
-                    /* "soapcw/soapcw.pyx":491
+                    /* "soapcw/soapcw.pyx":493
  *                                                 value = tr[j][k][m] + obs1[t][i+k-sep_dist] + obs2[t][i+k-sep_dist] + val[t-1][i+j-tr_dist]
  *                                             else:
  *                                                 o1 = obs1_ind_2d[t][i+k-sep_dist]             # <<<<<<<<<<<<<<
  *                                                 o2 = obs2_ind_2d[t][i+m-sep_dist]
  *                                                 value = tr[j][k][m] + logarr_2d[o1,o2] + val[t-1][i+j-tr_dist]
  */
                     /*else*/ {
-                      if (unlikely(!__pyx_v_obs1_ind_2d.memview)) { __Pyx_RaiseUnboundLocalError("obs1_ind_2d"); __PYX_ERR(0, 491, __pyx_L1_error) }
-                      __pyx_t_86 = __pyx_v_t;
-                      __pyx_t_87 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
-                      __pyx_t_83 = -1;
-                      if (__pyx_t_86 < 0) {
-                        __pyx_t_86 += __pyx_v_obs1_ind_2d.shape[0];
-                        if (unlikely(__pyx_t_86 < 0)) __pyx_t_83 = 0;
-                      } else if (unlikely(__pyx_t_86 >= __pyx_v_obs1_ind_2d.shape[0])) __pyx_t_83 = 0;
-                      if (__pyx_t_87 < 0) {
-                        __pyx_t_87 += __pyx_v_obs1_ind_2d.shape[1];
-                        if (unlikely(__pyx_t_87 < 0)) __pyx_t_83 = 1;
-                      } else if (unlikely(__pyx_t_87 >= __pyx_v_obs1_ind_2d.shape[1])) __pyx_t_83 = 1;
-                      if (unlikely(__pyx_t_83 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_83);
-                        __PYX_ERR(0, 491, __pyx_L1_error)
+                      if (unlikely(!__pyx_v_obs1_ind_2d.memview)) { __Pyx_RaiseUnboundLocalError("obs1_ind_2d"); __PYX_ERR(0, 493, __pyx_L1_error) }
+                      __pyx_t_31 = __pyx_v_t;
+                      __pyx_t_35 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
+                      __pyx_t_42 = -1;
+                      if (__pyx_t_31 < 0) {
+                        __pyx_t_31 += __pyx_v_obs1_ind_2d.shape[0];
+                        if (unlikely(__pyx_t_31 < 0)) __pyx_t_42 = 0;
+                      } else if (unlikely(__pyx_t_31 >= __pyx_v_obs1_ind_2d.shape[0])) __pyx_t_42 = 0;
+                      if (__pyx_t_35 < 0) {
+                        __pyx_t_35 += __pyx_v_obs1_ind_2d.shape[1];
+                        if (unlikely(__pyx_t_35 < 0)) __pyx_t_42 = 1;
+                      } else if (unlikely(__pyx_t_35 >= __pyx_v_obs1_ind_2d.shape[1])) __pyx_t_42 = 1;
+                      if (unlikely(__pyx_t_42 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_42);
+                        __PYX_ERR(0, 493, __pyx_L1_error)
                       }
-                      __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind_2d.data + __pyx_t_86 * __pyx_v_obs1_ind_2d.strides[0]) ) + __pyx_t_87 * __pyx_v_obs1_ind_2d.strides[1]) )));
+                      __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind_2d.data + __pyx_t_31 * __pyx_v_obs1_ind_2d.strides[0]) ) + __pyx_t_35 * __pyx_v_obs1_ind_2d.strides[1]) )));
 
-                      /* "soapcw/soapcw.pyx":492
+                      /* "soapcw/soapcw.pyx":494
  *                                             else:
  *                                                 o1 = obs1_ind_2d[t][i+k-sep_dist]
  *                                                 o2 = obs2_ind_2d[t][i+m-sep_dist]             # <<<<<<<<<<<<<<
  *                                                 value = tr[j][k][m] + logarr_2d[o1,o2] + val[t-1][i+j-tr_dist]
  * 
  */
-                      if (unlikely(!__pyx_v_obs2_ind_2d)) { __Pyx_RaiseUnboundLocalError("obs2_ind_2d"); __PYX_ERR(0, 492, __pyx_L1_error) }
-                      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs2_ind_2d, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 492, __pyx_L1_error)
+                      if (unlikely(!__pyx_v_obs2_ind_2d)) { __Pyx_RaiseUnboundLocalError("obs2_ind_2d"); __PYX_ERR(0, 494, __pyx_L1_error) }
+                      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs2_ind_2d, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 494, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_2);
-                      __pyx_t_83 = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
-                      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_t_83, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 492, __pyx_L1_error)
+                      __pyx_t_42 = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
+                      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_t_42, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 494, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-                      __pyx_t_83 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_83 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 492, __pyx_L1_error)
+                      __pyx_t_42 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_42 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 494, __pyx_L1_error)
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      __pyx_v_o2 = __pyx_t_83;
+                      __pyx_v_o2 = __pyx_t_42;
 
-                      /* "soapcw/soapcw.pyx":493
+                      /* "soapcw/soapcw.pyx":495
  *                                                 o1 = obs1_ind_2d[t][i+k-sep_dist]
  *                                                 o2 = obs2_ind_2d[t][i+m-sep_dist]
  *                                                 value = tr[j][k][m] + logarr_2d[o1,o2] + val[t-1][i+j-tr_dist]             # <<<<<<<<<<<<<<
  * 
  *                                             if value > temp:
  */
-                      __pyx_t_88 = __pyx_v_j;
-                      __pyx_t_89 = __pyx_v_k;
-                      __pyx_t_90 = __pyx_v_m;
-                      __pyx_t_83 = -1;
-                      if (__pyx_t_88 < 0) {
-                        __pyx_t_88 += __pyx_v_tr.shape[0];
-                        if (unlikely(__pyx_t_88 < 0)) __pyx_t_83 = 0;
-                      } else if (unlikely(__pyx_t_88 >= __pyx_v_tr.shape[0])) __pyx_t_83 = 0;
-                      if (__pyx_t_89 < 0) {
-                        __pyx_t_89 += __pyx_v_tr.shape[1];
-                        if (unlikely(__pyx_t_89 < 0)) __pyx_t_83 = 1;
-                      } else if (unlikely(__pyx_t_89 >= __pyx_v_tr.shape[1])) __pyx_t_83 = 1;
-                      if (__pyx_t_90 < 0) {
-                        __pyx_t_90 += __pyx_v_tr.shape[2];
-                        if (unlikely(__pyx_t_90 < 0)) __pyx_t_83 = 2;
-                      } else if (unlikely(__pyx_t_90 >= __pyx_v_tr.shape[2])) __pyx_t_83 = 2;
-                      if (unlikely(__pyx_t_83 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_83);
-                        __PYX_ERR(0, 493, __pyx_L1_error)
+                      __pyx_t_35 = __pyx_v_j;
+                      __pyx_t_31 = __pyx_v_k;
+                      __pyx_t_33 = __pyx_v_m;
+                      __pyx_t_42 = -1;
+                      if (__pyx_t_35 < 0) {
+                        __pyx_t_35 += __pyx_v_tr.shape[0];
+                        if (unlikely(__pyx_t_35 < 0)) __pyx_t_42 = 0;
+                      } else if (unlikely(__pyx_t_35 >= __pyx_v_tr.shape[0])) __pyx_t_42 = 0;
+                      if (__pyx_t_31 < 0) {
+                        __pyx_t_31 += __pyx_v_tr.shape[1];
+                        if (unlikely(__pyx_t_31 < 0)) __pyx_t_42 = 1;
+                      } else if (unlikely(__pyx_t_31 >= __pyx_v_tr.shape[1])) __pyx_t_42 = 1;
+                      if (__pyx_t_33 < 0) {
+                        __pyx_t_33 += __pyx_v_tr.shape[2];
+                        if (unlikely(__pyx_t_33 < 0)) __pyx_t_42 = 2;
+                      } else if (unlikely(__pyx_t_33 >= __pyx_v_tr.shape[2])) __pyx_t_42 = 2;
+                      if (unlikely(__pyx_t_42 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_42);
+                        __PYX_ERR(0, 495, __pyx_L1_error)
                       }
-                      if (unlikely(!__pyx_v_logarr_2d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_2d"); __PYX_ERR(0, 493, __pyx_L1_error) }
-                      __pyx_t_91 = __pyx_v_o1;
-                      __pyx_t_92 = __pyx_v_o2;
-                      __pyx_t_83 = -1;
-                      if (__pyx_t_91 < 0) {
-                        __pyx_t_91 += __pyx_v_logarr_2d.shape[0];
-                        if (unlikely(__pyx_t_91 < 0)) __pyx_t_83 = 0;
-                      } else if (unlikely(__pyx_t_91 >= __pyx_v_logarr_2d.shape[0])) __pyx_t_83 = 0;
-                      if (__pyx_t_92 < 0) {
-                        __pyx_t_92 += __pyx_v_logarr_2d.shape[1];
-                        if (unlikely(__pyx_t_92 < 0)) __pyx_t_83 = 1;
-                      } else if (unlikely(__pyx_t_92 >= __pyx_v_logarr_2d.shape[1])) __pyx_t_83 = 1;
-                      if (unlikely(__pyx_t_83 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_83);
-                        __PYX_ERR(0, 493, __pyx_L1_error)
+                      if (unlikely(!__pyx_v_logarr_2d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_2d"); __PYX_ERR(0, 495, __pyx_L1_error) }
+                      __pyx_t_36 = __pyx_v_o1;
+                      __pyx_t_32 = __pyx_v_o2;
+                      __pyx_t_42 = -1;
+                      if (__pyx_t_36 < 0) {
+                        __pyx_t_36 += __pyx_v_logarr_2d.shape[0];
+                        if (unlikely(__pyx_t_36 < 0)) __pyx_t_42 = 0;
+                      } else if (unlikely(__pyx_t_36 >= __pyx_v_logarr_2d.shape[0])) __pyx_t_42 = 0;
+                      if (__pyx_t_32 < 0) {
+                        __pyx_t_32 += __pyx_v_logarr_2d.shape[1];
+                        if (unlikely(__pyx_t_32 < 0)) __pyx_t_42 = 1;
+                      } else if (unlikely(__pyx_t_32 >= __pyx_v_logarr_2d.shape[1])) __pyx_t_42 = 1;
+                      if (unlikely(__pyx_t_42 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_42);
+                        __PYX_ERR(0, 495, __pyx_L1_error)
                       }
-                      __pyx_t_93 = (__pyx_v_t - 1);
-                      __pyx_t_94 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
-                      __pyx_t_83 = -1;
-                      if (__pyx_t_93 < 0) {
-                        __pyx_t_93 += __pyx_v_val.shape[0];
-                        if (unlikely(__pyx_t_93 < 0)) __pyx_t_83 = 0;
-                      } else if (unlikely(__pyx_t_93 >= __pyx_v_val.shape[0])) __pyx_t_83 = 0;
-                      if (__pyx_t_94 < 0) {
-                        __pyx_t_94 += __pyx_v_val.shape[1];
-                        if (unlikely(__pyx_t_94 < 0)) __pyx_t_83 = 1;
-                      } else if (unlikely(__pyx_t_94 >= __pyx_v_val.shape[1])) __pyx_t_83 = 1;
-                      if (unlikely(__pyx_t_83 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_83);
-                        __PYX_ERR(0, 493, __pyx_L1_error)
+                      __pyx_t_43 = (__pyx_v_t - 1);
+                      __pyx_t_44 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
+                      __pyx_t_42 = -1;
+                      if (__pyx_t_43 < 0) {
+                        __pyx_t_43 += __pyx_v_val.shape[0];
+                        if (unlikely(__pyx_t_43 < 0)) __pyx_t_42 = 0;
+                      } else if (unlikely(__pyx_t_43 >= __pyx_v_val.shape[0])) __pyx_t_42 = 0;
+                      if (__pyx_t_44 < 0) {
+                        __pyx_t_44 += __pyx_v_val.shape[1];
+                        if (unlikely(__pyx_t_44 < 0)) __pyx_t_42 = 1;
+                      } else if (unlikely(__pyx_t_44 >= __pyx_v_val.shape[1])) __pyx_t_42 = 1;
+                      if (unlikely(__pyx_t_42 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_42);
+                        __PYX_ERR(0, 495, __pyx_L1_error)
                       }
-                      __pyx_v_value = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_88 * __pyx_v_tr.strides[0]) ) + __pyx_t_89 * __pyx_v_tr.strides[1]) ) + __pyx_t_90 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_logarr_2d.data + __pyx_t_91 * __pyx_v_logarr_2d.strides[0]) ) + __pyx_t_92 * __pyx_v_logarr_2d.strides[1]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_93 * __pyx_v_val.strides[0]) ) + __pyx_t_94 * __pyx_v_val.strides[1]) ))));
+                      __pyx_v_value = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_35 * __pyx_v_tr.strides[0]) ) + __pyx_t_31 * __pyx_v_tr.strides[1]) ) + __pyx_t_33 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_logarr_2d.data + __pyx_t_36 * __pyx_v_logarr_2d.strides[0]) ) + __pyx_t_32 * __pyx_v_logarr_2d.strides[1]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_43 * __pyx_v_val.strides[0]) ) + __pyx_t_44 * __pyx_v_val.strides[1]) ))));
                     }
                     __pyx_L71:;
 
-                    /* "soapcw/soapcw.pyx":495
+                    /* "soapcw/soapcw.pyx":497
  *                                                 value = tr[j][k][m] + logarr_2d[o1,o2] + val[t-1][i+j-tr_dist]
  * 
  *                                             if value > temp:             # <<<<<<<<<<<<<<
  *                                                 temp = value
  *                                                 val[t][i] = temp
  */
                     __pyx_t_17 = ((__pyx_v_value > __pyx_v_temp) != 0);
                     if (__pyx_t_17) {
 
-                      /* "soapcw/soapcw.pyx":496
+                      /* "soapcw/soapcw.pyx":498
  * 
  *                                             if value > temp:
  *                                                 temp = value             # <<<<<<<<<<<<<<
  *                                                 val[t][i] = temp
  *                                                 prev[t][i] =  i+j-tr_dist
  */
                       __pyx_v_temp = __pyx_v_value;
 
-                      /* "soapcw/soapcw.pyx":497
+                      /* "soapcw/soapcw.pyx":499
  *                                             if value > temp:
  *                                                 temp = value
  *                                                 val[t][i] = temp             # <<<<<<<<<<<<<<
  *                                                 prev[t][i] =  i+j-tr_dist
  *                                                 det1[t][i] =  i+k-sep_dist
  */
-                      __pyx_t_95 = __pyx_v_t;
-                      __pyx_t_96 = __pyx_v_i;
-                      __pyx_t_83 = -1;
-                      if (__pyx_t_95 < 0) {
-                        __pyx_t_95 += __pyx_v_val.shape[0];
-                        if (unlikely(__pyx_t_95 < 0)) __pyx_t_83 = 0;
-                      } else if (unlikely(__pyx_t_95 >= __pyx_v_val.shape[0])) __pyx_t_83 = 0;
-                      if (__pyx_t_96 < 0) {
-                        __pyx_t_96 += __pyx_v_val.shape[1];
-                        if (unlikely(__pyx_t_96 < 0)) __pyx_t_83 = 1;
-                      } else if (unlikely(__pyx_t_96 >= __pyx_v_val.shape[1])) __pyx_t_83 = 1;
-                      if (unlikely(__pyx_t_83 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_83);
-                        __PYX_ERR(0, 497, __pyx_L1_error)
+                      __pyx_t_44 = __pyx_v_t;
+                      __pyx_t_43 = __pyx_v_i;
+                      __pyx_t_42 = -1;
+                      if (__pyx_t_44 < 0) {
+                        __pyx_t_44 += __pyx_v_val.shape[0];
+                        if (unlikely(__pyx_t_44 < 0)) __pyx_t_42 = 0;
+                      } else if (unlikely(__pyx_t_44 >= __pyx_v_val.shape[0])) __pyx_t_42 = 0;
+                      if (__pyx_t_43 < 0) {
+                        __pyx_t_43 += __pyx_v_val.shape[1];
+                        if (unlikely(__pyx_t_43 < 0)) __pyx_t_42 = 1;
+                      } else if (unlikely(__pyx_t_43 >= __pyx_v_val.shape[1])) __pyx_t_42 = 1;
+                      if (unlikely(__pyx_t_42 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_42);
+                        __PYX_ERR(0, 499, __pyx_L1_error)
                       }
-                      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_95 * __pyx_v_val.strides[0]) ) + __pyx_t_96 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
+                      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_44 * __pyx_v_val.strides[0]) ) + __pyx_t_43 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
 
-                      /* "soapcw/soapcw.pyx":498
+                      /* "soapcw/soapcw.pyx":500
  *                                                 temp = value
  *                                                 val[t][i] = temp
  *                                                 prev[t][i] =  i+j-tr_dist             # <<<<<<<<<<<<<<
  *                                                 det1[t][i] =  i+k-sep_dist
  *                                                 det2[t][i] =  i+m-sep_dist
  */
-                      __pyx_t_97 = __pyx_v_t;
-                      __pyx_t_98 = __pyx_v_i;
-                      __pyx_t_83 = -1;
-                      if (__pyx_t_97 < 0) {
-                        __pyx_t_97 += __pyx_v_prev.shape[0];
-                        if (unlikely(__pyx_t_97 < 0)) __pyx_t_83 = 0;
-                      } else if (unlikely(__pyx_t_97 >= __pyx_v_prev.shape[0])) __pyx_t_83 = 0;
-                      if (__pyx_t_98 < 0) {
-                        __pyx_t_98 += __pyx_v_prev.shape[1];
-                        if (unlikely(__pyx_t_98 < 0)) __pyx_t_83 = 1;
-                      } else if (unlikely(__pyx_t_98 >= __pyx_v_prev.shape[1])) __pyx_t_83 = 1;
-                      if (unlikely(__pyx_t_83 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_83);
-                        __PYX_ERR(0, 498, __pyx_L1_error)
+                      __pyx_t_43 = __pyx_v_t;
+                      __pyx_t_44 = __pyx_v_i;
+                      __pyx_t_42 = -1;
+                      if (__pyx_t_43 < 0) {
+                        __pyx_t_43 += __pyx_v_prev.shape[0];
+                        if (unlikely(__pyx_t_43 < 0)) __pyx_t_42 = 0;
+                      } else if (unlikely(__pyx_t_43 >= __pyx_v_prev.shape[0])) __pyx_t_42 = 0;
+                      if (__pyx_t_44 < 0) {
+                        __pyx_t_44 += __pyx_v_prev.shape[1];
+                        if (unlikely(__pyx_t_44 < 0)) __pyx_t_42 = 1;
+                      } else if (unlikely(__pyx_t_44 >= __pyx_v_prev.shape[1])) __pyx_t_42 = 1;
+                      if (unlikely(__pyx_t_42 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_42);
+                        __PYX_ERR(0, 500, __pyx_L1_error)
                       }
-                      *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_97 * __pyx_v_prev.strides[0]) ) + __pyx_t_98 * __pyx_v_prev.strides[1]) )) = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
+                      *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_43 * __pyx_v_prev.strides[0]) ) + __pyx_t_44 * __pyx_v_prev.strides[1]) )) = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
 
-                      /* "soapcw/soapcw.pyx":499
+                      /* "soapcw/soapcw.pyx":501
  *                                                 val[t][i] = temp
  *                                                 prev[t][i] =  i+j-tr_dist
  *                                                 det1[t][i] =  i+k-sep_dist             # <<<<<<<<<<<<<<
  *                                                 det2[t][i] =  i+m-sep_dist
  *                                             else:
  */
-                      __pyx_t_99 = __pyx_v_t;
-                      __pyx_t_100 = __pyx_v_i;
-                      __pyx_t_83 = -1;
-                      if (__pyx_t_99 < 0) {
-                        __pyx_t_99 += __pyx_v_det1.shape[0];
-                        if (unlikely(__pyx_t_99 < 0)) __pyx_t_83 = 0;
-                      } else if (unlikely(__pyx_t_99 >= __pyx_v_det1.shape[0])) __pyx_t_83 = 0;
-                      if (__pyx_t_100 < 0) {
-                        __pyx_t_100 += __pyx_v_det1.shape[1];
-                        if (unlikely(__pyx_t_100 < 0)) __pyx_t_83 = 1;
-                      } else if (unlikely(__pyx_t_100 >= __pyx_v_det1.shape[1])) __pyx_t_83 = 1;
-                      if (unlikely(__pyx_t_83 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_83);
-                        __PYX_ERR(0, 499, __pyx_L1_error)
+                      __pyx_t_44 = __pyx_v_t;
+                      __pyx_t_43 = __pyx_v_i;
+                      __pyx_t_42 = -1;
+                      if (__pyx_t_44 < 0) {
+                        __pyx_t_44 += __pyx_v_det1.shape[0];
+                        if (unlikely(__pyx_t_44 < 0)) __pyx_t_42 = 0;
+                      } else if (unlikely(__pyx_t_44 >= __pyx_v_det1.shape[0])) __pyx_t_42 = 0;
+                      if (__pyx_t_43 < 0) {
+                        __pyx_t_43 += __pyx_v_det1.shape[1];
+                        if (unlikely(__pyx_t_43 < 0)) __pyx_t_42 = 1;
+                      } else if (unlikely(__pyx_t_43 >= __pyx_v_det1.shape[1])) __pyx_t_42 = 1;
+                      if (unlikely(__pyx_t_42 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_42);
+                        __PYX_ERR(0, 501, __pyx_L1_error)
                       }
-                      *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_99 * __pyx_v_det1.strides[0]) ) + __pyx_t_100 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
+                      *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_44 * __pyx_v_det1.strides[0]) ) + __pyx_t_43 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
 
-                      /* "soapcw/soapcw.pyx":500
+                      /* "soapcw/soapcw.pyx":502
  *                                                 prev[t][i] =  i+j-tr_dist
  *                                                 det1[t][i] =  i+k-sep_dist
  *                                                 det2[t][i] =  i+m-sep_dist             # <<<<<<<<<<<<<<
  *                                             else:
  *                                                 continue
  */
-                      __pyx_t_101 = __pyx_v_t;
-                      __pyx_t_102 = __pyx_v_i;
-                      __pyx_t_83 = -1;
-                      if (__pyx_t_101 < 0) {
-                        __pyx_t_101 += __pyx_v_det2.shape[0];
-                        if (unlikely(__pyx_t_101 < 0)) __pyx_t_83 = 0;
-                      } else if (unlikely(__pyx_t_101 >= __pyx_v_det2.shape[0])) __pyx_t_83 = 0;
-                      if (__pyx_t_102 < 0) {
-                        __pyx_t_102 += __pyx_v_det2.shape[1];
-                        if (unlikely(__pyx_t_102 < 0)) __pyx_t_83 = 1;
-                      } else if (unlikely(__pyx_t_102 >= __pyx_v_det2.shape[1])) __pyx_t_83 = 1;
-                      if (unlikely(__pyx_t_83 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_83);
-                        __PYX_ERR(0, 500, __pyx_L1_error)
+                      __pyx_t_43 = __pyx_v_t;
+                      __pyx_t_44 = __pyx_v_i;
+                      __pyx_t_42 = -1;
+                      if (__pyx_t_43 < 0) {
+                        __pyx_t_43 += __pyx_v_det2.shape[0];
+                        if (unlikely(__pyx_t_43 < 0)) __pyx_t_42 = 0;
+                      } else if (unlikely(__pyx_t_43 >= __pyx_v_det2.shape[0])) __pyx_t_42 = 0;
+                      if (__pyx_t_44 < 0) {
+                        __pyx_t_44 += __pyx_v_det2.shape[1];
+                        if (unlikely(__pyx_t_44 < 0)) __pyx_t_42 = 1;
+                      } else if (unlikely(__pyx_t_44 >= __pyx_v_det2.shape[1])) __pyx_t_42 = 1;
+                      if (unlikely(__pyx_t_42 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_42);
+                        __PYX_ERR(0, 502, __pyx_L1_error)
                       }
-                      *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_101 * __pyx_v_det2.strides[0]) ) + __pyx_t_102 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
+                      *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_43 * __pyx_v_det2.strides[0]) ) + __pyx_t_44 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
 
-                      /* "soapcw/soapcw.pyx":495
+                      /* "soapcw/soapcw.pyx":497
  *                                                 value = tr[j][k][m] + logarr_2d[o1,o2] + val[t-1][i+j-tr_dist]
  * 
  *                                             if value > temp:             # <<<<<<<<<<<<<<
  *                                                 temp = value
  *                                                 val[t][i] = temp
  */
                       goto __pyx_L72;
                     }
 
-                    /* "soapcw/soapcw.pyx":502
+                    /* "soapcw/soapcw.pyx":504
  *                                                 det2[t][i] =  i+m-sep_dist
  *                                             else:
  *                                                 continue             # <<<<<<<<<<<<<<
  *                         else:
  *                             if obs1data[t] and not obs2data[t]:
  */
                     /*else*/ {
                       goto __pyx_L66_continue;
                     }
                     __pyx_L72:;
 
-                    /* "soapcw/soapcw.pyx":487
+                    /* "soapcw/soapcw.pyx":489
  *                                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                                     for m in range(sep_len):
  *                                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                                             if sumv:
  *                                                 value = tr[j][k][m] + obs1[t][i+k-sep_dist] + obs2[t][i+k-sep_dist] + val[t-1][i+j-tr_dist]
  */
                   }
                   __pyx_L66_continue:;
                 }
 
-                /* "soapcw/soapcw.pyx":485
+                /* "soapcw/soapcw.pyx":487
  *                         if obs1data[t] and obs2data[t]:
  *                             for k in range(sep_len):
  *                                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                                     for m in range(sep_len):
  *                                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  */
               }
             }
 
-            /* "soapcw/soapcw.pyx":483
+            /* "soapcw/soapcw.pyx":485
  *                 for j in range(tr_len):
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:
  *                         if obs1data[t] and obs2data[t]:             # <<<<<<<<<<<<<<
  *                             for k in range(sep_len):
  *                                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  */
             goto __pyx_L58;
           }
 
-          /* "soapcw/soapcw.pyx":504
+          /* "soapcw/soapcw.pyx":506
  *                                                 continue
  *                         else:
  *                             if obs1data[t] and not obs2data[t]:             # <<<<<<<<<<<<<<
  *                                 o1 = obs1_ind_1d[t][i]
  *                                 k,m = 1,1
  */
           /*else*/ {
-            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs1data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 504, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs1data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 504, __pyx_L1_error)
+            __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 506, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
             if (__pyx_t_16) {
             } else {
               __pyx_t_17 = __pyx_t_16;
               goto __pyx_L74_bool_binop_done;
             }
-            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 504, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 504, __pyx_L1_error)
+            __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 506, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            __pyx_t_22 = ((!__pyx_t_16) != 0);
-            __pyx_t_17 = __pyx_t_22;
+            __pyx_t_21 = ((!__pyx_t_16) != 0);
+            __pyx_t_17 = __pyx_t_21;
             __pyx_L74_bool_binop_done:;
             if (__pyx_t_17) {
 
-              /* "soapcw/soapcw.pyx":505
+              /* "soapcw/soapcw.pyx":507
  *                         else:
  *                             if obs1data[t] and not obs2data[t]:
  *                                 o1 = obs1_ind_1d[t][i]             # <<<<<<<<<<<<<<
  *                                 k,m = 1,1
  *                                 value = tr[j][k][m] + logarr_1d[o1] + val[t-1][i+j-tr_dist]
  */
-              if (unlikely(!__pyx_v_obs1_ind_1d.memview)) { __Pyx_RaiseUnboundLocalError("obs1_ind_1d"); __PYX_ERR(0, 505, __pyx_L1_error) }
-              __pyx_t_103 = __pyx_v_t;
-              __pyx_t_104 = __pyx_v_i;
-              __pyx_t_35 = -1;
-              if (__pyx_t_103 < 0) {
-                __pyx_t_103 += __pyx_v_obs1_ind_1d.shape[0];
-                if (unlikely(__pyx_t_103 < 0)) __pyx_t_35 = 0;
-              } else if (unlikely(__pyx_t_103 >= __pyx_v_obs1_ind_1d.shape[0])) __pyx_t_35 = 0;
-              if (__pyx_t_104 < 0) {
-                __pyx_t_104 += __pyx_v_obs1_ind_1d.shape[1];
-                if (unlikely(__pyx_t_104 < 0)) __pyx_t_35 = 1;
-              } else if (unlikely(__pyx_t_104 >= __pyx_v_obs1_ind_1d.shape[1])) __pyx_t_35 = 1;
-              if (unlikely(__pyx_t_35 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                __PYX_ERR(0, 505, __pyx_L1_error)
+              if (unlikely(!__pyx_v_obs1_ind_1d.memview)) { __Pyx_RaiseUnboundLocalError("obs1_ind_1d"); __PYX_ERR(0, 507, __pyx_L1_error) }
+              __pyx_t_44 = __pyx_v_t;
+              __pyx_t_43 = __pyx_v_i;
+              __pyx_t_34 = -1;
+              if (__pyx_t_44 < 0) {
+                __pyx_t_44 += __pyx_v_obs1_ind_1d.shape[0];
+                if (unlikely(__pyx_t_44 < 0)) __pyx_t_34 = 0;
+              } else if (unlikely(__pyx_t_44 >= __pyx_v_obs1_ind_1d.shape[0])) __pyx_t_34 = 0;
+              if (__pyx_t_43 < 0) {
+                __pyx_t_43 += __pyx_v_obs1_ind_1d.shape[1];
+                if (unlikely(__pyx_t_43 < 0)) __pyx_t_34 = 1;
+              } else if (unlikely(__pyx_t_43 >= __pyx_v_obs1_ind_1d.shape[1])) __pyx_t_34 = 1;
+              if (unlikely(__pyx_t_34 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                __PYX_ERR(0, 507, __pyx_L1_error)
               }
-              __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind_1d.data + __pyx_t_103 * __pyx_v_obs1_ind_1d.strides[0]) ) + __pyx_t_104 * __pyx_v_obs1_ind_1d.strides[1]) )));
+              __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind_1d.data + __pyx_t_44 * __pyx_v_obs1_ind_1d.strides[0]) ) + __pyx_t_43 * __pyx_v_obs1_ind_1d.strides[1]) )));
 
-              /* "soapcw/soapcw.pyx":506
+              /* "soapcw/soapcw.pyx":508
  *                             if obs1data[t] and not obs2data[t]:
  *                                 o1 = obs1_ind_1d[t][i]
  *                                 k,m = 1,1             # <<<<<<<<<<<<<<
  *                                 value = tr[j][k][m] + logarr_1d[o1] + val[t-1][i+j-tr_dist]
  *                             elif obs2data[t] and not obs1data[t]:
  */
-              __pyx_t_35 = 1;
-              __pyx_t_75 = 1;
-              __pyx_v_k = __pyx_t_35;
-              __pyx_v_m = __pyx_t_75;
+              __pyx_t_34 = 1;
+              __pyx_t_37 = 1;
+              __pyx_v_k = __pyx_t_34;
+              __pyx_v_m = __pyx_t_37;
 
-              /* "soapcw/soapcw.pyx":507
+              /* "soapcw/soapcw.pyx":509
  *                                 o1 = obs1_ind_1d[t][i]
  *                                 k,m = 1,1
  *                                 value = tr[j][k][m] + logarr_1d[o1] + val[t-1][i+j-tr_dist]             # <<<<<<<<<<<<<<
  *                             elif obs2data[t] and not obs1data[t]:
  *                                 o2 = obs2_ind_1d[t][i]
  */
-              __pyx_t_105 = __pyx_v_j;
-              __pyx_t_106 = __pyx_v_k;
-              __pyx_t_107 = __pyx_v_m;
-              __pyx_t_75 = -1;
-              if (__pyx_t_105 < 0) {
-                __pyx_t_105 += __pyx_v_tr.shape[0];
-                if (unlikely(__pyx_t_105 < 0)) __pyx_t_75 = 0;
-              } else if (unlikely(__pyx_t_105 >= __pyx_v_tr.shape[0])) __pyx_t_75 = 0;
-              if (__pyx_t_106 < 0) {
-                __pyx_t_106 += __pyx_v_tr.shape[1];
-                if (unlikely(__pyx_t_106 < 0)) __pyx_t_75 = 1;
-              } else if (unlikely(__pyx_t_106 >= __pyx_v_tr.shape[1])) __pyx_t_75 = 1;
-              if (__pyx_t_107 < 0) {
-                __pyx_t_107 += __pyx_v_tr.shape[2];
-                if (unlikely(__pyx_t_107 < 0)) __pyx_t_75 = 2;
-              } else if (unlikely(__pyx_t_107 >= __pyx_v_tr.shape[2])) __pyx_t_75 = 2;
-              if (unlikely(__pyx_t_75 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_75);
-                __PYX_ERR(0, 507, __pyx_L1_error)
+              __pyx_t_43 = __pyx_v_j;
+              __pyx_t_44 = __pyx_v_k;
+              __pyx_t_32 = __pyx_v_m;
+              __pyx_t_37 = -1;
+              if (__pyx_t_43 < 0) {
+                __pyx_t_43 += __pyx_v_tr.shape[0];
+                if (unlikely(__pyx_t_43 < 0)) __pyx_t_37 = 0;
+              } else if (unlikely(__pyx_t_43 >= __pyx_v_tr.shape[0])) __pyx_t_37 = 0;
+              if (__pyx_t_44 < 0) {
+                __pyx_t_44 += __pyx_v_tr.shape[1];
+                if (unlikely(__pyx_t_44 < 0)) __pyx_t_37 = 1;
+              } else if (unlikely(__pyx_t_44 >= __pyx_v_tr.shape[1])) __pyx_t_37 = 1;
+              if (__pyx_t_32 < 0) {
+                __pyx_t_32 += __pyx_v_tr.shape[2];
+                if (unlikely(__pyx_t_32 < 0)) __pyx_t_37 = 2;
+              } else if (unlikely(__pyx_t_32 >= __pyx_v_tr.shape[2])) __pyx_t_37 = 2;
+              if (unlikely(__pyx_t_37 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_37);
+                __PYX_ERR(0, 509, __pyx_L1_error)
               }
-              if (unlikely(!__pyx_v_logarr_1d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_1d"); __PYX_ERR(0, 507, __pyx_L1_error) }
-              __pyx_t_108 = __pyx_v_o1;
-              __pyx_t_75 = -1;
-              if (__pyx_t_108 < 0) {
-                __pyx_t_108 += __pyx_v_logarr_1d.shape[0];
-                if (unlikely(__pyx_t_108 < 0)) __pyx_t_75 = 0;
-              } else if (unlikely(__pyx_t_108 >= __pyx_v_logarr_1d.shape[0])) __pyx_t_75 = 0;
-              if (unlikely(__pyx_t_75 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_75);
-                __PYX_ERR(0, 507, __pyx_L1_error)
+              if (unlikely(!__pyx_v_logarr_1d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_1d"); __PYX_ERR(0, 509, __pyx_L1_error) }
+              __pyx_t_36 = __pyx_v_o1;
+              __pyx_t_37 = -1;
+              if (__pyx_t_36 < 0) {
+                __pyx_t_36 += __pyx_v_logarr_1d.shape[0];
+                if (unlikely(__pyx_t_36 < 0)) __pyx_t_37 = 0;
+              } else if (unlikely(__pyx_t_36 >= __pyx_v_logarr_1d.shape[0])) __pyx_t_37 = 0;
+              if (unlikely(__pyx_t_37 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_37);
+                __PYX_ERR(0, 509, __pyx_L1_error)
               }
-              __pyx_t_109 = (__pyx_v_t - 1);
-              __pyx_t_110 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
-              __pyx_t_75 = -1;
-              if (__pyx_t_109 < 0) {
-                __pyx_t_109 += __pyx_v_val.shape[0];
-                if (unlikely(__pyx_t_109 < 0)) __pyx_t_75 = 0;
-              } else if (unlikely(__pyx_t_109 >= __pyx_v_val.shape[0])) __pyx_t_75 = 0;
-              if (__pyx_t_110 < 0) {
-                __pyx_t_110 += __pyx_v_val.shape[1];
-                if (unlikely(__pyx_t_110 < 0)) __pyx_t_75 = 1;
-              } else if (unlikely(__pyx_t_110 >= __pyx_v_val.shape[1])) __pyx_t_75 = 1;
-              if (unlikely(__pyx_t_75 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_75);
-                __PYX_ERR(0, 507, __pyx_L1_error)
+              __pyx_t_33 = (__pyx_v_t - 1);
+              __pyx_t_31 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
+              __pyx_t_37 = -1;
+              if (__pyx_t_33 < 0) {
+                __pyx_t_33 += __pyx_v_val.shape[0];
+                if (unlikely(__pyx_t_33 < 0)) __pyx_t_37 = 0;
+              } else if (unlikely(__pyx_t_33 >= __pyx_v_val.shape[0])) __pyx_t_37 = 0;
+              if (__pyx_t_31 < 0) {
+                __pyx_t_31 += __pyx_v_val.shape[1];
+                if (unlikely(__pyx_t_31 < 0)) __pyx_t_37 = 1;
+              } else if (unlikely(__pyx_t_31 >= __pyx_v_val.shape[1])) __pyx_t_37 = 1;
+              if (unlikely(__pyx_t_37 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_37);
+                __PYX_ERR(0, 509, __pyx_L1_error)
               }
-              __pyx_v_value = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_105 * __pyx_v_tr.strides[0]) ) + __pyx_t_106 * __pyx_v_tr.strides[1]) ) + __pyx_t_107 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr_1d.data + __pyx_t_108 * __pyx_v_logarr_1d.strides[0]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_109 * __pyx_v_val.strides[0]) ) + __pyx_t_110 * __pyx_v_val.strides[1]) ))));
+              __pyx_v_value = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_43 * __pyx_v_tr.strides[0]) ) + __pyx_t_44 * __pyx_v_tr.strides[1]) ) + __pyx_t_32 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr_1d.data + __pyx_t_36 * __pyx_v_logarr_1d.strides[0]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_33 * __pyx_v_val.strides[0]) ) + __pyx_t_31 * __pyx_v_val.strides[1]) ))));
 
-              /* "soapcw/soapcw.pyx":504
+              /* "soapcw/soapcw.pyx":506
  *                                                 continue
  *                         else:
  *                             if obs1data[t] and not obs2data[t]:             # <<<<<<<<<<<<<<
  *                                 o1 = obs1_ind_1d[t][i]
  *                                 k,m = 1,1
  */
               goto __pyx_L73;
             }
 
-            /* "soapcw/soapcw.pyx":508
+            /* "soapcw/soapcw.pyx":510
  *                                 k,m = 1,1
  *                                 value = tr[j][k][m] + logarr_1d[o1] + val[t-1][i+j-tr_dist]
  *                             elif obs2data[t] and not obs1data[t]:             # <<<<<<<<<<<<<<
  *                                 o2 = obs2_ind_1d[t][i]
  *                                 k,m = 1,1
  */
-            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 508, __pyx_L1_error)
+            __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 510, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (__pyx_t_22) {
+            if (__pyx_t_21) {
             } else {
-              __pyx_t_17 = __pyx_t_22;
+              __pyx_t_17 = __pyx_t_21;
               goto __pyx_L76_bool_binop_done;
             }
-            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs1data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs1data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 508, __pyx_L1_error)
+            __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 510, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            __pyx_t_16 = ((!__pyx_t_22) != 0);
+            __pyx_t_16 = ((!__pyx_t_21) != 0);
             __pyx_t_17 = __pyx_t_16;
             __pyx_L76_bool_binop_done:;
             if (__pyx_t_17) {
 
-              /* "soapcw/soapcw.pyx":509
+              /* "soapcw/soapcw.pyx":511
  *                                 value = tr[j][k][m] + logarr_1d[o1] + val[t-1][i+j-tr_dist]
  *                             elif obs2data[t] and not obs1data[t]:
  *                                 o2 = obs2_ind_1d[t][i]             # <<<<<<<<<<<<<<
  *                                 k,m = 1,1
  *                                 value = tr[j][k][m] + logarr_1d[o2] + val[t-1][i+j-tr_dist]
  */
-              if (unlikely(!__pyx_v_obs2_ind_1d)) { __Pyx_RaiseUnboundLocalError("obs2_ind_1d"); __PYX_ERR(0, 509, __pyx_L1_error) }
-              __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2_ind_1d, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 509, __pyx_L1_error)
+              if (unlikely(!__pyx_v_obs2_ind_1d)) { __Pyx_RaiseUnboundLocalError("obs2_ind_1d"); __PYX_ERR(0, 511, __pyx_L1_error) }
+              __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs2_ind_1d, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 511, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_3);
-              __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 509, __pyx_L1_error)
+              __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 511, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_2);
               __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-              __pyx_t_75 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_75 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 509, __pyx_L1_error)
+              __pyx_t_37 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_37 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 511, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-              __pyx_v_o2 = __pyx_t_75;
+              __pyx_v_o2 = __pyx_t_37;
 
-              /* "soapcw/soapcw.pyx":510
+              /* "soapcw/soapcw.pyx":512
  *                             elif obs2data[t] and not obs1data[t]:
  *                                 o2 = obs2_ind_1d[t][i]
  *                                 k,m = 1,1             # <<<<<<<<<<<<<<
  *                                 value = tr[j][k][m] + logarr_1d[o2] + val[t-1][i+j-tr_dist]
  *                             elif not obs2data[t] and not obs1data[t]:
  */
-              __pyx_t_75 = 1;
-              __pyx_t_35 = 1;
-              __pyx_v_k = __pyx_t_75;
-              __pyx_v_m = __pyx_t_35;
+              __pyx_t_37 = 1;
+              __pyx_t_34 = 1;
+              __pyx_v_k = __pyx_t_37;
+              __pyx_v_m = __pyx_t_34;
 
-              /* "soapcw/soapcw.pyx":511
+              /* "soapcw/soapcw.pyx":513
  *                                 o2 = obs2_ind_1d[t][i]
  *                                 k,m = 1,1
  *                                 value = tr[j][k][m] + logarr_1d[o2] + val[t-1][i+j-tr_dist]             # <<<<<<<<<<<<<<
  *                             elif not obs2data[t] and not obs1data[t]:
  *                                 o1 = obs1_ind_2d[t][i]
  */
-              __pyx_t_111 = __pyx_v_j;
-              __pyx_t_112 = __pyx_v_k;
-              __pyx_t_113 = __pyx_v_m;
-              __pyx_t_35 = -1;
-              if (__pyx_t_111 < 0) {
-                __pyx_t_111 += __pyx_v_tr.shape[0];
-                if (unlikely(__pyx_t_111 < 0)) __pyx_t_35 = 0;
-              } else if (unlikely(__pyx_t_111 >= __pyx_v_tr.shape[0])) __pyx_t_35 = 0;
-              if (__pyx_t_112 < 0) {
-                __pyx_t_112 += __pyx_v_tr.shape[1];
-                if (unlikely(__pyx_t_112 < 0)) __pyx_t_35 = 1;
-              } else if (unlikely(__pyx_t_112 >= __pyx_v_tr.shape[1])) __pyx_t_35 = 1;
-              if (__pyx_t_113 < 0) {
-                __pyx_t_113 += __pyx_v_tr.shape[2];
-                if (unlikely(__pyx_t_113 < 0)) __pyx_t_35 = 2;
-              } else if (unlikely(__pyx_t_113 >= __pyx_v_tr.shape[2])) __pyx_t_35 = 2;
-              if (unlikely(__pyx_t_35 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                __PYX_ERR(0, 511, __pyx_L1_error)
+              __pyx_t_31 = __pyx_v_j;
+              __pyx_t_33 = __pyx_v_k;
+              __pyx_t_36 = __pyx_v_m;
+              __pyx_t_34 = -1;
+              if (__pyx_t_31 < 0) {
+                __pyx_t_31 += __pyx_v_tr.shape[0];
+                if (unlikely(__pyx_t_31 < 0)) __pyx_t_34 = 0;
+              } else if (unlikely(__pyx_t_31 >= __pyx_v_tr.shape[0])) __pyx_t_34 = 0;
+              if (__pyx_t_33 < 0) {
+                __pyx_t_33 += __pyx_v_tr.shape[1];
+                if (unlikely(__pyx_t_33 < 0)) __pyx_t_34 = 1;
+              } else if (unlikely(__pyx_t_33 >= __pyx_v_tr.shape[1])) __pyx_t_34 = 1;
+              if (__pyx_t_36 < 0) {
+                __pyx_t_36 += __pyx_v_tr.shape[2];
+                if (unlikely(__pyx_t_36 < 0)) __pyx_t_34 = 2;
+              } else if (unlikely(__pyx_t_36 >= __pyx_v_tr.shape[2])) __pyx_t_34 = 2;
+              if (unlikely(__pyx_t_34 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                __PYX_ERR(0, 513, __pyx_L1_error)
               }
-              if (unlikely(!__pyx_v_logarr_1d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_1d"); __PYX_ERR(0, 511, __pyx_L1_error) }
-              __pyx_t_114 = __pyx_v_o2;
-              __pyx_t_35 = -1;
-              if (__pyx_t_114 < 0) {
-                __pyx_t_114 += __pyx_v_logarr_1d.shape[0];
-                if (unlikely(__pyx_t_114 < 0)) __pyx_t_35 = 0;
-              } else if (unlikely(__pyx_t_114 >= __pyx_v_logarr_1d.shape[0])) __pyx_t_35 = 0;
-              if (unlikely(__pyx_t_35 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                __PYX_ERR(0, 511, __pyx_L1_error)
+              if (unlikely(!__pyx_v_logarr_1d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_1d"); __PYX_ERR(0, 513, __pyx_L1_error) }
+              __pyx_t_32 = __pyx_v_o2;
+              __pyx_t_34 = -1;
+              if (__pyx_t_32 < 0) {
+                __pyx_t_32 += __pyx_v_logarr_1d.shape[0];
+                if (unlikely(__pyx_t_32 < 0)) __pyx_t_34 = 0;
+              } else if (unlikely(__pyx_t_32 >= __pyx_v_logarr_1d.shape[0])) __pyx_t_34 = 0;
+              if (unlikely(__pyx_t_34 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                __PYX_ERR(0, 513, __pyx_L1_error)
               }
-              __pyx_t_115 = (__pyx_v_t - 1);
-              __pyx_t_116 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
-              __pyx_t_35 = -1;
-              if (__pyx_t_115 < 0) {
-                __pyx_t_115 += __pyx_v_val.shape[0];
-                if (unlikely(__pyx_t_115 < 0)) __pyx_t_35 = 0;
-              } else if (unlikely(__pyx_t_115 >= __pyx_v_val.shape[0])) __pyx_t_35 = 0;
-              if (__pyx_t_116 < 0) {
-                __pyx_t_116 += __pyx_v_val.shape[1];
-                if (unlikely(__pyx_t_116 < 0)) __pyx_t_35 = 1;
-              } else if (unlikely(__pyx_t_116 >= __pyx_v_val.shape[1])) __pyx_t_35 = 1;
-              if (unlikely(__pyx_t_35 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                __PYX_ERR(0, 511, __pyx_L1_error)
+              __pyx_t_44 = (__pyx_v_t - 1);
+              __pyx_t_43 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
+              __pyx_t_34 = -1;
+              if (__pyx_t_44 < 0) {
+                __pyx_t_44 += __pyx_v_val.shape[0];
+                if (unlikely(__pyx_t_44 < 0)) __pyx_t_34 = 0;
+              } else if (unlikely(__pyx_t_44 >= __pyx_v_val.shape[0])) __pyx_t_34 = 0;
+              if (__pyx_t_43 < 0) {
+                __pyx_t_43 += __pyx_v_val.shape[1];
+                if (unlikely(__pyx_t_43 < 0)) __pyx_t_34 = 1;
+              } else if (unlikely(__pyx_t_43 >= __pyx_v_val.shape[1])) __pyx_t_34 = 1;
+              if (unlikely(__pyx_t_34 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                __PYX_ERR(0, 513, __pyx_L1_error)
               }
-              __pyx_v_value = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_111 * __pyx_v_tr.strides[0]) ) + __pyx_t_112 * __pyx_v_tr.strides[1]) ) + __pyx_t_113 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr_1d.data + __pyx_t_114 * __pyx_v_logarr_1d.strides[0]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_115 * __pyx_v_val.strides[0]) ) + __pyx_t_116 * __pyx_v_val.strides[1]) ))));
+              __pyx_v_value = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_31 * __pyx_v_tr.strides[0]) ) + __pyx_t_33 * __pyx_v_tr.strides[1]) ) + __pyx_t_36 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr_1d.data + __pyx_t_32 * __pyx_v_logarr_1d.strides[0]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_44 * __pyx_v_val.strides[0]) ) + __pyx_t_43 * __pyx_v_val.strides[1]) ))));
 
-              /* "soapcw/soapcw.pyx":508
+              /* "soapcw/soapcw.pyx":510
  *                                 k,m = 1,1
  *                                 value = tr[j][k][m] + logarr_1d[o1] + val[t-1][i+j-tr_dist]
  *                             elif obs2data[t] and not obs1data[t]:             # <<<<<<<<<<<<<<
  *                                 o2 = obs2_ind_1d[t][i]
  *                                 k,m = 1,1
  */
               goto __pyx_L73;
             }
 
-            /* "soapcw/soapcw.pyx":512
+            /* "soapcw/soapcw.pyx":514
  *                                 k,m = 1,1
  *                                 value = tr[j][k][m] + logarr_1d[o2] + val[t-1][i+j-tr_dist]
  *                             elif not obs2data[t] and not obs1data[t]:             # <<<<<<<<<<<<<<
  *                                 o1 = obs1_ind_2d[t][i]
  *                                 k,m = 1,1
  */
-            __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs2data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 512, __pyx_L1_error)
+            __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs2data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 514, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_2);
-            __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 512, __pyx_L1_error)
+            __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 514, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-            __pyx_t_22 = ((!__pyx_t_16) != 0);
-            if (__pyx_t_22) {
+            __pyx_t_21 = ((!__pyx_t_16) != 0);
+            if (__pyx_t_21) {
             } else {
-              __pyx_t_17 = __pyx_t_22;
+              __pyx_t_17 = __pyx_t_21;
               goto __pyx_L78_bool_binop_done;
             }
-            __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs1data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 512, __pyx_L1_error)
+            __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs1data, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 514, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_2);
-            __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 512, __pyx_L1_error)
+            __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 514, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-            __pyx_t_16 = ((!__pyx_t_22) != 0);
+            __pyx_t_16 = ((!__pyx_t_21) != 0);
             __pyx_t_17 = __pyx_t_16;
             __pyx_L78_bool_binop_done:;
             if (__pyx_t_17) {
 
-              /* "soapcw/soapcw.pyx":513
+              /* "soapcw/soapcw.pyx":515
  *                                 value = tr[j][k][m] + logarr_1d[o2] + val[t-1][i+j-tr_dist]
  *                             elif not obs2data[t] and not obs1data[t]:
  *                                 o1 = obs1_ind_2d[t][i]             # <<<<<<<<<<<<<<
  *                                 k,m = 1,1
  *                                 value = tr[j][k][m] + logarr_1d[o1] + val[t-1][i+j-tr_dist]
  */
-              if (unlikely(!__pyx_v_obs1_ind_2d.memview)) { __Pyx_RaiseUnboundLocalError("obs1_ind_2d"); __PYX_ERR(0, 513, __pyx_L1_error) }
-              __pyx_t_117 = __pyx_v_t;
-              __pyx_t_118 = __pyx_v_i;
-              __pyx_t_35 = -1;
-              if (__pyx_t_117 < 0) {
-                __pyx_t_117 += __pyx_v_obs1_ind_2d.shape[0];
-                if (unlikely(__pyx_t_117 < 0)) __pyx_t_35 = 0;
-              } else if (unlikely(__pyx_t_117 >= __pyx_v_obs1_ind_2d.shape[0])) __pyx_t_35 = 0;
-              if (__pyx_t_118 < 0) {
-                __pyx_t_118 += __pyx_v_obs1_ind_2d.shape[1];
-                if (unlikely(__pyx_t_118 < 0)) __pyx_t_35 = 1;
-              } else if (unlikely(__pyx_t_118 >= __pyx_v_obs1_ind_2d.shape[1])) __pyx_t_35 = 1;
-              if (unlikely(__pyx_t_35 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_35);
-                __PYX_ERR(0, 513, __pyx_L1_error)
+              if (unlikely(!__pyx_v_obs1_ind_2d.memview)) { __Pyx_RaiseUnboundLocalError("obs1_ind_2d"); __PYX_ERR(0, 515, __pyx_L1_error) }
+              __pyx_t_43 = __pyx_v_t;
+              __pyx_t_44 = __pyx_v_i;
+              __pyx_t_34 = -1;
+              if (__pyx_t_43 < 0) {
+                __pyx_t_43 += __pyx_v_obs1_ind_2d.shape[0];
+                if (unlikely(__pyx_t_43 < 0)) __pyx_t_34 = 0;
+              } else if (unlikely(__pyx_t_43 >= __pyx_v_obs1_ind_2d.shape[0])) __pyx_t_34 = 0;
+              if (__pyx_t_44 < 0) {
+                __pyx_t_44 += __pyx_v_obs1_ind_2d.shape[1];
+                if (unlikely(__pyx_t_44 < 0)) __pyx_t_34 = 1;
+              } else if (unlikely(__pyx_t_44 >= __pyx_v_obs1_ind_2d.shape[1])) __pyx_t_34 = 1;
+              if (unlikely(__pyx_t_34 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_34);
+                __PYX_ERR(0, 515, __pyx_L1_error)
               }
-              __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind_2d.data + __pyx_t_117 * __pyx_v_obs1_ind_2d.strides[0]) ) + __pyx_t_118 * __pyx_v_obs1_ind_2d.strides[1]) )));
+              __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind_2d.data + __pyx_t_43 * __pyx_v_obs1_ind_2d.strides[0]) ) + __pyx_t_44 * __pyx_v_obs1_ind_2d.strides[1]) )));
 
-              /* "soapcw/soapcw.pyx":514
+              /* "soapcw/soapcw.pyx":516
  *                             elif not obs2data[t] and not obs1data[t]:
  *                                 o1 = obs1_ind_2d[t][i]
  *                                 k,m = 1,1             # <<<<<<<<<<<<<<
  *                                 value = tr[j][k][m] + logarr_1d[o1] + val[t-1][i+j-tr_dist]
  * 
  */
-              __pyx_t_35 = 1;
-              __pyx_t_75 = 1;
-              __pyx_v_k = __pyx_t_35;
-              __pyx_v_m = __pyx_t_75;
+              __pyx_t_34 = 1;
+              __pyx_t_37 = 1;
+              __pyx_v_k = __pyx_t_34;
+              __pyx_v_m = __pyx_t_37;
 
-              /* "soapcw/soapcw.pyx":515
+              /* "soapcw/soapcw.pyx":517
  *                                 o1 = obs1_ind_2d[t][i]
  *                                 k,m = 1,1
  *                                 value = tr[j][k][m] + logarr_1d[o1] + val[t-1][i+j-tr_dist]             # <<<<<<<<<<<<<<
  * 
  * 
  */
-              __pyx_t_119 = __pyx_v_j;
-              __pyx_t_120 = __pyx_v_k;
-              __pyx_t_121 = __pyx_v_m;
-              __pyx_t_75 = -1;
-              if (__pyx_t_119 < 0) {
-                __pyx_t_119 += __pyx_v_tr.shape[0];
-                if (unlikely(__pyx_t_119 < 0)) __pyx_t_75 = 0;
-              } else if (unlikely(__pyx_t_119 >= __pyx_v_tr.shape[0])) __pyx_t_75 = 0;
-              if (__pyx_t_120 < 0) {
-                __pyx_t_120 += __pyx_v_tr.shape[1];
-                if (unlikely(__pyx_t_120 < 0)) __pyx_t_75 = 1;
-              } else if (unlikely(__pyx_t_120 >= __pyx_v_tr.shape[1])) __pyx_t_75 = 1;
-              if (__pyx_t_121 < 0) {
-                __pyx_t_121 += __pyx_v_tr.shape[2];
-                if (unlikely(__pyx_t_121 < 0)) __pyx_t_75 = 2;
-              } else if (unlikely(__pyx_t_121 >= __pyx_v_tr.shape[2])) __pyx_t_75 = 2;
-              if (unlikely(__pyx_t_75 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_75);
-                __PYX_ERR(0, 515, __pyx_L1_error)
+              __pyx_t_44 = __pyx_v_j;
+              __pyx_t_43 = __pyx_v_k;
+              __pyx_t_32 = __pyx_v_m;
+              __pyx_t_37 = -1;
+              if (__pyx_t_44 < 0) {
+                __pyx_t_44 += __pyx_v_tr.shape[0];
+                if (unlikely(__pyx_t_44 < 0)) __pyx_t_37 = 0;
+              } else if (unlikely(__pyx_t_44 >= __pyx_v_tr.shape[0])) __pyx_t_37 = 0;
+              if (__pyx_t_43 < 0) {
+                __pyx_t_43 += __pyx_v_tr.shape[1];
+                if (unlikely(__pyx_t_43 < 0)) __pyx_t_37 = 1;
+              } else if (unlikely(__pyx_t_43 >= __pyx_v_tr.shape[1])) __pyx_t_37 = 1;
+              if (__pyx_t_32 < 0) {
+                __pyx_t_32 += __pyx_v_tr.shape[2];
+                if (unlikely(__pyx_t_32 < 0)) __pyx_t_37 = 2;
+              } else if (unlikely(__pyx_t_32 >= __pyx_v_tr.shape[2])) __pyx_t_37 = 2;
+              if (unlikely(__pyx_t_37 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_37);
+                __PYX_ERR(0, 517, __pyx_L1_error)
               }
-              if (unlikely(!__pyx_v_logarr_1d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_1d"); __PYX_ERR(0, 515, __pyx_L1_error) }
-              __pyx_t_122 = __pyx_v_o1;
-              __pyx_t_75 = -1;
-              if (__pyx_t_122 < 0) {
-                __pyx_t_122 += __pyx_v_logarr_1d.shape[0];
-                if (unlikely(__pyx_t_122 < 0)) __pyx_t_75 = 0;
-              } else if (unlikely(__pyx_t_122 >= __pyx_v_logarr_1d.shape[0])) __pyx_t_75 = 0;
-              if (unlikely(__pyx_t_75 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_75);
-                __PYX_ERR(0, 515, __pyx_L1_error)
+              if (unlikely(!__pyx_v_logarr_1d.memview)) { __Pyx_RaiseUnboundLocalError("logarr_1d"); __PYX_ERR(0, 517, __pyx_L1_error) }
+              __pyx_t_36 = __pyx_v_o1;
+              __pyx_t_37 = -1;
+              if (__pyx_t_36 < 0) {
+                __pyx_t_36 += __pyx_v_logarr_1d.shape[0];
+                if (unlikely(__pyx_t_36 < 0)) __pyx_t_37 = 0;
+              } else if (unlikely(__pyx_t_36 >= __pyx_v_logarr_1d.shape[0])) __pyx_t_37 = 0;
+              if (unlikely(__pyx_t_37 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_37);
+                __PYX_ERR(0, 517, __pyx_L1_error)
               }
-              __pyx_t_123 = (__pyx_v_t - 1);
-              __pyx_t_124 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
-              __pyx_t_75 = -1;
-              if (__pyx_t_123 < 0) {
-                __pyx_t_123 += __pyx_v_val.shape[0];
-                if (unlikely(__pyx_t_123 < 0)) __pyx_t_75 = 0;
-              } else if (unlikely(__pyx_t_123 >= __pyx_v_val.shape[0])) __pyx_t_75 = 0;
-              if (__pyx_t_124 < 0) {
-                __pyx_t_124 += __pyx_v_val.shape[1];
-                if (unlikely(__pyx_t_124 < 0)) __pyx_t_75 = 1;
-              } else if (unlikely(__pyx_t_124 >= __pyx_v_val.shape[1])) __pyx_t_75 = 1;
-              if (unlikely(__pyx_t_75 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_75);
-                __PYX_ERR(0, 515, __pyx_L1_error)
+              __pyx_t_33 = (__pyx_v_t - 1);
+              __pyx_t_31 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
+              __pyx_t_37 = -1;
+              if (__pyx_t_33 < 0) {
+                __pyx_t_33 += __pyx_v_val.shape[0];
+                if (unlikely(__pyx_t_33 < 0)) __pyx_t_37 = 0;
+              } else if (unlikely(__pyx_t_33 >= __pyx_v_val.shape[0])) __pyx_t_37 = 0;
+              if (__pyx_t_31 < 0) {
+                __pyx_t_31 += __pyx_v_val.shape[1];
+                if (unlikely(__pyx_t_31 < 0)) __pyx_t_37 = 1;
+              } else if (unlikely(__pyx_t_31 >= __pyx_v_val.shape[1])) __pyx_t_37 = 1;
+              if (unlikely(__pyx_t_37 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_37);
+                __PYX_ERR(0, 517, __pyx_L1_error)
               }
-              __pyx_v_value = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_119 * __pyx_v_tr.strides[0]) ) + __pyx_t_120 * __pyx_v_tr.strides[1]) ) + __pyx_t_121 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr_1d.data + __pyx_t_122 * __pyx_v_logarr_1d.strides[0]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_123 * __pyx_v_val.strides[0]) ) + __pyx_t_124 * __pyx_v_val.strides[1]) ))));
+              __pyx_v_value = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_44 * __pyx_v_tr.strides[0]) ) + __pyx_t_43 * __pyx_v_tr.strides[1]) ) + __pyx_t_32 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_logarr_1d.data + __pyx_t_36 * __pyx_v_logarr_1d.strides[0]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_33 * __pyx_v_val.strides[0]) ) + __pyx_t_31 * __pyx_v_val.strides[1]) ))));
 
-              /* "soapcw/soapcw.pyx":512
+              /* "soapcw/soapcw.pyx":514
  *                                 k,m = 1,1
  *                                 value = tr[j][k][m] + logarr_1d[o2] + val[t-1][i+j-tr_dist]
  *                             elif not obs2data[t] and not obs1data[t]:             # <<<<<<<<<<<<<<
  *                                 o1 = obs1_ind_2d[t][i]
  *                                 k,m = 1,1
  */
             }
             __pyx_L73:;
 
-            /* "soapcw/soapcw.pyx":518
+            /* "soapcw/soapcw.pyx":520
  * 
  * 
  *                             if value > temp:             # <<<<<<<<<<<<<<
  *                                 temp = value
  *                                 val[t][i] = temp
  */
             __pyx_t_17 = ((__pyx_v_value > __pyx_v_temp) != 0);
             if (__pyx_t_17) {
 
-              /* "soapcw/soapcw.pyx":519
+              /* "soapcw/soapcw.pyx":521
  * 
  *                             if value > temp:
  *                                 temp = value             # <<<<<<<<<<<<<<
  *                                 val[t][i] = temp
  *                                 prev[t][i] =  i+j-tr_dist
  */
               __pyx_v_temp = __pyx_v_value;
 
-              /* "soapcw/soapcw.pyx":520
+              /* "soapcw/soapcw.pyx":522
  *                             if value > temp:
  *                                 temp = value
  *                                 val[t][i] = temp             # <<<<<<<<<<<<<<
  *                                 prev[t][i] =  i+j-tr_dist
  *                                 det1[t][i] =  i+k-sep_dist
  */
-              __pyx_t_125 = __pyx_v_t;
-              __pyx_t_126 = __pyx_v_i;
-              __pyx_t_75 = -1;
-              if (__pyx_t_125 < 0) {
-                __pyx_t_125 += __pyx_v_val.shape[0];
-                if (unlikely(__pyx_t_125 < 0)) __pyx_t_75 = 0;
-              } else if (unlikely(__pyx_t_125 >= __pyx_v_val.shape[0])) __pyx_t_75 = 0;
-              if (__pyx_t_126 < 0) {
-                __pyx_t_126 += __pyx_v_val.shape[1];
-                if (unlikely(__pyx_t_126 < 0)) __pyx_t_75 = 1;
-              } else if (unlikely(__pyx_t_126 >= __pyx_v_val.shape[1])) __pyx_t_75 = 1;
-              if (unlikely(__pyx_t_75 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_75);
-                __PYX_ERR(0, 520, __pyx_L1_error)
+              __pyx_t_31 = __pyx_v_t;
+              __pyx_t_33 = __pyx_v_i;
+              __pyx_t_37 = -1;
+              if (__pyx_t_31 < 0) {
+                __pyx_t_31 += __pyx_v_val.shape[0];
+                if (unlikely(__pyx_t_31 < 0)) __pyx_t_37 = 0;
+              } else if (unlikely(__pyx_t_31 >= __pyx_v_val.shape[0])) __pyx_t_37 = 0;
+              if (__pyx_t_33 < 0) {
+                __pyx_t_33 += __pyx_v_val.shape[1];
+                if (unlikely(__pyx_t_33 < 0)) __pyx_t_37 = 1;
+              } else if (unlikely(__pyx_t_33 >= __pyx_v_val.shape[1])) __pyx_t_37 = 1;
+              if (unlikely(__pyx_t_37 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_37);
+                __PYX_ERR(0, 522, __pyx_L1_error)
               }
-              *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_125 * __pyx_v_val.strides[0]) ) + __pyx_t_126 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
+              *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_31 * __pyx_v_val.strides[0]) ) + __pyx_t_33 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
 
-              /* "soapcw/soapcw.pyx":521
+              /* "soapcw/soapcw.pyx":523
  *                                 temp = value
  *                                 val[t][i] = temp
  *                                 prev[t][i] =  i+j-tr_dist             # <<<<<<<<<<<<<<
  *                                 det1[t][i] =  i+k-sep_dist
  *                                 det2[t][i] =  i+m-sep_dist
  */
-              __pyx_t_127 = __pyx_v_t;
-              __pyx_t_128 = __pyx_v_i;
-              __pyx_t_75 = -1;
-              if (__pyx_t_127 < 0) {
-                __pyx_t_127 += __pyx_v_prev.shape[0];
-                if (unlikely(__pyx_t_127 < 0)) __pyx_t_75 = 0;
-              } else if (unlikely(__pyx_t_127 >= __pyx_v_prev.shape[0])) __pyx_t_75 = 0;
-              if (__pyx_t_128 < 0) {
-                __pyx_t_128 += __pyx_v_prev.shape[1];
-                if (unlikely(__pyx_t_128 < 0)) __pyx_t_75 = 1;
-              } else if (unlikely(__pyx_t_128 >= __pyx_v_prev.shape[1])) __pyx_t_75 = 1;
-              if (unlikely(__pyx_t_75 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_75);
-                __PYX_ERR(0, 521, __pyx_L1_error)
+              __pyx_t_33 = __pyx_v_t;
+              __pyx_t_31 = __pyx_v_i;
+              __pyx_t_37 = -1;
+              if (__pyx_t_33 < 0) {
+                __pyx_t_33 += __pyx_v_prev.shape[0];
+                if (unlikely(__pyx_t_33 < 0)) __pyx_t_37 = 0;
+              } else if (unlikely(__pyx_t_33 >= __pyx_v_prev.shape[0])) __pyx_t_37 = 0;
+              if (__pyx_t_31 < 0) {
+                __pyx_t_31 += __pyx_v_prev.shape[1];
+                if (unlikely(__pyx_t_31 < 0)) __pyx_t_37 = 1;
+              } else if (unlikely(__pyx_t_31 >= __pyx_v_prev.shape[1])) __pyx_t_37 = 1;
+              if (unlikely(__pyx_t_37 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_37);
+                __PYX_ERR(0, 523, __pyx_L1_error)
               }
-              *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_127 * __pyx_v_prev.strides[0]) ) + __pyx_t_128 * __pyx_v_prev.strides[1]) )) = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
+              *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_33 * __pyx_v_prev.strides[0]) ) + __pyx_t_31 * __pyx_v_prev.strides[1]) )) = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
 
-              /* "soapcw/soapcw.pyx":522
+              /* "soapcw/soapcw.pyx":524
  *                                 val[t][i] = temp
  *                                 prev[t][i] =  i+j-tr_dist
  *                                 det1[t][i] =  i+k-sep_dist             # <<<<<<<<<<<<<<
  *                                 det2[t][i] =  i+m-sep_dist
  *                             else:
  */
-              __pyx_t_129 = __pyx_v_t;
-              __pyx_t_130 = __pyx_v_i;
-              __pyx_t_75 = -1;
-              if (__pyx_t_129 < 0) {
-                __pyx_t_129 += __pyx_v_det1.shape[0];
-                if (unlikely(__pyx_t_129 < 0)) __pyx_t_75 = 0;
-              } else if (unlikely(__pyx_t_129 >= __pyx_v_det1.shape[0])) __pyx_t_75 = 0;
-              if (__pyx_t_130 < 0) {
-                __pyx_t_130 += __pyx_v_det1.shape[1];
-                if (unlikely(__pyx_t_130 < 0)) __pyx_t_75 = 1;
-              } else if (unlikely(__pyx_t_130 >= __pyx_v_det1.shape[1])) __pyx_t_75 = 1;
-              if (unlikely(__pyx_t_75 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_75);
-                __PYX_ERR(0, 522, __pyx_L1_error)
+              __pyx_t_31 = __pyx_v_t;
+              __pyx_t_33 = __pyx_v_i;
+              __pyx_t_37 = -1;
+              if (__pyx_t_31 < 0) {
+                __pyx_t_31 += __pyx_v_det1.shape[0];
+                if (unlikely(__pyx_t_31 < 0)) __pyx_t_37 = 0;
+              } else if (unlikely(__pyx_t_31 >= __pyx_v_det1.shape[0])) __pyx_t_37 = 0;
+              if (__pyx_t_33 < 0) {
+                __pyx_t_33 += __pyx_v_det1.shape[1];
+                if (unlikely(__pyx_t_33 < 0)) __pyx_t_37 = 1;
+              } else if (unlikely(__pyx_t_33 >= __pyx_v_det1.shape[1])) __pyx_t_37 = 1;
+              if (unlikely(__pyx_t_37 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_37);
+                __PYX_ERR(0, 524, __pyx_L1_error)
               }
-              *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_129 * __pyx_v_det1.strides[0]) ) + __pyx_t_130 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
+              *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_31 * __pyx_v_det1.strides[0]) ) + __pyx_t_33 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
 
-              /* "soapcw/soapcw.pyx":523
+              /* "soapcw/soapcw.pyx":525
  *                                 prev[t][i] =  i+j-tr_dist
  *                                 det1[t][i] =  i+k-sep_dist
  *                                 det2[t][i] =  i+m-sep_dist             # <<<<<<<<<<<<<<
  *                             else:
  *                                 continue
  */
-              __pyx_t_131 = __pyx_v_t;
-              __pyx_t_132 = __pyx_v_i;
-              __pyx_t_75 = -1;
-              if (__pyx_t_131 < 0) {
-                __pyx_t_131 += __pyx_v_det2.shape[0];
-                if (unlikely(__pyx_t_131 < 0)) __pyx_t_75 = 0;
-              } else if (unlikely(__pyx_t_131 >= __pyx_v_det2.shape[0])) __pyx_t_75 = 0;
-              if (__pyx_t_132 < 0) {
-                __pyx_t_132 += __pyx_v_det2.shape[1];
-                if (unlikely(__pyx_t_132 < 0)) __pyx_t_75 = 1;
-              } else if (unlikely(__pyx_t_132 >= __pyx_v_det2.shape[1])) __pyx_t_75 = 1;
-              if (unlikely(__pyx_t_75 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_75);
-                __PYX_ERR(0, 523, __pyx_L1_error)
+              __pyx_t_33 = __pyx_v_t;
+              __pyx_t_31 = __pyx_v_i;
+              __pyx_t_37 = -1;
+              if (__pyx_t_33 < 0) {
+                __pyx_t_33 += __pyx_v_det2.shape[0];
+                if (unlikely(__pyx_t_33 < 0)) __pyx_t_37 = 0;
+              } else if (unlikely(__pyx_t_33 >= __pyx_v_det2.shape[0])) __pyx_t_37 = 0;
+              if (__pyx_t_31 < 0) {
+                __pyx_t_31 += __pyx_v_det2.shape[1];
+                if (unlikely(__pyx_t_31 < 0)) __pyx_t_37 = 1;
+              } else if (unlikely(__pyx_t_31 >= __pyx_v_det2.shape[1])) __pyx_t_37 = 1;
+              if (unlikely(__pyx_t_37 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_37);
+                __PYX_ERR(0, 525, __pyx_L1_error)
               }
-              *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_131 * __pyx_v_det2.strides[0]) ) + __pyx_t_132 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
+              *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_33 * __pyx_v_det2.strides[0]) ) + __pyx_t_31 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
 
-              /* "soapcw/soapcw.pyx":518
+              /* "soapcw/soapcw.pyx":520
  * 
  * 
  *                             if value > temp:             # <<<<<<<<<<<<<<
  *                                 temp = value
  *                                 val[t][i] = temp
  */
               goto __pyx_L80;
             }
 
-            /* "soapcw/soapcw.pyx":525
+            /* "soapcw/soapcw.pyx":527
  *                                 det2[t][i] =  i+m-sep_dist
  *                             else:
  *                                 continue             # <<<<<<<<<<<<<<
  * 
  *             if self.prog == True:
  */
             /*else*/ {
               goto __pyx_L53_continue;
             }
             __pyx_L80:;
           }
           __pyx_L58:;
 
-          /* "soapcw/soapcw.pyx":482
+          /* "soapcw/soapcw.pyx":484
  *                 temp = -np.inf
  *                 for j in range(tr_len):
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:             # <<<<<<<<<<<<<<
  *                         if obs1data[t] and obs2data[t]:
  *                             for k in range(sep_len):
  */
         }
         __pyx_L53_continue:;
       }
     }
 
-    /* "soapcw/soapcw.pyx":527
+    /* "soapcw/soapcw.pyx":529
  *                                 continue
  * 
  *             if self.prog == True:             # <<<<<<<<<<<<<<
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prog); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 527, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prog); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 529, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 527, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 529, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_17 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_17 < 0)) __PYX_ERR(0, 527, __pyx_L1_error)
+    __pyx_t_17 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_17 < 0)) __PYX_ERR(0, 529, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_17) {
 
-      /* "soapcw/soapcw.pyx":528
+      /* "soapcw/soapcw.pyx":530
  * 
  *             if self.prog == True:
  *                 if pt>pbar:             # <<<<<<<<<<<<<<
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  */
-      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 528, __pyx_L1_error)
+      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 530, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, __pyx_v_pbar, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 528, __pyx_L1_error)
+      __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, __pyx_v_pbar, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 530, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_17 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_17 < 0)) __PYX_ERR(0, 528, __pyx_L1_error)
+      __pyx_t_17 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_17 < 0)) __PYX_ERR(0, 530, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       if (__pyx_t_17) {
 
-        /* "soapcw/soapcw.pyx":529
+        /* "soapcw/soapcw.pyx":531
  *             if self.prog == True:
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))             # <<<<<<<<<<<<<<
  *                     stdout.flush()
  *                     pbar+=100./length
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_stdout); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 529, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_stdout); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 531, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_write); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 529, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_write); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 531, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u__4, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 529, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u__4, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 531, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 529, __pyx_L1_error)
+        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 531, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_14 = __Pyx_PyObject_CallOneArg(__pyx_builtin_round, __pyx_t_9); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 529, __pyx_L1_error)
+        __pyx_t_14 = __Pyx_PyObject_CallOneArg(__pyx_builtin_round, __pyx_t_9); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 531, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_14);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         __pyx_t_9 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
           __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_10);
           if (likely(__pyx_t_9)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
@@ -12385,15 +12611,15 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_10, function);
           }
         }
         __pyx_t_3 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_9, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_14);
         __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 529, __pyx_L1_error)
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 531, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __pyx_t_10 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
           __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_4);
           if (likely(__pyx_t_10)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -12401,243 +12627,243 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_4, function);
           }
         }
         __pyx_t_2 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_10, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
         __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 529, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 531, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-        /* "soapcw/soapcw.pyx":530
+        /* "soapcw/soapcw.pyx":532
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()             # <<<<<<<<<<<<<<
  *                     pbar+=100./length
  * 
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_stdout); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 530, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_stdout); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 532, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_flush); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 530, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_flush); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 532, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_4)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 530, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 532, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-        /* "soapcw/soapcw.pyx":531
+        /* "soapcw/soapcw.pyx":533
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  *                     pbar+=100./length             # <<<<<<<<<<<<<<
  * 
  *         self.V = np.array(val)
  */
         if (unlikely(__pyx_v_length == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-          __PYX_ERR(0, 531, __pyx_L1_error)
+          __PYX_ERR(0, 533, __pyx_L1_error)
         }
-        __pyx_t_2 = PyFloat_FromDouble((100. / ((double)__pyx_v_length))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 531, __pyx_L1_error)
+        __pyx_t_2 = PyFloat_FromDouble((100. / ((double)__pyx_v_length))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 533, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_pbar, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 531, __pyx_L1_error)
+        __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_pbar, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 533, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF_SET(__pyx_v_pbar, __pyx_t_3);
         __pyx_t_3 = 0;
 
-        /* "soapcw/soapcw.pyx":528
+        /* "soapcw/soapcw.pyx":530
  * 
  *             if self.prog == True:
  *                 if pt>pbar:             # <<<<<<<<<<<<<<
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  */
       }
 
-      /* "soapcw/soapcw.pyx":527
+      /* "soapcw/soapcw.pyx":529
  *                                 continue
  * 
  *             if self.prog == True:             # <<<<<<<<<<<<<<
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  */
     }
   }
 
-  /* "soapcw/soapcw.pyx":533
+  /* "soapcw/soapcw.pyx":535
  *                     pbar+=100./length
  * 
  *         self.V = np.array(val)             # <<<<<<<<<<<<<<
  *         self.prev = np.array(prev)
  *         self.det1 = np.array(det1)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 533, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 533, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_val, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 533, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_val, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_10 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_10);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_3 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_10, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 533, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_V, __pyx_t_3) < 0) __PYX_ERR(0, 533, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_V, __pyx_t_3) < 0) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":534
+  /* "soapcw/soapcw.pyx":536
  * 
  *         self.V = np.array(val)
  *         self.prev = np.array(prev)             # <<<<<<<<<<<<<<
  *         self.det1 = np.array(det1)
  *         self.det2 = np.array(det2)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 534, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 534, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_prev, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 534, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_prev, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_10 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_10);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_3 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_10, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 534, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prev, __pyx_t_3) < 0) __PYX_ERR(0, 534, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prev, __pyx_t_3) < 0) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":535
+  /* "soapcw/soapcw.pyx":537
  *         self.V = np.array(val)
  *         self.prev = np.array(prev)
  *         self.det1 = np.array(det1)             # <<<<<<<<<<<<<<
  *         self.det2 = np.array(det2)
  *         self.width = width
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 535, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 537, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 535, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 537, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_det1, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 535, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_det1, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 537, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_10 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_10);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_3 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_10, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 535, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 537, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_det1, __pyx_t_3) < 0) __PYX_ERR(0, 535, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_det1, __pyx_t_3) < 0) __PYX_ERR(0, 537, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":536
+  /* "soapcw/soapcw.pyx":538
  *         self.prev = np.array(prev)
  *         self.det1 = np.array(det1)
  *         self.det2 = np.array(det2)             # <<<<<<<<<<<<<<
  *         self.width = width
  *         self.length = length
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 538, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 536, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 538, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_det2, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_det2, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 538, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_10 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_10);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_3 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_10, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 536, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 538, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_det2, __pyx_t_3) < 0) __PYX_ERR(0, 536, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_det2, __pyx_t_3) < 0) __PYX_ERR(0, 538, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":537
+  /* "soapcw/soapcw.pyx":539
  *         self.det1 = np.array(det1)
  *         self.det2 = np.array(det2)
  *         self.width = width             # <<<<<<<<<<<<<<
  *         self.length = length
  * 
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_width); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 537, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_width); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 539, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_width, __pyx_t_3) < 0) __PYX_ERR(0, 537, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_width, __pyx_t_3) < 0) __PYX_ERR(0, 539, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":538
+  /* "soapcw/soapcw.pyx":540
  *         self.det2 = np.array(det2)
  *         self.width = width
  *         self.length = length             # <<<<<<<<<<<<<<
  * 
  *     def run_lookup_amp(self,tr1, obs11, obs21,lookup_file = None, fractions = None):
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 538, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_length, __pyx_t_3) < 0) __PYX_ERR(0, 538, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_length, __pyx_t_3) < 0) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":298
+  /* "soapcw/soapcw.pyx":300
  *     #--------------------------------------------------------
  * 
  *     def run(self,transition, obs1, obs2, lookup_file_1det = None,lookup_file_2det = None):             # <<<<<<<<<<<<<<
  *         """
  *         viterbi algorithm for two detectors with an lookup table for the line veto statistic
  */
 
@@ -12652,15 +12878,14 @@
   __PYX_XDEC_MEMVIEW(&__pyx_t_8, 1);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
   __PYX_XDEC_MEMVIEW(&__pyx_t_11, 1);
   __Pyx_XDECREF(__pyx_t_14);
   __Pyx_XDECREF(__pyx_t_15);
   __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_t_21, 1);
   __Pyx_AddTraceback("soapcw.soapcw.two_detector.run", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_tr, 1);
   __Pyx_XDECREF(__pyx_v_shape);
   __PYX_XDEC_MEMVIEW(&__pyx_v_val, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_prev, 1);
@@ -12686,15 +12911,15 @@
   __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_obs1seg);
   __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_obs2seg);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":540
+/* "soapcw/soapcw.pyx":542
  *         self.length = length
  * 
  *     def run_lookup_amp(self,tr1, obs11, obs21,lookup_file = None, fractions = None):             # <<<<<<<<<<<<<<
  *         """
  *         viterbi algorithm for two detectors with an lookup table for the line veto statistic
  */
 
@@ -12705,14 +12930,17 @@
 static PyObject *__pyx_pw_6soapcw_6soapcw_12two_detector_11run_lookup_amp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_tr1 = 0;
   PyObject *__pyx_v_obs11 = 0;
   PyObject *__pyx_v_obs21 = 0;
   PyObject *__pyx_v_lookup_file = 0;
   PyObject *__pyx_v_fractions = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("run_lookup_amp (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr1,&__pyx_n_s_obs11,&__pyx_n_s_obs21,&__pyx_n_s_lookup_file,&__pyx_n_s_fractions,0};
     PyObject* values[6] = {0,0,0,0,0,0};
     values[4] = ((PyObject *)((PyObject *)Py_None));
@@ -12741,27 +12969,27 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run_lookup_amp", 0, 4, 6, 1); __PYX_ERR(0, 540, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run_lookup_amp", 0, 4, 6, 1); __PYX_ERR(0, 542, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs11)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run_lookup_amp", 0, 4, 6, 2); __PYX_ERR(0, 540, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run_lookup_amp", 0, 4, 6, 2); __PYX_ERR(0, 542, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs21)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run_lookup_amp", 0, 4, 6, 3); __PYX_ERR(0, 540, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run_lookup_amp", 0, 4, 6, 3); __PYX_ERR(0, 542, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_lookup_file);
           if (value) { values[4] = value; kw_args--; }
         }
@@ -12769,15 +12997,15 @@
         case  5:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fractions);
           if (value) { values[5] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "run_lookup_amp") < 0)) __PYX_ERR(0, 540, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "run_lookup_amp") < 0)) __PYX_ERR(0, 542, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
@@ -12794,15 +13022,15 @@
     __pyx_v_obs11 = values[2];
     __pyx_v_obs21 = values[3];
     __pyx_v_lookup_file = values[4];
     __pyx_v_fractions = values[5];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("run_lookup_amp", 0, 4, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 540, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("run_lookup_amp", 0, 4, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 542, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.two_detector.run_lookup_amp", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_12two_detector_10run_lookup_amp(__pyx_self, __pyx_v_self, __pyx_v_tr1, __pyx_v_obs11, __pyx_v_obs21, __pyx_v_lookup_file, __pyx_v_fractions);
 
@@ -12874,153 +13102,120 @@
   PyObject *__pyx_t_14 = NULL;
   PyObject *(*__pyx_t_15)(PyObject *);
   PyObject *(*__pyx_t_16)(PyObject *);
   __Pyx_memviewslice __pyx_t_17 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_18;
   int __pyx_t_19;
   PyObject *__pyx_t_20 = NULL;
-  __Pyx_memviewslice __pyx_t_21 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_t_21;
   int __pyx_t_22;
   int __pyx_t_23;
   int __pyx_t_24;
   int __pyx_t_25;
   int __pyx_t_26;
   int __pyx_t_27;
   int __pyx_t_28;
   int __pyx_t_29;
-  int __pyx_t_30;
+  Py_ssize_t __pyx_t_30;
   Py_ssize_t __pyx_t_31;
-  Py_ssize_t __pyx_t_32;
-  int __pyx_t_33;
+  int __pyx_t_32;
+  Py_ssize_t __pyx_t_33;
   Py_ssize_t __pyx_t_34;
   Py_ssize_t __pyx_t_35;
   Py_ssize_t __pyx_t_36;
   Py_ssize_t __pyx_t_37;
   Py_ssize_t __pyx_t_38;
   Py_ssize_t __pyx_t_39;
   Py_ssize_t __pyx_t_40;
   Py_ssize_t __pyx_t_41;
-  Py_ssize_t __pyx_t_42;
-  Py_ssize_t __pyx_t_43;
-  Py_ssize_t __pyx_t_44;
-  Py_ssize_t __pyx_t_45;
-  Py_ssize_t __pyx_t_46;
-  Py_ssize_t __pyx_t_47;
-  Py_ssize_t __pyx_t_48;
+  double __pyx_t_42;
+  int __pyx_t_43;
+  int __pyx_t_44;
+  int __pyx_t_45;
+  int __pyx_t_46;
+  int __pyx_t_47;
+  int __pyx_t_48;
   Py_ssize_t __pyx_t_49;
   Py_ssize_t __pyx_t_50;
-  Py_ssize_t __pyx_t_51;
-  Py_ssize_t __pyx_t_52;
-  Py_ssize_t __pyx_t_53;
-  Py_ssize_t __pyx_t_54;
-  double __pyx_t_55;
-  int __pyx_t_56;
-  int __pyx_t_57;
-  int __pyx_t_58;
-  int __pyx_t_59;
-  int __pyx_t_60;
-  Py_ssize_t __pyx_t_61;
-  Py_ssize_t __pyx_t_62;
-  int __pyx_t_63;
-  Py_ssize_t __pyx_t_64;
-  Py_ssize_t __pyx_t_65;
-  Py_ssize_t __pyx_t_66;
-  Py_ssize_t __pyx_t_67;
-  Py_ssize_t __pyx_t_68;
-  Py_ssize_t __pyx_t_69;
-  Py_ssize_t __pyx_t_70;
-  Py_ssize_t __pyx_t_71;
-  Py_ssize_t __pyx_t_72;
-  Py_ssize_t __pyx_t_73;
-  Py_ssize_t __pyx_t_74;
-  Py_ssize_t __pyx_t_75;
-  Py_ssize_t __pyx_t_76;
-  Py_ssize_t __pyx_t_77;
-  Py_ssize_t __pyx_t_78;
-  Py_ssize_t __pyx_t_79;
-  Py_ssize_t __pyx_t_80;
-  Py_ssize_t __pyx_t_81;
-  Py_ssize_t __pyx_t_82;
-  Py_ssize_t __pyx_t_83;
-  Py_ssize_t __pyx_t_84;
-  Py_ssize_t __pyx_t_85;
-  Py_ssize_t __pyx_t_86;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("run_lookup_amp", 0);
   __Pyx_INCREF(__pyx_v_fractions);
 
-  /* "soapcw/soapcw.pyx":560
+  /* "soapcw/soapcw.pyx":562
  *             previous positions before jump
  *         """
  *         cdef double[:, :, :] tr = tr1             # <<<<<<<<<<<<<<
  *         cdef double[:, :] obs1 = obs11
  *         cdef double[:, :] obs2 = obs21
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_v_tr1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 560, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_v_tr1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 562, __pyx_L1_error)
   __pyx_v_tr = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "soapcw/soapcw.pyx":561
+  /* "soapcw/soapcw.pyx":563
  *         """
  *         cdef double[:, :, :] tr = tr1
  *         cdef double[:, :] obs1 = obs11             # <<<<<<<<<<<<<<
  *         cdef double[:, :] obs2 = obs21
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 561, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 563, __pyx_L1_error)
   __pyx_v_obs1 = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "soapcw/soapcw.pyx":562
+  /* "soapcw/soapcw.pyx":564
  *         cdef double[:, :, :] tr = tr1
  *         cdef double[:, :] obs1 = obs11
  *         cdef double[:, :] obs2 = obs21             # <<<<<<<<<<<<<<
  * 
  *         shape = np.shape(obs1)
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs21, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 562, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs21, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 564, __pyx_L1_error)
   __pyx_v_obs2 = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "soapcw/soapcw.pyx":564
+  /* "soapcw/soapcw.pyx":566
  *         cdef double[:, :] obs2 = obs21
  * 
  *         shape = np.shape(obs1)             # <<<<<<<<<<<<<<
  * 
  *         cdef int length = min(len(obs1),len(obs2))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 564, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 564, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_obs1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 564, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_obs1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 564, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_shape = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":566
+  /* "soapcw/soapcw.pyx":568
  *         shape = np.shape(obs1)
  * 
  *         cdef int length = min(len(obs1),len(obs2))             # <<<<<<<<<<<<<<
  *         cdef int width = len(obs1[0])
  * 
  */
   __pyx_t_7 = __Pyx_MemoryView_Len(__pyx_v_obs2); 
@@ -13028,15 +13223,15 @@
   if (((__pyx_t_7 < __pyx_t_8) != 0)) {
     __pyx_t_9 = __pyx_t_7;
   } else {
     __pyx_t_9 = __pyx_t_8;
   }
   __pyx_v_length = __pyx_t_9;
 
-  /* "soapcw/soapcw.pyx":567
+  /* "soapcw/soapcw.pyx":569
  * 
  *         cdef int length = min(len(obs1),len(obs2))
  *         cdef int width = len(obs1[0])             # <<<<<<<<<<<<<<
  * 
  *         cdef double[:, :] val = np.ones(shape)*-1e6
  */
   __pyx_t_10.data = __pyx_v_obs1.data;
@@ -13044,190 +13239,190 @@
   __PYX_INC_MEMVIEW(&__pyx_t_10, 0);
   {
     Py_ssize_t __pyx_tmp_idx = 0;
         Py_ssize_t __pyx_tmp_shape = __pyx_v_obs1.shape[0];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_obs1.strides[0];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
-        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
+        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 0)");
-            __PYX_ERR(0, 567, __pyx_L1_error)
+            __PYX_ERR(0, 569, __pyx_L1_error)
         }
         __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
 __pyx_t_10.shape[0] = __pyx_v_obs1.shape[1];
 __pyx_t_10.strides[0] = __pyx_v_obs1.strides[1];
     __pyx_t_10.suboffsets[0] = -1;
 
 __pyx_t_7 = __Pyx_MemoryView_Len(__pyx_t_10); 
   __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
   __pyx_t_10.memview = NULL;
   __pyx_t_10.data = NULL;
   __pyx_v_width = __pyx_t_7;
 
-  /* "soapcw/soapcw.pyx":569
+  /* "soapcw/soapcw.pyx":571
  *         cdef int width = len(obs1[0])
  * 
  *         cdef double[:, :] val = np.ones(shape)*-1e6             # <<<<<<<<<<<<<<
- *         cdef long[:, :] prev = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
+ *         cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 569, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 571, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_ones); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 569, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_ones); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 571, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_shape);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 569, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 571, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_3, __pyx_float_neg_1e6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 569, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_3, __pyx_float_neg_1e6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 571, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 569, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 571, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_val = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "soapcw/soapcw.pyx":570
+  /* "soapcw/soapcw.pyx":572
  * 
  *         cdef double[:, :] val = np.ones(shape)*-1e6
- *         cdef long[:, :] prev = np.zeros(shape,dtype = np.int)             # <<<<<<<<<<<<<<
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)
+ *         cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)             # <<<<<<<<<<<<<<
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 572, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 572, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 572, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_shape);
   __Pyx_GIVEREF(__pyx_v_shape);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_shape);
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 572, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_int); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_int32); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 572, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 570, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 572, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 572, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_long(__pyx_t_11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 572, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __pyx_v_prev = __pyx_t_12;
   __pyx_t_12.memview = NULL;
   __pyx_t_12.data = NULL;
 
-  /* "soapcw/soapcw.pyx":571
+  /* "soapcw/soapcw.pyx":573
  *         cdef double[:, :] val = np.ones(shape)*-1e6
- *         cdef long[:, :] prev = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)             # <<<<<<<<<<<<<<
- *         cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)
+ *         cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)             # <<<<<<<<<<<<<<
+ *         cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_INCREF(__pyx_v_shape);
   __Pyx_GIVEREF(__pyx_v_shape);
   PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_v_shape);
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 571, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_long(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_det1 = __pyx_t_12;
   __pyx_t_12.memview = NULL;
   __pyx_t_12.data = NULL;
 
-  /* "soapcw/soapcw.pyx":572
- *         cdef long[:, :] prev = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)             # <<<<<<<<<<<<<<
+  /* "soapcw/soapcw.pyx":574
+ *         cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)             # <<<<<<<<<<<<<<
  * 
  *         cdef int tr_len = len(tr)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_shape);
   __Pyx_GIVEREF(__pyx_v_shape);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_shape);
-  __pyx_t_11 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 572, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 574, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_long(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 574, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_det2 = __pyx_t_12;
   __pyx_t_12.memview = NULL;
   __pyx_t_12.data = NULL;
 
-  /* "soapcw/soapcw.pyx":574
- *         cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)
+  /* "soapcw/soapcw.pyx":576
+ *         cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)
  * 
  *         cdef int tr_len = len(tr)             # <<<<<<<<<<<<<<
  *         cdef int sep_len = len(tr[0])
  *         cdef int tr_dist = int(len(tr)/2. - 0.5)
  */
   __pyx_t_7 = __Pyx_MemoryView_Len(__pyx_v_tr); 
   __pyx_v_tr_len = __pyx_t_7;
 
-  /* "soapcw/soapcw.pyx":575
+  /* "soapcw/soapcw.pyx":577
  * 
  *         cdef int tr_len = len(tr)
  *         cdef int sep_len = len(tr[0])             # <<<<<<<<<<<<<<
  *         cdef int tr_dist = int(len(tr)/2. - 0.5)
  *         cdef int sep_dist = int(len(tr)/2. - 0.5)
  */
   __pyx_t_2.data = __pyx_v_tr.data;
@@ -13235,18 +13430,18 @@
   __PYX_INC_MEMVIEW(&__pyx_t_2, 0);
   {
     Py_ssize_t __pyx_tmp_idx = 0;
         Py_ssize_t __pyx_tmp_shape = __pyx_v_tr.shape[0];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_tr.strides[0];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
-        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
+        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 0)");
-            __PYX_ERR(0, 575, __pyx_L1_error)
+            __PYX_ERR(0, 577, __pyx_L1_error)
         }
         __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
 __pyx_t_2.shape[0] = __pyx_v_tr.shape[1];
 __pyx_t_2.strides[0] = __pyx_v_tr.strides[1];
     __pyx_t_2.suboffsets[0] = -1;
@@ -13257,74 +13452,74 @@
 
 __pyx_t_7 = __Pyx_MemoryView_Len(__pyx_t_2); 
   __PYX_XDEC_MEMVIEW(&__pyx_t_2, 1);
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
   __pyx_v_sep_len = __pyx_t_7;
 
-  /* "soapcw/soapcw.pyx":576
+  /* "soapcw/soapcw.pyx":578
  *         cdef int tr_len = len(tr)
  *         cdef int sep_len = len(tr[0])
  *         cdef int tr_dist = int(len(tr)/2. - 0.5)             # <<<<<<<<<<<<<<
  *         cdef int sep_dist = int(len(tr)/2. - 0.5)
  * 
  */
   __pyx_t_7 = __Pyx_MemoryView_Len(__pyx_v_tr); 
   __pyx_v_tr_dist = ((int)((((double)__pyx_t_7) / 2.) - 0.5));
 
-  /* "soapcw/soapcw.pyx":577
+  /* "soapcw/soapcw.pyx":579
  *         cdef int sep_len = len(tr[0])
  *         cdef int tr_dist = int(len(tr)/2. - 0.5)
  *         cdef int sep_dist = int(len(tr)/2. - 0.5)             # <<<<<<<<<<<<<<
  * 
  *         cdef int i
  */
   __pyx_t_7 = __Pyx_MemoryView_Len(__pyx_v_tr); 
   __pyx_v_sep_dist = ((int)((((double)__pyx_t_7) / 2.) - 0.5));
 
-  /* "soapcw/soapcw.pyx":594
+  /* "soapcw/soapcw.pyx":596
  *         cdef double value
  *         cdef double temp
  *         cdef int edge_range = 0             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_v_edge_range = 0;
 
-  /* "soapcw/soapcw.pyx":600
+  /* "soapcw/soapcw.pyx":602
  *         cdef double fact_frac
  * 
  *         likelihood, pow_ranges, frac_ranges, pow_fact, frac_fact = self.read_lookup_amp(lookup_file)             # <<<<<<<<<<<<<<
  * 
  *         # define the likelihood as two array one which is the transpose of the other, such that the fractions of time one detector can always be compared with a value less than 1
  */
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_read_lookup_amp); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 600, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_read_lookup_amp); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 602, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_11);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_11, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_6, __pyx_v_lookup_file) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_v_lookup_file);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 600, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 602, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
     PyObject* sequence = __pyx_t_3;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 5)) {
       if (size > 5) __Pyx_RaiseTooManyValuesError(5);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 600, __pyx_L1_error)
+      __PYX_ERR(0, 602, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_11 = PyTuple_GET_ITEM(sequence, 0); 
       __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
       __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2); 
       __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3); 
@@ -13342,104 +13537,104 @@
     __Pyx_INCREF(__pyx_t_5);
     __Pyx_INCREF(__pyx_t_13);
     #else
     {
       Py_ssize_t i;
       PyObject** temps[5] = {&__pyx_t_11,&__pyx_t_6,&__pyx_t_4,&__pyx_t_5,&__pyx_t_13};
       for (i=0; i < 5; i++) {
-        PyObject* item = PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 600, __pyx_L1_error)
+        PyObject* item = PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 602, __pyx_L1_error)
         __Pyx_GOTREF(item);
         *(temps[i]) = item;
       }
     }
     #endif
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } else {
     Py_ssize_t index = -1;
     PyObject** temps[5] = {&__pyx_t_11,&__pyx_t_6,&__pyx_t_4,&__pyx_t_5,&__pyx_t_13};
-    __pyx_t_14 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 600, __pyx_L1_error)
+    __pyx_t_14 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 602, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_15 = Py_TYPE(__pyx_t_14)->tp_iternext;
     for (index=0; index < 5; index++) {
       PyObject* item = __pyx_t_15(__pyx_t_14); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
       __Pyx_GOTREF(item);
       *(temps[index]) = item;
     }
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_15(__pyx_t_14), 5) < 0) __PYX_ERR(0, 600, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_15(__pyx_t_14), 5) < 0) __PYX_ERR(0, 602, __pyx_L1_error)
     __pyx_t_15 = NULL;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     goto __pyx_L4_unpacking_done;
     __pyx_L3_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __pyx_t_15 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 600, __pyx_L1_error)
+    __PYX_ERR(0, 602, __pyx_L1_error)
     __pyx_L4_unpacking_done:;
   }
   __pyx_v_likelihood = __pyx_t_11;
   __pyx_t_11 = 0;
   __pyx_v_pow_ranges = __pyx_t_6;
   __pyx_t_6 = 0;
   __pyx_v_frac_ranges = __pyx_t_4;
   __pyx_t_4 = 0;
   __pyx_v_pow_fact = __pyx_t_5;
   __pyx_t_5 = 0;
   __pyx_v_frac_fact = __pyx_t_13;
   __pyx_t_13 = 0;
 
-  /* "soapcw/soapcw.pyx":603
+  /* "soapcw/soapcw.pyx":605
  * 
  *         # define the likelihood as two array one which is the transpose of the other, such that the fractions of time one detector can always be compared with a value less than 1
  *         shp = np.shape(likelihood)             # <<<<<<<<<<<<<<
  *         logarr1 = np.zeros((2,shp[0],shp[1],shp[2]))
  *         logarr1[0] = likelihood
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 603, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 605, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 603, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 605, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   __pyx_t_13 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_13)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_13);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_13, __pyx_v_likelihood) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_likelihood);
   __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 603, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 605, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_shp = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":604
+  /* "soapcw/soapcw.pyx":606
  *         # define the likelihood as two array one which is the transpose of the other, such that the fractions of time one detector can always be compared with a value less than 1
  *         shp = np.shape(likelihood)
  *         logarr1 = np.zeros((2,shp[0],shp[1],shp[2]))             # <<<<<<<<<<<<<<
  *         logarr1[0] = likelihood
  *         logarr1[1] = ([np.array(lkl).T for lkl in likelihood])
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 604, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 606, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 604, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 606, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_shp, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 604, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_shp, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 606, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_shp, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 604, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_shp, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 606, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_shp, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 604, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_shp, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 606, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_11 = PyTuple_New(4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 604, __pyx_L1_error)
+  __pyx_t_11 = PyTuple_New(4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 606, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_int_2);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
@@ -13458,248 +13653,248 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_13, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_6, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_11);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 604, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 606, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   __pyx_v_logarr1 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":605
+  /* "soapcw/soapcw.pyx":607
  *         shp = np.shape(likelihood)
  *         logarr1 = np.zeros((2,shp[0],shp[1],shp[2]))
  *         logarr1[0] = likelihood             # <<<<<<<<<<<<<<
  *         logarr1[1] = ([np.array(lkl).T for lkl in likelihood])
  *         cdef double[:,:,:,:] logarr = logarr1
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_logarr1, 0, __pyx_v_likelihood, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 605, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_logarr1, 0, __pyx_v_likelihood, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 607, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":606
+  /* "soapcw/soapcw.pyx":608
  *         logarr1 = np.zeros((2,shp[0],shp[1],shp[2]))
  *         logarr1[0] = likelihood
  *         logarr1[1] = ([np.array(lkl).T for lkl in likelihood])             # <<<<<<<<<<<<<<
  *         cdef double[:,:,:,:] logarr = logarr1
  * 
  */
   { /* enter inner scope */
-    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 606, __pyx_L7_error)
+    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 608, __pyx_L7_error)
     __Pyx_GOTREF(__pyx_t_3);
     if (likely(PyList_CheckExact(__pyx_v_likelihood)) || PyTuple_CheckExact(__pyx_v_likelihood)) {
       __pyx_t_13 = __pyx_v_likelihood; __Pyx_INCREF(__pyx_t_13); __pyx_t_9 = 0;
       __pyx_t_16 = NULL;
     } else {
-      __pyx_t_9 = -1; __pyx_t_13 = PyObject_GetIter(__pyx_v_likelihood); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 606, __pyx_L7_error)
+      __pyx_t_9 = -1; __pyx_t_13 = PyObject_GetIter(__pyx_v_likelihood); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 608, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_13);
-      __pyx_t_16 = Py_TYPE(__pyx_t_13)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 606, __pyx_L7_error)
+      __pyx_t_16 = Py_TYPE(__pyx_t_13)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 608, __pyx_L7_error)
     }
     for (;;) {
       if (likely(!__pyx_t_16)) {
         if (likely(PyList_CheckExact(__pyx_t_13))) {
           if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_13)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_11 = PyList_GET_ITEM(__pyx_t_13, __pyx_t_9); __Pyx_INCREF(__pyx_t_11); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 606, __pyx_L7_error)
+          __pyx_t_11 = PyList_GET_ITEM(__pyx_t_13, __pyx_t_9); __Pyx_INCREF(__pyx_t_11); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 608, __pyx_L7_error)
           #else
-          __pyx_t_11 = PySequence_ITEM(__pyx_t_13, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 606, __pyx_L7_error)
+          __pyx_t_11 = PySequence_ITEM(__pyx_t_13, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 608, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_11);
           #endif
         } else {
           if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_13)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_13, __pyx_t_9); __Pyx_INCREF(__pyx_t_11); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 606, __pyx_L7_error)
+          __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_13, __pyx_t_9); __Pyx_INCREF(__pyx_t_11); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 608, __pyx_L7_error)
           #else
-          __pyx_t_11 = PySequence_ITEM(__pyx_t_13, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 606, __pyx_L7_error)
+          __pyx_t_11 = PySequence_ITEM(__pyx_t_13, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 608, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_11);
           #endif
         }
       } else {
         __pyx_t_11 = __pyx_t_16(__pyx_t_13);
         if (unlikely(!__pyx_t_11)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 606, __pyx_L7_error)
+            else __PYX_ERR(0, 608, __pyx_L7_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_11);
       }
       __Pyx_XDECREF_SET(__pyx_8genexpr3__pyx_v_lkl, __pyx_t_11);
       __pyx_t_11 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 606, __pyx_L7_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 608, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 606, __pyx_L7_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 608, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __pyx_t_6 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_6);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
       __pyx_t_11 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6, __pyx_8genexpr3__pyx_v_lkl) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_8genexpr3__pyx_v_lkl);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 606, __pyx_L7_error)
+      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 608, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_T); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 606, __pyx_L7_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_T); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 608, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 606, __pyx_L7_error)
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 608, __pyx_L7_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_lkl); __pyx_8genexpr3__pyx_v_lkl = 0;
     goto __pyx_L10_exit_scope;
     __pyx_L7_error:;
     __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_lkl); __pyx_8genexpr3__pyx_v_lkl = 0;
     goto __pyx_L1_error;
     __pyx_L10_exit_scope:;
   } /* exit inner scope */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_logarr1, 1, __pyx_t_3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 606, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_logarr1, 1, __pyx_t_3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 608, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":607
+  /* "soapcw/soapcw.pyx":609
  *         logarr1[0] = likelihood
  *         logarr1[1] = ([np.array(lkl).T for lkl in likelihood])
  *         cdef double[:,:,:,:] logarr = logarr1             # <<<<<<<<<<<<<<
  * 
  *         # if the fractions are above a value of 1, inverse the lookup table so that only values between 0 and 1 have to be generated.
  */
-  __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double(__pyx_v_logarr1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 607, __pyx_L1_error)
+  __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double(__pyx_v_logarr1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 609, __pyx_L1_error)
   __pyx_v_logarr = __pyx_t_17;
   __pyx_t_17.memview = NULL;
   __pyx_t_17.data = NULL;
 
-  /* "soapcw/soapcw.pyx":610
+  /* "soapcw/soapcw.pyx":612
  * 
  *         # if the fractions are above a value of 1, inverse the lookup table so that only values between 0 and 1 have to be generated.
  *         if len(np.shape(fractions)) == 1:             # <<<<<<<<<<<<<<
  *             fractions = np.array([np.ones(width)*i for i in fractions])
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 610, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 612, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 610, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 612, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   __pyx_t_13 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_13)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_13);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_3 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_13, __pyx_v_fractions) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_fractions);
   __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 610, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 612, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_9 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 610, __pyx_L1_error)
+  __pyx_t_9 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 612, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_18 = ((__pyx_t_9 == 1) != 0);
   if (__pyx_t_18) {
 
-    /* "soapcw/soapcw.pyx":611
+    /* "soapcw/soapcw.pyx":613
  *         # if the fractions are above a value of 1, inverse the lookup table so that only values between 0 and 1 have to be generated.
  *         if len(np.shape(fractions)) == 1:
  *             fractions = np.array([np.ones(width)*i for i in fractions])             # <<<<<<<<<<<<<<
  * 
  *         det_order1 = np.ones(np.shape(fractions)).astype(np.int32)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 611, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 613, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 611, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 613, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     { /* enter inner scope */
-      __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 611, __pyx_L1_error)
+      __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 613, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       if (likely(PyList_CheckExact(__pyx_v_fractions)) || PyTuple_CheckExact(__pyx_v_fractions)) {
         __pyx_t_11 = __pyx_v_fractions; __Pyx_INCREF(__pyx_t_11); __pyx_t_9 = 0;
         __pyx_t_16 = NULL;
       } else {
-        __pyx_t_9 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_v_fractions); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 611, __pyx_L1_error)
+        __pyx_t_9 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_v_fractions); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 613, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_16 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 611, __pyx_L1_error)
+        __pyx_t_16 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 613, __pyx_L1_error)
       }
       for (;;) {
         if (likely(!__pyx_t_16)) {
           if (likely(PyList_CheckExact(__pyx_t_11))) {
             if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_11)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_6 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 611, __pyx_L1_error)
+            __pyx_t_6 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 613, __pyx_L1_error)
             #else
-            __pyx_t_6 = PySequence_ITEM(__pyx_t_11, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 611, __pyx_L1_error)
+            __pyx_t_6 = PySequence_ITEM(__pyx_t_11, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 613, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
             #endif
           } else {
             if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 611, __pyx_L1_error)
+            __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 613, __pyx_L1_error)
             #else
-            __pyx_t_6 = PySequence_ITEM(__pyx_t_11, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 611, __pyx_L1_error)
+            __pyx_t_6 = PySequence_ITEM(__pyx_t_11, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 613, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
             #endif
           }
         } else {
           __pyx_t_6 = __pyx_t_16(__pyx_t_11);
           if (unlikely(!__pyx_t_6)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 611, __pyx_L1_error)
+              else __PYX_ERR(0, 613, __pyx_L1_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_6);
         }
-        __pyx_t_19 = __Pyx_PyInt_As_int(__pyx_t_6); if (unlikely((__pyx_t_19 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 611, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyInt_As_int(__pyx_t_6); if (unlikely((__pyx_t_19 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 613, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_8genexpr4__pyx_v_i = __pyx_t_19;
-        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 611, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 613, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_ones); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 611, __pyx_L1_error)
+        __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_ones); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 613, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_14);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_width); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 611, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_width); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 613, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __pyx_t_20 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
           __pyx_t_20 = PyMethod_GET_SELF(__pyx_t_14);
           if (likely(__pyx_t_20)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
             __Pyx_INCREF(__pyx_t_20);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_14, function);
           }
         }
         __pyx_t_6 = (__pyx_t_20) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_20, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_5);
         __Pyx_XDECREF(__pyx_t_20); __pyx_t_20 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 611, __pyx_L1_error)
+        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 613, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-        __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_8genexpr4__pyx_v_i); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 611, __pyx_L1_error)
+        __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_8genexpr4__pyx_v_i); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 613, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_14);
-        __pyx_t_5 = PyNumber_Multiply(__pyx_t_6, __pyx_t_14); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 611, __pyx_L1_error)
+        __pyx_t_5 = PyNumber_Multiply(__pyx_t_6, __pyx_t_14); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 613, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-        if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 611, __pyx_L1_error)
+        if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 613, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       }
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     } /* exit inner scope */
     __pyx_t_11 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
       __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_13);
@@ -13709,59 +13904,59 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_13, function);
       }
     }
     __pyx_t_3 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_11, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 611, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 613, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_DECREF_SET(__pyx_v_fractions, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "soapcw/soapcw.pyx":610
+    /* "soapcw/soapcw.pyx":612
  * 
  *         # if the fractions are above a value of 1, inverse the lookup table so that only values between 0 and 1 have to be generated.
  *         if len(np.shape(fractions)) == 1:             # <<<<<<<<<<<<<<
  *             fractions = np.array([np.ones(width)*i for i in fractions])
  * 
  */
   }
 
-  /* "soapcw/soapcw.pyx":613
+  /* "soapcw/soapcw.pyx":615
  *             fractions = np.array([np.ones(width)*i for i in fractions])
  * 
  *         det_order1 = np.ones(np.shape(fractions)).astype(np.int32)             # <<<<<<<<<<<<<<
  *         det_order1[fractions > 1] = int(1)
  *         det_order1[fractions <= 1] = int(0)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ones); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ones); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 615, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 615, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_shape); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_shape); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 615, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_14);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_14, function);
     }
   }
   __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_5, __pyx_v_fractions) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_v_fractions);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 613, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
   __pyx_t_14 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
     __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_11);
     if (likely(__pyx_t_14)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
@@ -13769,23 +13964,23 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_11, function);
     }
   }
   __pyx_t_13 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_14, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 613, __pyx_L1_error)
+  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 615, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_astype); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_astype); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 615, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 615, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   __pyx_t_13 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
     __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_11);
     if (likely(__pyx_t_13)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
@@ -13793,107 +13988,107 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_11, function);
     }
   }
   __pyx_t_3 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_13, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 613, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 615, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __pyx_v_det_order1 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":614
+  /* "soapcw/soapcw.pyx":616
  * 
  *         det_order1 = np.ones(np.shape(fractions)).astype(np.int32)
  *         det_order1[fractions > 1] = int(1)             # <<<<<<<<<<<<<<
  *         det_order1[fractions <= 1] = int(0)
  *         cdef int[:,:] det_order = det_order1
  */
-  __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_int_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 614, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_int_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 616, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_11 = PyObject_RichCompare(__pyx_v_fractions, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 614, __pyx_L1_error)
-  if (unlikely(PyObject_SetItem(__pyx_v_det_order1, __pyx_t_11, __pyx_t_3) < 0)) __PYX_ERR(0, 614, __pyx_L1_error)
+  __pyx_t_11 = PyObject_RichCompare(__pyx_v_fractions, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 616, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_det_order1, __pyx_t_11, __pyx_t_3) < 0)) __PYX_ERR(0, 616, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":615
+  /* "soapcw/soapcw.pyx":617
  *         det_order1 = np.ones(np.shape(fractions)).astype(np.int32)
  *         det_order1[fractions > 1] = int(1)
  *         det_order1[fractions <= 1] = int(0)             # <<<<<<<<<<<<<<
  *         cdef int[:,:] det_order = det_order1
  *         del det_order1
  */
-  __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_int_0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 615, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_int_0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 617, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_11 = PyObject_RichCompare(__pyx_v_fractions, __pyx_int_1, Py_LE); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 615, __pyx_L1_error)
-  if (unlikely(PyObject_SetItem(__pyx_v_det_order1, __pyx_t_11, __pyx_t_3) < 0)) __PYX_ERR(0, 615, __pyx_L1_error)
+  __pyx_t_11 = PyObject_RichCompare(__pyx_v_fractions, __pyx_int_1, Py_LE); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 617, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_det_order1, __pyx_t_11, __pyx_t_3) < 0)) __PYX_ERR(0, 617, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":616
+  /* "soapcw/soapcw.pyx":618
  *         det_order1[fractions > 1] = int(1)
  *         det_order1[fractions <= 1] = int(0)
  *         cdef int[:,:] det_order = det_order1             # <<<<<<<<<<<<<<
  *         del det_order1
  * 
  */
-  __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_det_order1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 616, __pyx_L1_error)
-  __pyx_v_det_order = __pyx_t_21;
-  __pyx_t_21.memview = NULL;
-  __pyx_t_21.data = NULL;
+  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_det_order1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 618, __pyx_L1_error)
+  __pyx_v_det_order = __pyx_t_12;
+  __pyx_t_12.memview = NULL;
+  __pyx_t_12.data = NULL;
 
-  /* "soapcw/soapcw.pyx":617
+  /* "soapcw/soapcw.pyx":619
  *         det_order1[fractions <= 1] = int(0)
  *         cdef int[:,:] det_order = det_order1
  *         del det_order1             # <<<<<<<<<<<<<<
  * 
  *         fractions[fractions > 1] = 1./fractions[fractions > 1]
  */
   __Pyx_DECREF(__pyx_v_det_order1);
   __pyx_v_det_order1 = NULL;
 
-  /* "soapcw/soapcw.pyx":619
+  /* "soapcw/soapcw.pyx":621
  *         del det_order1
  * 
  *         fractions[fractions > 1] = 1./fractions[fractions > 1]             # <<<<<<<<<<<<<<
  * 
  *         # make sure the fractions are the same dimensions as the input data and convert into an index
  */
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_fractions, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 619, __pyx_L1_error)
-  __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_fractions, __pyx_t_3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_v_fractions, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 621, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_fractions, __pyx_t_3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 621, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_11, 1., 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_11, 1., 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 621, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = PyObject_RichCompare(__pyx_v_fractions, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 619, __pyx_L1_error)
-  if (unlikely(PyObject_SetItem(__pyx_v_fractions, __pyx_t_11, __pyx_t_3) < 0)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_11 = PyObject_RichCompare(__pyx_v_fractions, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 621, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_fractions, __pyx_t_11, __pyx_t_3) < 0)) __PYX_ERR(0, 621, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":622
+  /* "soapcw/soapcw.pyx":624
  * 
  *         # make sure the fractions are the same dimensions as the input data and convert into an index
  *         frac_ind1 = np.array((fractions-frac_ranges[0])*frac_fact).astype(np.int32)             # <<<<<<<<<<<<<<
  *         frac_ind1[frac_ind1 < 0] = 0
  *         frac_ind1[frac_ind1 >= len(frac_ranges)] = -1
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_frac_ranges, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_frac_ranges, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_14 = PyNumber_Subtract(__pyx_v_fractions, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __pyx_t_14 = PyNumber_Subtract(__pyx_v_fractions, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_14, __pyx_v_frac_fact); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_14, __pyx_v_frac_fact); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
   __pyx_t_14 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
     __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
     if (likely(__pyx_t_14)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
@@ -13901,23 +14096,23 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_13, function);
     }
   }
   __pyx_t_11 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_14, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 622, __pyx_L1_error)
+  if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_astype); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_astype); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __pyx_t_11 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
     __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_13);
     if (likely(__pyx_t_11)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
@@ -13925,145 +14120,145 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_13, function);
     }
   }
   __pyx_t_3 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_11, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 622, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   __pyx_v_frac_ind1 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":623
+  /* "soapcw/soapcw.pyx":625
  *         # make sure the fractions are the same dimensions as the input data and convert into an index
  *         frac_ind1 = np.array((fractions-frac_ranges[0])*frac_fact).astype(np.int32)
  *         frac_ind1[frac_ind1 < 0] = 0             # <<<<<<<<<<<<<<
  *         frac_ind1[frac_ind1 >= len(frac_ranges)] = -1
  *         cdef int[:,:] frac_ind = frac_ind1
  */
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_frac_ind1, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)
-  if (unlikely(PyObject_SetItem(__pyx_v_frac_ind1, __pyx_t_3, __pyx_int_0) < 0)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_v_frac_ind1, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 625, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_frac_ind1, __pyx_t_3, __pyx_int_0) < 0)) __PYX_ERR(0, 625, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":624
+  /* "soapcw/soapcw.pyx":626
  *         frac_ind1 = np.array((fractions-frac_ranges[0])*frac_fact).astype(np.int32)
  *         frac_ind1[frac_ind1 < 0] = 0
  *         frac_ind1[frac_ind1 >= len(frac_ranges)] = -1             # <<<<<<<<<<<<<<
  *         cdef int[:,:] frac_ind = frac_ind1
  *         del frac_ind1
  */
-  __pyx_t_9 = PyObject_Length(__pyx_v_frac_ranges); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 624, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_9 = PyObject_Length(__pyx_v_frac_ranges); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 626, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 626, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_13 = PyObject_RichCompare(__pyx_v_frac_ind1, __pyx_t_3, Py_GE); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_13 = PyObject_RichCompare(__pyx_v_frac_ind1, __pyx_t_3, Py_GE); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 626, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(PyObject_SetItem(__pyx_v_frac_ind1, __pyx_t_13, __pyx_int_neg_1) < 0)) __PYX_ERR(0, 624, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_frac_ind1, __pyx_t_13, __pyx_int_neg_1) < 0)) __PYX_ERR(0, 626, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
-  /* "soapcw/soapcw.pyx":625
+  /* "soapcw/soapcw.pyx":627
  *         frac_ind1[frac_ind1 < 0] = 0
  *         frac_ind1[frac_ind1 >= len(frac_ranges)] = -1
  *         cdef int[:,:] frac_ind = frac_ind1             # <<<<<<<<<<<<<<
  *         del frac_ind1
  * 
  */
-  __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_frac_ind1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 625, __pyx_L1_error)
-  __pyx_v_frac_ind = __pyx_t_21;
-  __pyx_t_21.memview = NULL;
-  __pyx_t_21.data = NULL;
+  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_frac_ind1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 627, __pyx_L1_error)
+  __pyx_v_frac_ind = __pyx_t_12;
+  __pyx_t_12.memview = NULL;
+  __pyx_t_12.data = NULL;
 
-  /* "soapcw/soapcw.pyx":626
+  /* "soapcw/soapcw.pyx":628
  *         frac_ind1[frac_ind1 >= len(frac_ranges)] = -1
  *         cdef int[:,:] frac_ind = frac_ind1
  *         del frac_ind1             # <<<<<<<<<<<<<<
  * 
  *         obs1_ind_arr = (obs11 - pow_ranges[0])*pow_fact
  */
   __Pyx_DECREF(__pyx_v_frac_ind1);
   __pyx_v_frac_ind1 = NULL;
 
-  /* "soapcw/soapcw.pyx":628
+  /* "soapcw/soapcw.pyx":630
  *         del frac_ind1
  * 
  *         obs1_ind_arr = (obs11 - pow_ranges[0])*pow_fact             # <<<<<<<<<<<<<<
  *         obs1_ind_arr[obs1_ind_arr >= len(pow_ranges)] = -1
  *         obs1_ind_arr[obs1_ind_arr < 0] = 0
  */
-  __pyx_t_13 = __Pyx_GetItemInt(__pyx_v_pow_ranges, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 628, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_GetItemInt(__pyx_v_pow_ranges, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 630, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_3 = PyNumber_Subtract(__pyx_v_obs11, __pyx_t_13); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 628, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_v_obs11, __pyx_t_13); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 630, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = PyNumber_Multiply(__pyx_t_3, __pyx_v_pow_fact); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 628, __pyx_L1_error)
+  __pyx_t_13 = PyNumber_Multiply(__pyx_t_3, __pyx_v_pow_fact); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 630, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_obs1_ind_arr = __pyx_t_13;
   __pyx_t_13 = 0;
 
-  /* "soapcw/soapcw.pyx":629
+  /* "soapcw/soapcw.pyx":631
  * 
  *         obs1_ind_arr = (obs11 - pow_ranges[0])*pow_fact
  *         obs1_ind_arr[obs1_ind_arr >= len(pow_ranges)] = -1             # <<<<<<<<<<<<<<
  *         obs1_ind_arr[obs1_ind_arr < 0] = 0
  *         cdef int[:,:] obs1_ind = np.array(obs1_ind_arr).astype(np.int32)
  */
-  __pyx_t_9 = PyObject_Length(__pyx_v_pow_ranges); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 629, __pyx_L1_error)
-  __pyx_t_13 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __pyx_t_9 = PyObject_Length(__pyx_v_pow_ranges); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_13 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 631, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_obs1_ind_arr, __pyx_t_13, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_v_obs1_ind_arr, __pyx_t_13, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 631, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (unlikely(PyObject_SetItem(__pyx_v_obs1_ind_arr, __pyx_t_3, __pyx_int_neg_1) < 0)) __PYX_ERR(0, 629, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_obs1_ind_arr, __pyx_t_3, __pyx_int_neg_1) < 0)) __PYX_ERR(0, 631, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":630
+  /* "soapcw/soapcw.pyx":632
  *         obs1_ind_arr = (obs11 - pow_ranges[0])*pow_fact
  *         obs1_ind_arr[obs1_ind_arr >= len(pow_ranges)] = -1
  *         obs1_ind_arr[obs1_ind_arr < 0] = 0             # <<<<<<<<<<<<<<
  *         cdef int[:,:] obs1_ind = np.array(obs1_ind_arr).astype(np.int32)
  *         del obs1_ind_arr
  */
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_obs1_ind_arr, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 630, __pyx_L1_error)
-  if (unlikely(PyObject_SetItem(__pyx_v_obs1_ind_arr, __pyx_t_3, __pyx_int_0) < 0)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_v_obs1_ind_arr, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 632, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_obs1_ind_arr, __pyx_t_3, __pyx_int_0) < 0)) __PYX_ERR(0, 632, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":631
+  /* "soapcw/soapcw.pyx":633
  *         obs1_ind_arr[obs1_ind_arr >= len(pow_ranges)] = -1
  *         obs1_ind_arr[obs1_ind_arr < 0] = 0
  *         cdef int[:,:] obs1_ind = np.array(obs1_ind_arr).astype(np.int32)             # <<<<<<<<<<<<<<
  *         del obs1_ind_arr
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_11);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_11, function);
     }
   }
   __pyx_t_13 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_4, __pyx_v_obs1_ind_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_v_obs1_ind_arr);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 631, __pyx_L1_error)
+  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_astype); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_astype); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   __pyx_t_13 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
     __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_11);
     if (likely(__pyx_t_13)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
@@ -14071,110 +14266,110 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_11, function);
     }
   }
   __pyx_t_3 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_13, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 631, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_obs1_ind = __pyx_t_21;
-  __pyx_t_21.memview = NULL;
-  __pyx_t_21.data = NULL;
+  __pyx_v_obs1_ind = __pyx_t_12;
+  __pyx_t_12.memview = NULL;
+  __pyx_t_12.data = NULL;
 
-  /* "soapcw/soapcw.pyx":632
+  /* "soapcw/soapcw.pyx":634
  *         obs1_ind_arr[obs1_ind_arr < 0] = 0
  *         cdef int[:,:] obs1_ind = np.array(obs1_ind_arr).astype(np.int32)
  *         del obs1_ind_arr             # <<<<<<<<<<<<<<
  * 
  *         obs2_ind_arr = (obs21-pow_ranges[0])*pow_fact
  */
   __Pyx_DECREF(__pyx_v_obs1_ind_arr);
   __pyx_v_obs1_ind_arr = NULL;
 
-  /* "soapcw/soapcw.pyx":634
+  /* "soapcw/soapcw.pyx":636
  *         del obs1_ind_arr
  * 
  *         obs2_ind_arr = (obs21-pow_ranges[0])*pow_fact             # <<<<<<<<<<<<<<
  *         obs2_ind_arr[obs2_ind_arr >= len(pow_ranges)] = -1
  *         obs2_ind_arr[obs2_ind_arr < 0] = 0
  */
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_pow_ranges, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_pow_ranges, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_11 = PyNumber_Subtract(__pyx_v_obs21, __pyx_t_3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __pyx_t_11 = PyNumber_Subtract(__pyx_v_obs21, __pyx_t_3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 636, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_11, __pyx_v_pow_fact); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_11, __pyx_v_pow_fact); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __pyx_v_obs2_ind_arr = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":635
+  /* "soapcw/soapcw.pyx":637
  * 
  *         obs2_ind_arr = (obs21-pow_ranges[0])*pow_fact
  *         obs2_ind_arr[obs2_ind_arr >= len(pow_ranges)] = -1             # <<<<<<<<<<<<<<
  *         obs2_ind_arr[obs2_ind_arr < 0] = 0
  *         cdef int[:,:] obs2_ind = np.array(obs2_ind_arr).astype(np.int32)
  */
-  __pyx_t_9 = PyObject_Length(__pyx_v_pow_ranges); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 635, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_9 = PyObject_Length(__pyx_v_pow_ranges); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_11 = PyObject_RichCompare(__pyx_v_obs2_ind_arr, __pyx_t_3, Py_GE); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_11 = PyObject_RichCompare(__pyx_v_obs2_ind_arr, __pyx_t_3, Py_GE); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 637, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(PyObject_SetItem(__pyx_v_obs2_ind_arr, __pyx_t_11, __pyx_int_neg_1) < 0)) __PYX_ERR(0, 635, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_obs2_ind_arr, __pyx_t_11, __pyx_int_neg_1) < 0)) __PYX_ERR(0, 637, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-  /* "soapcw/soapcw.pyx":636
+  /* "soapcw/soapcw.pyx":638
  *         obs2_ind_arr = (obs21-pow_ranges[0])*pow_fact
  *         obs2_ind_arr[obs2_ind_arr >= len(pow_ranges)] = -1
  *         obs2_ind_arr[obs2_ind_arr < 0] = 0             # <<<<<<<<<<<<<<
  *         cdef int[:,:] obs2_ind = np.array(obs2_ind_arr).astype(np.int32)
  *         del obs2_ind_arr
  */
-  __pyx_t_11 = PyObject_RichCompare(__pyx_v_obs2_ind_arr, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 636, __pyx_L1_error)
-  if (unlikely(PyObject_SetItem(__pyx_v_obs2_ind_arr, __pyx_t_11, __pyx_int_0) < 0)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_11 = PyObject_RichCompare(__pyx_v_obs2_ind_arr, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 638, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_obs2_ind_arr, __pyx_t_11, __pyx_int_0) < 0)) __PYX_ERR(0, 638, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-  /* "soapcw/soapcw.pyx":637
+  /* "soapcw/soapcw.pyx":639
  *         obs2_ind_arr[obs2_ind_arr >= len(pow_ranges)] = -1
  *         obs2_ind_arr[obs2_ind_arr < 0] = 0
  *         cdef int[:,:] obs2_ind = np.array(obs2_ind_arr).astype(np.int32)             # <<<<<<<<<<<<<<
  *         del obs2_ind_arr
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_13);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_13, function);
     }
   }
   __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_4, __pyx_v_obs2_ind_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_v_obs2_ind_arr);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_13);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
@@ -14182,924 +14377,924 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_13, function);
     }
   }
   __pyx_t_11 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 637, __pyx_L1_error)
+  if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_v_obs2_ind = __pyx_t_21;
-  __pyx_t_21.memview = NULL;
-  __pyx_t_21.data = NULL;
+  __pyx_v_obs2_ind = __pyx_t_12;
+  __pyx_t_12.memview = NULL;
+  __pyx_t_12.data = NULL;
 
-  /* "soapcw/soapcw.pyx":638
+  /* "soapcw/soapcw.pyx":640
  *         obs2_ind_arr[obs2_ind_arr < 0] = 0
  *         cdef int[:,:] obs2_ind = np.array(obs2_ind_arr).astype(np.int32)
  *         del obs2_ind_arr             # <<<<<<<<<<<<<<
  * 
  *         for i in range(width):
  */
   __Pyx_DECREF(__pyx_v_obs2_ind_arr);
   __pyx_v_obs2_ind_arr = NULL;
 
-  /* "soapcw/soapcw.pyx":640
+  /* "soapcw/soapcw.pyx":642
  *         del obs2_ind_arr
  * 
  *         for i in range(width):             # <<<<<<<<<<<<<<
  *             temp = -1e6
  *             for k in range(sep_len):
  */
   __pyx_t_19 = __pyx_v_width;
-  __pyx_t_22 = __pyx_t_19;
-  for (__pyx_t_23 = 0; __pyx_t_23 < __pyx_t_22; __pyx_t_23+=1) {
-    __pyx_v_i = __pyx_t_23;
+  __pyx_t_21 = __pyx_t_19;
+  for (__pyx_t_22 = 0; __pyx_t_22 < __pyx_t_21; __pyx_t_22+=1) {
+    __pyx_v_i = __pyx_t_22;
 
-    /* "soapcw/soapcw.pyx":641
+    /* "soapcw/soapcw.pyx":643
  * 
  *         for i in range(width):
  *             temp = -1e6             # <<<<<<<<<<<<<<
  *             for k in range(sep_len):
  *                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  */
     __pyx_v_temp = -1e6;
 
-    /* "soapcw/soapcw.pyx":642
+    /* "soapcw/soapcw.pyx":644
  *         for i in range(width):
  *             temp = -1e6
  *             for k in range(sep_len):             # <<<<<<<<<<<<<<
  *                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                     for m in range(sep_len):
  */
-    __pyx_t_24 = __pyx_v_sep_len;
-    __pyx_t_25 = __pyx_t_24;
-    for (__pyx_t_26 = 0; __pyx_t_26 < __pyx_t_25; __pyx_t_26+=1) {
-      __pyx_v_k = __pyx_t_26;
+    __pyx_t_23 = __pyx_v_sep_len;
+    __pyx_t_24 = __pyx_t_23;
+    for (__pyx_t_25 = 0; __pyx_t_25 < __pyx_t_24; __pyx_t_25+=1) {
+      __pyx_v_k = __pyx_t_25;
 
-      /* "soapcw/soapcw.pyx":643
+      /* "soapcw/soapcw.pyx":645
  *             temp = -1e6
  *             for k in range(sep_len):
  *                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                     for m in range(sep_len):
  *                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  */
-      __pyx_t_27 = ((((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist) >= (0 + __pyx_v_edge_range)) != 0);
-      if (__pyx_t_27) {
+      __pyx_t_26 = ((((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist) >= (0 + __pyx_v_edge_range)) != 0);
+      if (__pyx_t_26) {
       } else {
-        __pyx_t_18 = __pyx_t_27;
+        __pyx_t_18 = __pyx_t_26;
         goto __pyx_L19_bool_binop_done;
       }
-      __pyx_t_27 = ((((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist) < (__pyx_v_width - __pyx_v_edge_range)) != 0);
-      __pyx_t_18 = __pyx_t_27;
+      __pyx_t_26 = ((((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist) < (__pyx_v_width - __pyx_v_edge_range)) != 0);
+      __pyx_t_18 = __pyx_t_26;
       __pyx_L19_bool_binop_done:;
       if (__pyx_t_18) {
 
-        /* "soapcw/soapcw.pyx":644
+        /* "soapcw/soapcw.pyx":646
  *             for k in range(sep_len):
  *                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                     for m in range(sep_len):             # <<<<<<<<<<<<<<
  *                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                             o1 = int(obs1_ind[0][i+k-sep_dist])
  */
-        __pyx_t_28 = __pyx_v_sep_len;
-        __pyx_t_29 = __pyx_t_28;
-        for (__pyx_t_30 = 0; __pyx_t_30 < __pyx_t_29; __pyx_t_30+=1) {
-          __pyx_v_m = __pyx_t_30;
+        __pyx_t_27 = __pyx_v_sep_len;
+        __pyx_t_28 = __pyx_t_27;
+        for (__pyx_t_29 = 0; __pyx_t_29 < __pyx_t_28; __pyx_t_29+=1) {
+          __pyx_v_m = __pyx_t_29;
 
-          /* "soapcw/soapcw.pyx":645
+          /* "soapcw/soapcw.pyx":647
  *                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                     for m in range(sep_len):
  *                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                             o1 = int(obs1_ind[0][i+k-sep_dist])
  *                             o2 = int(obs2_ind[0][i+m-sep_dist])
  */
-          __pyx_t_27 = ((((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist) >= (0 + __pyx_v_edge_range)) != 0);
-          if (__pyx_t_27) {
+          __pyx_t_26 = ((((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist) >= (0 + __pyx_v_edge_range)) != 0);
+          if (__pyx_t_26) {
           } else {
-            __pyx_t_18 = __pyx_t_27;
+            __pyx_t_18 = __pyx_t_26;
             goto __pyx_L24_bool_binop_done;
           }
-          __pyx_t_27 = ((((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist) < (__pyx_v_width - __pyx_v_edge_range)) != 0);
-          __pyx_t_18 = __pyx_t_27;
+          __pyx_t_26 = ((((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist) < (__pyx_v_width - __pyx_v_edge_range)) != 0);
+          __pyx_t_18 = __pyx_t_26;
           __pyx_L24_bool_binop_done:;
           if (__pyx_t_18) {
 
-            /* "soapcw/soapcw.pyx":646
+            /* "soapcw/soapcw.pyx":648
  *                     for m in range(sep_len):
  *                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                             o1 = int(obs1_ind[0][i+k-sep_dist])             # <<<<<<<<<<<<<<
  *                             o2 = int(obs2_ind[0][i+m-sep_dist])
  *                             value = tr[1][k][m] + logarr[det_order[0,i],frac_ind[0,i],o1,o2]
  */
-            __pyx_t_31 = 0;
-            __pyx_t_32 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
-            __pyx_t_33 = -1;
+            __pyx_t_30 = 0;
+            __pyx_t_31 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
+            __pyx_t_32 = -1;
+            if (__pyx_t_30 < 0) {
+              __pyx_t_30 += __pyx_v_obs1_ind.shape[0];
+              if (unlikely(__pyx_t_30 < 0)) __pyx_t_32 = 0;
+            } else if (unlikely(__pyx_t_30 >= __pyx_v_obs1_ind.shape[0])) __pyx_t_32 = 0;
             if (__pyx_t_31 < 0) {
-              __pyx_t_31 += __pyx_v_obs1_ind.shape[0];
-              if (unlikely(__pyx_t_31 < 0)) __pyx_t_33 = 0;
-            } else if (unlikely(__pyx_t_31 >= __pyx_v_obs1_ind.shape[0])) __pyx_t_33 = 0;
-            if (__pyx_t_32 < 0) {
-              __pyx_t_32 += __pyx_v_obs1_ind.shape[1];
-              if (unlikely(__pyx_t_32 < 0)) __pyx_t_33 = 1;
-            } else if (unlikely(__pyx_t_32 >= __pyx_v_obs1_ind.shape[1])) __pyx_t_33 = 1;
-            if (unlikely(__pyx_t_33 != -1)) {
-              __Pyx_RaiseBufferIndexError(__pyx_t_33);
-              __PYX_ERR(0, 646, __pyx_L1_error)
+              __pyx_t_31 += __pyx_v_obs1_ind.shape[1];
+              if (unlikely(__pyx_t_31 < 0)) __pyx_t_32 = 1;
+            } else if (unlikely(__pyx_t_31 >= __pyx_v_obs1_ind.shape[1])) __pyx_t_32 = 1;
+            if (unlikely(__pyx_t_32 != -1)) {
+              __Pyx_RaiseBufferIndexError(__pyx_t_32);
+              __PYX_ERR(0, 648, __pyx_L1_error)
             }
-            __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind.data + __pyx_t_31 * __pyx_v_obs1_ind.strides[0]) ) + __pyx_t_32 * __pyx_v_obs1_ind.strides[1]) )));
+            __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind.data + __pyx_t_30 * __pyx_v_obs1_ind.strides[0]) ) + __pyx_t_31 * __pyx_v_obs1_ind.strides[1]) )));
 
-            /* "soapcw/soapcw.pyx":647
+            /* "soapcw/soapcw.pyx":649
  *                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                             o1 = int(obs1_ind[0][i+k-sep_dist])
  *                             o2 = int(obs2_ind[0][i+m-sep_dist])             # <<<<<<<<<<<<<<
  *                             value = tr[1][k][m] + logarr[det_order[0,i],frac_ind[0,i],o1,o2]
  *                             if value > temp:
  */
-            __pyx_t_34 = 0;
-            __pyx_t_35 = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
-            __pyx_t_33 = -1;
-            if (__pyx_t_34 < 0) {
-              __pyx_t_34 += __pyx_v_obs2_ind.shape[0];
-              if (unlikely(__pyx_t_34 < 0)) __pyx_t_33 = 0;
-            } else if (unlikely(__pyx_t_34 >= __pyx_v_obs2_ind.shape[0])) __pyx_t_33 = 0;
-            if (__pyx_t_35 < 0) {
-              __pyx_t_35 += __pyx_v_obs2_ind.shape[1];
-              if (unlikely(__pyx_t_35 < 0)) __pyx_t_33 = 1;
-            } else if (unlikely(__pyx_t_35 >= __pyx_v_obs2_ind.shape[1])) __pyx_t_33 = 1;
-            if (unlikely(__pyx_t_33 != -1)) {
-              __Pyx_RaiseBufferIndexError(__pyx_t_33);
-              __PYX_ERR(0, 647, __pyx_L1_error)
+            __pyx_t_31 = 0;
+            __pyx_t_30 = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
+            __pyx_t_32 = -1;
+            if (__pyx_t_31 < 0) {
+              __pyx_t_31 += __pyx_v_obs2_ind.shape[0];
+              if (unlikely(__pyx_t_31 < 0)) __pyx_t_32 = 0;
+            } else if (unlikely(__pyx_t_31 >= __pyx_v_obs2_ind.shape[0])) __pyx_t_32 = 0;
+            if (__pyx_t_30 < 0) {
+              __pyx_t_30 += __pyx_v_obs2_ind.shape[1];
+              if (unlikely(__pyx_t_30 < 0)) __pyx_t_32 = 1;
+            } else if (unlikely(__pyx_t_30 >= __pyx_v_obs2_ind.shape[1])) __pyx_t_32 = 1;
+            if (unlikely(__pyx_t_32 != -1)) {
+              __Pyx_RaiseBufferIndexError(__pyx_t_32);
+              __PYX_ERR(0, 649, __pyx_L1_error)
             }
-            __pyx_v_o2 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs2_ind.data + __pyx_t_34 * __pyx_v_obs2_ind.strides[0]) ) + __pyx_t_35 * __pyx_v_obs2_ind.strides[1]) )));
+            __pyx_v_o2 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs2_ind.data + __pyx_t_31 * __pyx_v_obs2_ind.strides[0]) ) + __pyx_t_30 * __pyx_v_obs2_ind.strides[1]) )));
 
-            /* "soapcw/soapcw.pyx":648
+            /* "soapcw/soapcw.pyx":650
  *                             o1 = int(obs1_ind[0][i+k-sep_dist])
  *                             o2 = int(obs2_ind[0][i+m-sep_dist])
  *                             value = tr[1][k][m] + logarr[det_order[0,i],frac_ind[0,i],o1,o2]             # <<<<<<<<<<<<<<
  *                             if value > temp:
  *                                 temp = value
  */
-            __pyx_t_36 = 1;
-            __pyx_t_37 = __pyx_v_k;
-            __pyx_t_38 = __pyx_v_m;
-            __pyx_t_33 = -1;
+            __pyx_t_30 = 1;
+            __pyx_t_31 = __pyx_v_k;
+            __pyx_t_33 = __pyx_v_m;
+            __pyx_t_32 = -1;
+            if (__pyx_t_30 < 0) {
+              __pyx_t_30 += __pyx_v_tr.shape[0];
+              if (unlikely(__pyx_t_30 < 0)) __pyx_t_32 = 0;
+            } else if (unlikely(__pyx_t_30 >= __pyx_v_tr.shape[0])) __pyx_t_32 = 0;
+            if (__pyx_t_31 < 0) {
+              __pyx_t_31 += __pyx_v_tr.shape[1];
+              if (unlikely(__pyx_t_31 < 0)) __pyx_t_32 = 1;
+            } else if (unlikely(__pyx_t_31 >= __pyx_v_tr.shape[1])) __pyx_t_32 = 1;
+            if (__pyx_t_33 < 0) {
+              __pyx_t_33 += __pyx_v_tr.shape[2];
+              if (unlikely(__pyx_t_33 < 0)) __pyx_t_32 = 2;
+            } else if (unlikely(__pyx_t_33 >= __pyx_v_tr.shape[2])) __pyx_t_32 = 2;
+            if (unlikely(__pyx_t_32 != -1)) {
+              __Pyx_RaiseBufferIndexError(__pyx_t_32);
+              __PYX_ERR(0, 650, __pyx_L1_error)
+            }
+            __pyx_t_34 = 0;
+            __pyx_t_35 = __pyx_v_i;
+            __pyx_t_32 = -1;
+            if (__pyx_t_34 < 0) {
+              __pyx_t_34 += __pyx_v_det_order.shape[0];
+              if (unlikely(__pyx_t_34 < 0)) __pyx_t_32 = 0;
+            } else if (unlikely(__pyx_t_34 >= __pyx_v_det_order.shape[0])) __pyx_t_32 = 0;
+            if (__pyx_t_35 < 0) {
+              __pyx_t_35 += __pyx_v_det_order.shape[1];
+              if (unlikely(__pyx_t_35 < 0)) __pyx_t_32 = 1;
+            } else if (unlikely(__pyx_t_35 >= __pyx_v_det_order.shape[1])) __pyx_t_32 = 1;
+            if (unlikely(__pyx_t_32 != -1)) {
+              __Pyx_RaiseBufferIndexError(__pyx_t_32);
+              __PYX_ERR(0, 650, __pyx_L1_error)
+            }
+            __pyx_t_36 = 0;
+            __pyx_t_37 = __pyx_v_i;
+            __pyx_t_32 = -1;
             if (__pyx_t_36 < 0) {
-              __pyx_t_36 += __pyx_v_tr.shape[0];
-              if (unlikely(__pyx_t_36 < 0)) __pyx_t_33 = 0;
-            } else if (unlikely(__pyx_t_36 >= __pyx_v_tr.shape[0])) __pyx_t_33 = 0;
+              __pyx_t_36 += __pyx_v_frac_ind.shape[0];
+              if (unlikely(__pyx_t_36 < 0)) __pyx_t_32 = 0;
+            } else if (unlikely(__pyx_t_36 >= __pyx_v_frac_ind.shape[0])) __pyx_t_32 = 0;
             if (__pyx_t_37 < 0) {
-              __pyx_t_37 += __pyx_v_tr.shape[1];
-              if (unlikely(__pyx_t_37 < 0)) __pyx_t_33 = 1;
-            } else if (unlikely(__pyx_t_37 >= __pyx_v_tr.shape[1])) __pyx_t_33 = 1;
+              __pyx_t_37 += __pyx_v_frac_ind.shape[1];
+              if (unlikely(__pyx_t_37 < 0)) __pyx_t_32 = 1;
+            } else if (unlikely(__pyx_t_37 >= __pyx_v_frac_ind.shape[1])) __pyx_t_32 = 1;
+            if (unlikely(__pyx_t_32 != -1)) {
+              __Pyx_RaiseBufferIndexError(__pyx_t_32);
+              __PYX_ERR(0, 650, __pyx_L1_error)
+            }
+            __pyx_t_38 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det_order.data + __pyx_t_34 * __pyx_v_det_order.strides[0]) ) + __pyx_t_35 * __pyx_v_det_order.strides[1]) )));
+            __pyx_t_39 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_frac_ind.data + __pyx_t_36 * __pyx_v_frac_ind.strides[0]) ) + __pyx_t_37 * __pyx_v_frac_ind.strides[1]) )));
+            __pyx_t_40 = __pyx_v_o1;
+            __pyx_t_41 = __pyx_v_o2;
+            __pyx_t_32 = -1;
             if (__pyx_t_38 < 0) {
-              __pyx_t_38 += __pyx_v_tr.shape[2];
-              if (unlikely(__pyx_t_38 < 0)) __pyx_t_33 = 2;
-            } else if (unlikely(__pyx_t_38 >= __pyx_v_tr.shape[2])) __pyx_t_33 = 2;
-            if (unlikely(__pyx_t_33 != -1)) {
-              __Pyx_RaiseBufferIndexError(__pyx_t_33);
-              __PYX_ERR(0, 648, __pyx_L1_error)
-            }
-            __pyx_t_39 = 0;
-            __pyx_t_40 = __pyx_v_i;
-            __pyx_t_33 = -1;
+              __pyx_t_38 += __pyx_v_logarr.shape[0];
+              if (unlikely(__pyx_t_38 < 0)) __pyx_t_32 = 0;
+            } else if (unlikely(__pyx_t_38 >= __pyx_v_logarr.shape[0])) __pyx_t_32 = 0;
             if (__pyx_t_39 < 0) {
-              __pyx_t_39 += __pyx_v_det_order.shape[0];
-              if (unlikely(__pyx_t_39 < 0)) __pyx_t_33 = 0;
-            } else if (unlikely(__pyx_t_39 >= __pyx_v_det_order.shape[0])) __pyx_t_33 = 0;
+              __pyx_t_39 += __pyx_v_logarr.shape[1];
+              if (unlikely(__pyx_t_39 < 0)) __pyx_t_32 = 1;
+            } else if (unlikely(__pyx_t_39 >= __pyx_v_logarr.shape[1])) __pyx_t_32 = 1;
             if (__pyx_t_40 < 0) {
-              __pyx_t_40 += __pyx_v_det_order.shape[1];
-              if (unlikely(__pyx_t_40 < 0)) __pyx_t_33 = 1;
-            } else if (unlikely(__pyx_t_40 >= __pyx_v_det_order.shape[1])) __pyx_t_33 = 1;
-            if (unlikely(__pyx_t_33 != -1)) {
-              __Pyx_RaiseBufferIndexError(__pyx_t_33);
-              __PYX_ERR(0, 648, __pyx_L1_error)
-            }
-            __pyx_t_41 = 0;
-            __pyx_t_42 = __pyx_v_i;
-            __pyx_t_33 = -1;
+              __pyx_t_40 += __pyx_v_logarr.shape[2];
+              if (unlikely(__pyx_t_40 < 0)) __pyx_t_32 = 2;
+            } else if (unlikely(__pyx_t_40 >= __pyx_v_logarr.shape[2])) __pyx_t_32 = 2;
             if (__pyx_t_41 < 0) {
-              __pyx_t_41 += __pyx_v_frac_ind.shape[0];
-              if (unlikely(__pyx_t_41 < 0)) __pyx_t_33 = 0;
-            } else if (unlikely(__pyx_t_41 >= __pyx_v_frac_ind.shape[0])) __pyx_t_33 = 0;
-            if (__pyx_t_42 < 0) {
-              __pyx_t_42 += __pyx_v_frac_ind.shape[1];
-              if (unlikely(__pyx_t_42 < 0)) __pyx_t_33 = 1;
-            } else if (unlikely(__pyx_t_42 >= __pyx_v_frac_ind.shape[1])) __pyx_t_33 = 1;
-            if (unlikely(__pyx_t_33 != -1)) {
-              __Pyx_RaiseBufferIndexError(__pyx_t_33);
-              __PYX_ERR(0, 648, __pyx_L1_error)
-            }
-            __pyx_t_43 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det_order.data + __pyx_t_39 * __pyx_v_det_order.strides[0]) ) + __pyx_t_40 * __pyx_v_det_order.strides[1]) )));
-            __pyx_t_44 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_frac_ind.data + __pyx_t_41 * __pyx_v_frac_ind.strides[0]) ) + __pyx_t_42 * __pyx_v_frac_ind.strides[1]) )));
-            __pyx_t_45 = __pyx_v_o1;
-            __pyx_t_46 = __pyx_v_o2;
-            __pyx_t_33 = -1;
-            if (__pyx_t_43 < 0) {
-              __pyx_t_43 += __pyx_v_logarr.shape[0];
-              if (unlikely(__pyx_t_43 < 0)) __pyx_t_33 = 0;
-            } else if (unlikely(__pyx_t_43 >= __pyx_v_logarr.shape[0])) __pyx_t_33 = 0;
-            if (__pyx_t_44 < 0) {
-              __pyx_t_44 += __pyx_v_logarr.shape[1];
-              if (unlikely(__pyx_t_44 < 0)) __pyx_t_33 = 1;
-            } else if (unlikely(__pyx_t_44 >= __pyx_v_logarr.shape[1])) __pyx_t_33 = 1;
-            if (__pyx_t_45 < 0) {
-              __pyx_t_45 += __pyx_v_logarr.shape[2];
-              if (unlikely(__pyx_t_45 < 0)) __pyx_t_33 = 2;
-            } else if (unlikely(__pyx_t_45 >= __pyx_v_logarr.shape[2])) __pyx_t_33 = 2;
-            if (__pyx_t_46 < 0) {
-              __pyx_t_46 += __pyx_v_logarr.shape[3];
-              if (unlikely(__pyx_t_46 < 0)) __pyx_t_33 = 3;
-            } else if (unlikely(__pyx_t_46 >= __pyx_v_logarr.shape[3])) __pyx_t_33 = 3;
-            if (unlikely(__pyx_t_33 != -1)) {
-              __Pyx_RaiseBufferIndexError(__pyx_t_33);
-              __PYX_ERR(0, 648, __pyx_L1_error)
+              __pyx_t_41 += __pyx_v_logarr.shape[3];
+              if (unlikely(__pyx_t_41 < 0)) __pyx_t_32 = 3;
+            } else if (unlikely(__pyx_t_41 >= __pyx_v_logarr.shape[3])) __pyx_t_32 = 3;
+            if (unlikely(__pyx_t_32 != -1)) {
+              __Pyx_RaiseBufferIndexError(__pyx_t_32);
+              __PYX_ERR(0, 650, __pyx_L1_error)
             }
-            __pyx_v_value = ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_36 * __pyx_v_tr.strides[0]) ) + __pyx_t_37 * __pyx_v_tr.strides[1]) ) + __pyx_t_38 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_logarr.data + __pyx_t_43 * __pyx_v_logarr.strides[0]) ) + __pyx_t_44 * __pyx_v_logarr.strides[1]) ) + __pyx_t_45 * __pyx_v_logarr.strides[2]) ) + __pyx_t_46 * __pyx_v_logarr.strides[3]) ))));
+            __pyx_v_value = ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_30 * __pyx_v_tr.strides[0]) ) + __pyx_t_31 * __pyx_v_tr.strides[1]) ) + __pyx_t_33 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_logarr.data + __pyx_t_38 * __pyx_v_logarr.strides[0]) ) + __pyx_t_39 * __pyx_v_logarr.strides[1]) ) + __pyx_t_40 * __pyx_v_logarr.strides[2]) ) + __pyx_t_41 * __pyx_v_logarr.strides[3]) ))));
 
-            /* "soapcw/soapcw.pyx":649
+            /* "soapcw/soapcw.pyx":651
  *                             o2 = int(obs2_ind[0][i+m-sep_dist])
  *                             value = tr[1][k][m] + logarr[det_order[0,i],frac_ind[0,i],o1,o2]
  *                             if value > temp:             # <<<<<<<<<<<<<<
  *                                 temp = value
  *                                 val[0][i] = temp
  */
             __pyx_t_18 = ((__pyx_v_value > __pyx_v_temp) != 0);
             if (__pyx_t_18) {
 
-              /* "soapcw/soapcw.pyx":650
+              /* "soapcw/soapcw.pyx":652
  *                             value = tr[1][k][m] + logarr[det_order[0,i],frac_ind[0,i],o1,o2]
  *                             if value > temp:
  *                                 temp = value             # <<<<<<<<<<<<<<
  *                                 val[0][i] = temp
  *                                 prev[0][i] =  i
  */
               __pyx_v_temp = __pyx_v_value;
 
-              /* "soapcw/soapcw.pyx":651
+              /* "soapcw/soapcw.pyx":653
  *                             if value > temp:
  *                                 temp = value
  *                                 val[0][i] = temp             # <<<<<<<<<<<<<<
  *                                 prev[0][i] =  i
  *                                 det1[0][i] =  i+k-1
  */
-              __pyx_t_47 = 0;
-              __pyx_t_48 = __pyx_v_i;
-              __pyx_t_33 = -1;
-              if (__pyx_t_47 < 0) {
-                __pyx_t_47 += __pyx_v_val.shape[0];
-                if (unlikely(__pyx_t_47 < 0)) __pyx_t_33 = 0;
-              } else if (unlikely(__pyx_t_47 >= __pyx_v_val.shape[0])) __pyx_t_33 = 0;
-              if (__pyx_t_48 < 0) {
-                __pyx_t_48 += __pyx_v_val.shape[1];
-                if (unlikely(__pyx_t_48 < 0)) __pyx_t_33 = 1;
-              } else if (unlikely(__pyx_t_48 >= __pyx_v_val.shape[1])) __pyx_t_33 = 1;
-              if (unlikely(__pyx_t_33 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_33);
-                __PYX_ERR(0, 651, __pyx_L1_error)
+              __pyx_t_37 = 0;
+              __pyx_t_36 = __pyx_v_i;
+              __pyx_t_32 = -1;
+              if (__pyx_t_37 < 0) {
+                __pyx_t_37 += __pyx_v_val.shape[0];
+                if (unlikely(__pyx_t_37 < 0)) __pyx_t_32 = 0;
+              } else if (unlikely(__pyx_t_37 >= __pyx_v_val.shape[0])) __pyx_t_32 = 0;
+              if (__pyx_t_36 < 0) {
+                __pyx_t_36 += __pyx_v_val.shape[1];
+                if (unlikely(__pyx_t_36 < 0)) __pyx_t_32 = 1;
+              } else if (unlikely(__pyx_t_36 >= __pyx_v_val.shape[1])) __pyx_t_32 = 1;
+              if (unlikely(__pyx_t_32 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_32);
+                __PYX_ERR(0, 653, __pyx_L1_error)
               }
-              *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_47 * __pyx_v_val.strides[0]) ) + __pyx_t_48 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
+              *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_37 * __pyx_v_val.strides[0]) ) + __pyx_t_36 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
 
-              /* "soapcw/soapcw.pyx":652
+              /* "soapcw/soapcw.pyx":654
  *                                 temp = value
  *                                 val[0][i] = temp
  *                                 prev[0][i] =  i             # <<<<<<<<<<<<<<
  *                                 det1[0][i] =  i+k-1
  *                                 det2[0][i] =  i+m-1
  */
-              __pyx_t_49 = 0;
-              __pyx_t_50 = __pyx_v_i;
-              __pyx_t_33 = -1;
-              if (__pyx_t_49 < 0) {
-                __pyx_t_49 += __pyx_v_prev.shape[0];
-                if (unlikely(__pyx_t_49 < 0)) __pyx_t_33 = 0;
-              } else if (unlikely(__pyx_t_49 >= __pyx_v_prev.shape[0])) __pyx_t_33 = 0;
-              if (__pyx_t_50 < 0) {
-                __pyx_t_50 += __pyx_v_prev.shape[1];
-                if (unlikely(__pyx_t_50 < 0)) __pyx_t_33 = 1;
-              } else if (unlikely(__pyx_t_50 >= __pyx_v_prev.shape[1])) __pyx_t_33 = 1;
-              if (unlikely(__pyx_t_33 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_33);
-                __PYX_ERR(0, 652, __pyx_L1_error)
+              __pyx_t_36 = 0;
+              __pyx_t_37 = __pyx_v_i;
+              __pyx_t_32 = -1;
+              if (__pyx_t_36 < 0) {
+                __pyx_t_36 += __pyx_v_prev.shape[0];
+                if (unlikely(__pyx_t_36 < 0)) __pyx_t_32 = 0;
+              } else if (unlikely(__pyx_t_36 >= __pyx_v_prev.shape[0])) __pyx_t_32 = 0;
+              if (__pyx_t_37 < 0) {
+                __pyx_t_37 += __pyx_v_prev.shape[1];
+                if (unlikely(__pyx_t_37 < 0)) __pyx_t_32 = 1;
+              } else if (unlikely(__pyx_t_37 >= __pyx_v_prev.shape[1])) __pyx_t_32 = 1;
+              if (unlikely(__pyx_t_32 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_32);
+                __PYX_ERR(0, 654, __pyx_L1_error)
               }
-              *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_49 * __pyx_v_prev.strides[0]) ) + __pyx_t_50 * __pyx_v_prev.strides[1]) )) = __pyx_v_i;
+              *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_36 * __pyx_v_prev.strides[0]) ) + __pyx_t_37 * __pyx_v_prev.strides[1]) )) = __pyx_v_i;
 
-              /* "soapcw/soapcw.pyx":653
+              /* "soapcw/soapcw.pyx":655
  *                                 val[0][i] = temp
  *                                 prev[0][i] =  i
  *                                 det1[0][i] =  i+k-1             # <<<<<<<<<<<<<<
  *                                 det2[0][i] =  i+m-1
  *                             else:
  */
-              __pyx_t_51 = 0;
-              __pyx_t_52 = __pyx_v_i;
-              __pyx_t_33 = -1;
-              if (__pyx_t_51 < 0) {
-                __pyx_t_51 += __pyx_v_det1.shape[0];
-                if (unlikely(__pyx_t_51 < 0)) __pyx_t_33 = 0;
-              } else if (unlikely(__pyx_t_51 >= __pyx_v_det1.shape[0])) __pyx_t_33 = 0;
-              if (__pyx_t_52 < 0) {
-                __pyx_t_52 += __pyx_v_det1.shape[1];
-                if (unlikely(__pyx_t_52 < 0)) __pyx_t_33 = 1;
-              } else if (unlikely(__pyx_t_52 >= __pyx_v_det1.shape[1])) __pyx_t_33 = 1;
-              if (unlikely(__pyx_t_33 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_33);
-                __PYX_ERR(0, 653, __pyx_L1_error)
+              __pyx_t_37 = 0;
+              __pyx_t_36 = __pyx_v_i;
+              __pyx_t_32 = -1;
+              if (__pyx_t_37 < 0) {
+                __pyx_t_37 += __pyx_v_det1.shape[0];
+                if (unlikely(__pyx_t_37 < 0)) __pyx_t_32 = 0;
+              } else if (unlikely(__pyx_t_37 >= __pyx_v_det1.shape[0])) __pyx_t_32 = 0;
+              if (__pyx_t_36 < 0) {
+                __pyx_t_36 += __pyx_v_det1.shape[1];
+                if (unlikely(__pyx_t_36 < 0)) __pyx_t_32 = 1;
+              } else if (unlikely(__pyx_t_36 >= __pyx_v_det1.shape[1])) __pyx_t_32 = 1;
+              if (unlikely(__pyx_t_32 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_32);
+                __PYX_ERR(0, 655, __pyx_L1_error)
               }
-              *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_51 * __pyx_v_det1.strides[0]) ) + __pyx_t_52 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - 1);
+              *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_37 * __pyx_v_det1.strides[0]) ) + __pyx_t_36 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - 1);
 
-              /* "soapcw/soapcw.pyx":654
+              /* "soapcw/soapcw.pyx":656
  *                                 prev[0][i] =  i
  *                                 det1[0][i] =  i+k-1
  *                                 det2[0][i] =  i+m-1             # <<<<<<<<<<<<<<
  *                             else:
  *                                 continue
  */
-              __pyx_t_53 = 0;
-              __pyx_t_54 = __pyx_v_i;
-              __pyx_t_33 = -1;
-              if (__pyx_t_53 < 0) {
-                __pyx_t_53 += __pyx_v_det2.shape[0];
-                if (unlikely(__pyx_t_53 < 0)) __pyx_t_33 = 0;
-              } else if (unlikely(__pyx_t_53 >= __pyx_v_det2.shape[0])) __pyx_t_33 = 0;
-              if (__pyx_t_54 < 0) {
-                __pyx_t_54 += __pyx_v_det2.shape[1];
-                if (unlikely(__pyx_t_54 < 0)) __pyx_t_33 = 1;
-              } else if (unlikely(__pyx_t_54 >= __pyx_v_det2.shape[1])) __pyx_t_33 = 1;
-              if (unlikely(__pyx_t_33 != -1)) {
-                __Pyx_RaiseBufferIndexError(__pyx_t_33);
-                __PYX_ERR(0, 654, __pyx_L1_error)
+              __pyx_t_36 = 0;
+              __pyx_t_37 = __pyx_v_i;
+              __pyx_t_32 = -1;
+              if (__pyx_t_36 < 0) {
+                __pyx_t_36 += __pyx_v_det2.shape[0];
+                if (unlikely(__pyx_t_36 < 0)) __pyx_t_32 = 0;
+              } else if (unlikely(__pyx_t_36 >= __pyx_v_det2.shape[0])) __pyx_t_32 = 0;
+              if (__pyx_t_37 < 0) {
+                __pyx_t_37 += __pyx_v_det2.shape[1];
+                if (unlikely(__pyx_t_37 < 0)) __pyx_t_32 = 1;
+              } else if (unlikely(__pyx_t_37 >= __pyx_v_det2.shape[1])) __pyx_t_32 = 1;
+              if (unlikely(__pyx_t_32 != -1)) {
+                __Pyx_RaiseBufferIndexError(__pyx_t_32);
+                __PYX_ERR(0, 656, __pyx_L1_error)
               }
-              *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_53 * __pyx_v_det2.strides[0]) ) + __pyx_t_54 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - 1);
+              *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_36 * __pyx_v_det2.strides[0]) ) + __pyx_t_37 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - 1);
 
-              /* "soapcw/soapcw.pyx":649
+              /* "soapcw/soapcw.pyx":651
  *                             o2 = int(obs2_ind[0][i+m-sep_dist])
  *                             value = tr[1][k][m] + logarr[det_order[0,i],frac_ind[0,i],o1,o2]
  *                             if value > temp:             # <<<<<<<<<<<<<<
  *                                 temp = value
  *                                 val[0][i] = temp
  */
               goto __pyx_L26;
             }
 
-            /* "soapcw/soapcw.pyx":656
+            /* "soapcw/soapcw.pyx":658
  *                                 det2[0][i] =  i+m-1
  *                             else:
  *                                 continue             # <<<<<<<<<<<<<<
  * 
  *         # i is current frequency position
  */
             /*else*/ {
               goto __pyx_L21_continue;
             }
             __pyx_L26:;
 
-            /* "soapcw/soapcw.pyx":645
+            /* "soapcw/soapcw.pyx":647
  *                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                     for m in range(sep_len):
  *                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                             o1 = int(obs1_ind[0][i+k-sep_dist])
  *                             o2 = int(obs2_ind[0][i+m-sep_dist])
  */
           }
           __pyx_L21_continue:;
         }
 
-        /* "soapcw/soapcw.pyx":643
+        /* "soapcw/soapcw.pyx":645
  *             temp = -1e6
  *             for k in range(sep_len):
  *                 if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                     for m in range(sep_len):
  *                         if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  */
       }
     }
   }
 
-  /* "soapcw/soapcw.pyx":665
+  /* "soapcw/soapcw.pyx":667
  * 
  * 
  *         pbar = 0             # <<<<<<<<<<<<<<
  *         for t in range(1,length):
  *             pt = t/(float(length))*100.
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_v_pbar = __pyx_int_0;
 
-  /* "soapcw/soapcw.pyx":666
+  /* "soapcw/soapcw.pyx":668
  * 
  *         pbar = 0
  *         for t in range(1,length):             # <<<<<<<<<<<<<<
  *             pt = t/(float(length))*100.
  *             for i in range(width):
  */
   __pyx_t_19 = __pyx_v_length;
-  __pyx_t_22 = __pyx_t_19;
-  for (__pyx_t_23 = 1; __pyx_t_23 < __pyx_t_22; __pyx_t_23+=1) {
-    __pyx_v_t = __pyx_t_23;
+  __pyx_t_21 = __pyx_t_19;
+  for (__pyx_t_22 = 1; __pyx_t_22 < __pyx_t_21; __pyx_t_22+=1) {
+    __pyx_v_t = __pyx_t_22;
 
-    /* "soapcw/soapcw.pyx":667
+    /* "soapcw/soapcw.pyx":669
  *         pbar = 0
  *         for t in range(1,length):
  *             pt = t/(float(length))*100.             # <<<<<<<<<<<<<<
  *             for i in range(width):
  *                 temp = -np.inf
  */
     if (unlikely(((double)__pyx_v_length) == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-      __PYX_ERR(0, 667, __pyx_L1_error)
+      __PYX_ERR(0, 669, __pyx_L1_error)
     }
     __pyx_v_pt = ((((double)__pyx_v_t) / ((double)__pyx_v_length)) * 100.);
 
-    /* "soapcw/soapcw.pyx":668
+    /* "soapcw/soapcw.pyx":670
  *         for t in range(1,length):
  *             pt = t/(float(length))*100.
  *             for i in range(width):             # <<<<<<<<<<<<<<
  *                 temp = -np.inf
  *                 for j in range(tr_len):
  */
-    __pyx_t_24 = __pyx_v_width;
-    __pyx_t_25 = __pyx_t_24;
-    for (__pyx_t_26 = 0; __pyx_t_26 < __pyx_t_25; __pyx_t_26+=1) {
-      __pyx_v_i = __pyx_t_26;
+    __pyx_t_23 = __pyx_v_width;
+    __pyx_t_24 = __pyx_t_23;
+    for (__pyx_t_25 = 0; __pyx_t_25 < __pyx_t_24; __pyx_t_25+=1) {
+      __pyx_v_i = __pyx_t_25;
 
-      /* "soapcw/soapcw.pyx":669
+      /* "soapcw/soapcw.pyx":671
  *             pt = t/(float(length))*100.
  *             for i in range(width):
  *                 temp = -np.inf             # <<<<<<<<<<<<<<
  *                 for j in range(tr_len):
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 669, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 671, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_inf); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 669, __pyx_L1_error)
+      __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_inf); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 671, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = PyNumber_Negative(__pyx_t_13); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 669, __pyx_L1_error)
+      __pyx_t_11 = PyNumber_Negative(__pyx_t_13); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 671, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __pyx_t_55 = __pyx_PyFloat_AsDouble(__pyx_t_11); if (unlikely((__pyx_t_55 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 669, __pyx_L1_error)
+      __pyx_t_42 = __pyx_PyFloat_AsDouble(__pyx_t_11); if (unlikely((__pyx_t_42 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 671, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_v_temp = __pyx_t_55;
+      __pyx_v_temp = __pyx_t_42;
 
-      /* "soapcw/soapcw.pyx":670
+      /* "soapcw/soapcw.pyx":672
  *             for i in range(width):
  *                 temp = -np.inf
  *                 for j in range(tr_len):             # <<<<<<<<<<<<<<
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:
  *                        for k in range(sep_len):
  */
-      __pyx_t_28 = __pyx_v_tr_len;
-      __pyx_t_29 = __pyx_t_28;
-      for (__pyx_t_30 = 0; __pyx_t_30 < __pyx_t_29; __pyx_t_30+=1) {
-        __pyx_v_j = __pyx_t_30;
+      __pyx_t_27 = __pyx_v_tr_len;
+      __pyx_t_28 = __pyx_t_27;
+      for (__pyx_t_29 = 0; __pyx_t_29 < __pyx_t_28; __pyx_t_29+=1) {
+        __pyx_v_j = __pyx_t_29;
 
-        /* "soapcw/soapcw.pyx":671
+        /* "soapcw/soapcw.pyx":673
  *                 temp = -np.inf
  *                 for j in range(tr_len):
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:             # <<<<<<<<<<<<<<
  *                        for k in range(sep_len):
  *                             if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  */
-        __pyx_t_27 = ((((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist) >= 0) != 0);
-        if (__pyx_t_27) {
+        __pyx_t_26 = ((((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist) >= 0) != 0);
+        if (__pyx_t_26) {
         } else {
-          __pyx_t_18 = __pyx_t_27;
+          __pyx_t_18 = __pyx_t_26;
           goto __pyx_L34_bool_binop_done;
         }
-        __pyx_t_27 = ((((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist) < __pyx_v_width) != 0);
-        __pyx_t_18 = __pyx_t_27;
+        __pyx_t_26 = ((((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist) < __pyx_v_width) != 0);
+        __pyx_t_18 = __pyx_t_26;
         __pyx_L34_bool_binop_done:;
         if (__pyx_t_18) {
 
-          /* "soapcw/soapcw.pyx":672
+          /* "soapcw/soapcw.pyx":674
  *                 for j in range(tr_len):
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:
  *                        for k in range(sep_len):             # <<<<<<<<<<<<<<
  *                             if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                                 for m in range(sep_len):
  */
-          __pyx_t_33 = __pyx_v_sep_len;
-          __pyx_t_56 = __pyx_t_33;
-          for (__pyx_t_57 = 0; __pyx_t_57 < __pyx_t_56; __pyx_t_57+=1) {
-            __pyx_v_k = __pyx_t_57;
+          __pyx_t_32 = __pyx_v_sep_len;
+          __pyx_t_43 = __pyx_t_32;
+          for (__pyx_t_44 = 0; __pyx_t_44 < __pyx_t_43; __pyx_t_44+=1) {
+            __pyx_v_k = __pyx_t_44;
 
-            /* "soapcw/soapcw.pyx":673
+            /* "soapcw/soapcw.pyx":675
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:
  *                        for k in range(sep_len):
  *                             if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                                 for m in range(sep_len):
  *                                     if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  */
-            __pyx_t_27 = ((((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist) >= (0 + __pyx_v_edge_range)) != 0);
-            if (__pyx_t_27) {
+            __pyx_t_26 = ((((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist) >= (0 + __pyx_v_edge_range)) != 0);
+            if (__pyx_t_26) {
             } else {
-              __pyx_t_18 = __pyx_t_27;
+              __pyx_t_18 = __pyx_t_26;
               goto __pyx_L39_bool_binop_done;
             }
-            __pyx_t_27 = ((((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist) < (__pyx_v_width - __pyx_v_edge_range)) != 0);
-            __pyx_t_18 = __pyx_t_27;
+            __pyx_t_26 = ((((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist) < (__pyx_v_width - __pyx_v_edge_range)) != 0);
+            __pyx_t_18 = __pyx_t_26;
             __pyx_L39_bool_binop_done:;
             if (__pyx_t_18) {
 
-              /* "soapcw/soapcw.pyx":674
+              /* "soapcw/soapcw.pyx":676
  *                        for k in range(sep_len):
  *                             if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                                 for m in range(sep_len):             # <<<<<<<<<<<<<<
  *                                     if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                                         o1 = int(obs1_ind[t][i+k-sep_dist])
  */
-              __pyx_t_58 = __pyx_v_sep_len;
-              __pyx_t_59 = __pyx_t_58;
-              for (__pyx_t_60 = 0; __pyx_t_60 < __pyx_t_59; __pyx_t_60+=1) {
-                __pyx_v_m = __pyx_t_60;
+              __pyx_t_45 = __pyx_v_sep_len;
+              __pyx_t_46 = __pyx_t_45;
+              for (__pyx_t_47 = 0; __pyx_t_47 < __pyx_t_46; __pyx_t_47+=1) {
+                __pyx_v_m = __pyx_t_47;
 
-                /* "soapcw/soapcw.pyx":675
+                /* "soapcw/soapcw.pyx":677
  *                             if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                                 for m in range(sep_len):
  *                                     if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                                         o1 = int(obs1_ind[t][i+k-sep_dist])
  *                                         o2 = int(obs2_ind[t][i+m-sep_dist])
  */
-                __pyx_t_27 = ((((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist) >= (0 + __pyx_v_edge_range)) != 0);
-                if (__pyx_t_27) {
+                __pyx_t_26 = ((((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist) >= (0 + __pyx_v_edge_range)) != 0);
+                if (__pyx_t_26) {
                 } else {
-                  __pyx_t_18 = __pyx_t_27;
+                  __pyx_t_18 = __pyx_t_26;
                   goto __pyx_L44_bool_binop_done;
                 }
-                __pyx_t_27 = ((((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist) < (__pyx_v_width - __pyx_v_edge_range)) != 0);
-                __pyx_t_18 = __pyx_t_27;
+                __pyx_t_26 = ((((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist) < (__pyx_v_width - __pyx_v_edge_range)) != 0);
+                __pyx_t_18 = __pyx_t_26;
                 __pyx_L44_bool_binop_done:;
                 if (__pyx_t_18) {
 
-                  /* "soapcw/soapcw.pyx":676
+                  /* "soapcw/soapcw.pyx":678
  *                                 for m in range(sep_len):
  *                                     if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                                         o1 = int(obs1_ind[t][i+k-sep_dist])             # <<<<<<<<<<<<<<
  *                                         o2 = int(obs2_ind[t][i+m-sep_dist])
  *                                         value = tr[j][k][m] + val[t-1][i+j-tr_dist] + logarr[det_order[t,i],frac_ind[t,i],o1,o2]
  */
-                  __pyx_t_61 = __pyx_v_t;
-                  __pyx_t_62 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
-                  __pyx_t_63 = -1;
-                  if (__pyx_t_61 < 0) {
-                    __pyx_t_61 += __pyx_v_obs1_ind.shape[0];
-                    if (unlikely(__pyx_t_61 < 0)) __pyx_t_63 = 0;
-                  } else if (unlikely(__pyx_t_61 >= __pyx_v_obs1_ind.shape[0])) __pyx_t_63 = 0;
-                  if (__pyx_t_62 < 0) {
-                    __pyx_t_62 += __pyx_v_obs1_ind.shape[1];
-                    if (unlikely(__pyx_t_62 < 0)) __pyx_t_63 = 1;
-                  } else if (unlikely(__pyx_t_62 >= __pyx_v_obs1_ind.shape[1])) __pyx_t_63 = 1;
-                  if (unlikely(__pyx_t_63 != -1)) {
-                    __Pyx_RaiseBufferIndexError(__pyx_t_63);
-                    __PYX_ERR(0, 676, __pyx_L1_error)
+                  __pyx_t_37 = __pyx_v_t;
+                  __pyx_t_36 = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
+                  __pyx_t_48 = -1;
+                  if (__pyx_t_37 < 0) {
+                    __pyx_t_37 += __pyx_v_obs1_ind.shape[0];
+                    if (unlikely(__pyx_t_37 < 0)) __pyx_t_48 = 0;
+                  } else if (unlikely(__pyx_t_37 >= __pyx_v_obs1_ind.shape[0])) __pyx_t_48 = 0;
+                  if (__pyx_t_36 < 0) {
+                    __pyx_t_36 += __pyx_v_obs1_ind.shape[1];
+                    if (unlikely(__pyx_t_36 < 0)) __pyx_t_48 = 1;
+                  } else if (unlikely(__pyx_t_36 >= __pyx_v_obs1_ind.shape[1])) __pyx_t_48 = 1;
+                  if (unlikely(__pyx_t_48 != -1)) {
+                    __Pyx_RaiseBufferIndexError(__pyx_t_48);
+                    __PYX_ERR(0, 678, __pyx_L1_error)
                   }
-                  __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind.data + __pyx_t_61 * __pyx_v_obs1_ind.strides[0]) ) + __pyx_t_62 * __pyx_v_obs1_ind.strides[1]) )));
+                  __pyx_v_o1 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1_ind.data + __pyx_t_37 * __pyx_v_obs1_ind.strides[0]) ) + __pyx_t_36 * __pyx_v_obs1_ind.strides[1]) )));
 
-                  /* "soapcw/soapcw.pyx":677
+                  /* "soapcw/soapcw.pyx":679
  *                                     if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  *                                         o1 = int(obs1_ind[t][i+k-sep_dist])
  *                                         o2 = int(obs2_ind[t][i+m-sep_dist])             # <<<<<<<<<<<<<<
  *                                         value = tr[j][k][m] + val[t-1][i+j-tr_dist] + logarr[det_order[t,i],frac_ind[t,i],o1,o2]
  * 
  */
-                  __pyx_t_64 = __pyx_v_t;
-                  __pyx_t_65 = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
-                  __pyx_t_63 = -1;
-                  if (__pyx_t_64 < 0) {
-                    __pyx_t_64 += __pyx_v_obs2_ind.shape[0];
-                    if (unlikely(__pyx_t_64 < 0)) __pyx_t_63 = 0;
-                  } else if (unlikely(__pyx_t_64 >= __pyx_v_obs2_ind.shape[0])) __pyx_t_63 = 0;
-                  if (__pyx_t_65 < 0) {
-                    __pyx_t_65 += __pyx_v_obs2_ind.shape[1];
-                    if (unlikely(__pyx_t_65 < 0)) __pyx_t_63 = 1;
-                  } else if (unlikely(__pyx_t_65 >= __pyx_v_obs2_ind.shape[1])) __pyx_t_63 = 1;
-                  if (unlikely(__pyx_t_63 != -1)) {
-                    __Pyx_RaiseBufferIndexError(__pyx_t_63);
-                    __PYX_ERR(0, 677, __pyx_L1_error)
+                  __pyx_t_36 = __pyx_v_t;
+                  __pyx_t_37 = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
+                  __pyx_t_48 = -1;
+                  if (__pyx_t_36 < 0) {
+                    __pyx_t_36 += __pyx_v_obs2_ind.shape[0];
+                    if (unlikely(__pyx_t_36 < 0)) __pyx_t_48 = 0;
+                  } else if (unlikely(__pyx_t_36 >= __pyx_v_obs2_ind.shape[0])) __pyx_t_48 = 0;
+                  if (__pyx_t_37 < 0) {
+                    __pyx_t_37 += __pyx_v_obs2_ind.shape[1];
+                    if (unlikely(__pyx_t_37 < 0)) __pyx_t_48 = 1;
+                  } else if (unlikely(__pyx_t_37 >= __pyx_v_obs2_ind.shape[1])) __pyx_t_48 = 1;
+                  if (unlikely(__pyx_t_48 != -1)) {
+                    __Pyx_RaiseBufferIndexError(__pyx_t_48);
+                    __PYX_ERR(0, 679, __pyx_L1_error)
                   }
-                  __pyx_v_o2 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs2_ind.data + __pyx_t_64 * __pyx_v_obs2_ind.strides[0]) ) + __pyx_t_65 * __pyx_v_obs2_ind.strides[1]) )));
+                  __pyx_v_o2 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs2_ind.data + __pyx_t_36 * __pyx_v_obs2_ind.strides[0]) ) + __pyx_t_37 * __pyx_v_obs2_ind.strides[1]) )));
 
-                  /* "soapcw/soapcw.pyx":678
+                  /* "soapcw/soapcw.pyx":680
  *                                         o1 = int(obs1_ind[t][i+k-sep_dist])
  *                                         o2 = int(obs2_ind[t][i+m-sep_dist])
  *                                         value = tr[j][k][m] + val[t-1][i+j-tr_dist] + logarr[det_order[t,i],frac_ind[t,i],o1,o2]             # <<<<<<<<<<<<<<
  * 
  *                                         if value > temp:
  */
-                  __pyx_t_66 = __pyx_v_j;
-                  __pyx_t_67 = __pyx_v_k;
-                  __pyx_t_68 = __pyx_v_m;
-                  __pyx_t_63 = -1;
-                  if (__pyx_t_66 < 0) {
-                    __pyx_t_66 += __pyx_v_tr.shape[0];
-                    if (unlikely(__pyx_t_66 < 0)) __pyx_t_63 = 0;
-                  } else if (unlikely(__pyx_t_66 >= __pyx_v_tr.shape[0])) __pyx_t_63 = 0;
-                  if (__pyx_t_67 < 0) {
-                    __pyx_t_67 += __pyx_v_tr.shape[1];
-                    if (unlikely(__pyx_t_67 < 0)) __pyx_t_63 = 1;
-                  } else if (unlikely(__pyx_t_67 >= __pyx_v_tr.shape[1])) __pyx_t_63 = 1;
-                  if (__pyx_t_68 < 0) {
-                    __pyx_t_68 += __pyx_v_tr.shape[2];
-                    if (unlikely(__pyx_t_68 < 0)) __pyx_t_63 = 2;
-                  } else if (unlikely(__pyx_t_68 >= __pyx_v_tr.shape[2])) __pyx_t_63 = 2;
-                  if (unlikely(__pyx_t_63 != -1)) {
-                    __Pyx_RaiseBufferIndexError(__pyx_t_63);
-                    __PYX_ERR(0, 678, __pyx_L1_error)
+                  __pyx_t_37 = __pyx_v_j;
+                  __pyx_t_36 = __pyx_v_k;
+                  __pyx_t_35 = __pyx_v_m;
+                  __pyx_t_48 = -1;
+                  if (__pyx_t_37 < 0) {
+                    __pyx_t_37 += __pyx_v_tr.shape[0];
+                    if (unlikely(__pyx_t_37 < 0)) __pyx_t_48 = 0;
+                  } else if (unlikely(__pyx_t_37 >= __pyx_v_tr.shape[0])) __pyx_t_48 = 0;
+                  if (__pyx_t_36 < 0) {
+                    __pyx_t_36 += __pyx_v_tr.shape[1];
+                    if (unlikely(__pyx_t_36 < 0)) __pyx_t_48 = 1;
+                  } else if (unlikely(__pyx_t_36 >= __pyx_v_tr.shape[1])) __pyx_t_48 = 1;
+                  if (__pyx_t_35 < 0) {
+                    __pyx_t_35 += __pyx_v_tr.shape[2];
+                    if (unlikely(__pyx_t_35 < 0)) __pyx_t_48 = 2;
+                  } else if (unlikely(__pyx_t_35 >= __pyx_v_tr.shape[2])) __pyx_t_48 = 2;
+                  if (unlikely(__pyx_t_48 != -1)) {
+                    __Pyx_RaiseBufferIndexError(__pyx_t_48);
+                    __PYX_ERR(0, 680, __pyx_L1_error)
                   }
-                  __pyx_t_69 = (__pyx_v_t - 1);
-                  __pyx_t_70 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
-                  __pyx_t_63 = -1;
-                  if (__pyx_t_69 < 0) {
-                    __pyx_t_69 += __pyx_v_val.shape[0];
-                    if (unlikely(__pyx_t_69 < 0)) __pyx_t_63 = 0;
-                  } else if (unlikely(__pyx_t_69 >= __pyx_v_val.shape[0])) __pyx_t_63 = 0;
-                  if (__pyx_t_70 < 0) {
-                    __pyx_t_70 += __pyx_v_val.shape[1];
-                    if (unlikely(__pyx_t_70 < 0)) __pyx_t_63 = 1;
-                  } else if (unlikely(__pyx_t_70 >= __pyx_v_val.shape[1])) __pyx_t_63 = 1;
-                  if (unlikely(__pyx_t_63 != -1)) {
-                    __Pyx_RaiseBufferIndexError(__pyx_t_63);
-                    __PYX_ERR(0, 678, __pyx_L1_error)
+                  __pyx_t_34 = (__pyx_v_t - 1);
+                  __pyx_t_41 = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
+                  __pyx_t_48 = -1;
+                  if (__pyx_t_34 < 0) {
+                    __pyx_t_34 += __pyx_v_val.shape[0];
+                    if (unlikely(__pyx_t_34 < 0)) __pyx_t_48 = 0;
+                  } else if (unlikely(__pyx_t_34 >= __pyx_v_val.shape[0])) __pyx_t_48 = 0;
+                  if (__pyx_t_41 < 0) {
+                    __pyx_t_41 += __pyx_v_val.shape[1];
+                    if (unlikely(__pyx_t_41 < 0)) __pyx_t_48 = 1;
+                  } else if (unlikely(__pyx_t_41 >= __pyx_v_val.shape[1])) __pyx_t_48 = 1;
+                  if (unlikely(__pyx_t_48 != -1)) {
+                    __Pyx_RaiseBufferIndexError(__pyx_t_48);
+                    __PYX_ERR(0, 680, __pyx_L1_error)
                   }
-                  __pyx_t_71 = __pyx_v_t;
-                  __pyx_t_72 = __pyx_v_i;
-                  __pyx_t_63 = -1;
-                  if (__pyx_t_71 < 0) {
-                    __pyx_t_71 += __pyx_v_det_order.shape[0];
-                    if (unlikely(__pyx_t_71 < 0)) __pyx_t_63 = 0;
-                  } else if (unlikely(__pyx_t_71 >= __pyx_v_det_order.shape[0])) __pyx_t_63 = 0;
-                  if (__pyx_t_72 < 0) {
-                    __pyx_t_72 += __pyx_v_det_order.shape[1];
-                    if (unlikely(__pyx_t_72 < 0)) __pyx_t_63 = 1;
-                  } else if (unlikely(__pyx_t_72 >= __pyx_v_det_order.shape[1])) __pyx_t_63 = 1;
-                  if (unlikely(__pyx_t_63 != -1)) {
-                    __Pyx_RaiseBufferIndexError(__pyx_t_63);
-                    __PYX_ERR(0, 678, __pyx_L1_error)
+                  __pyx_t_40 = __pyx_v_t;
+                  __pyx_t_39 = __pyx_v_i;
+                  __pyx_t_48 = -1;
+                  if (__pyx_t_40 < 0) {
+                    __pyx_t_40 += __pyx_v_det_order.shape[0];
+                    if (unlikely(__pyx_t_40 < 0)) __pyx_t_48 = 0;
+                  } else if (unlikely(__pyx_t_40 >= __pyx_v_det_order.shape[0])) __pyx_t_48 = 0;
+                  if (__pyx_t_39 < 0) {
+                    __pyx_t_39 += __pyx_v_det_order.shape[1];
+                    if (unlikely(__pyx_t_39 < 0)) __pyx_t_48 = 1;
+                  } else if (unlikely(__pyx_t_39 >= __pyx_v_det_order.shape[1])) __pyx_t_48 = 1;
+                  if (unlikely(__pyx_t_48 != -1)) {
+                    __Pyx_RaiseBufferIndexError(__pyx_t_48);
+                    __PYX_ERR(0, 680, __pyx_L1_error)
                   }
-                  __pyx_t_73 = __pyx_v_t;
-                  __pyx_t_74 = __pyx_v_i;
-                  __pyx_t_63 = -1;
-                  if (__pyx_t_73 < 0) {
-                    __pyx_t_73 += __pyx_v_frac_ind.shape[0];
-                    if (unlikely(__pyx_t_73 < 0)) __pyx_t_63 = 0;
-                  } else if (unlikely(__pyx_t_73 >= __pyx_v_frac_ind.shape[0])) __pyx_t_63 = 0;
-                  if (__pyx_t_74 < 0) {
-                    __pyx_t_74 += __pyx_v_frac_ind.shape[1];
-                    if (unlikely(__pyx_t_74 < 0)) __pyx_t_63 = 1;
-                  } else if (unlikely(__pyx_t_74 >= __pyx_v_frac_ind.shape[1])) __pyx_t_63 = 1;
-                  if (unlikely(__pyx_t_63 != -1)) {
-                    __Pyx_RaiseBufferIndexError(__pyx_t_63);
-                    __PYX_ERR(0, 678, __pyx_L1_error)
+                  __pyx_t_38 = __pyx_v_t;
+                  __pyx_t_33 = __pyx_v_i;
+                  __pyx_t_48 = -1;
+                  if (__pyx_t_38 < 0) {
+                    __pyx_t_38 += __pyx_v_frac_ind.shape[0];
+                    if (unlikely(__pyx_t_38 < 0)) __pyx_t_48 = 0;
+                  } else if (unlikely(__pyx_t_38 >= __pyx_v_frac_ind.shape[0])) __pyx_t_48 = 0;
+                  if (__pyx_t_33 < 0) {
+                    __pyx_t_33 += __pyx_v_frac_ind.shape[1];
+                    if (unlikely(__pyx_t_33 < 0)) __pyx_t_48 = 1;
+                  } else if (unlikely(__pyx_t_33 >= __pyx_v_frac_ind.shape[1])) __pyx_t_48 = 1;
+                  if (unlikely(__pyx_t_48 != -1)) {
+                    __Pyx_RaiseBufferIndexError(__pyx_t_48);
+                    __PYX_ERR(0, 680, __pyx_L1_error)
                   }
-                  __pyx_t_75 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det_order.data + __pyx_t_71 * __pyx_v_det_order.strides[0]) ) + __pyx_t_72 * __pyx_v_det_order.strides[1]) )));
-                  __pyx_t_76 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_frac_ind.data + __pyx_t_73 * __pyx_v_frac_ind.strides[0]) ) + __pyx_t_74 * __pyx_v_frac_ind.strides[1]) )));
-                  __pyx_t_77 = __pyx_v_o1;
-                  __pyx_t_78 = __pyx_v_o2;
-                  __pyx_t_63 = -1;
-                  if (__pyx_t_75 < 0) {
-                    __pyx_t_75 += __pyx_v_logarr.shape[0];
-                    if (unlikely(__pyx_t_75 < 0)) __pyx_t_63 = 0;
-                  } else if (unlikely(__pyx_t_75 >= __pyx_v_logarr.shape[0])) __pyx_t_63 = 0;
-                  if (__pyx_t_76 < 0) {
-                    __pyx_t_76 += __pyx_v_logarr.shape[1];
-                    if (unlikely(__pyx_t_76 < 0)) __pyx_t_63 = 1;
-                  } else if (unlikely(__pyx_t_76 >= __pyx_v_logarr.shape[1])) __pyx_t_63 = 1;
-                  if (__pyx_t_77 < 0) {
-                    __pyx_t_77 += __pyx_v_logarr.shape[2];
-                    if (unlikely(__pyx_t_77 < 0)) __pyx_t_63 = 2;
-                  } else if (unlikely(__pyx_t_77 >= __pyx_v_logarr.shape[2])) __pyx_t_63 = 2;
-                  if (__pyx_t_78 < 0) {
-                    __pyx_t_78 += __pyx_v_logarr.shape[3];
-                    if (unlikely(__pyx_t_78 < 0)) __pyx_t_63 = 3;
-                  } else if (unlikely(__pyx_t_78 >= __pyx_v_logarr.shape[3])) __pyx_t_63 = 3;
-                  if (unlikely(__pyx_t_63 != -1)) {
-                    __Pyx_RaiseBufferIndexError(__pyx_t_63);
-                    __PYX_ERR(0, 678, __pyx_L1_error)
+                  __pyx_t_31 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det_order.data + __pyx_t_40 * __pyx_v_det_order.strides[0]) ) + __pyx_t_39 * __pyx_v_det_order.strides[1]) )));
+                  __pyx_t_30 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_frac_ind.data + __pyx_t_38 * __pyx_v_frac_ind.strides[0]) ) + __pyx_t_33 * __pyx_v_frac_ind.strides[1]) )));
+                  __pyx_t_49 = __pyx_v_o1;
+                  __pyx_t_50 = __pyx_v_o2;
+                  __pyx_t_48 = -1;
+                  if (__pyx_t_31 < 0) {
+                    __pyx_t_31 += __pyx_v_logarr.shape[0];
+                    if (unlikely(__pyx_t_31 < 0)) __pyx_t_48 = 0;
+                  } else if (unlikely(__pyx_t_31 >= __pyx_v_logarr.shape[0])) __pyx_t_48 = 0;
+                  if (__pyx_t_30 < 0) {
+                    __pyx_t_30 += __pyx_v_logarr.shape[1];
+                    if (unlikely(__pyx_t_30 < 0)) __pyx_t_48 = 1;
+                  } else if (unlikely(__pyx_t_30 >= __pyx_v_logarr.shape[1])) __pyx_t_48 = 1;
+                  if (__pyx_t_49 < 0) {
+                    __pyx_t_49 += __pyx_v_logarr.shape[2];
+                    if (unlikely(__pyx_t_49 < 0)) __pyx_t_48 = 2;
+                  } else if (unlikely(__pyx_t_49 >= __pyx_v_logarr.shape[2])) __pyx_t_48 = 2;
+                  if (__pyx_t_50 < 0) {
+                    __pyx_t_50 += __pyx_v_logarr.shape[3];
+                    if (unlikely(__pyx_t_50 < 0)) __pyx_t_48 = 3;
+                  } else if (unlikely(__pyx_t_50 >= __pyx_v_logarr.shape[3])) __pyx_t_48 = 3;
+                  if (unlikely(__pyx_t_48 != -1)) {
+                    __Pyx_RaiseBufferIndexError(__pyx_t_48);
+                    __PYX_ERR(0, 680, __pyx_L1_error)
                   }
-                  __pyx_v_value = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_66 * __pyx_v_tr.strides[0]) ) + __pyx_t_67 * __pyx_v_tr.strides[1]) ) + __pyx_t_68 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_69 * __pyx_v_val.strides[0]) ) + __pyx_t_70 * __pyx_v_val.strides[1]) )))) + (*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_logarr.data + __pyx_t_75 * __pyx_v_logarr.strides[0]) ) + __pyx_t_76 * __pyx_v_logarr.strides[1]) ) + __pyx_t_77 * __pyx_v_logarr.strides[2]) ) + __pyx_t_78 * __pyx_v_logarr.strides[3]) ))));
+                  __pyx_v_value = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_37 * __pyx_v_tr.strides[0]) ) + __pyx_t_36 * __pyx_v_tr.strides[1]) ) + __pyx_t_35 * __pyx_v_tr.strides[2]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_34 * __pyx_v_val.strides[0]) ) + __pyx_t_41 * __pyx_v_val.strides[1]) )))) + (*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_logarr.data + __pyx_t_31 * __pyx_v_logarr.strides[0]) ) + __pyx_t_30 * __pyx_v_logarr.strides[1]) ) + __pyx_t_49 * __pyx_v_logarr.strides[2]) ) + __pyx_t_50 * __pyx_v_logarr.strides[3]) ))));
 
-                  /* "soapcw/soapcw.pyx":680
+                  /* "soapcw/soapcw.pyx":682
  *                                         value = tr[j][k][m] + val[t-1][i+j-tr_dist] + logarr[det_order[t,i],frac_ind[t,i],o1,o2]
  * 
  *                                         if value > temp:             # <<<<<<<<<<<<<<
  *                                             temp = value
  *                                             val[t][i] = temp
  */
                   __pyx_t_18 = ((__pyx_v_value > __pyx_v_temp) != 0);
                   if (__pyx_t_18) {
 
-                    /* "soapcw/soapcw.pyx":681
+                    /* "soapcw/soapcw.pyx":683
  * 
  *                                         if value > temp:
  *                                             temp = value             # <<<<<<<<<<<<<<
  *                                             val[t][i] = temp
  *                                             prev[t][i] =  i+j-tr_dist
  */
                     __pyx_v_temp = __pyx_v_value;
 
-                    /* "soapcw/soapcw.pyx":682
+                    /* "soapcw/soapcw.pyx":684
  *                                         if value > temp:
  *                                             temp = value
  *                                             val[t][i] = temp             # <<<<<<<<<<<<<<
  *                                             prev[t][i] =  i+j-tr_dist
  *                                             det1[t][i] =  i+k-sep_dist
  */
-                    __pyx_t_79 = __pyx_v_t;
-                    __pyx_t_80 = __pyx_v_i;
-                    __pyx_t_63 = -1;
-                    if (__pyx_t_79 < 0) {
-                      __pyx_t_79 += __pyx_v_val.shape[0];
-                      if (unlikely(__pyx_t_79 < 0)) __pyx_t_63 = 0;
-                    } else if (unlikely(__pyx_t_79 >= __pyx_v_val.shape[0])) __pyx_t_63 = 0;
-                    if (__pyx_t_80 < 0) {
-                      __pyx_t_80 += __pyx_v_val.shape[1];
-                      if (unlikely(__pyx_t_80 < 0)) __pyx_t_63 = 1;
-                    } else if (unlikely(__pyx_t_80 >= __pyx_v_val.shape[1])) __pyx_t_63 = 1;
-                    if (unlikely(__pyx_t_63 != -1)) {
-                      __Pyx_RaiseBufferIndexError(__pyx_t_63);
-                      __PYX_ERR(0, 682, __pyx_L1_error)
+                    __pyx_t_33 = __pyx_v_t;
+                    __pyx_t_38 = __pyx_v_i;
+                    __pyx_t_48 = -1;
+                    if (__pyx_t_33 < 0) {
+                      __pyx_t_33 += __pyx_v_val.shape[0];
+                      if (unlikely(__pyx_t_33 < 0)) __pyx_t_48 = 0;
+                    } else if (unlikely(__pyx_t_33 >= __pyx_v_val.shape[0])) __pyx_t_48 = 0;
+                    if (__pyx_t_38 < 0) {
+                      __pyx_t_38 += __pyx_v_val.shape[1];
+                      if (unlikely(__pyx_t_38 < 0)) __pyx_t_48 = 1;
+                    } else if (unlikely(__pyx_t_38 >= __pyx_v_val.shape[1])) __pyx_t_48 = 1;
+                    if (unlikely(__pyx_t_48 != -1)) {
+                      __Pyx_RaiseBufferIndexError(__pyx_t_48);
+                      __PYX_ERR(0, 684, __pyx_L1_error)
                     }
-                    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_79 * __pyx_v_val.strides[0]) ) + __pyx_t_80 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
+                    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_33 * __pyx_v_val.strides[0]) ) + __pyx_t_38 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
 
-                    /* "soapcw/soapcw.pyx":683
+                    /* "soapcw/soapcw.pyx":685
  *                                             temp = value
  *                                             val[t][i] = temp
  *                                             prev[t][i] =  i+j-tr_dist             # <<<<<<<<<<<<<<
  *                                             det1[t][i] =  i+k-sep_dist
  *                                             det2[t][i] =  i+m-sep_dist
  */
-                    __pyx_t_81 = __pyx_v_t;
-                    __pyx_t_82 = __pyx_v_i;
-                    __pyx_t_63 = -1;
-                    if (__pyx_t_81 < 0) {
-                      __pyx_t_81 += __pyx_v_prev.shape[0];
-                      if (unlikely(__pyx_t_81 < 0)) __pyx_t_63 = 0;
-                    } else if (unlikely(__pyx_t_81 >= __pyx_v_prev.shape[0])) __pyx_t_63 = 0;
-                    if (__pyx_t_82 < 0) {
-                      __pyx_t_82 += __pyx_v_prev.shape[1];
-                      if (unlikely(__pyx_t_82 < 0)) __pyx_t_63 = 1;
-                    } else if (unlikely(__pyx_t_82 >= __pyx_v_prev.shape[1])) __pyx_t_63 = 1;
-                    if (unlikely(__pyx_t_63 != -1)) {
-                      __Pyx_RaiseBufferIndexError(__pyx_t_63);
-                      __PYX_ERR(0, 683, __pyx_L1_error)
+                    __pyx_t_38 = __pyx_v_t;
+                    __pyx_t_33 = __pyx_v_i;
+                    __pyx_t_48 = -1;
+                    if (__pyx_t_38 < 0) {
+                      __pyx_t_38 += __pyx_v_prev.shape[0];
+                      if (unlikely(__pyx_t_38 < 0)) __pyx_t_48 = 0;
+                    } else if (unlikely(__pyx_t_38 >= __pyx_v_prev.shape[0])) __pyx_t_48 = 0;
+                    if (__pyx_t_33 < 0) {
+                      __pyx_t_33 += __pyx_v_prev.shape[1];
+                      if (unlikely(__pyx_t_33 < 0)) __pyx_t_48 = 1;
+                    } else if (unlikely(__pyx_t_33 >= __pyx_v_prev.shape[1])) __pyx_t_48 = 1;
+                    if (unlikely(__pyx_t_48 != -1)) {
+                      __Pyx_RaiseBufferIndexError(__pyx_t_48);
+                      __PYX_ERR(0, 685, __pyx_L1_error)
                     }
-                    *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_81 * __pyx_v_prev.strides[0]) ) + __pyx_t_82 * __pyx_v_prev.strides[1]) )) = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
+                    *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_38 * __pyx_v_prev.strides[0]) ) + __pyx_t_33 * __pyx_v_prev.strides[1]) )) = ((__pyx_v_i + __pyx_v_j) - __pyx_v_tr_dist);
 
-                    /* "soapcw/soapcw.pyx":684
+                    /* "soapcw/soapcw.pyx":686
  *                                             val[t][i] = temp
  *                                             prev[t][i] =  i+j-tr_dist
  *                                             det1[t][i] =  i+k-sep_dist             # <<<<<<<<<<<<<<
  *                                             det2[t][i] =  i+m-sep_dist
  *                                         else:
  */
-                    __pyx_t_83 = __pyx_v_t;
-                    __pyx_t_84 = __pyx_v_i;
-                    __pyx_t_63 = -1;
-                    if (__pyx_t_83 < 0) {
-                      __pyx_t_83 += __pyx_v_det1.shape[0];
-                      if (unlikely(__pyx_t_83 < 0)) __pyx_t_63 = 0;
-                    } else if (unlikely(__pyx_t_83 >= __pyx_v_det1.shape[0])) __pyx_t_63 = 0;
-                    if (__pyx_t_84 < 0) {
-                      __pyx_t_84 += __pyx_v_det1.shape[1];
-                      if (unlikely(__pyx_t_84 < 0)) __pyx_t_63 = 1;
-                    } else if (unlikely(__pyx_t_84 >= __pyx_v_det1.shape[1])) __pyx_t_63 = 1;
-                    if (unlikely(__pyx_t_63 != -1)) {
-                      __Pyx_RaiseBufferIndexError(__pyx_t_63);
-                      __PYX_ERR(0, 684, __pyx_L1_error)
+                    __pyx_t_33 = __pyx_v_t;
+                    __pyx_t_38 = __pyx_v_i;
+                    __pyx_t_48 = -1;
+                    if (__pyx_t_33 < 0) {
+                      __pyx_t_33 += __pyx_v_det1.shape[0];
+                      if (unlikely(__pyx_t_33 < 0)) __pyx_t_48 = 0;
+                    } else if (unlikely(__pyx_t_33 >= __pyx_v_det1.shape[0])) __pyx_t_48 = 0;
+                    if (__pyx_t_38 < 0) {
+                      __pyx_t_38 += __pyx_v_det1.shape[1];
+                      if (unlikely(__pyx_t_38 < 0)) __pyx_t_48 = 1;
+                    } else if (unlikely(__pyx_t_38 >= __pyx_v_det1.shape[1])) __pyx_t_48 = 1;
+                    if (unlikely(__pyx_t_48 != -1)) {
+                      __Pyx_RaiseBufferIndexError(__pyx_t_48);
+                      __PYX_ERR(0, 686, __pyx_L1_error)
                     }
-                    *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_83 * __pyx_v_det1.strides[0]) ) + __pyx_t_84 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
+                    *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_33 * __pyx_v_det1.strides[0]) ) + __pyx_t_38 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - __pyx_v_sep_dist);
 
-                    /* "soapcw/soapcw.pyx":685
+                    /* "soapcw/soapcw.pyx":687
  *                                             prev[t][i] =  i+j-tr_dist
  *                                             det1[t][i] =  i+k-sep_dist
  *                                             det2[t][i] =  i+m-sep_dist             # <<<<<<<<<<<<<<
  *                                         else:
  *                                             continue
  */
-                    __pyx_t_85 = __pyx_v_t;
-                    __pyx_t_86 = __pyx_v_i;
-                    __pyx_t_63 = -1;
-                    if (__pyx_t_85 < 0) {
-                      __pyx_t_85 += __pyx_v_det2.shape[0];
-                      if (unlikely(__pyx_t_85 < 0)) __pyx_t_63 = 0;
-                    } else if (unlikely(__pyx_t_85 >= __pyx_v_det2.shape[0])) __pyx_t_63 = 0;
-                    if (__pyx_t_86 < 0) {
-                      __pyx_t_86 += __pyx_v_det2.shape[1];
-                      if (unlikely(__pyx_t_86 < 0)) __pyx_t_63 = 1;
-                    } else if (unlikely(__pyx_t_86 >= __pyx_v_det2.shape[1])) __pyx_t_63 = 1;
-                    if (unlikely(__pyx_t_63 != -1)) {
-                      __Pyx_RaiseBufferIndexError(__pyx_t_63);
-                      __PYX_ERR(0, 685, __pyx_L1_error)
+                    __pyx_t_38 = __pyx_v_t;
+                    __pyx_t_33 = __pyx_v_i;
+                    __pyx_t_48 = -1;
+                    if (__pyx_t_38 < 0) {
+                      __pyx_t_38 += __pyx_v_det2.shape[0];
+                      if (unlikely(__pyx_t_38 < 0)) __pyx_t_48 = 0;
+                    } else if (unlikely(__pyx_t_38 >= __pyx_v_det2.shape[0])) __pyx_t_48 = 0;
+                    if (__pyx_t_33 < 0) {
+                      __pyx_t_33 += __pyx_v_det2.shape[1];
+                      if (unlikely(__pyx_t_33 < 0)) __pyx_t_48 = 1;
+                    } else if (unlikely(__pyx_t_33 >= __pyx_v_det2.shape[1])) __pyx_t_48 = 1;
+                    if (unlikely(__pyx_t_48 != -1)) {
+                      __Pyx_RaiseBufferIndexError(__pyx_t_48);
+                      __PYX_ERR(0, 687, __pyx_L1_error)
                     }
-                    *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_85 * __pyx_v_det2.strides[0]) ) + __pyx_t_86 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
+                    *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_38 * __pyx_v_det2.strides[0]) ) + __pyx_t_33 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - __pyx_v_sep_dist);
 
-                    /* "soapcw/soapcw.pyx":680
+                    /* "soapcw/soapcw.pyx":682
  *                                         value = tr[j][k][m] + val[t-1][i+j-tr_dist] + logarr[det_order[t,i],frac_ind[t,i],o1,o2]
  * 
  *                                         if value > temp:             # <<<<<<<<<<<<<<
  *                                             temp = value
  *                                             val[t][i] = temp
  */
                     goto __pyx_L46;
                   }
 
-                  /* "soapcw/soapcw.pyx":687
+                  /* "soapcw/soapcw.pyx":689
  *                                             det2[t][i] =  i+m-sep_dist
  *                                         else:
  *                                             continue             # <<<<<<<<<<<<<<
  *             if self.prog == True:
  *                 if pt>pbar:
  */
                   /*else*/ {
                     goto __pyx_L41_continue;
                   }
                   __pyx_L46:;
 
-                  /* "soapcw/soapcw.pyx":675
+                  /* "soapcw/soapcw.pyx":677
  *                             if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  *                                 for m in range(sep_len):
  *                                     if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                                         o1 = int(obs1_ind[t][i+k-sep_dist])
  *                                         o2 = int(obs2_ind[t][i+m-sep_dist])
  */
                 }
                 __pyx_L41_continue:;
               }
 
-              /* "soapcw/soapcw.pyx":673
+              /* "soapcw/soapcw.pyx":675
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:
  *                        for k in range(sep_len):
  *                             if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:             # <<<<<<<<<<<<<<
  *                                 for m in range(sep_len):
  *                                     if i+m-sep_dist>=0+edge_range and i+m-sep_dist<width-edge_range:
  */
             }
           }
 
-          /* "soapcw/soapcw.pyx":671
+          /* "soapcw/soapcw.pyx":673
  *                 temp = -np.inf
  *                 for j in range(tr_len):
  *                     if i+j-tr_dist>=0 and i+j-tr_dist<width:             # <<<<<<<<<<<<<<
  *                        for k in range(sep_len):
  *                             if i+k-sep_dist>=0+edge_range and i+k-sep_dist<width-edge_range:
  */
         }
       }
     }
 
-    /* "soapcw/soapcw.pyx":688
+    /* "soapcw/soapcw.pyx":690
  *                                         else:
  *                                             continue
  *             if self.prog == True:             # <<<<<<<<<<<<<<
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prog); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 688, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prog); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 690, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_13 = PyObject_RichCompare(__pyx_t_11, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 688, __pyx_L1_error)
+    __pyx_t_13 = PyObject_RichCompare(__pyx_t_11, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 690, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 688, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 690, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     if (__pyx_t_18) {
 
-      /* "soapcw/soapcw.pyx":689
+      /* "soapcw/soapcw.pyx":691
  *                                             continue
  *             if self.prog == True:
  *                 if pt>pbar:             # <<<<<<<<<<<<<<
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  */
-      __pyx_t_13 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 689, __pyx_L1_error)
+      __pyx_t_13 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 691, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
-      __pyx_t_11 = PyObject_RichCompare(__pyx_t_13, __pyx_v_pbar, Py_GT); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 689, __pyx_L1_error)
+      __pyx_t_11 = PyObject_RichCompare(__pyx_t_13, __pyx_v_pbar, Py_GT); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 691, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 689, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 691, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       if (__pyx_t_18) {
 
-        /* "soapcw/soapcw.pyx":690
+        /* "soapcw/soapcw.pyx":692
  *             if self.prog == True:
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))             # <<<<<<<<<<<<<<
  *                     stdout.flush()
  *                     pbar+=100./length
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_stdout); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 690, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_stdout); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 692, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_13);
-        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_write); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 690, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_write); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u__4, __pyx_n_s_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 690, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u__4, __pyx_n_s_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 692, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_14 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 690, __pyx_L1_error)
+        __pyx_t_14 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 692, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_14);
-        __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_round, __pyx_t_14); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 690, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_round, __pyx_t_14); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 692, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
         __pyx_t_14 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_14)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -15107,15 +15302,15 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_13 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_14, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
         __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 690, __pyx_L1_error)
+        if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 692, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_13);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_t_3 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
           __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
           if (likely(__pyx_t_3)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -15123,243 +15318,243 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_4, function);
           }
         }
         __pyx_t_11 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_13);
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 690, __pyx_L1_error)
+        if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 692, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-        /* "soapcw/soapcw.pyx":691
+        /* "soapcw/soapcw.pyx":693
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()             # <<<<<<<<<<<<<<
  *                     pbar+=100./length
  * 
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_stdout); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_stdout); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 693, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_flush); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 691, __pyx_L1_error)
+        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_flush); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 693, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_13);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_13);
           if (likely(__pyx_t_4)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_13, function);
           }
         }
         __pyx_t_11 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_13);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 691, __pyx_L1_error)
+        if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 693, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-        /* "soapcw/soapcw.pyx":692
+        /* "soapcw/soapcw.pyx":694
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  *                     pbar+=100./length             # <<<<<<<<<<<<<<
  * 
  *         self.V = np.array(val)
  */
         if (unlikely(__pyx_v_length == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-          __PYX_ERR(0, 692, __pyx_L1_error)
+          __PYX_ERR(0, 694, __pyx_L1_error)
         }
-        __pyx_t_11 = PyFloat_FromDouble((100. / ((double)__pyx_v_length))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 692, __pyx_L1_error)
+        __pyx_t_11 = PyFloat_FromDouble((100. / ((double)__pyx_v_length))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 694, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_13 = PyNumber_InPlaceAdd(__pyx_v_pbar, __pyx_t_11); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 692, __pyx_L1_error)
+        __pyx_t_13 = PyNumber_InPlaceAdd(__pyx_v_pbar, __pyx_t_11); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 694, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_13);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_DECREF_SET(__pyx_v_pbar, __pyx_t_13);
         __pyx_t_13 = 0;
 
-        /* "soapcw/soapcw.pyx":689
+        /* "soapcw/soapcw.pyx":691
  *                                             continue
  *             if self.prog == True:
  *                 if pt>pbar:             # <<<<<<<<<<<<<<
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  */
       }
 
-      /* "soapcw/soapcw.pyx":688
+      /* "soapcw/soapcw.pyx":690
  *                                         else:
  *                                             continue
  *             if self.prog == True:             # <<<<<<<<<<<<<<
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  */
     }
   }
 
-  /* "soapcw/soapcw.pyx":694
+  /* "soapcw/soapcw.pyx":696
  *                     pbar+=100./length
  * 
  *         self.V = np.array(val)             # <<<<<<<<<<<<<<
  *         self.prev = np.array(prev)
  *         self.det1 = np.array(det1)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 694, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 696, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 694, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 696, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_v_val, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 694, __pyx_L1_error)
+  __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_v_val, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 696, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_13 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_11);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 694, __pyx_L1_error)
+  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 696, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_V, __pyx_t_13) < 0) __PYX_ERR(0, 694, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_V, __pyx_t_13) < 0) __PYX_ERR(0, 696, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
-  /* "soapcw/soapcw.pyx":695
+  /* "soapcw/soapcw.pyx":697
  * 
  *         self.V = np.array(val)
  *         self.prev = np.array(prev)             # <<<<<<<<<<<<<<
  *         self.det1 = np.array(det1)
  *         self.det2 = np.array(det2)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 695, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 695, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_prev, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 695, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_prev, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_11);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_11, function);
     }
   }
   __pyx_t_13 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 695, __pyx_L1_error)
+  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prev, __pyx_t_13) < 0) __PYX_ERR(0, 695, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prev, __pyx_t_13) < 0) __PYX_ERR(0, 697, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
-  /* "soapcw/soapcw.pyx":696
+  /* "soapcw/soapcw.pyx":698
  *         self.V = np.array(val)
  *         self.prev = np.array(prev)
  *         self.det1 = np.array(det1)             # <<<<<<<<<<<<<<
  *         self.det2 = np.array(det2)
  *         self.width = width
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 698, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_v_det1, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_v_det1, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 698, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_13 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_11);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 696, __pyx_L1_error)
+  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 698, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_det1, __pyx_t_13) < 0) __PYX_ERR(0, 696, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_det1, __pyx_t_13) < 0) __PYX_ERR(0, 698, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
-  /* "soapcw/soapcw.pyx":697
+  /* "soapcw/soapcw.pyx":699
  *         self.prev = np.array(prev)
  *         self.det1 = np.array(det1)
  *         self.det2 = np.array(det2)             # <<<<<<<<<<<<<<
  *         self.width = width
  *         self.length = length
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_det2, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_det2, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_11);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_11, function);
     }
   }
   __pyx_t_13 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 697, __pyx_L1_error)
+  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_det2, __pyx_t_13) < 0) __PYX_ERR(0, 697, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_det2, __pyx_t_13) < 0) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
-  /* "soapcw/soapcw.pyx":698
+  /* "soapcw/soapcw.pyx":700
  *         self.det1 = np.array(det1)
  *         self.det2 = np.array(det2)
  *         self.width = width             # <<<<<<<<<<<<<<
  *         self.length = length
  * 
  */
-  __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_width); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 698, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_width); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_width, __pyx_t_13) < 0) __PYX_ERR(0, 698, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_width, __pyx_t_13) < 0) __PYX_ERR(0, 700, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
-  /* "soapcw/soapcw.pyx":699
+  /* "soapcw/soapcw.pyx":701
  *         self.det2 = np.array(det2)
  *         self.width = width
  *         self.length = length             # <<<<<<<<<<<<<<
  * 
  *     def get_track(self):
  */
-  __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_length); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 699, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_length); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 701, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_length, __pyx_t_13) < 0) __PYX_ERR(0, 699, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_length, __pyx_t_13) < 0) __PYX_ERR(0, 701, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
-  /* "soapcw/soapcw.pyx":540
+  /* "soapcw/soapcw.pyx":542
  *         self.length = length
  * 
  *     def run_lookup_amp(self,tr1, obs11, obs21,lookup_file = None, fractions = None):             # <<<<<<<<<<<<<<
  *         """
  *         viterbi algorithm for two detectors with an lookup table for the line veto statistic
  */
 
@@ -15376,15 +15571,14 @@
   __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
   __Pyx_XDECREF(__pyx_t_11);
   __PYX_XDEC_MEMVIEW(&__pyx_t_12, 1);
   __Pyx_XDECREF(__pyx_t_13);
   __Pyx_XDECREF(__pyx_t_14);
   __PYX_XDEC_MEMVIEW(&__pyx_t_17, 1);
   __Pyx_XDECREF(__pyx_t_20);
-  __PYX_XDEC_MEMVIEW(&__pyx_t_21, 1);
   __Pyx_AddTraceback("soapcw.soapcw.two_detector.run_lookup_amp", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_tr, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_obs1, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_obs2, 1);
   __Pyx_XDECREF(__pyx_v_shape);
@@ -15412,15 +15606,15 @@
   __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_lkl);
   __Pyx_XDECREF(__pyx_v_fractions);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":701
+/* "soapcw/soapcw.pyx":703
  *         self.length = length
  * 
  *     def get_track(self):             # <<<<<<<<<<<<<<
  *         """
  *         Takes in the viterbi data from a run and identifies the track thorugh whcih gives the maximum probability
  */
 
@@ -15463,269 +15657,267 @@
   PyObject *__pyx_t_10 = NULL;
   PyObject *__pyx_t_11 = NULL;
   float __pyx_t_12;
   long __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   int __pyx_t_15;
   Py_ssize_t __pyx_t_16;
-  Py_ssize_t __pyx_t_17;
-  Py_ssize_t __pyx_t_18;
-  Py_ssize_t __pyx_t_19;
-  Py_ssize_t __pyx_t_20;
-  Py_ssize_t __pyx_t_21;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_track", 0);
 
-  /* "soapcw/soapcw.pyx":715
+  /* "soapcw/soapcw.pyx":717
  *            value of maxmimum end statistic
  *         """
  *         cdef long previous = 1             # <<<<<<<<<<<<<<
  *         cdef long[:] vit_trackr = np.zeros(self.length).astype(int)
  *         cdef long[:] vit_track2 = np.zeros(self.length).astype(int)
  */
   __pyx_v_previous = 1;
 
-  /* "soapcw/soapcw.pyx":716
+  /* "soapcw/soapcw.pyx":718
  *         """
  *         cdef long previous = 1
  *         cdef long[:] vit_trackr = np.zeros(self.length).astype(int)             # <<<<<<<<<<<<<<
  *         cdef long[:] vit_track2 = np.zeros(self.length).astype(int)
  *         cdef long[:] vit_track1 = np.zeros(self.length).astype(int)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 716, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 718, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 716, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 718, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 716, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 718, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 716, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 718, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 716, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 718, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_4, ((PyObject *)(&PyInt_Type)));
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 716, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 718, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 716, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 718, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_vit_trackr = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "soapcw/soapcw.pyx":717
+  /* "soapcw/soapcw.pyx":719
  *         cdef long previous = 1
  *         cdef long[:] vit_trackr = np.zeros(self.length).astype(int)
  *         cdef long[:] vit_track2 = np.zeros(self.length).astype(int)             # <<<<<<<<<<<<<<
  *         cdef long[:] vit_track1 = np.zeros(self.length).astype(int)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 717, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 719, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 717, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 719, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 717, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 719, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 717, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 719, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 717, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 719, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_3, ((PyObject *)(&PyInt_Type)));
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 717, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 717, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 719, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_vit_track2 = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "soapcw/soapcw.pyx":718
+  /* "soapcw/soapcw.pyx":720
  *         cdef long[:] vit_trackr = np.zeros(self.length).astype(int)
  *         cdef long[:] vit_track2 = np.zeros(self.length).astype(int)
  *         cdef long[:] vit_track1 = np.zeros(self.length).astype(int)             # <<<<<<<<<<<<<<
  * 
  *         cdef float max_prob = np.array([self.V[self.length-1][i] for i in range(self.width)]).max()
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 718, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 718, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 718, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 718, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 718, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_2, ((PyObject *)(&PyInt_Type)));
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 718, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 718, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 720, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_vit_track1 = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "soapcw/soapcw.pyx":720
+  /* "soapcw/soapcw.pyx":722
  *         cdef long[:] vit_track1 = np.zeros(self.length).astype(int)
  * 
  *         cdef float max_prob = np.array([self.V[self.length-1][i] for i in range(self.width)]).max()             # <<<<<<<<<<<<<<
  *         cdef long max_prob_index = np.array([self.V[self.length-1][i] for i in range(self.width)]).argmax()
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 720, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 720, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   { /* enter inner scope */
-    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 720, __pyx_L5_error)
+    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 722, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_width); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 720, __pyx_L5_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_width); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 722, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 720, __pyx_L5_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 722, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
       __pyx_t_5 = __pyx_t_7; __Pyx_INCREF(__pyx_t_5); __pyx_t_8 = 0;
       __pyx_t_9 = NULL;
     } else {
-      __pyx_t_8 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 720, __pyx_L5_error)
+      __pyx_t_8 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 722, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_9 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 720, __pyx_L5_error)
+      __pyx_t_9 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 722, __pyx_L5_error)
     }
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     for (;;) {
       if (likely(!__pyx_t_9)) {
         if (likely(PyList_CheckExact(__pyx_t_5))) {
           if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_5)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_7); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 720, __pyx_L5_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_7); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 722, __pyx_L5_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 720, __pyx_L5_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 722, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_7); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 720, __pyx_L5_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_7); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 722, __pyx_L5_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 720, __pyx_L5_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 722, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
         __pyx_t_7 = __pyx_t_9(__pyx_t_5);
         if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 720, __pyx_L5_error)
+            else __PYX_ERR(0, 722, __pyx_L5_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_7);
       }
       __Pyx_XDECREF_SET(__pyx_8genexpr5__pyx_v_i, __pyx_t_7);
       __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_V); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 720, __pyx_L5_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_V); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 722, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 720, __pyx_L5_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 722, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_11 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 720, __pyx_L5_error)
+      __pyx_t_11 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 722, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 720, __pyx_L5_error)
+      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 722, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_10, __pyx_8genexpr5__pyx_v_i); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 720, __pyx_L5_error)
+      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_10, __pyx_8genexpr5__pyx_v_i); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 722, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_11))) __PYX_ERR(0, 720, __pyx_L5_error)
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_11))) __PYX_ERR(0, 722, __pyx_L5_error)
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_XDECREF(__pyx_8genexpr5__pyx_v_i); __pyx_8genexpr5__pyx_v_i = 0;
     goto __pyx_L8_exit_scope;
     __pyx_L5_error:;
     __Pyx_XDECREF(__pyx_8genexpr5__pyx_v_i); __pyx_8genexpr5__pyx_v_i = 0;
@@ -15741,116 +15933,116 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_max); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 720, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_max); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_12 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_12 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 720, __pyx_L1_error)
+  __pyx_t_12 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_12 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 722, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_max_prob = __pyx_t_12;
 
-  /* "soapcw/soapcw.pyx":721
+  /* "soapcw/soapcw.pyx":723
  * 
  *         cdef float max_prob = np.array([self.V[self.length-1][i] for i in range(self.width)]).max()
  *         cdef long max_prob_index = np.array([self.V[self.length-1][i] for i in range(self.width)]).argmax()             # <<<<<<<<<<<<<<
  * 
  *         vit_trackr[self.length-1] = max_prob_index
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 721, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   { /* enter inner scope */
-    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L11_error)
+    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 723, __pyx_L11_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_width); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 721, __pyx_L11_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_width); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 723, __pyx_L11_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 721, __pyx_L11_error)
+    __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 723, __pyx_L11_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (likely(PyList_CheckExact(__pyx_t_11)) || PyTuple_CheckExact(__pyx_t_11)) {
       __pyx_t_5 = __pyx_t_11; __Pyx_INCREF(__pyx_t_5); __pyx_t_8 = 0;
       __pyx_t_9 = NULL;
     } else {
-      __pyx_t_8 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 721, __pyx_L11_error)
+      __pyx_t_8 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 723, __pyx_L11_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_9 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 721, __pyx_L11_error)
+      __pyx_t_9 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 723, __pyx_L11_error)
     }
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     for (;;) {
       if (likely(!__pyx_t_9)) {
         if (likely(PyList_CheckExact(__pyx_t_5))) {
           if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_5)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_11 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_11); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 721, __pyx_L11_error)
+          __pyx_t_11 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_11); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 723, __pyx_L11_error)
           #else
-          __pyx_t_11 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 721, __pyx_L11_error)
+          __pyx_t_11 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 723, __pyx_L11_error)
           __Pyx_GOTREF(__pyx_t_11);
           #endif
         } else {
           if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_11); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 721, __pyx_L11_error)
+          __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_11); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 723, __pyx_L11_error)
           #else
-          __pyx_t_11 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 721, __pyx_L11_error)
+          __pyx_t_11 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 723, __pyx_L11_error)
           __Pyx_GOTREF(__pyx_t_11);
           #endif
         }
       } else {
         __pyx_t_11 = __pyx_t_9(__pyx_t_5);
         if (unlikely(!__pyx_t_11)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 721, __pyx_L11_error)
+            else __PYX_ERR(0, 723, __pyx_L11_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_11);
       }
       __Pyx_XDECREF_SET(__pyx_8genexpr6__pyx_v_i, __pyx_t_11);
       __pyx_t_11 = 0;
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_V); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 721, __pyx_L11_error)
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_V); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 723, __pyx_L11_error)
       __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 721, __pyx_L11_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 723, __pyx_L11_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_7 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 721, __pyx_L11_error)
+      __pyx_t_7 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 723, __pyx_L11_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_11, __pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 721, __pyx_L11_error)
+      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_11, __pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 723, __pyx_L11_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_10, __pyx_8genexpr6__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 721, __pyx_L11_error)
+      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_10, __pyx_8genexpr6__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 723, __pyx_L11_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 721, __pyx_L11_error)
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 723, __pyx_L11_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_i); __pyx_8genexpr6__pyx_v_i = 0;
     goto __pyx_L14_exit_scope;
     __pyx_L11_error:;
     __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_i); __pyx_8genexpr6__pyx_v_i = 0;
@@ -15866,464 +16058,464 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 721, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_argmax); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 721, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_argmax); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 721, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 721, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 723, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_max_prob_index = __pyx_t_13;
 
-  /* "soapcw/soapcw.pyx":723
+  /* "soapcw/soapcw.pyx":725
  *         cdef long max_prob_index = np.array([self.V[self.length-1][i] for i in range(self.width)]).argmax()
  * 
  *         vit_trackr[self.length-1] = max_prob_index             # <<<<<<<<<<<<<<
  *         vit_track1[self.length-1] = self.det1[self.length-1][max_prob_index]
  *         vit_track2[self.length-1] = self.det2[self.length-1][max_prob_index]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 723, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 725, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 723, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 725, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 723, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 725, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_14 = __pyx_t_8;
   __pyx_t_15 = -1;
   if (__pyx_t_14 < 0) {
     __pyx_t_14 += __pyx_v_vit_trackr.shape[0];
     if (unlikely(__pyx_t_14 < 0)) __pyx_t_15 = 0;
   } else if (unlikely(__pyx_t_14 >= __pyx_v_vit_trackr.shape[0])) __pyx_t_15 = 0;
   if (unlikely(__pyx_t_15 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_15);
-    __PYX_ERR(0, 723, __pyx_L1_error)
+    __PYX_ERR(0, 725, __pyx_L1_error)
   }
   *((long *) ( /* dim=0 */ (__pyx_v_vit_trackr.data + __pyx_t_14 * __pyx_v_vit_trackr.strides[0]) )) = __pyx_v_max_prob_index;
 
-  /* "soapcw/soapcw.pyx":724
+  /* "soapcw/soapcw.pyx":726
  * 
  *         vit_trackr[self.length-1] = max_prob_index
  *         vit_track1[self.length-1] = self.det1[self.length-1][max_prob_index]             # <<<<<<<<<<<<<<
  *         vit_track2[self.length-1] = self.det2[self.length-1][max_prob_index]
  *         previous = self.prev[self.length-1][max_prob_index]
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_det1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 724, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_det1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 726, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 724, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 724, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 726, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 724, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_max_prob_index, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 724, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_max_prob_index, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 726, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_4); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 724, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_4); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 726, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 724, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 726, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 724, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 724, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 726, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_16 = __pyx_t_8;
+  __pyx_t_14 = __pyx_t_8;
   __pyx_t_15 = -1;
-  if (__pyx_t_16 < 0) {
-    __pyx_t_16 += __pyx_v_vit_track1.shape[0];
-    if (unlikely(__pyx_t_16 < 0)) __pyx_t_15 = 0;
-  } else if (unlikely(__pyx_t_16 >= __pyx_v_vit_track1.shape[0])) __pyx_t_15 = 0;
+  if (__pyx_t_14 < 0) {
+    __pyx_t_14 += __pyx_v_vit_track1.shape[0];
+    if (unlikely(__pyx_t_14 < 0)) __pyx_t_15 = 0;
+  } else if (unlikely(__pyx_t_14 >= __pyx_v_vit_track1.shape[0])) __pyx_t_15 = 0;
   if (unlikely(__pyx_t_15 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_15);
-    __PYX_ERR(0, 724, __pyx_L1_error)
+    __PYX_ERR(0, 726, __pyx_L1_error)
   }
-  *((long *) ( /* dim=0 */ (__pyx_v_vit_track1.data + __pyx_t_16 * __pyx_v_vit_track1.strides[0]) )) = __pyx_t_13;
+  *((long *) ( /* dim=0 */ (__pyx_v_vit_track1.data + __pyx_t_14 * __pyx_v_vit_track1.strides[0]) )) = __pyx_t_13;
 
-  /* "soapcw/soapcw.pyx":725
+  /* "soapcw/soapcw.pyx":727
  *         vit_trackr[self.length-1] = max_prob_index
  *         vit_track1[self.length-1] = self.det1[self.length-1][max_prob_index]
  *         vit_track2[self.length-1] = self.det2[self.length-1][max_prob_index]             # <<<<<<<<<<<<<<
  *         previous = self.prev[self.length-1][max_prob_index]
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_det2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_det2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_max_prob_index, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_max_prob_index, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 725, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 725, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_17 = __pyx_t_8;
+  __pyx_t_14 = __pyx_t_8;
   __pyx_t_15 = -1;
-  if (__pyx_t_17 < 0) {
-    __pyx_t_17 += __pyx_v_vit_track2.shape[0];
-    if (unlikely(__pyx_t_17 < 0)) __pyx_t_15 = 0;
-  } else if (unlikely(__pyx_t_17 >= __pyx_v_vit_track2.shape[0])) __pyx_t_15 = 0;
+  if (__pyx_t_14 < 0) {
+    __pyx_t_14 += __pyx_v_vit_track2.shape[0];
+    if (unlikely(__pyx_t_14 < 0)) __pyx_t_15 = 0;
+  } else if (unlikely(__pyx_t_14 >= __pyx_v_vit_track2.shape[0])) __pyx_t_15 = 0;
   if (unlikely(__pyx_t_15 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_15);
-    __PYX_ERR(0, 725, __pyx_L1_error)
+    __PYX_ERR(0, 727, __pyx_L1_error)
   }
-  *((long *) ( /* dim=0 */ (__pyx_v_vit_track2.data + __pyx_t_17 * __pyx_v_vit_track2.strides[0]) )) = __pyx_t_13;
+  *((long *) ( /* dim=0 */ (__pyx_v_vit_track2.data + __pyx_t_14 * __pyx_v_vit_track2.strides[0]) )) = __pyx_t_13;
 
-  /* "soapcw/soapcw.pyx":726
+  /* "soapcw/soapcw.pyx":728
  *         vit_track1[self.length-1] = self.det1[self.length-1][max_prob_index]
  *         vit_track2[self.length-1] = self.det2[self.length-1][max_prob_index]
  *         previous = self.prev[self.length-1][max_prob_index]             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prev); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 726, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prev); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 728, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 726, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 728, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 728, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 726, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 728, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_max_prob_index, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_max_prob_index, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 728, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 726, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 728, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_previous = __pyx_t_13;
 
-  /* "soapcw/soapcw.pyx":729
+  /* "soapcw/soapcw.pyx":731
  * 
  * 
  *         for t in range(self.length-2,-1,-1):             # <<<<<<<<<<<<<<
  *             vit_trackr[t] = previous # insert previous step
  *             vit_track1[t] = self.det1[t][previous]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 729, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 729, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 729, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_neg_1);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 729, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
     __pyx_t_1 = __pyx_t_3; __Pyx_INCREF(__pyx_t_1); __pyx_t_8 = 0;
     __pyx_t_9 = NULL;
   } else {
-    __pyx_t_8 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 729, __pyx_L1_error)
+    __pyx_t_8 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 729, __pyx_L1_error)
+    __pyx_t_9 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 731, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   for (;;) {
     if (likely(!__pyx_t_9)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 729, __pyx_L1_error)
+        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 731, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 729, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       } else {
         if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 729, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 731, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 729, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       }
     } else {
       __pyx_t_3 = __pyx_t_9(__pyx_t_1);
       if (unlikely(!__pyx_t_3)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 729, __pyx_L1_error)
+          else __PYX_ERR(0, 731, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_3);
     }
     __Pyx_XDECREF_SET(__pyx_v_t, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "soapcw/soapcw.pyx":730
+    /* "soapcw/soapcw.pyx":732
  * 
  *         for t in range(self.length-2,-1,-1):
  *             vit_trackr[t] = previous # insert previous step             # <<<<<<<<<<<<<<
  *             vit_track1[t] = self.det1[t][previous]
  *             vit_track2[t] = self.det2[t][previous]
  */
-    __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_v_t); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 730, __pyx_L1_error)
-    __pyx_t_19 = __pyx_t_18;
+    __pyx_t_16 = __Pyx_PyIndex_AsSsize_t(__pyx_v_t); if (unlikely((__pyx_t_16 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 732, __pyx_L1_error)
+    __pyx_t_14 = __pyx_t_16;
     __pyx_t_15 = -1;
-    if (__pyx_t_19 < 0) {
-      __pyx_t_19 += __pyx_v_vit_trackr.shape[0];
-      if (unlikely(__pyx_t_19 < 0)) __pyx_t_15 = 0;
-    } else if (unlikely(__pyx_t_19 >= __pyx_v_vit_trackr.shape[0])) __pyx_t_15 = 0;
+    if (__pyx_t_14 < 0) {
+      __pyx_t_14 += __pyx_v_vit_trackr.shape[0];
+      if (unlikely(__pyx_t_14 < 0)) __pyx_t_15 = 0;
+    } else if (unlikely(__pyx_t_14 >= __pyx_v_vit_trackr.shape[0])) __pyx_t_15 = 0;
     if (unlikely(__pyx_t_15 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_15);
-      __PYX_ERR(0, 730, __pyx_L1_error)
+      __PYX_ERR(0, 732, __pyx_L1_error)
     }
-    *((long *) ( /* dim=0 */ (__pyx_v_vit_trackr.data + __pyx_t_19 * __pyx_v_vit_trackr.strides[0]) )) = __pyx_v_previous;
+    *((long *) ( /* dim=0 */ (__pyx_v_vit_trackr.data + __pyx_t_14 * __pyx_v_vit_trackr.strides[0]) )) = __pyx_v_previous;
 
-    /* "soapcw/soapcw.pyx":731
+    /* "soapcw/soapcw.pyx":733
  *         for t in range(self.length-2,-1,-1):
  *             vit_trackr[t] = previous # insert previous step
  *             vit_track1[t] = self.det1[t][previous]             # <<<<<<<<<<<<<<
  *             vit_track2[t] = self.det2[t][previous]
  *             previous = self.prev[t][previous]
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_det1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_det1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 733, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 731, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 733, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_previous, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_previous, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 733, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 731, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 733, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_v_t); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 731, __pyx_L1_error)
-    __pyx_t_20 = __pyx_t_18;
+    __pyx_t_16 = __Pyx_PyIndex_AsSsize_t(__pyx_v_t); if (unlikely((__pyx_t_16 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 733, __pyx_L1_error)
+    __pyx_t_14 = __pyx_t_16;
     __pyx_t_15 = -1;
-    if (__pyx_t_20 < 0) {
-      __pyx_t_20 += __pyx_v_vit_track1.shape[0];
-      if (unlikely(__pyx_t_20 < 0)) __pyx_t_15 = 0;
-    } else if (unlikely(__pyx_t_20 >= __pyx_v_vit_track1.shape[0])) __pyx_t_15 = 0;
+    if (__pyx_t_14 < 0) {
+      __pyx_t_14 += __pyx_v_vit_track1.shape[0];
+      if (unlikely(__pyx_t_14 < 0)) __pyx_t_15 = 0;
+    } else if (unlikely(__pyx_t_14 >= __pyx_v_vit_track1.shape[0])) __pyx_t_15 = 0;
     if (unlikely(__pyx_t_15 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_15);
-      __PYX_ERR(0, 731, __pyx_L1_error)
+      __PYX_ERR(0, 733, __pyx_L1_error)
     }
-    *((long *) ( /* dim=0 */ (__pyx_v_vit_track1.data + __pyx_t_20 * __pyx_v_vit_track1.strides[0]) )) = __pyx_t_13;
+    *((long *) ( /* dim=0 */ (__pyx_v_vit_track1.data + __pyx_t_14 * __pyx_v_vit_track1.strides[0]) )) = __pyx_t_13;
 
-    /* "soapcw/soapcw.pyx":732
+    /* "soapcw/soapcw.pyx":734
  *             vit_trackr[t] = previous # insert previous step
  *             vit_track1[t] = self.det1[t][previous]
  *             vit_track2[t] = self.det2[t][previous]             # <<<<<<<<<<<<<<
  *             previous = self.prev[t][previous]
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_det2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 732, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_det2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 734, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 732, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 734, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_previous, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 732, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_previous, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 734, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 732, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 734, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_v_t); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 732, __pyx_L1_error)
-    __pyx_t_21 = __pyx_t_18;
+    __pyx_t_16 = __Pyx_PyIndex_AsSsize_t(__pyx_v_t); if (unlikely((__pyx_t_16 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 734, __pyx_L1_error)
+    __pyx_t_14 = __pyx_t_16;
     __pyx_t_15 = -1;
-    if (__pyx_t_21 < 0) {
-      __pyx_t_21 += __pyx_v_vit_track2.shape[0];
-      if (unlikely(__pyx_t_21 < 0)) __pyx_t_15 = 0;
-    } else if (unlikely(__pyx_t_21 >= __pyx_v_vit_track2.shape[0])) __pyx_t_15 = 0;
+    if (__pyx_t_14 < 0) {
+      __pyx_t_14 += __pyx_v_vit_track2.shape[0];
+      if (unlikely(__pyx_t_14 < 0)) __pyx_t_15 = 0;
+    } else if (unlikely(__pyx_t_14 >= __pyx_v_vit_track2.shape[0])) __pyx_t_15 = 0;
     if (unlikely(__pyx_t_15 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_15);
-      __PYX_ERR(0, 732, __pyx_L1_error)
+      __PYX_ERR(0, 734, __pyx_L1_error)
     }
-    *((long *) ( /* dim=0 */ (__pyx_v_vit_track2.data + __pyx_t_21 * __pyx_v_vit_track2.strides[0]) )) = __pyx_t_13;
+    *((long *) ( /* dim=0 */ (__pyx_v_vit_track2.data + __pyx_t_14 * __pyx_v_vit_track2.strides[0]) )) = __pyx_t_13;
 
-    /* "soapcw/soapcw.pyx":733
+    /* "soapcw/soapcw.pyx":735
  *             vit_track1[t] = self.det1[t][previous]
  *             vit_track2[t] = self.det2[t][previous]
  *             previous = self.prev[t][previous]             # <<<<<<<<<<<<<<
  * 
  *         self.vit_track1 = np.array(vit_track1)
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prev); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 733, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prev); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 735, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 733, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 735, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_previous, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 733, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_previous, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 735, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 733, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_13 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 735, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_previous = __pyx_t_13;
 
-    /* "soapcw/soapcw.pyx":729
+    /* "soapcw/soapcw.pyx":731
  * 
  * 
  *         for t in range(self.length-2,-1,-1):             # <<<<<<<<<<<<<<
  *             vit_trackr[t] = previous # insert previous step
  *             vit_track1[t] = self.det1[t][previous]
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":735
+  /* "soapcw/soapcw.pyx":737
  *             previous = self.prev[t][previous]
  * 
  *         self.vit_track1 = np.array(vit_track1)             # <<<<<<<<<<<<<<
  *         self.vit_track2 = np.array(vit_track2)
  *         self.vit_track = np.array(vit_trackr)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 735, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 737, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 735, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 737, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_vit_track1, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 735, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_vit_track1, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 737, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 735, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 737, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track1, __pyx_t_1) < 0) __PYX_ERR(0, 735, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track1, __pyx_t_1) < 0) __PYX_ERR(0, 737, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":736
+  /* "soapcw/soapcw.pyx":738
  * 
  *         self.vit_track1 = np.array(vit_track1)
  *         self.vit_track2 = np.array(vit_track2)             # <<<<<<<<<<<<<<
  *         self.vit_track = np.array(vit_trackr)
  *         self.max_end_prob = max_prob
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_vit_track2, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_vit_track2, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track2, __pyx_t_1) < 0) __PYX_ERR(0, 736, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track2, __pyx_t_1) < 0) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":737
+  /* "soapcw/soapcw.pyx":739
  *         self.vit_track1 = np.array(vit_track1)
  *         self.vit_track2 = np.array(vit_track2)
  *         self.vit_track = np.array(vit_trackr)             # <<<<<<<<<<<<<<
  *         self.max_end_prob = max_prob
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_vit_trackr, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_vit_trackr, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 737, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track, __pyx_t_1) < 0) __PYX_ERR(0, 737, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track, __pyx_t_1) < 0) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":738
+  /* "soapcw/soapcw.pyx":740
  *         self.vit_track2 = np.array(vit_track2)
  *         self.vit_track = np.array(vit_trackr)
  *         self.max_end_prob = max_prob             # <<<<<<<<<<<<<<
  * 
  *         #return np.array(vit_track1), np.array(vit_track2), np.array(vit_trackr), np.array(val),np.array(prev),max_prob
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_prob); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_prob); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_max_end_prob, __pyx_t_1) < 0) __PYX_ERR(0, 738, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_max_end_prob, __pyx_t_1) < 0) __PYX_ERR(0, 740, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":701
+  /* "soapcw/soapcw.pyx":703
  *         self.length = length
  * 
  *     def get_track(self):             # <<<<<<<<<<<<<<
  *         """
  *         Takes in the viterbi data from a run and identifies the track thorugh whcih gives the maximum probability
  */
 
@@ -16350,15 +16542,15 @@
   __Pyx_XDECREF(__pyx_8genexpr5__pyx_v_i);
   __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_i);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":745
+/* "soapcw/soapcw.pyx":747
  * class three_detector(object):
  * 
  *     def __init__(self, tr, obs1, obs2, obs3, prog = False):             # <<<<<<<<<<<<<<
  *         '''
  *         initialising viterbi class
  */
 
@@ -16369,14 +16561,17 @@
 static PyObject *__pyx_pw_6soapcw_6soapcw_14three_detector_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_tr = 0;
   PyObject *__pyx_v_obs1 = 0;
   PyObject *__pyx_v_obs2 = 0;
   PyObject *__pyx_v_obs3 = 0;
   PyObject *__pyx_v_prog = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr,&__pyx_n_s_obs1,&__pyx_n_s_obs2,&__pyx_n_s_obs3,&__pyx_n_s_prog,0};
     PyObject* values[6] = {0,0,0,0,0,0};
     values[5] = ((PyObject *)((PyObject *)Py_False));
@@ -16404,43 +16599,43 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 5, 6, 1); __PYX_ERR(0, 745, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 5, 6, 1); __PYX_ERR(0, 747, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 5, 6, 2); __PYX_ERR(0, 745, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 5, 6, 2); __PYX_ERR(0, 747, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 5, 6, 3); __PYX_ERR(0, 745, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 5, 6, 3); __PYX_ERR(0, 747, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs3)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 5, 6, 4); __PYX_ERR(0, 745, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 5, 6, 4); __PYX_ERR(0, 747, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_prog);
           if (value) { values[5] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 745, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 747, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
@@ -16456,15 +16651,15 @@
     __pyx_v_obs1 = values[2];
     __pyx_v_obs2 = values[3];
     __pyx_v_obs3 = values[4];
     __pyx_v_prog = values[5];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 5, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 745, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 5, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 747, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.three_detector.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_14three_detector___init__(__pyx_self, __pyx_v_self, __pyx_v_tr, __pyx_v_obs1, __pyx_v_obs2, __pyx_v_obs3, __pyx_v_prog);
 
@@ -16477,33 +16672,36 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "soapcw/soapcw.pyx":749
+  /* "soapcw/soapcw.pyx":751
  *         initialising viterbi class
  *         '''
  *         self.prog = prog             # <<<<<<<<<<<<<<
  *         self.tracks = self.run(tr, obs1, obs2, obs3)
  * 
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prog, __pyx_v_prog) < 0) __PYX_ERR(0, 749, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prog, __pyx_v_prog) < 0) __PYX_ERR(0, 751, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":750
+  /* "soapcw/soapcw.pyx":752
  *         '''
  *         self.prog = prog
  *         self.tracks = self.run(tr, obs1, obs2, obs3)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_run); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 750, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_run); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 752, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -16512,29 +16710,29 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[5] = {__pyx_t_3, __pyx_v_tr, __pyx_v_obs1, __pyx_v_obs2, __pyx_v_obs3};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 4+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 4+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 752, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[5] = {__pyx_t_3, __pyx_v_tr, __pyx_v_obs1, __pyx_v_obs2, __pyx_v_obs3};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 4+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 4+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 752, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 752, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_3) {
       __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
     }
     __Pyx_INCREF(__pyx_v_tr);
     __Pyx_GIVEREF(__pyx_v_tr);
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_tr);
@@ -16543,23 +16741,23 @@
     PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_obs1);
     __Pyx_INCREF(__pyx_v_obs2);
     __Pyx_GIVEREF(__pyx_v_obs2);
     PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_4, __pyx_v_obs2);
     __Pyx_INCREF(__pyx_v_obs3);
     __Pyx_GIVEREF(__pyx_v_obs3);
     PyTuple_SET_ITEM(__pyx_t_5, 3+__pyx_t_4, __pyx_v_obs3);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 752, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tracks, __pyx_t_1) < 0) __PYX_ERR(0, 750, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tracks, __pyx_t_1) < 0) __PYX_ERR(0, 752, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":745
+  /* "soapcw/soapcw.pyx":747
  * class three_detector(object):
  * 
  *     def __init__(self, tr, obs1, obs2, obs3, prog = False):             # <<<<<<<<<<<<<<
  *         '''
  *         initialising viterbi class
  */
 
@@ -16575,15 +16773,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":758
+/* "soapcw/soapcw.pyx":760
  *     #--------------------------------------------------------
  * 
  *     def run(self,tr1, obs11, obs21, obs31):             # <<<<<<<<<<<<<<
  *         """
  *         viterbi algorithm for multiple detectors 2 at the moment
  */
 
@@ -16593,14 +16791,17 @@
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_14three_detector_3run = {"run", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_14three_detector_3run, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6soapcw_6soapcw_14three_detector_2run};
 static PyObject *__pyx_pw_6soapcw_6soapcw_14three_detector_3run(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_tr1 = 0;
   PyObject *__pyx_v_obs11 = 0;
   PyObject *__pyx_v_obs21 = 0;
   PyObject *__pyx_v_obs31 = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("run (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr1,&__pyx_n_s_obs11,&__pyx_n_s_obs21,&__pyx_n_s_obs31,0};
     PyObject* values[5] = {0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
@@ -16625,37 +16826,37 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run", 1, 5, 5, 1); __PYX_ERR(0, 758, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run", 1, 5, 5, 1); __PYX_ERR(0, 760, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs11)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run", 1, 5, 5, 2); __PYX_ERR(0, 758, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run", 1, 5, 5, 2); __PYX_ERR(0, 760, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs21)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run", 1, 5, 5, 3); __PYX_ERR(0, 758, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run", 1, 5, 5, 3); __PYX_ERR(0, 760, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs31)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run", 1, 5, 5, 4); __PYX_ERR(0, 758, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run", 1, 5, 5, 4); __PYX_ERR(0, 760, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "run") < 0)) __PYX_ERR(0, 758, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "run") < 0)) __PYX_ERR(0, 760, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -16666,15 +16867,15 @@
     __pyx_v_tr1 = values[1];
     __pyx_v_obs11 = values[2];
     __pyx_v_obs21 = values[3];
     __pyx_v_obs31 = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("run", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 758, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("run", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 760, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.three_detector.run", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_14three_detector_2run(__pyx_self, __pyx_v_self, __pyx_v_tr1, __pyx_v_obs11, __pyx_v_obs21, __pyx_v_obs31);
 
@@ -16752,168 +16953,114 @@
   Py_ssize_t __pyx_t_32;
   Py_ssize_t __pyx_t_33;
   Py_ssize_t __pyx_t_34;
   Py_ssize_t __pyx_t_35;
   Py_ssize_t __pyx_t_36;
   Py_ssize_t __pyx_t_37;
   Py_ssize_t __pyx_t_38;
-  Py_ssize_t __pyx_t_39;
-  Py_ssize_t __pyx_t_40;
-  Py_ssize_t __pyx_t_41;
-  Py_ssize_t __pyx_t_42;
-  Py_ssize_t __pyx_t_43;
-  Py_ssize_t __pyx_t_44;
+  int __pyx_t_39;
+  int __pyx_t_40;
+  int __pyx_t_41;
+  int __pyx_t_42;
+  int __pyx_t_43;
+  int __pyx_t_44;
   Py_ssize_t __pyx_t_45;
   Py_ssize_t __pyx_t_46;
-  long __pyx_t_47;
-  Py_ssize_t __pyx_t_48;
-  Py_ssize_t __pyx_t_49;
-  int __pyx_t_50;
-  int __pyx_t_51;
-  int __pyx_t_52;
-  int __pyx_t_53;
-  int __pyx_t_54;
-  Py_ssize_t __pyx_t_55;
-  Py_ssize_t __pyx_t_56;
-  int __pyx_t_57;
-  Py_ssize_t __pyx_t_58;
-  Py_ssize_t __pyx_t_59;
-  Py_ssize_t __pyx_t_60;
-  Py_ssize_t __pyx_t_61;
-  Py_ssize_t __pyx_t_62;
-  Py_ssize_t __pyx_t_63;
-  Py_ssize_t __pyx_t_64;
-  Py_ssize_t __pyx_t_65;
-  Py_ssize_t __pyx_t_66;
-  Py_ssize_t __pyx_t_67;
-  Py_ssize_t __pyx_t_68;
-  Py_ssize_t __pyx_t_69;
-  Py_ssize_t __pyx_t_70;
-  Py_ssize_t __pyx_t_71;
-  Py_ssize_t __pyx_t_72;
-  Py_ssize_t __pyx_t_73;
-  Py_ssize_t __pyx_t_74;
-  Py_ssize_t __pyx_t_75;
-  Py_ssize_t __pyx_t_76;
-  Py_ssize_t __pyx_t_77;
-  PyObject *__pyx_t_78 = NULL;
-  __Pyx_memviewslice __pyx_t_79 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  Py_ssize_t __pyx_t_80;
-  Py_ssize_t __pyx_t_81;
-  float __pyx_t_82;
-  Py_ssize_t __pyx_t_83;
-  Py_ssize_t __pyx_t_84;
-  Py_ssize_t __pyx_t_85;
-  Py_ssize_t __pyx_t_86;
-  Py_ssize_t __pyx_t_87;
-  Py_ssize_t __pyx_t_88;
-  Py_ssize_t __pyx_t_89;
-  Py_ssize_t __pyx_t_90;
-  Py_ssize_t __pyx_t_91;
-  Py_ssize_t __pyx_t_92;
-  Py_ssize_t __pyx_t_93;
-  Py_ssize_t __pyx_t_94;
-  Py_ssize_t __pyx_t_95;
-  Py_ssize_t __pyx_t_96;
-  Py_ssize_t __pyx_t_97;
-  Py_ssize_t __pyx_t_98;
-  Py_ssize_t __pyx_t_99;
-  Py_ssize_t __pyx_t_100;
-  Py_ssize_t __pyx_t_101;
-  Py_ssize_t __pyx_t_102;
-  Py_ssize_t __pyx_t_103;
-  Py_ssize_t __pyx_t_104;
-  Py_ssize_t __pyx_t_105;
-  Py_ssize_t __pyx_t_106;
-  Py_ssize_t __pyx_t_107;
-  Py_ssize_t __pyx_t_108;
+  int __pyx_t_47;
+  PyObject *__pyx_t_48 = NULL;
+  __Pyx_memviewslice __pyx_t_49 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  float __pyx_t_50;
+  long __pyx_t_51;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("run", 0);
 
-  /* "soapcw/soapcw.pyx":790
+  /* "soapcw/soapcw.pyx":792
  * 
  * 
  *         cdef double[:, :, :, :] tr = tr1             # <<<<<<<<<<<<<<
  *         cdef double[:, :] obs1 = obs11
  *         cdef double[:, :] obs2 = obs21
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double(__pyx_v_tr1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 790, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double(__pyx_v_tr1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 792, __pyx_L1_error)
   __pyx_v_tr = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "soapcw/soapcw.pyx":791
+  /* "soapcw/soapcw.pyx":793
  * 
  *         cdef double[:, :, :, :] tr = tr1
  *         cdef double[:, :] obs1 = obs11             # <<<<<<<<<<<<<<
  *         cdef double[:, :] obs2 = obs21
  *         cdef double[:, :] obs3 = obs31
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 791, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 793, __pyx_L1_error)
   __pyx_v_obs1 = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "soapcw/soapcw.pyx":792
+  /* "soapcw/soapcw.pyx":794
  *         cdef double[:, :, :, :] tr = tr1
  *         cdef double[:, :] obs1 = obs11
  *         cdef double[:, :] obs2 = obs21             # <<<<<<<<<<<<<<
  *         cdef double[:, :] obs3 = obs31
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs21, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 792, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs21, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 794, __pyx_L1_error)
   __pyx_v_obs2 = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "soapcw/soapcw.pyx":793
+  /* "soapcw/soapcw.pyx":795
  *         cdef double[:, :] obs1 = obs11
  *         cdef double[:, :] obs2 = obs21
  *         cdef double[:, :] obs3 = obs31             # <<<<<<<<<<<<<<
  * 
  *         shape = np.shape(obs1)
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs31, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 793, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs31, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 795, __pyx_L1_error)
   __pyx_v_obs3 = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "soapcw/soapcw.pyx":795
+  /* "soapcw/soapcw.pyx":797
  *         cdef double[:, :] obs3 = obs31
  * 
  *         shape = np.shape(obs1)             # <<<<<<<<<<<<<<
  * 
  *         cdef int length = min(len(obs1),len(obs2),len(obs3))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 797, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 797, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_obs1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_obs1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 797, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 795, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 797, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_shape = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":797
+  /* "soapcw/soapcw.pyx":799
  *         shape = np.shape(obs1)
  * 
  *         cdef int length = min(len(obs1),len(obs2),len(obs3))             # <<<<<<<<<<<<<<
  *         cdef int width = len(obs1[0])
  * 
  */
   __pyx_t_7 = __Pyx_MemoryView_Len(__pyx_v_obs2); 
@@ -16928,15 +17075,15 @@
   if (((__pyx_t_8 < __pyx_t_11) != 0)) {
     __pyx_t_10 = __pyx_t_8;
   } else {
     __pyx_t_10 = __pyx_t_11;
   }
   __pyx_v_length = __pyx_t_10;
 
-  /* "soapcw/soapcw.pyx":798
+  /* "soapcw/soapcw.pyx":800
  * 
  *         cdef int length = min(len(obs1),len(obs2),len(obs3))
  *         cdef int width = len(obs1[0])             # <<<<<<<<<<<<<<
  * 
  *         cdef double[:, :] val = np.ones(shape)*-1e6
  */
   __pyx_t_12.data = __pyx_v_obs1.data;
@@ -16944,260 +17091,260 @@
   __PYX_INC_MEMVIEW(&__pyx_t_12, 0);
   {
     Py_ssize_t __pyx_tmp_idx = 0;
         Py_ssize_t __pyx_tmp_shape = __pyx_v_obs1.shape[0];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_obs1.strides[0];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
-        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
+        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 0)");
-            __PYX_ERR(0, 798, __pyx_L1_error)
+            __PYX_ERR(0, 800, __pyx_L1_error)
         }
         __pyx_t_12.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
 __pyx_t_12.shape[0] = __pyx_v_obs1.shape[1];
 __pyx_t_12.strides[0] = __pyx_v_obs1.strides[1];
     __pyx_t_12.suboffsets[0] = -1;
 
 __pyx_t_7 = __Pyx_MemoryView_Len(__pyx_t_12); 
   __PYX_XDEC_MEMVIEW(&__pyx_t_12, 1);
   __pyx_t_12.memview = NULL;
   __pyx_t_12.data = NULL;
   __pyx_v_width = __pyx_t_7;
 
-  /* "soapcw/soapcw.pyx":800
+  /* "soapcw/soapcw.pyx":802
  *         cdef int width = len(obs1[0])
  * 
  *         cdef double[:, :] val = np.ones(shape)*-1e6             # <<<<<<<<<<<<<<
- *         cdef long[:, :] prev = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
+ *         cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 802, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_ones); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_ones); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 802, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_v_shape) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_shape);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 800, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 802, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_3, __pyx_float_neg_1e6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_3, __pyx_float_neg_1e6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 802, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 802, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_val = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "soapcw/soapcw.pyx":801
+  /* "soapcw/soapcw.pyx":803
  * 
  *         cdef double[:, :] val = np.ones(shape)*-1e6
- *         cdef long[:, :] prev = np.zeros(shape,dtype = np.int)             # <<<<<<<<<<<<<<
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)
+ *         cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)             # <<<<<<<<<<<<<<
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 803, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 803, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 803, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_shape);
   __Pyx_GIVEREF(__pyx_v_shape);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_shape);
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 803, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 803, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_int); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_int32); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 803, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_13) < 0) __PYX_ERR(0, 801, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_13) < 0) __PYX_ERR(0, 803, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 803, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_dsds_long(__pyx_t_13, PyBUF_WRITABLE); if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_13, PyBUF_WRITABLE); if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 803, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   __pyx_v_prev = __pyx_t_14;
   __pyx_t_14.memview = NULL;
   __pyx_t_14.data = NULL;
 
-  /* "soapcw/soapcw.pyx":802
+  /* "soapcw/soapcw.pyx":804
  *         cdef double[:, :] val = np.ones(shape)*-1e6
- *         cdef long[:, :] prev = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)             # <<<<<<<<<<<<<<
- *         cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det3 = np.zeros(shape,dtype = np.int)
+ *         cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)             # <<<<<<<<<<<<<<
+ *         cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det3 = np.zeros(shape,dtype = np.int32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = PyTuple_New(1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_t_13 = PyTuple_New(1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_INCREF(__pyx_v_shape);
   __Pyx_GIVEREF(__pyx_v_shape);
   PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_v_shape);
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 802, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 804, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_13, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_13, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_dsds_long(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 804, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_det1 = __pyx_t_14;
   __pyx_t_14.memview = NULL;
   __pyx_t_14.data = NULL;
 
-  /* "soapcw/soapcw.pyx":803
- *         cdef long[:, :] prev = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)             # <<<<<<<<<<<<<<
- *         cdef long[:, :] det3 = np.zeros(shape,dtype = np.int)
+  /* "soapcw/soapcw.pyx":805
+ *         cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)             # <<<<<<<<<<<<<<
+ *         cdef int[:, :] det3 = np.zeros(shape,dtype = np.int32)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 805, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 805, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 805, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_shape);
   __Pyx_GIVEREF(__pyx_v_shape);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_shape);
-  __pyx_t_13 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 805, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 805, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 805, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_13, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 803, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_13, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 805, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_13); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_13); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 805, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_dsds_long(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 805, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_det2 = __pyx_t_14;
   __pyx_t_14.memview = NULL;
   __pyx_t_14.data = NULL;
 
-  /* "soapcw/soapcw.pyx":804
- *         cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)
- *         cdef long[:, :] det3 = np.zeros(shape,dtype = np.int)             # <<<<<<<<<<<<<<
+  /* "soapcw/soapcw.pyx":806
+ *         cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)
+ *         cdef int[:, :] det3 = np.zeros(shape,dtype = np.int32)             # <<<<<<<<<<<<<<
  * 
  *         cdef int tr_len = len(tr)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 804, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 804, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 804, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_shape);
   __Pyx_GIVEREF(__pyx_v_shape);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_shape);
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 804, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 804, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 804, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 804, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 804, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_dsds_long(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 804, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_det3 = __pyx_t_14;
   __pyx_t_14.memview = NULL;
   __pyx_t_14.data = NULL;
 
-  /* "soapcw/soapcw.pyx":806
- *         cdef long[:, :] det3 = np.zeros(shape,dtype = np.int)
+  /* "soapcw/soapcw.pyx":808
+ *         cdef int[:, :] det3 = np.zeros(shape,dtype = np.int32)
  * 
  *         cdef int tr_len = len(tr)             # <<<<<<<<<<<<<<
  * 
  *         cdef int i
  */
   __pyx_t_7 = __Pyx_MemoryView_Len(__pyx_v_tr); 
   __pyx_v_tr_len = __pyx_t_7;
 
-  /* "soapcw/soapcw.pyx":822
+  /* "soapcw/soapcw.pyx":824
  *         #cdef double[:] max_vals
  * 
  *         for i in range(width):             # <<<<<<<<<<<<<<
  * 
  *             temp = -1e6
  */
   __pyx_t_15 = __pyx_v_width;
   __pyx_t_16 = __pyx_t_15;
   for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
     __pyx_v_i = __pyx_t_17;
 
-    /* "soapcw/soapcw.pyx":824
+    /* "soapcw/soapcw.pyx":826
  *         for i in range(width):
  * 
  *             temp = -1e6             # <<<<<<<<<<<<<<
  *             for k in range(tr_len):
  *                 if i+k-1>=0 and i+k-1<width:
  */
     __pyx_v_temp = -1e6;
 
-    /* "soapcw/soapcw.pyx":825
+    /* "soapcw/soapcw.pyx":827
  * 
  *             temp = -1e6
  *             for k in range(tr_len):             # <<<<<<<<<<<<<<
  *                 if i+k-1>=0 and i+k-1<width:
  *                     for m in range(tr_len):
  */
     __pyx_t_18 = __pyx_v_tr_len;
     __pyx_t_19 = __pyx_t_18;
     for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
       __pyx_v_k = __pyx_t_20;
 
-      /* "soapcw/soapcw.pyx":826
+      /* "soapcw/soapcw.pyx":828
  *             temp = -1e6
  *             for k in range(tr_len):
  *                 if i+k-1>=0 and i+k-1<width:             # <<<<<<<<<<<<<<
  *                     for m in range(tr_len):
  *                         if i+m-1>=0 and i+m-1<width:
  */
       __pyx_t_22 = ((((__pyx_v_i + __pyx_v_k) - 1) >= 0) != 0);
@@ -17207,27 +17354,27 @@
         goto __pyx_L8_bool_binop_done;
       }
       __pyx_t_22 = ((((__pyx_v_i + __pyx_v_k) - 1) < __pyx_v_width) != 0);
       __pyx_t_21 = __pyx_t_22;
       __pyx_L8_bool_binop_done:;
       if (__pyx_t_21) {
 
-        /* "soapcw/soapcw.pyx":827
+        /* "soapcw/soapcw.pyx":829
  *             for k in range(tr_len):
  *                 if i+k-1>=0 and i+k-1<width:
  *                     for m in range(tr_len):             # <<<<<<<<<<<<<<
  *                         if i+m-1>=0 and i+m-1<width:
  *                             for l in range(tr_len):
  */
         __pyx_t_23 = __pyx_v_tr_len;
         __pyx_t_24 = __pyx_t_23;
         for (__pyx_t_25 = 0; __pyx_t_25 < __pyx_t_24; __pyx_t_25+=1) {
           __pyx_v_m = __pyx_t_25;
 
-          /* "soapcw/soapcw.pyx":828
+          /* "soapcw/soapcw.pyx":830
  *                 if i+k-1>=0 and i+k-1<width:
  *                     for m in range(tr_len):
  *                         if i+m-1>=0 and i+m-1<width:             # <<<<<<<<<<<<<<
  *                             for l in range(tr_len):
  *                                 if i+l-1>=0 and i+l-1<width:
  */
           __pyx_t_22 = ((((__pyx_v_i + __pyx_v_m) - 1) >= 0) != 0);
@@ -17237,113 +17384,113 @@
             goto __pyx_L13_bool_binop_done;
           }
           __pyx_t_22 = ((((__pyx_v_i + __pyx_v_m) - 1) < __pyx_v_width) != 0);
           __pyx_t_21 = __pyx_t_22;
           __pyx_L13_bool_binop_done:;
           if (__pyx_t_21) {
 
-            /* "soapcw/soapcw.pyx":829
+            /* "soapcw/soapcw.pyx":831
  *                     for m in range(tr_len):
  *                         if i+m-1>=0 and i+m-1<width:
  *                             for l in range(tr_len):             # <<<<<<<<<<<<<<
  *                                 if i+l-1>=0 and i+l-1<width:
  *                                     value = obs1[0][i+k-1] + obs2[0][i+m-1] + obs3[0][i+l-1] + tr[1][k][m][l]
  */
-            __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_tr_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 829, __pyx_L1_error)
+            __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_tr_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 829, __pyx_L1_error)
+            __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 831, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
               __pyx_t_5 = __pyx_t_6; __Pyx_INCREF(__pyx_t_5); __pyx_t_10 = 0;
               __pyx_t_26 = NULL;
             } else {
-              __pyx_t_10 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 829, __pyx_L1_error)
+              __pyx_t_10 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_5);
-              __pyx_t_26 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 829, __pyx_L1_error)
+              __pyx_t_26 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 831, __pyx_L1_error)
             }
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
             for (;;) {
               if (likely(!__pyx_t_26)) {
                 if (likely(PyList_CheckExact(__pyx_t_5))) {
                   if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_5)) break;
                   #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                  __pyx_t_6 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_10); __Pyx_INCREF(__pyx_t_6); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 829, __pyx_L1_error)
+                  __pyx_t_6 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_10); __Pyx_INCREF(__pyx_t_6); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 831, __pyx_L1_error)
                   #else
-                  __pyx_t_6 = PySequence_ITEM(__pyx_t_5, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 829, __pyx_L1_error)
+                  __pyx_t_6 = PySequence_ITEM(__pyx_t_5, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 831, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_6);
                   #endif
                 } else {
                   if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
                   #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                  __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_10); __Pyx_INCREF(__pyx_t_6); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 829, __pyx_L1_error)
+                  __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_10); __Pyx_INCREF(__pyx_t_6); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 831, __pyx_L1_error)
                   #else
-                  __pyx_t_6 = PySequence_ITEM(__pyx_t_5, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 829, __pyx_L1_error)
+                  __pyx_t_6 = PySequence_ITEM(__pyx_t_5, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 831, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_6);
                   #endif
                 }
               } else {
                 __pyx_t_6 = __pyx_t_26(__pyx_t_5);
                 if (unlikely(!__pyx_t_6)) {
                   PyObject* exc_type = PyErr_Occurred();
                   if (exc_type) {
                     if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                    else __PYX_ERR(0, 829, __pyx_L1_error)
+                    else __PYX_ERR(0, 831, __pyx_L1_error)
                   }
                   break;
                 }
                 __Pyx_GOTREF(__pyx_t_6);
               }
               __Pyx_XDECREF_SET(__pyx_v_l, __pyx_t_6);
               __pyx_t_6 = 0;
 
-              /* "soapcw/soapcw.pyx":830
+              /* "soapcw/soapcw.pyx":832
  *                         if i+m-1>=0 and i+m-1<width:
  *                             for l in range(tr_len):
  *                                 if i+l-1>=0 and i+l-1<width:             # <<<<<<<<<<<<<<
  *                                     value = obs1[0][i+k-1] + obs2[0][i+m-1] + obs3[0][i+l-1] + tr[1][k][m][l]
  *                                 if value > temp:
  */
-              __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 830, __pyx_L1_error)
+              __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 832, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_6);
-              __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_v_l); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 830, __pyx_L1_error)
+              __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_v_l); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 832, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_3);
               __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-              __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 830, __pyx_L1_error)
+              __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 832, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_6);
               __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-              __pyx_t_3 = PyObject_RichCompare(__pyx_t_6, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 830, __pyx_L1_error)
+              __pyx_t_3 = PyObject_RichCompare(__pyx_t_6, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 832, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-              __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 830, __pyx_L1_error)
+              __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 832, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
               if (__pyx_t_22) {
               } else {
                 __pyx_t_21 = __pyx_t_22;
                 goto __pyx_L18_bool_binop_done;
               }
-              __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 830, __pyx_L1_error)
+              __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 832, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_3);
-              __pyx_t_6 = PyNumber_Add(__pyx_t_3, __pyx_v_l); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 830, __pyx_L1_error)
+              __pyx_t_6 = PyNumber_Add(__pyx_t_3, __pyx_v_l); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 832, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_6);
               __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-              __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 830, __pyx_L1_error)
+              __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 832, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_3);
               __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-              __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_width); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 830, __pyx_L1_error)
+              __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_width); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 832, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_6);
-              __pyx_t_13 = PyObject_RichCompare(__pyx_t_3, __pyx_t_6, Py_LT); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 830, __pyx_L1_error)
+              __pyx_t_13 = PyObject_RichCompare(__pyx_t_3, __pyx_t_6, Py_LT); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 832, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
               __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-              __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 830, __pyx_L1_error)
+              __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 832, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
               __pyx_t_21 = __pyx_t_22;
               __pyx_L18_bool_binop_done:;
               if (__pyx_t_21) {
 
-                /* "soapcw/soapcw.pyx":831
+                /* "soapcw/soapcw.pyx":833
  *                             for l in range(tr_len):
  *                                 if i+l-1>=0 and i+l-1<width:
  *                                     value = obs1[0][i+k-1] + obs2[0][i+m-1] + obs3[0][i+l-1] + tr[1][k][m][l]             # <<<<<<<<<<<<<<
  *                                 if value > temp:
  *                                     temp = value
  */
                 __pyx_t_27 = 0;
@@ -17355,57 +17502,57 @@
                 } else if (unlikely(__pyx_t_27 >= __pyx_v_obs1.shape[0])) __pyx_t_29 = 0;
                 if (__pyx_t_28 < 0) {
                   __pyx_t_28 += __pyx_v_obs1.shape[1];
                   if (unlikely(__pyx_t_28 < 0)) __pyx_t_29 = 1;
                 } else if (unlikely(__pyx_t_28 >= __pyx_v_obs1.shape[1])) __pyx_t_29 = 1;
                 if (unlikely(__pyx_t_29 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_29);
-                  __PYX_ERR(0, 831, __pyx_L1_error)
+                  __PYX_ERR(0, 833, __pyx_L1_error)
                 }
                 __pyx_t_30 = 0;
                 __pyx_t_31 = ((__pyx_v_i + __pyx_v_m) - 1);
                 __pyx_t_29 = -1;
                 if (__pyx_t_30 < 0) {
                   __pyx_t_30 += __pyx_v_obs2.shape[0];
                   if (unlikely(__pyx_t_30 < 0)) __pyx_t_29 = 0;
                 } else if (unlikely(__pyx_t_30 >= __pyx_v_obs2.shape[0])) __pyx_t_29 = 0;
                 if (__pyx_t_31 < 0) {
                   __pyx_t_31 += __pyx_v_obs2.shape[1];
                   if (unlikely(__pyx_t_31 < 0)) __pyx_t_29 = 1;
                 } else if (unlikely(__pyx_t_31 >= __pyx_v_obs2.shape[1])) __pyx_t_29 = 1;
                 if (unlikely(__pyx_t_29 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_29);
-                  __PYX_ERR(0, 831, __pyx_L1_error)
+                  __PYX_ERR(0, 833, __pyx_L1_error)
                 }
-                __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 831, __pyx_L1_error)
+                __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 833, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_13);
-                __pyx_t_6 = PyNumber_Add(__pyx_t_13, __pyx_v_l); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 831, __pyx_L1_error)
+                __pyx_t_6 = PyNumber_Add(__pyx_t_13, __pyx_v_l); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 833, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_6);
                 __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                __pyx_t_13 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 831, __pyx_L1_error)
+                __pyx_t_13 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 833, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_13);
                 __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-                __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_t_13); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 831, __pyx_L1_error)
+                __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_t_13); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 833, __pyx_L1_error)
                 __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
                 __pyx_t_32 = 0;
                 __pyx_t_33 = __pyx_t_11;
                 __pyx_t_29 = -1;
                 if (__pyx_t_32 < 0) {
                   __pyx_t_32 += __pyx_v_obs3.shape[0];
                   if (unlikely(__pyx_t_32 < 0)) __pyx_t_29 = 0;
                 } else if (unlikely(__pyx_t_32 >= __pyx_v_obs3.shape[0])) __pyx_t_29 = 0;
                 if (__pyx_t_33 < 0) {
                   __pyx_t_33 += __pyx_v_obs3.shape[1];
                   if (unlikely(__pyx_t_33 < 0)) __pyx_t_29 = 1;
                 } else if (unlikely(__pyx_t_33 >= __pyx_v_obs3.shape[1])) __pyx_t_29 = 1;
                 if (unlikely(__pyx_t_29 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_29);
-                  __PYX_ERR(0, 831, __pyx_L1_error)
+                  __PYX_ERR(0, 833, __pyx_L1_error)
                 }
-                __pyx_t_34 = __Pyx_PyIndex_AsSsize_t(__pyx_v_l); if (unlikely((__pyx_t_34 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 831, __pyx_L1_error)
+                __pyx_t_34 = __Pyx_PyIndex_AsSsize_t(__pyx_v_l); if (unlikely((__pyx_t_34 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 833, __pyx_L1_error)
                 __pyx_t_35 = 1;
                 __pyx_t_36 = __pyx_v_k;
                 __pyx_t_37 = __pyx_v_m;
                 __pyx_t_38 = __pyx_t_34;
                 __pyx_t_29 = -1;
                 if (__pyx_t_35 < 0) {
                   __pyx_t_35 += __pyx_v_tr.shape[0];
@@ -17421,299 +17568,299 @@
                 } else if (unlikely(__pyx_t_37 >= __pyx_v_tr.shape[2])) __pyx_t_29 = 2;
                 if (__pyx_t_38 < 0) {
                   __pyx_t_38 += __pyx_v_tr.shape[3];
                   if (unlikely(__pyx_t_38 < 0)) __pyx_t_29 = 3;
                 } else if (unlikely(__pyx_t_38 >= __pyx_v_tr.shape[3])) __pyx_t_29 = 3;
                 if (unlikely(__pyx_t_29 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_29);
-                  __PYX_ERR(0, 831, __pyx_L1_error)
+                  __PYX_ERR(0, 833, __pyx_L1_error)
                 }
                 __pyx_v_value = ((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1.data + __pyx_t_27 * __pyx_v_obs1.strides[0]) ) + __pyx_t_28 * __pyx_v_obs1.strides[1]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs2.data + __pyx_t_30 * __pyx_v_obs2.strides[0]) ) + __pyx_t_31 * __pyx_v_obs2.strides[1]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs3.data + __pyx_t_32 * __pyx_v_obs3.strides[0]) ) + __pyx_t_33 * __pyx_v_obs3.strides[1]) )))) + (*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_35 * __pyx_v_tr.strides[0]) ) + __pyx_t_36 * __pyx_v_tr.strides[1]) ) + __pyx_t_37 * __pyx_v_tr.strides[2]) ) + __pyx_t_38 * __pyx_v_tr.strides[3]) ))));
 
-                /* "soapcw/soapcw.pyx":830
+                /* "soapcw/soapcw.pyx":832
  *                         if i+m-1>=0 and i+m-1<width:
  *                             for l in range(tr_len):
  *                                 if i+l-1>=0 and i+l-1<width:             # <<<<<<<<<<<<<<
  *                                     value = obs1[0][i+k-1] + obs2[0][i+m-1] + obs3[0][i+l-1] + tr[1][k][m][l]
  *                                 if value > temp:
  */
               }
 
-              /* "soapcw/soapcw.pyx":832
+              /* "soapcw/soapcw.pyx":834
  *                                 if i+l-1>=0 and i+l-1<width:
  *                                     value = obs1[0][i+k-1] + obs2[0][i+m-1] + obs3[0][i+l-1] + tr[1][k][m][l]
  *                                 if value > temp:             # <<<<<<<<<<<<<<
  *                                     temp = value
  *                                     val[0][i] = temp
  */
               __pyx_t_21 = ((__pyx_v_value > __pyx_v_temp) != 0);
               if (__pyx_t_21) {
 
-                /* "soapcw/soapcw.pyx":833
+                /* "soapcw/soapcw.pyx":835
  *                                     value = obs1[0][i+k-1] + obs2[0][i+m-1] + obs3[0][i+l-1] + tr[1][k][m][l]
  *                                 if value > temp:
  *                                     temp = value             # <<<<<<<<<<<<<<
  *                                     val[0][i] = temp
  *                                     prev[0][i] =  i
  */
                 __pyx_v_temp = __pyx_v_value;
 
-                /* "soapcw/soapcw.pyx":834
+                /* "soapcw/soapcw.pyx":836
  *                                 if value > temp:
  *                                     temp = value
  *                                     val[0][i] = temp             # <<<<<<<<<<<<<<
  *                                     prev[0][i] =  i
  *                                     det1[0][i] =  i+k-1
  */
-                __pyx_t_39 = 0;
-                __pyx_t_40 = __pyx_v_i;
+                __pyx_t_38 = 0;
+                __pyx_t_37 = __pyx_v_i;
                 __pyx_t_29 = -1;
-                if (__pyx_t_39 < 0) {
-                  __pyx_t_39 += __pyx_v_val.shape[0];
-                  if (unlikely(__pyx_t_39 < 0)) __pyx_t_29 = 0;
-                } else if (unlikely(__pyx_t_39 >= __pyx_v_val.shape[0])) __pyx_t_29 = 0;
-                if (__pyx_t_40 < 0) {
-                  __pyx_t_40 += __pyx_v_val.shape[1];
-                  if (unlikely(__pyx_t_40 < 0)) __pyx_t_29 = 1;
-                } else if (unlikely(__pyx_t_40 >= __pyx_v_val.shape[1])) __pyx_t_29 = 1;
+                if (__pyx_t_38 < 0) {
+                  __pyx_t_38 += __pyx_v_val.shape[0];
+                  if (unlikely(__pyx_t_38 < 0)) __pyx_t_29 = 0;
+                } else if (unlikely(__pyx_t_38 >= __pyx_v_val.shape[0])) __pyx_t_29 = 0;
+                if (__pyx_t_37 < 0) {
+                  __pyx_t_37 += __pyx_v_val.shape[1];
+                  if (unlikely(__pyx_t_37 < 0)) __pyx_t_29 = 1;
+                } else if (unlikely(__pyx_t_37 >= __pyx_v_val.shape[1])) __pyx_t_29 = 1;
                 if (unlikely(__pyx_t_29 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_29);
-                  __PYX_ERR(0, 834, __pyx_L1_error)
+                  __PYX_ERR(0, 836, __pyx_L1_error)
                 }
-                *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_39 * __pyx_v_val.strides[0]) ) + __pyx_t_40 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
+                *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_38 * __pyx_v_val.strides[0]) ) + __pyx_t_37 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
 
-                /* "soapcw/soapcw.pyx":835
+                /* "soapcw/soapcw.pyx":837
  *                                     temp = value
  *                                     val[0][i] = temp
  *                                     prev[0][i] =  i             # <<<<<<<<<<<<<<
  *                                     det1[0][i] =  i+k-1
  *                                     det2[0][i] =  i+m-1
  */
-                __pyx_t_41 = 0;
-                __pyx_t_42 = __pyx_v_i;
+                __pyx_t_37 = 0;
+                __pyx_t_38 = __pyx_v_i;
                 __pyx_t_29 = -1;
-                if (__pyx_t_41 < 0) {
-                  __pyx_t_41 += __pyx_v_prev.shape[0];
-                  if (unlikely(__pyx_t_41 < 0)) __pyx_t_29 = 0;
-                } else if (unlikely(__pyx_t_41 >= __pyx_v_prev.shape[0])) __pyx_t_29 = 0;
-                if (__pyx_t_42 < 0) {
-                  __pyx_t_42 += __pyx_v_prev.shape[1];
-                  if (unlikely(__pyx_t_42 < 0)) __pyx_t_29 = 1;
-                } else if (unlikely(__pyx_t_42 >= __pyx_v_prev.shape[1])) __pyx_t_29 = 1;
+                if (__pyx_t_37 < 0) {
+                  __pyx_t_37 += __pyx_v_prev.shape[0];
+                  if (unlikely(__pyx_t_37 < 0)) __pyx_t_29 = 0;
+                } else if (unlikely(__pyx_t_37 >= __pyx_v_prev.shape[0])) __pyx_t_29 = 0;
+                if (__pyx_t_38 < 0) {
+                  __pyx_t_38 += __pyx_v_prev.shape[1];
+                  if (unlikely(__pyx_t_38 < 0)) __pyx_t_29 = 1;
+                } else if (unlikely(__pyx_t_38 >= __pyx_v_prev.shape[1])) __pyx_t_29 = 1;
                 if (unlikely(__pyx_t_29 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_29);
-                  __PYX_ERR(0, 835, __pyx_L1_error)
+                  __PYX_ERR(0, 837, __pyx_L1_error)
                 }
-                *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_41 * __pyx_v_prev.strides[0]) ) + __pyx_t_42 * __pyx_v_prev.strides[1]) )) = __pyx_v_i;
+                *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_37 * __pyx_v_prev.strides[0]) ) + __pyx_t_38 * __pyx_v_prev.strides[1]) )) = __pyx_v_i;
 
-                /* "soapcw/soapcw.pyx":836
+                /* "soapcw/soapcw.pyx":838
  *                                     val[0][i] = temp
  *                                     prev[0][i] =  i
  *                                     det1[0][i] =  i+k-1             # <<<<<<<<<<<<<<
  *                                     det2[0][i] =  i+m-1
  *                                     det3[0][i] =  i+l-1
  */
-                __pyx_t_43 = 0;
-                __pyx_t_44 = __pyx_v_i;
+                __pyx_t_38 = 0;
+                __pyx_t_37 = __pyx_v_i;
                 __pyx_t_29 = -1;
-                if (__pyx_t_43 < 0) {
-                  __pyx_t_43 += __pyx_v_det1.shape[0];
-                  if (unlikely(__pyx_t_43 < 0)) __pyx_t_29 = 0;
-                } else if (unlikely(__pyx_t_43 >= __pyx_v_det1.shape[0])) __pyx_t_29 = 0;
-                if (__pyx_t_44 < 0) {
-                  __pyx_t_44 += __pyx_v_det1.shape[1];
-                  if (unlikely(__pyx_t_44 < 0)) __pyx_t_29 = 1;
-                } else if (unlikely(__pyx_t_44 >= __pyx_v_det1.shape[1])) __pyx_t_29 = 1;
+                if (__pyx_t_38 < 0) {
+                  __pyx_t_38 += __pyx_v_det1.shape[0];
+                  if (unlikely(__pyx_t_38 < 0)) __pyx_t_29 = 0;
+                } else if (unlikely(__pyx_t_38 >= __pyx_v_det1.shape[0])) __pyx_t_29 = 0;
+                if (__pyx_t_37 < 0) {
+                  __pyx_t_37 += __pyx_v_det1.shape[1];
+                  if (unlikely(__pyx_t_37 < 0)) __pyx_t_29 = 1;
+                } else if (unlikely(__pyx_t_37 >= __pyx_v_det1.shape[1])) __pyx_t_29 = 1;
                 if (unlikely(__pyx_t_29 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_29);
-                  __PYX_ERR(0, 836, __pyx_L1_error)
+                  __PYX_ERR(0, 838, __pyx_L1_error)
                 }
-                *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_43 * __pyx_v_det1.strides[0]) ) + __pyx_t_44 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - 1);
+                *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_38 * __pyx_v_det1.strides[0]) ) + __pyx_t_37 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - 1);
 
-                /* "soapcw/soapcw.pyx":837
+                /* "soapcw/soapcw.pyx":839
  *                                     prev[0][i] =  i
  *                                     det1[0][i] =  i+k-1
  *                                     det2[0][i] =  i+m-1             # <<<<<<<<<<<<<<
  *                                     det3[0][i] =  i+l-1
  *                                 else:
  */
-                __pyx_t_45 = 0;
-                __pyx_t_46 = __pyx_v_i;
+                __pyx_t_37 = 0;
+                __pyx_t_38 = __pyx_v_i;
                 __pyx_t_29 = -1;
-                if (__pyx_t_45 < 0) {
-                  __pyx_t_45 += __pyx_v_det2.shape[0];
-                  if (unlikely(__pyx_t_45 < 0)) __pyx_t_29 = 0;
-                } else if (unlikely(__pyx_t_45 >= __pyx_v_det2.shape[0])) __pyx_t_29 = 0;
-                if (__pyx_t_46 < 0) {
-                  __pyx_t_46 += __pyx_v_det2.shape[1];
-                  if (unlikely(__pyx_t_46 < 0)) __pyx_t_29 = 1;
-                } else if (unlikely(__pyx_t_46 >= __pyx_v_det2.shape[1])) __pyx_t_29 = 1;
+                if (__pyx_t_37 < 0) {
+                  __pyx_t_37 += __pyx_v_det2.shape[0];
+                  if (unlikely(__pyx_t_37 < 0)) __pyx_t_29 = 0;
+                } else if (unlikely(__pyx_t_37 >= __pyx_v_det2.shape[0])) __pyx_t_29 = 0;
+                if (__pyx_t_38 < 0) {
+                  __pyx_t_38 += __pyx_v_det2.shape[1];
+                  if (unlikely(__pyx_t_38 < 0)) __pyx_t_29 = 1;
+                } else if (unlikely(__pyx_t_38 >= __pyx_v_det2.shape[1])) __pyx_t_29 = 1;
                 if (unlikely(__pyx_t_29 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_29);
-                  __PYX_ERR(0, 837, __pyx_L1_error)
+                  __PYX_ERR(0, 839, __pyx_L1_error)
                 }
-                *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_45 * __pyx_v_det2.strides[0]) ) + __pyx_t_46 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - 1);
+                *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_37 * __pyx_v_det2.strides[0]) ) + __pyx_t_38 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - 1);
 
-                /* "soapcw/soapcw.pyx":838
+                /* "soapcw/soapcw.pyx":840
  *                                     det1[0][i] =  i+k-1
  *                                     det2[0][i] =  i+m-1
  *                                     det3[0][i] =  i+l-1             # <<<<<<<<<<<<<<
  *                                 else:
  *                                     continue
  */
-                __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 838, __pyx_L1_error)
+                __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 840, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_13);
-                __pyx_t_6 = PyNumber_Add(__pyx_t_13, __pyx_v_l); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 838, __pyx_L1_error)
+                __pyx_t_6 = PyNumber_Add(__pyx_t_13, __pyx_v_l); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_6);
                 __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                __pyx_t_13 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 838, __pyx_L1_error)
+                __pyx_t_13 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 840, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_13);
                 __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-                __pyx_t_47 = __Pyx_PyInt_As_long(__pyx_t_13); if (unlikely((__pyx_t_47 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 838, __pyx_L1_error)
+                __pyx_t_29 = __Pyx_PyInt_As_int(__pyx_t_13); if (unlikely((__pyx_t_29 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 840, __pyx_L1_error)
                 __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                __pyx_t_48 = 0;
-                __pyx_t_49 = __pyx_v_i;
-                __pyx_t_29 = -1;
-                if (__pyx_t_48 < 0) {
-                  __pyx_t_48 += __pyx_v_det3.shape[0];
-                  if (unlikely(__pyx_t_48 < 0)) __pyx_t_29 = 0;
-                } else if (unlikely(__pyx_t_48 >= __pyx_v_det3.shape[0])) __pyx_t_29 = 0;
-                if (__pyx_t_49 < 0) {
-                  __pyx_t_49 += __pyx_v_det3.shape[1];
-                  if (unlikely(__pyx_t_49 < 0)) __pyx_t_29 = 1;
-                } else if (unlikely(__pyx_t_49 >= __pyx_v_det3.shape[1])) __pyx_t_29 = 1;
-                if (unlikely(__pyx_t_29 != -1)) {
-                  __Pyx_RaiseBufferIndexError(__pyx_t_29);
-                  __PYX_ERR(0, 838, __pyx_L1_error)
+                __pyx_t_38 = 0;
+                __pyx_t_37 = __pyx_v_i;
+                __pyx_t_39 = -1;
+                if (__pyx_t_38 < 0) {
+                  __pyx_t_38 += __pyx_v_det3.shape[0];
+                  if (unlikely(__pyx_t_38 < 0)) __pyx_t_39 = 0;
+                } else if (unlikely(__pyx_t_38 >= __pyx_v_det3.shape[0])) __pyx_t_39 = 0;
+                if (__pyx_t_37 < 0) {
+                  __pyx_t_37 += __pyx_v_det3.shape[1];
+                  if (unlikely(__pyx_t_37 < 0)) __pyx_t_39 = 1;
+                } else if (unlikely(__pyx_t_37 >= __pyx_v_det3.shape[1])) __pyx_t_39 = 1;
+                if (unlikely(__pyx_t_39 != -1)) {
+                  __Pyx_RaiseBufferIndexError(__pyx_t_39);
+                  __PYX_ERR(0, 840, __pyx_L1_error)
                 }
-                *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det3.data + __pyx_t_48 * __pyx_v_det3.strides[0]) ) + __pyx_t_49 * __pyx_v_det3.strides[1]) )) = __pyx_t_47;
+                *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det3.data + __pyx_t_38 * __pyx_v_det3.strides[0]) ) + __pyx_t_37 * __pyx_v_det3.strides[1]) )) = __pyx_t_29;
 
-                /* "soapcw/soapcw.pyx":832
+                /* "soapcw/soapcw.pyx":834
  *                                 if i+l-1>=0 and i+l-1<width:
  *                                     value = obs1[0][i+k-1] + obs2[0][i+m-1] + obs3[0][i+l-1] + tr[1][k][m][l]
  *                                 if value > temp:             # <<<<<<<<<<<<<<
  *                                     temp = value
  *                                     val[0][i] = temp
  */
                 goto __pyx_L20;
               }
 
-              /* "soapcw/soapcw.pyx":840
+              /* "soapcw/soapcw.pyx":842
  *                                     det3[0][i] =  i+l-1
  *                                 else:
  *                                     continue             # <<<<<<<<<<<<<<
  * 
  * 
  */
               /*else*/ {
                 goto __pyx_L15_continue;
               }
               __pyx_L20:;
 
-              /* "soapcw/soapcw.pyx":829
+              /* "soapcw/soapcw.pyx":831
  *                     for m in range(tr_len):
  *                         if i+m-1>=0 and i+m-1<width:
  *                             for l in range(tr_len):             # <<<<<<<<<<<<<<
  *                                 if i+l-1>=0 and i+l-1<width:
  *                                     value = obs1[0][i+k-1] + obs2[0][i+m-1] + obs3[0][i+l-1] + tr[1][k][m][l]
  */
               __pyx_L15_continue:;
             }
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-            /* "soapcw/soapcw.pyx":828
+            /* "soapcw/soapcw.pyx":830
  *                 if i+k-1>=0 and i+k-1<width:
  *                     for m in range(tr_len):
  *                         if i+m-1>=0 and i+m-1<width:             # <<<<<<<<<<<<<<
  *                             for l in range(tr_len):
  *                                 if i+l-1>=0 and i+l-1<width:
  */
           }
         }
 
-        /* "soapcw/soapcw.pyx":826
+        /* "soapcw/soapcw.pyx":828
  *             temp = -1e6
  *             for k in range(tr_len):
  *                 if i+k-1>=0 and i+k-1<width:             # <<<<<<<<<<<<<<
  *                     for m in range(tr_len):
  *                         if i+m-1>=0 and i+m-1<width:
  */
       }
     }
   }
 
-  /* "soapcw/soapcw.pyx":847
+  /* "soapcw/soapcw.pyx":849
  *         # k is separation from other detector
  * 
  *         pbar = 0             # <<<<<<<<<<<<<<
  *         for t in range(1,length):
  *             pt = t/(float(length))*100.
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_v_pbar = __pyx_int_0;
 
-  /* "soapcw/soapcw.pyx":848
+  /* "soapcw/soapcw.pyx":850
  * 
  *         pbar = 0
  *         for t in range(1,length):             # <<<<<<<<<<<<<<
  *             pt = t/(float(length))*100.
  *             for i in range(width):
  */
   __pyx_t_15 = __pyx_v_length;
   __pyx_t_16 = __pyx_t_15;
   for (__pyx_t_17 = 1; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
     __pyx_v_t = __pyx_t_17;
 
-    /* "soapcw/soapcw.pyx":849
+    /* "soapcw/soapcw.pyx":851
  *         pbar = 0
  *         for t in range(1,length):
  *             pt = t/(float(length))*100.             # <<<<<<<<<<<<<<
  *             for i in range(width):
  * 
  */
     if (unlikely(((double)__pyx_v_length) == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-      __PYX_ERR(0, 849, __pyx_L1_error)
+      __PYX_ERR(0, 851, __pyx_L1_error)
     }
     __pyx_v_pt = ((((double)__pyx_v_t) / ((double)__pyx_v_length)) * 100.);
 
-    /* "soapcw/soapcw.pyx":850
+    /* "soapcw/soapcw.pyx":852
  *         for t in range(1,length):
  *             pt = t/(float(length))*100.
  *             for i in range(width):             # <<<<<<<<<<<<<<
  * 
  *                 temp = -1e6
  */
     __pyx_t_18 = __pyx_v_width;
     __pyx_t_19 = __pyx_t_18;
     for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
       __pyx_v_i = __pyx_t_20;
 
-      /* "soapcw/soapcw.pyx":852
+      /* "soapcw/soapcw.pyx":854
  *             for i in range(width):
  * 
  *                 temp = -1e6             # <<<<<<<<<<<<<<
  *                 for j in range(tr_len):
  *                     if i+j-1>=0 and i+j-1<width:
  */
       __pyx_v_temp = -1e6;
 
-      /* "soapcw/soapcw.pyx":853
+      /* "soapcw/soapcw.pyx":855
  * 
  *                 temp = -1e6
  *                 for j in range(tr_len):             # <<<<<<<<<<<<<<
  *                     if i+j-1>=0 and i+j-1<width:
  *                        for k in range(tr_len):
  */
       __pyx_t_23 = __pyx_v_tr_len;
       __pyx_t_24 = __pyx_t_23;
       for (__pyx_t_25 = 0; __pyx_t_25 < __pyx_t_24; __pyx_t_25+=1) {
         __pyx_v_j = __pyx_t_25;
 
-        /* "soapcw/soapcw.pyx":854
+        /* "soapcw/soapcw.pyx":856
  *                 temp = -1e6
  *                 for j in range(tr_len):
  *                     if i+j-1>=0 and i+j-1<width:             # <<<<<<<<<<<<<<
  *                        for k in range(tr_len):
  *                             if i+k-1>=0 and i+k-1<width:
  */
         __pyx_t_22 = ((((__pyx_v_i + __pyx_v_j) - 1) >= 0) != 0);
@@ -17723,27 +17870,27 @@
           goto __pyx_L28_bool_binop_done;
         }
         __pyx_t_22 = ((((__pyx_v_i + __pyx_v_j) - 1) < __pyx_v_width) != 0);
         __pyx_t_21 = __pyx_t_22;
         __pyx_L28_bool_binop_done:;
         if (__pyx_t_21) {
 
-          /* "soapcw/soapcw.pyx":855
+          /* "soapcw/soapcw.pyx":857
  *                 for j in range(tr_len):
  *                     if i+j-1>=0 and i+j-1<width:
  *                        for k in range(tr_len):             # <<<<<<<<<<<<<<
  *                             if i+k-1>=0 and i+k-1<width:
  *                                 for m in range(tr_len):
  */
           __pyx_t_29 = __pyx_v_tr_len;
-          __pyx_t_50 = __pyx_t_29;
-          for (__pyx_t_51 = 0; __pyx_t_51 < __pyx_t_50; __pyx_t_51+=1) {
-            __pyx_v_k = __pyx_t_51;
+          __pyx_t_39 = __pyx_t_29;
+          for (__pyx_t_40 = 0; __pyx_t_40 < __pyx_t_39; __pyx_t_40+=1) {
+            __pyx_v_k = __pyx_t_40;
 
-            /* "soapcw/soapcw.pyx":856
+            /* "soapcw/soapcw.pyx":858
  *                     if i+j-1>=0 and i+j-1<width:
  *                        for k in range(tr_len):
  *                             if i+k-1>=0 and i+k-1<width:             # <<<<<<<<<<<<<<
  *                                 for m in range(tr_len):
  *                                      if i+m-1>=0 and i+m-1<width:
  */
             __pyx_t_22 = ((((__pyx_v_i + __pyx_v_k) - 1) >= 0) != 0);
@@ -17753,27 +17900,27 @@
               goto __pyx_L33_bool_binop_done;
             }
             __pyx_t_22 = ((((__pyx_v_i + __pyx_v_k) - 1) < __pyx_v_width) != 0);
             __pyx_t_21 = __pyx_t_22;
             __pyx_L33_bool_binop_done:;
             if (__pyx_t_21) {
 
-              /* "soapcw/soapcw.pyx":857
+              /* "soapcw/soapcw.pyx":859
  *                        for k in range(tr_len):
  *                             if i+k-1>=0 and i+k-1<width:
  *                                 for m in range(tr_len):             # <<<<<<<<<<<<<<
  *                                      if i+m-1>=0 and i+m-1<width:
  *                                          for l in range(tr_len):
  */
-              __pyx_t_52 = __pyx_v_tr_len;
-              __pyx_t_53 = __pyx_t_52;
-              for (__pyx_t_54 = 0; __pyx_t_54 < __pyx_t_53; __pyx_t_54+=1) {
-                __pyx_v_m = __pyx_t_54;
+              __pyx_t_41 = __pyx_v_tr_len;
+              __pyx_t_42 = __pyx_t_41;
+              for (__pyx_t_43 = 0; __pyx_t_43 < __pyx_t_42; __pyx_t_43+=1) {
+                __pyx_v_m = __pyx_t_43;
 
-                /* "soapcw/soapcw.pyx":858
+                /* "soapcw/soapcw.pyx":860
  *                             if i+k-1>=0 and i+k-1<width:
  *                                 for m in range(tr_len):
  *                                      if i+m-1>=0 and i+m-1<width:             # <<<<<<<<<<<<<<
  *                                          for l in range(tr_len):
  *                                              if i+l-1>=0 and i+l-1<width:
  */
                 __pyx_t_22 = ((((__pyx_v_i + __pyx_v_m) - 1) >= 0) != 0);
@@ -17783,502 +17930,502 @@
                   goto __pyx_L38_bool_binop_done;
                 }
                 __pyx_t_22 = ((((__pyx_v_i + __pyx_v_m) - 1) < __pyx_v_width) != 0);
                 __pyx_t_21 = __pyx_t_22;
                 __pyx_L38_bool_binop_done:;
                 if (__pyx_t_21) {
 
-                  /* "soapcw/soapcw.pyx":859
+                  /* "soapcw/soapcw.pyx":861
  *                                 for m in range(tr_len):
  *                                      if i+m-1>=0 and i+m-1<width:
  *                                          for l in range(tr_len):             # <<<<<<<<<<<<<<
  *                                              if i+l-1>=0 and i+l-1<width:
  *                                                  value = obs1[t][i+k-1] + obs2[t][i+m-1] + obs3[t][i+l-1] + tr[j][k][m][l] + val[t-1][i+j-1]
  */
-                  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_tr_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 859, __pyx_L1_error)
+                  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_tr_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 861, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_5);
-                  __pyx_t_13 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 859, __pyx_L1_error)
+                  __pyx_t_13 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 861, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_13);
                   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                   if (likely(PyList_CheckExact(__pyx_t_13)) || PyTuple_CheckExact(__pyx_t_13)) {
                     __pyx_t_5 = __pyx_t_13; __Pyx_INCREF(__pyx_t_5); __pyx_t_10 = 0;
                     __pyx_t_26 = NULL;
                   } else {
-                    __pyx_t_10 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_13); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 859, __pyx_L1_error)
+                    __pyx_t_10 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_13); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 861, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_5);
-                    __pyx_t_26 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 859, __pyx_L1_error)
+                    __pyx_t_26 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 861, __pyx_L1_error)
                   }
                   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
                   for (;;) {
                     if (likely(!__pyx_t_26)) {
                       if (likely(PyList_CheckExact(__pyx_t_5))) {
                         if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_5)) break;
                         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                        __pyx_t_13 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_10); __Pyx_INCREF(__pyx_t_13); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 859, __pyx_L1_error)
+                        __pyx_t_13 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_10); __Pyx_INCREF(__pyx_t_13); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 861, __pyx_L1_error)
                         #else
-                        __pyx_t_13 = PySequence_ITEM(__pyx_t_5, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 859, __pyx_L1_error)
+                        __pyx_t_13 = PySequence_ITEM(__pyx_t_5, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 861, __pyx_L1_error)
                         __Pyx_GOTREF(__pyx_t_13);
                         #endif
                       } else {
                         if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
                         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                        __pyx_t_13 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_10); __Pyx_INCREF(__pyx_t_13); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 859, __pyx_L1_error)
+                        __pyx_t_13 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_10); __Pyx_INCREF(__pyx_t_13); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 861, __pyx_L1_error)
                         #else
-                        __pyx_t_13 = PySequence_ITEM(__pyx_t_5, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 859, __pyx_L1_error)
+                        __pyx_t_13 = PySequence_ITEM(__pyx_t_5, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 861, __pyx_L1_error)
                         __Pyx_GOTREF(__pyx_t_13);
                         #endif
                       }
                     } else {
                       __pyx_t_13 = __pyx_t_26(__pyx_t_5);
                       if (unlikely(!__pyx_t_13)) {
                         PyObject* exc_type = PyErr_Occurred();
                         if (exc_type) {
                           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                          else __PYX_ERR(0, 859, __pyx_L1_error)
+                          else __PYX_ERR(0, 861, __pyx_L1_error)
                         }
                         break;
                       }
                       __Pyx_GOTREF(__pyx_t_13);
                     }
                     __Pyx_XDECREF_SET(__pyx_v_l, __pyx_t_13);
                     __pyx_t_13 = 0;
 
-                    /* "soapcw/soapcw.pyx":860
+                    /* "soapcw/soapcw.pyx":862
  *                                      if i+m-1>=0 and i+m-1<width:
  *                                          for l in range(tr_len):
  *                                              if i+l-1>=0 and i+l-1<width:             # <<<<<<<<<<<<<<
  *                                                  value = obs1[t][i+k-1] + obs2[t][i+m-1] + obs3[t][i+l-1] + tr[j][k][m][l] + val[t-1][i+j-1]
  *                                                  if value > temp:
  */
-                    __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 860, __pyx_L1_error)
+                    __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 862, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_13);
-                    __pyx_t_6 = PyNumber_Add(__pyx_t_13, __pyx_v_l); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 860, __pyx_L1_error)
+                    __pyx_t_6 = PyNumber_Add(__pyx_t_13, __pyx_v_l); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_6);
                     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                    __pyx_t_13 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 860, __pyx_L1_error)
+                    __pyx_t_13 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 862, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_13);
                     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-                    __pyx_t_6 = PyObject_RichCompare(__pyx_t_13, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 860, __pyx_L1_error)
+                    __pyx_t_6 = PyObject_RichCompare(__pyx_t_13, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
                     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                    __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 860, __pyx_L1_error)
+                    __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
                     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                     if (__pyx_t_22) {
                     } else {
                       __pyx_t_21 = __pyx_t_22;
                       goto __pyx_L43_bool_binop_done;
                     }
-                    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 860, __pyx_L1_error)
+                    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_6);
-                    __pyx_t_13 = PyNumber_Add(__pyx_t_6, __pyx_v_l); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 860, __pyx_L1_error)
+                    __pyx_t_13 = PyNumber_Add(__pyx_t_6, __pyx_v_l); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 862, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_13);
                     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-                    __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_t_13, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 860, __pyx_L1_error)
+                    __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_t_13, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_6);
                     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                    __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_width); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 860, __pyx_L1_error)
+                    __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_width); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 862, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_13);
-                    __pyx_t_3 = PyObject_RichCompare(__pyx_t_6, __pyx_t_13, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 860, __pyx_L1_error)
+                    __pyx_t_3 = PyObject_RichCompare(__pyx_t_6, __pyx_t_13, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 862, __pyx_L1_error)
                     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                    __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 860, __pyx_L1_error)
+                    __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_22 < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     __pyx_t_21 = __pyx_t_22;
                     __pyx_L43_bool_binop_done:;
                     if (__pyx_t_21) {
 
-                      /* "soapcw/soapcw.pyx":861
+                      /* "soapcw/soapcw.pyx":863
  *                                          for l in range(tr_len):
  *                                              if i+l-1>=0 and i+l-1<width:
  *                                                  value = obs1[t][i+k-1] + obs2[t][i+m-1] + obs3[t][i+l-1] + tr[j][k][m][l] + val[t-1][i+j-1]             # <<<<<<<<<<<<<<
  *                                                  if value > temp:
  *                                                      temp = value
  */
-                      __pyx_t_55 = __pyx_v_t;
-                      __pyx_t_56 = ((__pyx_v_i + __pyx_v_k) - 1);
-                      __pyx_t_57 = -1;
-                      if (__pyx_t_55 < 0) {
-                        __pyx_t_55 += __pyx_v_obs1.shape[0];
-                        if (unlikely(__pyx_t_55 < 0)) __pyx_t_57 = 0;
-                      } else if (unlikely(__pyx_t_55 >= __pyx_v_obs1.shape[0])) __pyx_t_57 = 0;
-                      if (__pyx_t_56 < 0) {
-                        __pyx_t_56 += __pyx_v_obs1.shape[1];
-                        if (unlikely(__pyx_t_56 < 0)) __pyx_t_57 = 1;
-                      } else if (unlikely(__pyx_t_56 >= __pyx_v_obs1.shape[1])) __pyx_t_57 = 1;
-                      if (unlikely(__pyx_t_57 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_57);
-                        __PYX_ERR(0, 861, __pyx_L1_error)
+                      __pyx_t_37 = __pyx_v_t;
+                      __pyx_t_38 = ((__pyx_v_i + __pyx_v_k) - 1);
+                      __pyx_t_44 = -1;
+                      if (__pyx_t_37 < 0) {
+                        __pyx_t_37 += __pyx_v_obs1.shape[0];
+                        if (unlikely(__pyx_t_37 < 0)) __pyx_t_44 = 0;
+                      } else if (unlikely(__pyx_t_37 >= __pyx_v_obs1.shape[0])) __pyx_t_44 = 0;
+                      if (__pyx_t_38 < 0) {
+                        __pyx_t_38 += __pyx_v_obs1.shape[1];
+                        if (unlikely(__pyx_t_38 < 0)) __pyx_t_44 = 1;
+                      } else if (unlikely(__pyx_t_38 >= __pyx_v_obs1.shape[1])) __pyx_t_44 = 1;
+                      if (unlikely(__pyx_t_44 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_44);
+                        __PYX_ERR(0, 863, __pyx_L1_error)
                       }
-                      __pyx_t_58 = __pyx_v_t;
-                      __pyx_t_59 = ((__pyx_v_i + __pyx_v_m) - 1);
-                      __pyx_t_57 = -1;
-                      if (__pyx_t_58 < 0) {
-                        __pyx_t_58 += __pyx_v_obs2.shape[0];
-                        if (unlikely(__pyx_t_58 < 0)) __pyx_t_57 = 0;
-                      } else if (unlikely(__pyx_t_58 >= __pyx_v_obs2.shape[0])) __pyx_t_57 = 0;
-                      if (__pyx_t_59 < 0) {
-                        __pyx_t_59 += __pyx_v_obs2.shape[1];
-                        if (unlikely(__pyx_t_59 < 0)) __pyx_t_57 = 1;
-                      } else if (unlikely(__pyx_t_59 >= __pyx_v_obs2.shape[1])) __pyx_t_57 = 1;
-                      if (unlikely(__pyx_t_57 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_57);
-                        __PYX_ERR(0, 861, __pyx_L1_error)
+                      __pyx_t_36 = __pyx_v_t;
+                      __pyx_t_35 = ((__pyx_v_i + __pyx_v_m) - 1);
+                      __pyx_t_44 = -1;
+                      if (__pyx_t_36 < 0) {
+                        __pyx_t_36 += __pyx_v_obs2.shape[0];
+                        if (unlikely(__pyx_t_36 < 0)) __pyx_t_44 = 0;
+                      } else if (unlikely(__pyx_t_36 >= __pyx_v_obs2.shape[0])) __pyx_t_44 = 0;
+                      if (__pyx_t_35 < 0) {
+                        __pyx_t_35 += __pyx_v_obs2.shape[1];
+                        if (unlikely(__pyx_t_35 < 0)) __pyx_t_44 = 1;
+                      } else if (unlikely(__pyx_t_35 >= __pyx_v_obs2.shape[1])) __pyx_t_44 = 1;
+                      if (unlikely(__pyx_t_44 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_44);
+                        __PYX_ERR(0, 863, __pyx_L1_error)
                       }
-                      __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 861, __pyx_L1_error)
+                      __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 863, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __pyx_t_13 = PyNumber_Add(__pyx_t_3, __pyx_v_l); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 861, __pyx_L1_error)
+                      __pyx_t_13 = PyNumber_Add(__pyx_t_3, __pyx_v_l); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 863, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_13);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_13, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 861, __pyx_L1_error)
+                      __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_13, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 863, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                      __pyx_t_34 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_34 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 861, __pyx_L1_error)
+                      __pyx_t_34 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_34 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      __pyx_t_60 = __pyx_v_t;
-                      __pyx_t_61 = __pyx_t_34;
-                      __pyx_t_57 = -1;
-                      if (__pyx_t_60 < 0) {
-                        __pyx_t_60 += __pyx_v_obs3.shape[0];
-                        if (unlikely(__pyx_t_60 < 0)) __pyx_t_57 = 0;
-                      } else if (unlikely(__pyx_t_60 >= __pyx_v_obs3.shape[0])) __pyx_t_57 = 0;
-                      if (__pyx_t_61 < 0) {
-                        __pyx_t_61 += __pyx_v_obs3.shape[1];
-                        if (unlikely(__pyx_t_61 < 0)) __pyx_t_57 = 1;
-                      } else if (unlikely(__pyx_t_61 >= __pyx_v_obs3.shape[1])) __pyx_t_57 = 1;
-                      if (unlikely(__pyx_t_57 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_57);
-                        __PYX_ERR(0, 861, __pyx_L1_error)
+                      __pyx_t_33 = __pyx_v_t;
+                      __pyx_t_32 = __pyx_t_34;
+                      __pyx_t_44 = -1;
+                      if (__pyx_t_33 < 0) {
+                        __pyx_t_33 += __pyx_v_obs3.shape[0];
+                        if (unlikely(__pyx_t_33 < 0)) __pyx_t_44 = 0;
+                      } else if (unlikely(__pyx_t_33 >= __pyx_v_obs3.shape[0])) __pyx_t_44 = 0;
+                      if (__pyx_t_32 < 0) {
+                        __pyx_t_32 += __pyx_v_obs3.shape[1];
+                        if (unlikely(__pyx_t_32 < 0)) __pyx_t_44 = 1;
+                      } else if (unlikely(__pyx_t_32 >= __pyx_v_obs3.shape[1])) __pyx_t_44 = 1;
+                      if (unlikely(__pyx_t_44 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_44);
+                        __PYX_ERR(0, 863, __pyx_L1_error)
                       }
-                      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_l); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 861, __pyx_L1_error)
-                      __pyx_t_62 = __pyx_v_j;
-                      __pyx_t_63 = __pyx_v_k;
-                      __pyx_t_64 = __pyx_v_m;
-                      __pyx_t_65 = __pyx_t_11;
-                      __pyx_t_57 = -1;
-                      if (__pyx_t_62 < 0) {
-                        __pyx_t_62 += __pyx_v_tr.shape[0];
-                        if (unlikely(__pyx_t_62 < 0)) __pyx_t_57 = 0;
-                      } else if (unlikely(__pyx_t_62 >= __pyx_v_tr.shape[0])) __pyx_t_57 = 0;
-                      if (__pyx_t_63 < 0) {
-                        __pyx_t_63 += __pyx_v_tr.shape[1];
-                        if (unlikely(__pyx_t_63 < 0)) __pyx_t_57 = 1;
-                      } else if (unlikely(__pyx_t_63 >= __pyx_v_tr.shape[1])) __pyx_t_57 = 1;
-                      if (__pyx_t_64 < 0) {
-                        __pyx_t_64 += __pyx_v_tr.shape[2];
-                        if (unlikely(__pyx_t_64 < 0)) __pyx_t_57 = 2;
-                      } else if (unlikely(__pyx_t_64 >= __pyx_v_tr.shape[2])) __pyx_t_57 = 2;
-                      if (__pyx_t_65 < 0) {
-                        __pyx_t_65 += __pyx_v_tr.shape[3];
-                        if (unlikely(__pyx_t_65 < 0)) __pyx_t_57 = 3;
-                      } else if (unlikely(__pyx_t_65 >= __pyx_v_tr.shape[3])) __pyx_t_57 = 3;
-                      if (unlikely(__pyx_t_57 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_57);
-                        __PYX_ERR(0, 861, __pyx_L1_error)
+                      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_l); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
+                      __pyx_t_31 = __pyx_v_j;
+                      __pyx_t_30 = __pyx_v_k;
+                      __pyx_t_28 = __pyx_v_m;
+                      __pyx_t_27 = __pyx_t_11;
+                      __pyx_t_44 = -1;
+                      if (__pyx_t_31 < 0) {
+                        __pyx_t_31 += __pyx_v_tr.shape[0];
+                        if (unlikely(__pyx_t_31 < 0)) __pyx_t_44 = 0;
+                      } else if (unlikely(__pyx_t_31 >= __pyx_v_tr.shape[0])) __pyx_t_44 = 0;
+                      if (__pyx_t_30 < 0) {
+                        __pyx_t_30 += __pyx_v_tr.shape[1];
+                        if (unlikely(__pyx_t_30 < 0)) __pyx_t_44 = 1;
+                      } else if (unlikely(__pyx_t_30 >= __pyx_v_tr.shape[1])) __pyx_t_44 = 1;
+                      if (__pyx_t_28 < 0) {
+                        __pyx_t_28 += __pyx_v_tr.shape[2];
+                        if (unlikely(__pyx_t_28 < 0)) __pyx_t_44 = 2;
+                      } else if (unlikely(__pyx_t_28 >= __pyx_v_tr.shape[2])) __pyx_t_44 = 2;
+                      if (__pyx_t_27 < 0) {
+                        __pyx_t_27 += __pyx_v_tr.shape[3];
+                        if (unlikely(__pyx_t_27 < 0)) __pyx_t_44 = 3;
+                      } else if (unlikely(__pyx_t_27 >= __pyx_v_tr.shape[3])) __pyx_t_44 = 3;
+                      if (unlikely(__pyx_t_44 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_44);
+                        __PYX_ERR(0, 863, __pyx_L1_error)
                       }
-                      __pyx_t_66 = (__pyx_v_t - 1);
-                      __pyx_t_67 = ((__pyx_v_i + __pyx_v_j) - 1);
-                      __pyx_t_57 = -1;
-                      if (__pyx_t_66 < 0) {
-                        __pyx_t_66 += __pyx_v_val.shape[0];
-                        if (unlikely(__pyx_t_66 < 0)) __pyx_t_57 = 0;
-                      } else if (unlikely(__pyx_t_66 >= __pyx_v_val.shape[0])) __pyx_t_57 = 0;
-                      if (__pyx_t_67 < 0) {
-                        __pyx_t_67 += __pyx_v_val.shape[1];
-                        if (unlikely(__pyx_t_67 < 0)) __pyx_t_57 = 1;
-                      } else if (unlikely(__pyx_t_67 >= __pyx_v_val.shape[1])) __pyx_t_57 = 1;
-                      if (unlikely(__pyx_t_57 != -1)) {
-                        __Pyx_RaiseBufferIndexError(__pyx_t_57);
-                        __PYX_ERR(0, 861, __pyx_L1_error)
+                      __pyx_t_45 = (__pyx_v_t - 1);
+                      __pyx_t_46 = ((__pyx_v_i + __pyx_v_j) - 1);
+                      __pyx_t_44 = -1;
+                      if (__pyx_t_45 < 0) {
+                        __pyx_t_45 += __pyx_v_val.shape[0];
+                        if (unlikely(__pyx_t_45 < 0)) __pyx_t_44 = 0;
+                      } else if (unlikely(__pyx_t_45 >= __pyx_v_val.shape[0])) __pyx_t_44 = 0;
+                      if (__pyx_t_46 < 0) {
+                        __pyx_t_46 += __pyx_v_val.shape[1];
+                        if (unlikely(__pyx_t_46 < 0)) __pyx_t_44 = 1;
+                      } else if (unlikely(__pyx_t_46 >= __pyx_v_val.shape[1])) __pyx_t_44 = 1;
+                      if (unlikely(__pyx_t_44 != -1)) {
+                        __Pyx_RaiseBufferIndexError(__pyx_t_44);
+                        __PYX_ERR(0, 863, __pyx_L1_error)
                       }
-                      __pyx_v_value = (((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1.data + __pyx_t_55 * __pyx_v_obs1.strides[0]) ) + __pyx_t_56 * __pyx_v_obs1.strides[1]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs2.data + __pyx_t_58 * __pyx_v_obs2.strides[0]) ) + __pyx_t_59 * __pyx_v_obs2.strides[1]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs3.data + __pyx_t_60 * __pyx_v_obs3.strides[0]) ) + __pyx_t_61 * __pyx_v_obs3.strides[1]) )))) + (*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_62 * __pyx_v_tr.strides[0]) ) + __pyx_t_63 * __pyx_v_tr.strides[1]) ) + __pyx_t_64 * __pyx_v_tr.strides[2]) ) + __pyx_t_65 * __pyx_v_tr.strides[3]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_66 * __pyx_v_val.strides[0]) ) + __pyx_t_67 * __pyx_v_val.strides[1]) ))));
+                      __pyx_v_value = (((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1.data + __pyx_t_37 * __pyx_v_obs1.strides[0]) ) + __pyx_t_38 * __pyx_v_obs1.strides[1]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs2.data + __pyx_t_36 * __pyx_v_obs2.strides[0]) ) + __pyx_t_35 * __pyx_v_obs2.strides[1]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs3.data + __pyx_t_33 * __pyx_v_obs3.strides[0]) ) + __pyx_t_32 * __pyx_v_obs3.strides[1]) )))) + (*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tr.data + __pyx_t_31 * __pyx_v_tr.strides[0]) ) + __pyx_t_30 * __pyx_v_tr.strides[1]) ) + __pyx_t_28 * __pyx_v_tr.strides[2]) ) + __pyx_t_27 * __pyx_v_tr.strides[3]) )))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_45 * __pyx_v_val.strides[0]) ) + __pyx_t_46 * __pyx_v_val.strides[1]) ))));
 
-                      /* "soapcw/soapcw.pyx":862
+                      /* "soapcw/soapcw.pyx":864
  *                                              if i+l-1>=0 and i+l-1<width:
  *                                                  value = obs1[t][i+k-1] + obs2[t][i+m-1] + obs3[t][i+l-1] + tr[j][k][m][l] + val[t-1][i+j-1]
  *                                                  if value > temp:             # <<<<<<<<<<<<<<
  *                                                      temp = value
  *                                                      val[t][i] = temp
  */
                       __pyx_t_21 = ((__pyx_v_value > __pyx_v_temp) != 0);
                       if (__pyx_t_21) {
 
-                        /* "soapcw/soapcw.pyx":863
+                        /* "soapcw/soapcw.pyx":865
  *                                                  value = obs1[t][i+k-1] + obs2[t][i+m-1] + obs3[t][i+l-1] + tr[j][k][m][l] + val[t-1][i+j-1]
  *                                                  if value > temp:
  *                                                      temp = value             # <<<<<<<<<<<<<<
  *                                                      val[t][i] = temp
  *                                                      prev[t][i] =  i+j-1
  */
                         __pyx_v_temp = __pyx_v_value;
 
-                        /* "soapcw/soapcw.pyx":864
+                        /* "soapcw/soapcw.pyx":866
  *                                                  if value > temp:
  *                                                      temp = value
  *                                                      val[t][i] = temp             # <<<<<<<<<<<<<<
  *                                                      prev[t][i] =  i+j-1
  *                                                      det1[t][i] =  i+k-1
  */
-                        __pyx_t_68 = __pyx_v_t;
-                        __pyx_t_69 = __pyx_v_i;
-                        __pyx_t_57 = -1;
-                        if (__pyx_t_68 < 0) {
-                          __pyx_t_68 += __pyx_v_val.shape[0];
-                          if (unlikely(__pyx_t_68 < 0)) __pyx_t_57 = 0;
-                        } else if (unlikely(__pyx_t_68 >= __pyx_v_val.shape[0])) __pyx_t_57 = 0;
-                        if (__pyx_t_69 < 0) {
-                          __pyx_t_69 += __pyx_v_val.shape[1];
-                          if (unlikely(__pyx_t_69 < 0)) __pyx_t_57 = 1;
-                        } else if (unlikely(__pyx_t_69 >= __pyx_v_val.shape[1])) __pyx_t_57 = 1;
-                        if (unlikely(__pyx_t_57 != -1)) {
-                          __Pyx_RaiseBufferIndexError(__pyx_t_57);
-                          __PYX_ERR(0, 864, __pyx_L1_error)
+                        __pyx_t_46 = __pyx_v_t;
+                        __pyx_t_45 = __pyx_v_i;
+                        __pyx_t_44 = -1;
+                        if (__pyx_t_46 < 0) {
+                          __pyx_t_46 += __pyx_v_val.shape[0];
+                          if (unlikely(__pyx_t_46 < 0)) __pyx_t_44 = 0;
+                        } else if (unlikely(__pyx_t_46 >= __pyx_v_val.shape[0])) __pyx_t_44 = 0;
+                        if (__pyx_t_45 < 0) {
+                          __pyx_t_45 += __pyx_v_val.shape[1];
+                          if (unlikely(__pyx_t_45 < 0)) __pyx_t_44 = 1;
+                        } else if (unlikely(__pyx_t_45 >= __pyx_v_val.shape[1])) __pyx_t_44 = 1;
+                        if (unlikely(__pyx_t_44 != -1)) {
+                          __Pyx_RaiseBufferIndexError(__pyx_t_44);
+                          __PYX_ERR(0, 866, __pyx_L1_error)
                         }
-                        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_68 * __pyx_v_val.strides[0]) ) + __pyx_t_69 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
+                        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_46 * __pyx_v_val.strides[0]) ) + __pyx_t_45 * __pyx_v_val.strides[1]) )) = __pyx_v_temp;
 
-                        /* "soapcw/soapcw.pyx":865
+                        /* "soapcw/soapcw.pyx":867
  *                                                      temp = value
  *                                                      val[t][i] = temp
  *                                                      prev[t][i] =  i+j-1             # <<<<<<<<<<<<<<
  *                                                      det1[t][i] =  i+k-1
  *                                                      det2[t][i] =  i+m-1
  */
-                        __pyx_t_70 = __pyx_v_t;
-                        __pyx_t_71 = __pyx_v_i;
-                        __pyx_t_57 = -1;
-                        if (__pyx_t_70 < 0) {
-                          __pyx_t_70 += __pyx_v_prev.shape[0];
-                          if (unlikely(__pyx_t_70 < 0)) __pyx_t_57 = 0;
-                        } else if (unlikely(__pyx_t_70 >= __pyx_v_prev.shape[0])) __pyx_t_57 = 0;
-                        if (__pyx_t_71 < 0) {
-                          __pyx_t_71 += __pyx_v_prev.shape[1];
-                          if (unlikely(__pyx_t_71 < 0)) __pyx_t_57 = 1;
-                        } else if (unlikely(__pyx_t_71 >= __pyx_v_prev.shape[1])) __pyx_t_57 = 1;
-                        if (unlikely(__pyx_t_57 != -1)) {
-                          __Pyx_RaiseBufferIndexError(__pyx_t_57);
-                          __PYX_ERR(0, 865, __pyx_L1_error)
+                        __pyx_t_45 = __pyx_v_t;
+                        __pyx_t_46 = __pyx_v_i;
+                        __pyx_t_44 = -1;
+                        if (__pyx_t_45 < 0) {
+                          __pyx_t_45 += __pyx_v_prev.shape[0];
+                          if (unlikely(__pyx_t_45 < 0)) __pyx_t_44 = 0;
+                        } else if (unlikely(__pyx_t_45 >= __pyx_v_prev.shape[0])) __pyx_t_44 = 0;
+                        if (__pyx_t_46 < 0) {
+                          __pyx_t_46 += __pyx_v_prev.shape[1];
+                          if (unlikely(__pyx_t_46 < 0)) __pyx_t_44 = 1;
+                        } else if (unlikely(__pyx_t_46 >= __pyx_v_prev.shape[1])) __pyx_t_44 = 1;
+                        if (unlikely(__pyx_t_44 != -1)) {
+                          __Pyx_RaiseBufferIndexError(__pyx_t_44);
+                          __PYX_ERR(0, 867, __pyx_L1_error)
                         }
-                        *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_70 * __pyx_v_prev.strides[0]) ) + __pyx_t_71 * __pyx_v_prev.strides[1]) )) = ((__pyx_v_i + __pyx_v_j) - 1);
+                        *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_45 * __pyx_v_prev.strides[0]) ) + __pyx_t_46 * __pyx_v_prev.strides[1]) )) = ((__pyx_v_i + __pyx_v_j) - 1);
 
-                        /* "soapcw/soapcw.pyx":866
+                        /* "soapcw/soapcw.pyx":868
  *                                                      val[t][i] = temp
  *                                                      prev[t][i] =  i+j-1
  *                                                      det1[t][i] =  i+k-1             # <<<<<<<<<<<<<<
  *                                                      det2[t][i] =  i+m-1
  *                                                      det3[0][i] =  i+l-1
  */
-                        __pyx_t_72 = __pyx_v_t;
-                        __pyx_t_73 = __pyx_v_i;
-                        __pyx_t_57 = -1;
-                        if (__pyx_t_72 < 0) {
-                          __pyx_t_72 += __pyx_v_det1.shape[0];
-                          if (unlikely(__pyx_t_72 < 0)) __pyx_t_57 = 0;
-                        } else if (unlikely(__pyx_t_72 >= __pyx_v_det1.shape[0])) __pyx_t_57 = 0;
-                        if (__pyx_t_73 < 0) {
-                          __pyx_t_73 += __pyx_v_det1.shape[1];
-                          if (unlikely(__pyx_t_73 < 0)) __pyx_t_57 = 1;
-                        } else if (unlikely(__pyx_t_73 >= __pyx_v_det1.shape[1])) __pyx_t_57 = 1;
-                        if (unlikely(__pyx_t_57 != -1)) {
-                          __Pyx_RaiseBufferIndexError(__pyx_t_57);
-                          __PYX_ERR(0, 866, __pyx_L1_error)
+                        __pyx_t_46 = __pyx_v_t;
+                        __pyx_t_45 = __pyx_v_i;
+                        __pyx_t_44 = -1;
+                        if (__pyx_t_46 < 0) {
+                          __pyx_t_46 += __pyx_v_det1.shape[0];
+                          if (unlikely(__pyx_t_46 < 0)) __pyx_t_44 = 0;
+                        } else if (unlikely(__pyx_t_46 >= __pyx_v_det1.shape[0])) __pyx_t_44 = 0;
+                        if (__pyx_t_45 < 0) {
+                          __pyx_t_45 += __pyx_v_det1.shape[1];
+                          if (unlikely(__pyx_t_45 < 0)) __pyx_t_44 = 1;
+                        } else if (unlikely(__pyx_t_45 >= __pyx_v_det1.shape[1])) __pyx_t_44 = 1;
+                        if (unlikely(__pyx_t_44 != -1)) {
+                          __Pyx_RaiseBufferIndexError(__pyx_t_44);
+                          __PYX_ERR(0, 868, __pyx_L1_error)
                         }
-                        *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_72 * __pyx_v_det1.strides[0]) ) + __pyx_t_73 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - 1);
+                        *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_46 * __pyx_v_det1.strides[0]) ) + __pyx_t_45 * __pyx_v_det1.strides[1]) )) = ((__pyx_v_i + __pyx_v_k) - 1);
 
-                        /* "soapcw/soapcw.pyx":867
+                        /* "soapcw/soapcw.pyx":869
  *                                                      prev[t][i] =  i+j-1
  *                                                      det1[t][i] =  i+k-1
  *                                                      det2[t][i] =  i+m-1             # <<<<<<<<<<<<<<
  *                                                      det3[0][i] =  i+l-1
  *                                                  else:
  */
-                        __pyx_t_74 = __pyx_v_t;
-                        __pyx_t_75 = __pyx_v_i;
-                        __pyx_t_57 = -1;
-                        if (__pyx_t_74 < 0) {
-                          __pyx_t_74 += __pyx_v_det2.shape[0];
-                          if (unlikely(__pyx_t_74 < 0)) __pyx_t_57 = 0;
-                        } else if (unlikely(__pyx_t_74 >= __pyx_v_det2.shape[0])) __pyx_t_57 = 0;
-                        if (__pyx_t_75 < 0) {
-                          __pyx_t_75 += __pyx_v_det2.shape[1];
-                          if (unlikely(__pyx_t_75 < 0)) __pyx_t_57 = 1;
-                        } else if (unlikely(__pyx_t_75 >= __pyx_v_det2.shape[1])) __pyx_t_57 = 1;
-                        if (unlikely(__pyx_t_57 != -1)) {
-                          __Pyx_RaiseBufferIndexError(__pyx_t_57);
-                          __PYX_ERR(0, 867, __pyx_L1_error)
+                        __pyx_t_45 = __pyx_v_t;
+                        __pyx_t_46 = __pyx_v_i;
+                        __pyx_t_44 = -1;
+                        if (__pyx_t_45 < 0) {
+                          __pyx_t_45 += __pyx_v_det2.shape[0];
+                          if (unlikely(__pyx_t_45 < 0)) __pyx_t_44 = 0;
+                        } else if (unlikely(__pyx_t_45 >= __pyx_v_det2.shape[0])) __pyx_t_44 = 0;
+                        if (__pyx_t_46 < 0) {
+                          __pyx_t_46 += __pyx_v_det2.shape[1];
+                          if (unlikely(__pyx_t_46 < 0)) __pyx_t_44 = 1;
+                        } else if (unlikely(__pyx_t_46 >= __pyx_v_det2.shape[1])) __pyx_t_44 = 1;
+                        if (unlikely(__pyx_t_44 != -1)) {
+                          __Pyx_RaiseBufferIndexError(__pyx_t_44);
+                          __PYX_ERR(0, 869, __pyx_L1_error)
                         }
-                        *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_74 * __pyx_v_det2.strides[0]) ) + __pyx_t_75 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - 1);
+                        *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_45 * __pyx_v_det2.strides[0]) ) + __pyx_t_46 * __pyx_v_det2.strides[1]) )) = ((__pyx_v_i + __pyx_v_m) - 1);
 
-                        /* "soapcw/soapcw.pyx":868
+                        /* "soapcw/soapcw.pyx":870
  *                                                      det1[t][i] =  i+k-1
  *                                                      det2[t][i] =  i+m-1
  *                                                      det3[0][i] =  i+l-1             # <<<<<<<<<<<<<<
  *                                                  else:
  *                                                      continue
  */
-                        __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
+                        __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 870, __pyx_L1_error)
                         __Pyx_GOTREF(__pyx_t_3);
-                        __pyx_t_13 = PyNumber_Add(__pyx_t_3, __pyx_v_l); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 868, __pyx_L1_error)
+                        __pyx_t_13 = PyNumber_Add(__pyx_t_3, __pyx_v_l); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 870, __pyx_L1_error)
                         __Pyx_GOTREF(__pyx_t_13);
                         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                        __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_13, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
+                        __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_13, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 870, __pyx_L1_error)
                         __Pyx_GOTREF(__pyx_t_3);
                         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                        __pyx_t_47 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_47 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 868, __pyx_L1_error)
+                        __pyx_t_44 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_44 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 870, __pyx_L1_error)
                         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                        __pyx_t_76 = 0;
-                        __pyx_t_77 = __pyx_v_i;
-                        __pyx_t_57 = -1;
-                        if (__pyx_t_76 < 0) {
-                          __pyx_t_76 += __pyx_v_det3.shape[0];
-                          if (unlikely(__pyx_t_76 < 0)) __pyx_t_57 = 0;
-                        } else if (unlikely(__pyx_t_76 >= __pyx_v_det3.shape[0])) __pyx_t_57 = 0;
-                        if (__pyx_t_77 < 0) {
-                          __pyx_t_77 += __pyx_v_det3.shape[1];
-                          if (unlikely(__pyx_t_77 < 0)) __pyx_t_57 = 1;
-                        } else if (unlikely(__pyx_t_77 >= __pyx_v_det3.shape[1])) __pyx_t_57 = 1;
-                        if (unlikely(__pyx_t_57 != -1)) {
-                          __Pyx_RaiseBufferIndexError(__pyx_t_57);
-                          __PYX_ERR(0, 868, __pyx_L1_error)
+                        __pyx_t_46 = 0;
+                        __pyx_t_45 = __pyx_v_i;
+                        __pyx_t_47 = -1;
+                        if (__pyx_t_46 < 0) {
+                          __pyx_t_46 += __pyx_v_det3.shape[0];
+                          if (unlikely(__pyx_t_46 < 0)) __pyx_t_47 = 0;
+                        } else if (unlikely(__pyx_t_46 >= __pyx_v_det3.shape[0])) __pyx_t_47 = 0;
+                        if (__pyx_t_45 < 0) {
+                          __pyx_t_45 += __pyx_v_det3.shape[1];
+                          if (unlikely(__pyx_t_45 < 0)) __pyx_t_47 = 1;
+                        } else if (unlikely(__pyx_t_45 >= __pyx_v_det3.shape[1])) __pyx_t_47 = 1;
+                        if (unlikely(__pyx_t_47 != -1)) {
+                          __Pyx_RaiseBufferIndexError(__pyx_t_47);
+                          __PYX_ERR(0, 870, __pyx_L1_error)
                         }
-                        *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det3.data + __pyx_t_76 * __pyx_v_det3.strides[0]) ) + __pyx_t_77 * __pyx_v_det3.strides[1]) )) = __pyx_t_47;
+                        *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det3.data + __pyx_t_46 * __pyx_v_det3.strides[0]) ) + __pyx_t_45 * __pyx_v_det3.strides[1]) )) = __pyx_t_44;
 
-                        /* "soapcw/soapcw.pyx":862
+                        /* "soapcw/soapcw.pyx":864
  *                                              if i+l-1>=0 and i+l-1<width:
  *                                                  value = obs1[t][i+k-1] + obs2[t][i+m-1] + obs3[t][i+l-1] + tr[j][k][m][l] + val[t-1][i+j-1]
  *                                                  if value > temp:             # <<<<<<<<<<<<<<
  *                                                      temp = value
  *                                                      val[t][i] = temp
  */
                         goto __pyx_L45;
                       }
 
-                      /* "soapcw/soapcw.pyx":870
+                      /* "soapcw/soapcw.pyx":872
  *                                                      det3[0][i] =  i+l-1
  *                                                  else:
  *                                                      continue             # <<<<<<<<<<<<<<
  * 
  *             if self.prog == True:
  */
                       /*else*/ {
                         goto __pyx_L40_continue;
                       }
                       __pyx_L45:;
 
-                      /* "soapcw/soapcw.pyx":860
+                      /* "soapcw/soapcw.pyx":862
  *                                      if i+m-1>=0 and i+m-1<width:
  *                                          for l in range(tr_len):
  *                                              if i+l-1>=0 and i+l-1<width:             # <<<<<<<<<<<<<<
  *                                                  value = obs1[t][i+k-1] + obs2[t][i+m-1] + obs3[t][i+l-1] + tr[j][k][m][l] + val[t-1][i+j-1]
  *                                                  if value > temp:
  */
                     }
 
-                    /* "soapcw/soapcw.pyx":859
+                    /* "soapcw/soapcw.pyx":861
  *                                 for m in range(tr_len):
  *                                      if i+m-1>=0 and i+m-1<width:
  *                                          for l in range(tr_len):             # <<<<<<<<<<<<<<
  *                                              if i+l-1>=0 and i+l-1<width:
  *                                                  value = obs1[t][i+k-1] + obs2[t][i+m-1] + obs3[t][i+l-1] + tr[j][k][m][l] + val[t-1][i+j-1]
  */
                     __pyx_L40_continue:;
                   }
                   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-                  /* "soapcw/soapcw.pyx":858
+                  /* "soapcw/soapcw.pyx":860
  *                             if i+k-1>=0 and i+k-1<width:
  *                                 for m in range(tr_len):
  *                                      if i+m-1>=0 and i+m-1<width:             # <<<<<<<<<<<<<<
  *                                          for l in range(tr_len):
  *                                              if i+l-1>=0 and i+l-1<width:
  */
                 }
               }
 
-              /* "soapcw/soapcw.pyx":856
+              /* "soapcw/soapcw.pyx":858
  *                     if i+j-1>=0 and i+j-1<width:
  *                        for k in range(tr_len):
  *                             if i+k-1>=0 and i+k-1<width:             # <<<<<<<<<<<<<<
  *                                 for m in range(tr_len):
  *                                      if i+m-1>=0 and i+m-1<width:
  */
             }
           }
 
-          /* "soapcw/soapcw.pyx":854
+          /* "soapcw/soapcw.pyx":856
  *                 temp = -1e6
  *                 for j in range(tr_len):
  *                     if i+j-1>=0 and i+j-1<width:             # <<<<<<<<<<<<<<
  *                        for k in range(tr_len):
  *                             if i+k-1>=0 and i+k-1<width:
  */
         }
       }
     }
 
-    /* "soapcw/soapcw.pyx":872
+    /* "soapcw/soapcw.pyx":874
  *                                                      continue
  * 
  *             if self.prog == True:             # <<<<<<<<<<<<<<
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prog); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prog); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 874, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 874, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 874, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_21) {
 
-      /* "soapcw/soapcw.pyx":873
+      /* "soapcw/soapcw.pyx":875
  * 
  *             if self.prog == True:
  *                 if pt>pbar:             # <<<<<<<<<<<<<<
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  */
-      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)
+      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_t_3, __pyx_v_pbar, Py_GT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 873, __pyx_L1_error)
+      __pyx_t_5 = PyObject_RichCompare(__pyx_t_3, __pyx_v_pbar, Py_GT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 873, __pyx_L1_error)
+      __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 875, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_21) {
 
-        /* "soapcw/soapcw.pyx":874
+        /* "soapcw/soapcw.pyx":876
  *             if self.prog == True:
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))             # <<<<<<<<<<<<<<
  *                     stdout.flush()
  *                     pbar+=100./length
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_stdout); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_stdout); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_write); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_write); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 876, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_13);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u__4, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u__4, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 876, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_4 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __pyx_t_4 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 876, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_78 = __Pyx_PyObject_CallOneArg(__pyx_builtin_round, __pyx_t_4); if (unlikely(!__pyx_t_78)) __PYX_ERR(0, 874, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_78);
+        __pyx_t_48 = __Pyx_PyObject_CallOneArg(__pyx_builtin_round, __pyx_t_4); if (unlikely(!__pyx_t_48)) __PYX_ERR(0, 876, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_48);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
           if (likely(__pyx_t_4)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_6, function);
           }
         }
-        __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_4, __pyx_t_78) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_78);
+        __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_4, __pyx_t_48) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_48);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __Pyx_DECREF(__pyx_t_78); __pyx_t_78 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_48); __pyx_t_48 = 0;
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_t_6 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
           __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_13);
           if (likely(__pyx_t_6)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
@@ -18286,979 +18433,979 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_13, function);
           }
         }
         __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_3);
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 874, __pyx_L1_error)
+        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 876, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "soapcw/soapcw.pyx":875
+        /* "soapcw/soapcw.pyx":877
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()             # <<<<<<<<<<<<<<
  *                     pbar+=100./length
  * 
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_stdout); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 875, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_stdout); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 877, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_13);
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_flush); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_flush); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 877, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         __pyx_t_13 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_13)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
             __Pyx_INCREF(__pyx_t_13);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_5 = (__pyx_t_13) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_13) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
         __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
+        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 877, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "soapcw/soapcw.pyx":876
+        /* "soapcw/soapcw.pyx":878
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  *                     pbar+=100./length             # <<<<<<<<<<<<<<
  * 
  * 
  */
         if (unlikely(__pyx_v_length == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-          __PYX_ERR(0, 876, __pyx_L1_error)
+          __PYX_ERR(0, 878, __pyx_L1_error)
         }
-        __pyx_t_5 = PyFloat_FromDouble((100. / ((double)__pyx_v_length))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 876, __pyx_L1_error)
+        __pyx_t_5 = PyFloat_FromDouble((100. / ((double)__pyx_v_length))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 878, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_pbar, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L1_error)
+        __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_pbar, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 878, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_DECREF_SET(__pyx_v_pbar, __pyx_t_3);
         __pyx_t_3 = 0;
 
-        /* "soapcw/soapcw.pyx":873
+        /* "soapcw/soapcw.pyx":875
  * 
  *             if self.prog == True:
  *                 if pt>pbar:             # <<<<<<<<<<<<<<
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  */
       }
 
-      /* "soapcw/soapcw.pyx":872
+      /* "soapcw/soapcw.pyx":874
  *                                                      continue
  * 
  *             if self.prog == True:             # <<<<<<<<<<<<<<
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  */
     }
   }
 
-  /* "soapcw/soapcw.pyx":880
+  /* "soapcw/soapcw.pyx":882
  * 
  * 
  *         cdef long previous = 1             # <<<<<<<<<<<<<<
  *         cdef long[:] vit_trackr = np.zeros(length).astype(int)
  *         cdef long[:] vit_track1 = np.zeros(length).astype(int)
  */
   __pyx_v_previous = 1;
 
-  /* "soapcw/soapcw.pyx":881
+  /* "soapcw/soapcw.pyx":883
  * 
  *         cdef long previous = 1
  *         cdef long[:] vit_trackr = np.zeros(length).astype(int)             # <<<<<<<<<<<<<<
  *         cdef long[:] vit_track1 = np.zeros(length).astype(int)
  *         cdef long[:] vit_track2 = np.zeros(length).astype(int)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 881, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 883, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 881, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 883, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_length); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 881, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_length); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 883, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_78 = NULL;
+  __pyx_t_48 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
-    __pyx_t_78 = PyMethod_GET_SELF(__pyx_t_6);
-    if (likely(__pyx_t_78)) {
+    __pyx_t_48 = PyMethod_GET_SELF(__pyx_t_6);
+    if (likely(__pyx_t_48)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
-      __Pyx_INCREF(__pyx_t_78);
+      __Pyx_INCREF(__pyx_t_48);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
-  __pyx_t_5 = (__pyx_t_78) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_78, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_13);
-  __Pyx_XDECREF(__pyx_t_78); __pyx_t_78 = 0;
+  __pyx_t_5 = (__pyx_t_48) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_48, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_48); __pyx_t_48 = 0;
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 881, __pyx_L1_error)
+  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 883, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 881, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 883, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_6, ((PyObject *)(&PyInt_Type)));
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 881, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 883, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_79 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_79.memview)) __PYX_ERR(0, 881, __pyx_L1_error)
+  __pyx_t_49 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_49.memview)) __PYX_ERR(0, 883, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_vit_trackr = __pyx_t_79;
-  __pyx_t_79.memview = NULL;
-  __pyx_t_79.data = NULL;
+  __pyx_v_vit_trackr = __pyx_t_49;
+  __pyx_t_49.memview = NULL;
+  __pyx_t_49.data = NULL;
 
-  /* "soapcw/soapcw.pyx":882
+  /* "soapcw/soapcw.pyx":884
  *         cdef long previous = 1
  *         cdef long[:] vit_trackr = np.zeros(length).astype(int)
  *         cdef long[:] vit_track1 = np.zeros(length).astype(int)             # <<<<<<<<<<<<<<
  *         cdef long[:] vit_track2 = np.zeros(length).astype(int)
  *         cdef long[:] vit_track3 = np.zeros(length).astype(int)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 882, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 884, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 882, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 884, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_length); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 882, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_length); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 884, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_78 = NULL;
+  __pyx_t_48 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
-    __pyx_t_78 = PyMethod_GET_SELF(__pyx_t_13);
-    if (likely(__pyx_t_78)) {
+    __pyx_t_48 = PyMethod_GET_SELF(__pyx_t_13);
+    if (likely(__pyx_t_48)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-      __Pyx_INCREF(__pyx_t_78);
+      __Pyx_INCREF(__pyx_t_48);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_13, function);
     }
   }
-  __pyx_t_6 = (__pyx_t_78) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_78, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_78); __pyx_t_78 = 0;
+  __pyx_t_6 = (__pyx_t_48) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_48, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_48); __pyx_t_48 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 882, __pyx_L1_error)
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 884, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_astype); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 882, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_astype); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 884, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_13);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_13, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_6, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_13, ((PyObject *)(&PyInt_Type)));
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 882, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 884, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_79 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_79.memview)) __PYX_ERR(0, 882, __pyx_L1_error)
+  __pyx_t_49 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_49.memview)) __PYX_ERR(0, 884, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_vit_track1 = __pyx_t_79;
-  __pyx_t_79.memview = NULL;
-  __pyx_t_79.data = NULL;
+  __pyx_v_vit_track1 = __pyx_t_49;
+  __pyx_t_49.memview = NULL;
+  __pyx_t_49.data = NULL;
 
-  /* "soapcw/soapcw.pyx":883
+  /* "soapcw/soapcw.pyx":885
  *         cdef long[:] vit_trackr = np.zeros(length).astype(int)
  *         cdef long[:] vit_track1 = np.zeros(length).astype(int)
  *         cdef long[:] vit_track2 = np.zeros(length).astype(int)             # <<<<<<<<<<<<<<
  *         cdef long[:] vit_track3 = np.zeros(length).astype(int)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 883, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 885, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 883, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 885, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 883, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 885, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_78 = NULL;
+  __pyx_t_48 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
-    __pyx_t_78 = PyMethod_GET_SELF(__pyx_t_5);
-    if (likely(__pyx_t_78)) {
+    __pyx_t_48 = PyMethod_GET_SELF(__pyx_t_5);
+    if (likely(__pyx_t_48)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
-      __Pyx_INCREF(__pyx_t_78);
+      __Pyx_INCREF(__pyx_t_48);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
-  __pyx_t_13 = (__pyx_t_78) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_78, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_78); __pyx_t_78 = 0;
+  __pyx_t_13 = (__pyx_t_48) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_48, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_48); __pyx_t_48 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 883, __pyx_L1_error)
+  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 885, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 883, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 885, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   __pyx_t_13 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_13)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_13);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_13, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_5, ((PyObject *)(&PyInt_Type)));
   __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 883, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 885, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_79 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_79.memview)) __PYX_ERR(0, 883, __pyx_L1_error)
+  __pyx_t_49 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_49.memview)) __PYX_ERR(0, 885, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_vit_track2 = __pyx_t_79;
-  __pyx_t_79.memview = NULL;
-  __pyx_t_79.data = NULL;
+  __pyx_v_vit_track2 = __pyx_t_49;
+  __pyx_t_49.memview = NULL;
+  __pyx_t_49.data = NULL;
 
-  /* "soapcw/soapcw.pyx":884
+  /* "soapcw/soapcw.pyx":886
  *         cdef long[:] vit_track1 = np.zeros(length).astype(int)
  *         cdef long[:] vit_track2 = np.zeros(length).astype(int)
  *         cdef long[:] vit_track3 = np.zeros(length).astype(int)             # <<<<<<<<<<<<<<
  * 
  *         cdef float max_prob = np.array([val[length-1][i] for i in range(width)]).max()
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 884, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 884, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_length); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 884, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_From_int(__pyx_v_length); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_78 = NULL;
+  __pyx_t_48 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
-    __pyx_t_78 = PyMethod_GET_SELF(__pyx_t_6);
-    if (likely(__pyx_t_78)) {
+    __pyx_t_48 = PyMethod_GET_SELF(__pyx_t_6);
+    if (likely(__pyx_t_48)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
-      __Pyx_INCREF(__pyx_t_78);
+      __Pyx_INCREF(__pyx_t_48);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
-  __pyx_t_5 = (__pyx_t_78) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_78, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_13);
-  __Pyx_XDECREF(__pyx_t_78); __pyx_t_78 = 0;
+  __pyx_t_5 = (__pyx_t_48) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_48, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_48); __pyx_t_48 = 0;
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 884, __pyx_L1_error)
+  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 884, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_6, ((PyObject *)(&PyInt_Type)));
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 884, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_79 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_79.memview)) __PYX_ERR(0, 884, __pyx_L1_error)
+  __pyx_t_49 = __Pyx_PyObject_to_MemoryviewSlice_ds_long(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_49.memview)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_vit_track3 = __pyx_t_79;
-  __pyx_t_79.memview = NULL;
-  __pyx_t_79.data = NULL;
+  __pyx_v_vit_track3 = __pyx_t_49;
+  __pyx_t_49.memview = NULL;
+  __pyx_t_49.data = NULL;
 
-  /* "soapcw/soapcw.pyx":886
+  /* "soapcw/soapcw.pyx":888
  *         cdef long[:] vit_track3 = np.zeros(length).astype(int)
  * 
  *         cdef float max_prob = np.array([val[length-1][i] for i in range(width)]).max()             # <<<<<<<<<<<<<<
  *         cdef long max_prob_index = np.array([val[length-1][i] for i in range(width)]).argmax()
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 886, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 888, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 886, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 888, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   { /* enter inner scope */
-    __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 886, __pyx_L1_error)
+    __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 888, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_15 = __pyx_v_width;
     __pyx_t_16 = __pyx_t_15;
     for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
       __pyx_8genexpr7__pyx_v_i = __pyx_t_17;
-      __pyx_t_80 = (__pyx_v_length - 1);
-      __pyx_t_81 = __pyx_8genexpr7__pyx_v_i;
+      __pyx_t_45 = (__pyx_v_length - 1);
+      __pyx_t_46 = __pyx_8genexpr7__pyx_v_i;
       __pyx_t_18 = -1;
-      if (__pyx_t_80 < 0) {
-        __pyx_t_80 += __pyx_v_val.shape[0];
-        if (unlikely(__pyx_t_80 < 0)) __pyx_t_18 = 0;
-      } else if (unlikely(__pyx_t_80 >= __pyx_v_val.shape[0])) __pyx_t_18 = 0;
-      if (__pyx_t_81 < 0) {
-        __pyx_t_81 += __pyx_v_val.shape[1];
-        if (unlikely(__pyx_t_81 < 0)) __pyx_t_18 = 1;
-      } else if (unlikely(__pyx_t_81 >= __pyx_v_val.shape[1])) __pyx_t_18 = 1;
+      if (__pyx_t_45 < 0) {
+        __pyx_t_45 += __pyx_v_val.shape[0];
+        if (unlikely(__pyx_t_45 < 0)) __pyx_t_18 = 0;
+      } else if (unlikely(__pyx_t_45 >= __pyx_v_val.shape[0])) __pyx_t_18 = 0;
+      if (__pyx_t_46 < 0) {
+        __pyx_t_46 += __pyx_v_val.shape[1];
+        if (unlikely(__pyx_t_46 < 0)) __pyx_t_18 = 1;
+      } else if (unlikely(__pyx_t_46 >= __pyx_v_val.shape[1])) __pyx_t_18 = 1;
       if (unlikely(__pyx_t_18 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_18);
-        __PYX_ERR(0, 886, __pyx_L1_error)
+        __PYX_ERR(0, 888, __pyx_L1_error)
       }
-      __pyx_t_78 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_80 * __pyx_v_val.strides[0]) ) + __pyx_t_81 * __pyx_v_val.strides[1]) )))); if (unlikely(!__pyx_t_78)) __PYX_ERR(0, 886, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_78);
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_5, (PyObject*)__pyx_t_78))) __PYX_ERR(0, 886, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_78); __pyx_t_78 = 0;
+      __pyx_t_48 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_45 * __pyx_v_val.strides[0]) ) + __pyx_t_46 * __pyx_v_val.strides[1]) )))); if (unlikely(!__pyx_t_48)) __PYX_ERR(0, 888, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_48);
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_5, (PyObject*)__pyx_t_48))) __PYX_ERR(0, 888, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_48); __pyx_t_48 = 0;
     }
   } /* exit inner scope */
-  __pyx_t_78 = NULL;
+  __pyx_t_48 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
-    __pyx_t_78 = PyMethod_GET_SELF(__pyx_t_13);
-    if (likely(__pyx_t_78)) {
+    __pyx_t_48 = PyMethod_GET_SELF(__pyx_t_13);
+    if (likely(__pyx_t_48)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-      __Pyx_INCREF(__pyx_t_78);
+      __Pyx_INCREF(__pyx_t_48);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_13, function);
     }
   }
-  __pyx_t_6 = (__pyx_t_78) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_78, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_78); __pyx_t_78 = 0;
+  __pyx_t_6 = (__pyx_t_48) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_48, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_48); __pyx_t_48 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 886, __pyx_L1_error)
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 888, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_max); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 886, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_max); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 888, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_13);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_13, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_13);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 886, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 888, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_82 = __pyx_PyFloat_AsFloat(__pyx_t_3); if (unlikely((__pyx_t_82 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 886, __pyx_L1_error)
+  __pyx_t_50 = __pyx_PyFloat_AsFloat(__pyx_t_3); if (unlikely((__pyx_t_50 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 888, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_max_prob = __pyx_t_82;
+  __pyx_v_max_prob = __pyx_t_50;
 
-  /* "soapcw/soapcw.pyx":887
+  /* "soapcw/soapcw.pyx":889
  * 
  *         cdef float max_prob = np.array([val[length-1][i] for i in range(width)]).max()
  *         cdef long max_prob_index = np.array([val[length-1][i] for i in range(width)]).argmax()             # <<<<<<<<<<<<<<
  * 
  *         vit_trackr[length-1] = max_prob_index
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 887, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 889, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 887, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 889, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   { /* enter inner scope */
-    __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 887, __pyx_L1_error)
+    __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 889, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_15 = __pyx_v_width;
     __pyx_t_16 = __pyx_t_15;
     for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
       __pyx_8genexpr8__pyx_v_i = __pyx_t_17;
-      __pyx_t_83 = (__pyx_v_length - 1);
-      __pyx_t_84 = __pyx_8genexpr8__pyx_v_i;
+      __pyx_t_46 = (__pyx_v_length - 1);
+      __pyx_t_45 = __pyx_8genexpr8__pyx_v_i;
       __pyx_t_18 = -1;
-      if (__pyx_t_83 < 0) {
-        __pyx_t_83 += __pyx_v_val.shape[0];
-        if (unlikely(__pyx_t_83 < 0)) __pyx_t_18 = 0;
-      } else if (unlikely(__pyx_t_83 >= __pyx_v_val.shape[0])) __pyx_t_18 = 0;
-      if (__pyx_t_84 < 0) {
-        __pyx_t_84 += __pyx_v_val.shape[1];
-        if (unlikely(__pyx_t_84 < 0)) __pyx_t_18 = 1;
-      } else if (unlikely(__pyx_t_84 >= __pyx_v_val.shape[1])) __pyx_t_18 = 1;
+      if (__pyx_t_46 < 0) {
+        __pyx_t_46 += __pyx_v_val.shape[0];
+        if (unlikely(__pyx_t_46 < 0)) __pyx_t_18 = 0;
+      } else if (unlikely(__pyx_t_46 >= __pyx_v_val.shape[0])) __pyx_t_18 = 0;
+      if (__pyx_t_45 < 0) {
+        __pyx_t_45 += __pyx_v_val.shape[1];
+        if (unlikely(__pyx_t_45 < 0)) __pyx_t_18 = 1;
+      } else if (unlikely(__pyx_t_45 >= __pyx_v_val.shape[1])) __pyx_t_18 = 1;
       if (unlikely(__pyx_t_18 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_18);
-        __PYX_ERR(0, 887, __pyx_L1_error)
+        __PYX_ERR(0, 889, __pyx_L1_error)
       }
-      __pyx_t_78 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_83 * __pyx_v_val.strides[0]) ) + __pyx_t_84 * __pyx_v_val.strides[1]) )))); if (unlikely(!__pyx_t_78)) __PYX_ERR(0, 887, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_78);
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_t_78))) __PYX_ERR(0, 887, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_78); __pyx_t_78 = 0;
+      __pyx_t_48 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_val.data + __pyx_t_46 * __pyx_v_val.strides[0]) ) + __pyx_t_45 * __pyx_v_val.strides[1]) )))); if (unlikely(!__pyx_t_48)) __PYX_ERR(0, 889, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_48);
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_t_48))) __PYX_ERR(0, 889, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_48); __pyx_t_48 = 0;
     }
   } /* exit inner scope */
-  __pyx_t_78 = NULL;
+  __pyx_t_48 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
-    __pyx_t_78 = PyMethod_GET_SELF(__pyx_t_5);
-    if (likely(__pyx_t_78)) {
+    __pyx_t_48 = PyMethod_GET_SELF(__pyx_t_5);
+    if (likely(__pyx_t_48)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
-      __Pyx_INCREF(__pyx_t_78);
+      __Pyx_INCREF(__pyx_t_48);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
-  __pyx_t_13 = (__pyx_t_78) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_78, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_78); __pyx_t_78 = 0;
+  __pyx_t_13 = (__pyx_t_48) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_48, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_48); __pyx_t_48 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 887, __pyx_L1_error)
+  if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 889, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_argmax); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 887, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_argmax); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 889, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   __pyx_t_13 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_13)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_13);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_13) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_13) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 887, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 889, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_47 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_47 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 887, __pyx_L1_error)
+  __pyx_t_51 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_51 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 889, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_max_prob_index = __pyx_t_47;
+  __pyx_v_max_prob_index = __pyx_t_51;
 
-  /* "soapcw/soapcw.pyx":889
+  /* "soapcw/soapcw.pyx":891
  *         cdef long max_prob_index = np.array([val[length-1][i] for i in range(width)]).argmax()
  * 
  *         vit_trackr[length-1] = max_prob_index             # <<<<<<<<<<<<<<
  *         vit_track1[length-1] = det1[length-1][max_prob_index]
  *         vit_track2[length-1] = det2[length-1][max_prob_index]
  */
-  __pyx_t_85 = (__pyx_v_length - 1);
+  __pyx_t_45 = (__pyx_v_length - 1);
   __pyx_t_15 = -1;
-  if (__pyx_t_85 < 0) {
-    __pyx_t_85 += __pyx_v_vit_trackr.shape[0];
-    if (unlikely(__pyx_t_85 < 0)) __pyx_t_15 = 0;
-  } else if (unlikely(__pyx_t_85 >= __pyx_v_vit_trackr.shape[0])) __pyx_t_15 = 0;
+  if (__pyx_t_45 < 0) {
+    __pyx_t_45 += __pyx_v_vit_trackr.shape[0];
+    if (unlikely(__pyx_t_45 < 0)) __pyx_t_15 = 0;
+  } else if (unlikely(__pyx_t_45 >= __pyx_v_vit_trackr.shape[0])) __pyx_t_15 = 0;
   if (unlikely(__pyx_t_15 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_15);
-    __PYX_ERR(0, 889, __pyx_L1_error)
+    __PYX_ERR(0, 891, __pyx_L1_error)
   }
-  *((long *) ( /* dim=0 */ (__pyx_v_vit_trackr.data + __pyx_t_85 * __pyx_v_vit_trackr.strides[0]) )) = __pyx_v_max_prob_index;
+  *((long *) ( /* dim=0 */ (__pyx_v_vit_trackr.data + __pyx_t_45 * __pyx_v_vit_trackr.strides[0]) )) = __pyx_v_max_prob_index;
 
-  /* "soapcw/soapcw.pyx":890
+  /* "soapcw/soapcw.pyx":892
  * 
  *         vit_trackr[length-1] = max_prob_index
  *         vit_track1[length-1] = det1[length-1][max_prob_index]             # <<<<<<<<<<<<<<
  *         vit_track2[length-1] = det2[length-1][max_prob_index]
  *         vit_track3[length-1] = det3[length-1][max_prob_index]
  */
-  __pyx_t_86 = (__pyx_v_length - 1);
-  __pyx_t_87 = __pyx_v_max_prob_index;
+  __pyx_t_45 = (__pyx_v_length - 1);
+  __pyx_t_46 = __pyx_v_max_prob_index;
   __pyx_t_15 = -1;
-  if (__pyx_t_86 < 0) {
-    __pyx_t_86 += __pyx_v_det1.shape[0];
-    if (unlikely(__pyx_t_86 < 0)) __pyx_t_15 = 0;
-  } else if (unlikely(__pyx_t_86 >= __pyx_v_det1.shape[0])) __pyx_t_15 = 0;
-  if (__pyx_t_87 < 0) {
-    __pyx_t_87 += __pyx_v_det1.shape[1];
-    if (unlikely(__pyx_t_87 < 0)) __pyx_t_15 = 1;
-  } else if (unlikely(__pyx_t_87 >= __pyx_v_det1.shape[1])) __pyx_t_15 = 1;
+  if (__pyx_t_45 < 0) {
+    __pyx_t_45 += __pyx_v_det1.shape[0];
+    if (unlikely(__pyx_t_45 < 0)) __pyx_t_15 = 0;
+  } else if (unlikely(__pyx_t_45 >= __pyx_v_det1.shape[0])) __pyx_t_15 = 0;
+  if (__pyx_t_46 < 0) {
+    __pyx_t_46 += __pyx_v_det1.shape[1];
+    if (unlikely(__pyx_t_46 < 0)) __pyx_t_15 = 1;
+  } else if (unlikely(__pyx_t_46 >= __pyx_v_det1.shape[1])) __pyx_t_15 = 1;
   if (unlikely(__pyx_t_15 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_15);
-    __PYX_ERR(0, 890, __pyx_L1_error)
+    __PYX_ERR(0, 892, __pyx_L1_error)
   }
-  __pyx_t_88 = (__pyx_v_length - 1);
+  __pyx_t_27 = (__pyx_v_length - 1);
   __pyx_t_15 = -1;
-  if (__pyx_t_88 < 0) {
-    __pyx_t_88 += __pyx_v_vit_track1.shape[0];
-    if (unlikely(__pyx_t_88 < 0)) __pyx_t_15 = 0;
-  } else if (unlikely(__pyx_t_88 >= __pyx_v_vit_track1.shape[0])) __pyx_t_15 = 0;
+  if (__pyx_t_27 < 0) {
+    __pyx_t_27 += __pyx_v_vit_track1.shape[0];
+    if (unlikely(__pyx_t_27 < 0)) __pyx_t_15 = 0;
+  } else if (unlikely(__pyx_t_27 >= __pyx_v_vit_track1.shape[0])) __pyx_t_15 = 0;
   if (unlikely(__pyx_t_15 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_15);
-    __PYX_ERR(0, 890, __pyx_L1_error)
+    __PYX_ERR(0, 892, __pyx_L1_error)
   }
-  *((long *) ( /* dim=0 */ (__pyx_v_vit_track1.data + __pyx_t_88 * __pyx_v_vit_track1.strides[0]) )) = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_86 * __pyx_v_det1.strides[0]) ) + __pyx_t_87 * __pyx_v_det1.strides[1]) )));
+  *((long *) ( /* dim=0 */ (__pyx_v_vit_track1.data + __pyx_t_27 * __pyx_v_vit_track1.strides[0]) )) = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_45 * __pyx_v_det1.strides[0]) ) + __pyx_t_46 * __pyx_v_det1.strides[1]) )));
 
-  /* "soapcw/soapcw.pyx":891
+  /* "soapcw/soapcw.pyx":893
  *         vit_trackr[length-1] = max_prob_index
  *         vit_track1[length-1] = det1[length-1][max_prob_index]
  *         vit_track2[length-1] = det2[length-1][max_prob_index]             # <<<<<<<<<<<<<<
  *         vit_track3[length-1] = det3[length-1][max_prob_index]
  *         previous = prev[length-1][max_prob_index]
  */
-  __pyx_t_89 = (__pyx_v_length - 1);
-  __pyx_t_90 = __pyx_v_max_prob_index;
+  __pyx_t_46 = (__pyx_v_length - 1);
+  __pyx_t_45 = __pyx_v_max_prob_index;
   __pyx_t_15 = -1;
-  if (__pyx_t_89 < 0) {
-    __pyx_t_89 += __pyx_v_det2.shape[0];
-    if (unlikely(__pyx_t_89 < 0)) __pyx_t_15 = 0;
-  } else if (unlikely(__pyx_t_89 >= __pyx_v_det2.shape[0])) __pyx_t_15 = 0;
-  if (__pyx_t_90 < 0) {
-    __pyx_t_90 += __pyx_v_det2.shape[1];
-    if (unlikely(__pyx_t_90 < 0)) __pyx_t_15 = 1;
-  } else if (unlikely(__pyx_t_90 >= __pyx_v_det2.shape[1])) __pyx_t_15 = 1;
+  if (__pyx_t_46 < 0) {
+    __pyx_t_46 += __pyx_v_det2.shape[0];
+    if (unlikely(__pyx_t_46 < 0)) __pyx_t_15 = 0;
+  } else if (unlikely(__pyx_t_46 >= __pyx_v_det2.shape[0])) __pyx_t_15 = 0;
+  if (__pyx_t_45 < 0) {
+    __pyx_t_45 += __pyx_v_det2.shape[1];
+    if (unlikely(__pyx_t_45 < 0)) __pyx_t_15 = 1;
+  } else if (unlikely(__pyx_t_45 >= __pyx_v_det2.shape[1])) __pyx_t_15 = 1;
   if (unlikely(__pyx_t_15 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_15);
-    __PYX_ERR(0, 891, __pyx_L1_error)
+    __PYX_ERR(0, 893, __pyx_L1_error)
   }
-  __pyx_t_91 = (__pyx_v_length - 1);
+  __pyx_t_27 = (__pyx_v_length - 1);
   __pyx_t_15 = -1;
-  if (__pyx_t_91 < 0) {
-    __pyx_t_91 += __pyx_v_vit_track2.shape[0];
-    if (unlikely(__pyx_t_91 < 0)) __pyx_t_15 = 0;
-  } else if (unlikely(__pyx_t_91 >= __pyx_v_vit_track2.shape[0])) __pyx_t_15 = 0;
+  if (__pyx_t_27 < 0) {
+    __pyx_t_27 += __pyx_v_vit_track2.shape[0];
+    if (unlikely(__pyx_t_27 < 0)) __pyx_t_15 = 0;
+  } else if (unlikely(__pyx_t_27 >= __pyx_v_vit_track2.shape[0])) __pyx_t_15 = 0;
   if (unlikely(__pyx_t_15 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_15);
-    __PYX_ERR(0, 891, __pyx_L1_error)
+    __PYX_ERR(0, 893, __pyx_L1_error)
   }
-  *((long *) ( /* dim=0 */ (__pyx_v_vit_track2.data + __pyx_t_91 * __pyx_v_vit_track2.strides[0]) )) = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_89 * __pyx_v_det2.strides[0]) ) + __pyx_t_90 * __pyx_v_det2.strides[1]) )));
+  *((long *) ( /* dim=0 */ (__pyx_v_vit_track2.data + __pyx_t_27 * __pyx_v_vit_track2.strides[0]) )) = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_46 * __pyx_v_det2.strides[0]) ) + __pyx_t_45 * __pyx_v_det2.strides[1]) )));
 
-  /* "soapcw/soapcw.pyx":892
+  /* "soapcw/soapcw.pyx":894
  *         vit_track1[length-1] = det1[length-1][max_prob_index]
  *         vit_track2[length-1] = det2[length-1][max_prob_index]
  *         vit_track3[length-1] = det3[length-1][max_prob_index]             # <<<<<<<<<<<<<<
  *         previous = prev[length-1][max_prob_index]
  * 
  */
-  __pyx_t_92 = (__pyx_v_length - 1);
-  __pyx_t_93 = __pyx_v_max_prob_index;
+  __pyx_t_45 = (__pyx_v_length - 1);
+  __pyx_t_46 = __pyx_v_max_prob_index;
   __pyx_t_15 = -1;
-  if (__pyx_t_92 < 0) {
-    __pyx_t_92 += __pyx_v_det3.shape[0];
-    if (unlikely(__pyx_t_92 < 0)) __pyx_t_15 = 0;
-  } else if (unlikely(__pyx_t_92 >= __pyx_v_det3.shape[0])) __pyx_t_15 = 0;
-  if (__pyx_t_93 < 0) {
-    __pyx_t_93 += __pyx_v_det3.shape[1];
-    if (unlikely(__pyx_t_93 < 0)) __pyx_t_15 = 1;
-  } else if (unlikely(__pyx_t_93 >= __pyx_v_det3.shape[1])) __pyx_t_15 = 1;
+  if (__pyx_t_45 < 0) {
+    __pyx_t_45 += __pyx_v_det3.shape[0];
+    if (unlikely(__pyx_t_45 < 0)) __pyx_t_15 = 0;
+  } else if (unlikely(__pyx_t_45 >= __pyx_v_det3.shape[0])) __pyx_t_15 = 0;
+  if (__pyx_t_46 < 0) {
+    __pyx_t_46 += __pyx_v_det3.shape[1];
+    if (unlikely(__pyx_t_46 < 0)) __pyx_t_15 = 1;
+  } else if (unlikely(__pyx_t_46 >= __pyx_v_det3.shape[1])) __pyx_t_15 = 1;
   if (unlikely(__pyx_t_15 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_15);
-    __PYX_ERR(0, 892, __pyx_L1_error)
+    __PYX_ERR(0, 894, __pyx_L1_error)
   }
-  __pyx_t_94 = (__pyx_v_length - 1);
+  __pyx_t_27 = (__pyx_v_length - 1);
   __pyx_t_15 = -1;
-  if (__pyx_t_94 < 0) {
-    __pyx_t_94 += __pyx_v_vit_track3.shape[0];
-    if (unlikely(__pyx_t_94 < 0)) __pyx_t_15 = 0;
-  } else if (unlikely(__pyx_t_94 >= __pyx_v_vit_track3.shape[0])) __pyx_t_15 = 0;
+  if (__pyx_t_27 < 0) {
+    __pyx_t_27 += __pyx_v_vit_track3.shape[0];
+    if (unlikely(__pyx_t_27 < 0)) __pyx_t_15 = 0;
+  } else if (unlikely(__pyx_t_27 >= __pyx_v_vit_track3.shape[0])) __pyx_t_15 = 0;
   if (unlikely(__pyx_t_15 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_15);
-    __PYX_ERR(0, 892, __pyx_L1_error)
+    __PYX_ERR(0, 894, __pyx_L1_error)
   }
-  *((long *) ( /* dim=0 */ (__pyx_v_vit_track3.data + __pyx_t_94 * __pyx_v_vit_track3.strides[0]) )) = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det3.data + __pyx_t_92 * __pyx_v_det3.strides[0]) ) + __pyx_t_93 * __pyx_v_det3.strides[1]) )));
+  *((long *) ( /* dim=0 */ (__pyx_v_vit_track3.data + __pyx_t_27 * __pyx_v_vit_track3.strides[0]) )) = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det3.data + __pyx_t_45 * __pyx_v_det3.strides[0]) ) + __pyx_t_46 * __pyx_v_det3.strides[1]) )));
 
-  /* "soapcw/soapcw.pyx":893
+  /* "soapcw/soapcw.pyx":895
  *         vit_track2[length-1] = det2[length-1][max_prob_index]
  *         vit_track3[length-1] = det3[length-1][max_prob_index]
  *         previous = prev[length-1][max_prob_index]             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_95 = (__pyx_v_length - 1);
-  __pyx_t_96 = __pyx_v_max_prob_index;
+  __pyx_t_46 = (__pyx_v_length - 1);
+  __pyx_t_45 = __pyx_v_max_prob_index;
   __pyx_t_15 = -1;
-  if (__pyx_t_95 < 0) {
-    __pyx_t_95 += __pyx_v_prev.shape[0];
-    if (unlikely(__pyx_t_95 < 0)) __pyx_t_15 = 0;
-  } else if (unlikely(__pyx_t_95 >= __pyx_v_prev.shape[0])) __pyx_t_15 = 0;
-  if (__pyx_t_96 < 0) {
-    __pyx_t_96 += __pyx_v_prev.shape[1];
-    if (unlikely(__pyx_t_96 < 0)) __pyx_t_15 = 1;
-  } else if (unlikely(__pyx_t_96 >= __pyx_v_prev.shape[1])) __pyx_t_15 = 1;
+  if (__pyx_t_46 < 0) {
+    __pyx_t_46 += __pyx_v_prev.shape[0];
+    if (unlikely(__pyx_t_46 < 0)) __pyx_t_15 = 0;
+  } else if (unlikely(__pyx_t_46 >= __pyx_v_prev.shape[0])) __pyx_t_15 = 0;
+  if (__pyx_t_45 < 0) {
+    __pyx_t_45 += __pyx_v_prev.shape[1];
+    if (unlikely(__pyx_t_45 < 0)) __pyx_t_15 = 1;
+  } else if (unlikely(__pyx_t_45 >= __pyx_v_prev.shape[1])) __pyx_t_15 = 1;
   if (unlikely(__pyx_t_15 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_15);
-    __PYX_ERR(0, 893, __pyx_L1_error)
+    __PYX_ERR(0, 895, __pyx_L1_error)
   }
-  __pyx_v_previous = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_95 * __pyx_v_prev.strides[0]) ) + __pyx_t_96 * __pyx_v_prev.strides[1]) )));
+  __pyx_v_previous = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_46 * __pyx_v_prev.strides[0]) ) + __pyx_t_45 * __pyx_v_prev.strides[1]) )));
 
-  /* "soapcw/soapcw.pyx":896
+  /* "soapcw/soapcw.pyx":898
  * 
  * 
  *         for t in range(length-2,-1,-1):             # <<<<<<<<<<<<<<
  *             vit_trackr[t] = previous # insert previous step
  *             vit_track1[t] = det1[t][previous]
  */
   for (__pyx_t_15 = (__pyx_v_length - 2); __pyx_t_15 > -1; __pyx_t_15-=1) {
     __pyx_v_t = __pyx_t_15;
 
-    /* "soapcw/soapcw.pyx":897
+    /* "soapcw/soapcw.pyx":899
  * 
  *         for t in range(length-2,-1,-1):
  *             vit_trackr[t] = previous # insert previous step             # <<<<<<<<<<<<<<
  *             vit_track1[t] = det1[t][previous]
  *             vit_track2[t] = det2[t][previous]
  */
-    __pyx_t_97 = __pyx_v_t;
+    __pyx_t_45 = __pyx_v_t;
     __pyx_t_16 = -1;
-    if (__pyx_t_97 < 0) {
-      __pyx_t_97 += __pyx_v_vit_trackr.shape[0];
-      if (unlikely(__pyx_t_97 < 0)) __pyx_t_16 = 0;
-    } else if (unlikely(__pyx_t_97 >= __pyx_v_vit_trackr.shape[0])) __pyx_t_16 = 0;
+    if (__pyx_t_45 < 0) {
+      __pyx_t_45 += __pyx_v_vit_trackr.shape[0];
+      if (unlikely(__pyx_t_45 < 0)) __pyx_t_16 = 0;
+    } else if (unlikely(__pyx_t_45 >= __pyx_v_vit_trackr.shape[0])) __pyx_t_16 = 0;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 897, __pyx_L1_error)
+      __PYX_ERR(0, 899, __pyx_L1_error)
     }
-    *((long *) ( /* dim=0 */ (__pyx_v_vit_trackr.data + __pyx_t_97 * __pyx_v_vit_trackr.strides[0]) )) = __pyx_v_previous;
+    *((long *) ( /* dim=0 */ (__pyx_v_vit_trackr.data + __pyx_t_45 * __pyx_v_vit_trackr.strides[0]) )) = __pyx_v_previous;
 
-    /* "soapcw/soapcw.pyx":898
+    /* "soapcw/soapcw.pyx":900
  *         for t in range(length-2,-1,-1):
  *             vit_trackr[t] = previous # insert previous step
  *             vit_track1[t] = det1[t][previous]             # <<<<<<<<<<<<<<
  *             vit_track2[t] = det2[t][previous]
  *             vit_track3[t] = det3[t][previous]
  */
-    __pyx_t_98 = __pyx_v_t;
-    __pyx_t_99 = __pyx_v_previous;
+    __pyx_t_45 = __pyx_v_t;
+    __pyx_t_46 = __pyx_v_previous;
     __pyx_t_16 = -1;
-    if (__pyx_t_98 < 0) {
-      __pyx_t_98 += __pyx_v_det1.shape[0];
-      if (unlikely(__pyx_t_98 < 0)) __pyx_t_16 = 0;
-    } else if (unlikely(__pyx_t_98 >= __pyx_v_det1.shape[0])) __pyx_t_16 = 0;
-    if (__pyx_t_99 < 0) {
-      __pyx_t_99 += __pyx_v_det1.shape[1];
-      if (unlikely(__pyx_t_99 < 0)) __pyx_t_16 = 1;
-    } else if (unlikely(__pyx_t_99 >= __pyx_v_det1.shape[1])) __pyx_t_16 = 1;
+    if (__pyx_t_45 < 0) {
+      __pyx_t_45 += __pyx_v_det1.shape[0];
+      if (unlikely(__pyx_t_45 < 0)) __pyx_t_16 = 0;
+    } else if (unlikely(__pyx_t_45 >= __pyx_v_det1.shape[0])) __pyx_t_16 = 0;
+    if (__pyx_t_46 < 0) {
+      __pyx_t_46 += __pyx_v_det1.shape[1];
+      if (unlikely(__pyx_t_46 < 0)) __pyx_t_16 = 1;
+    } else if (unlikely(__pyx_t_46 >= __pyx_v_det1.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 898, __pyx_L1_error)
+      __PYX_ERR(0, 900, __pyx_L1_error)
     }
-    __pyx_t_100 = __pyx_v_t;
+    __pyx_t_27 = __pyx_v_t;
     __pyx_t_16 = -1;
-    if (__pyx_t_100 < 0) {
-      __pyx_t_100 += __pyx_v_vit_track1.shape[0];
-      if (unlikely(__pyx_t_100 < 0)) __pyx_t_16 = 0;
-    } else if (unlikely(__pyx_t_100 >= __pyx_v_vit_track1.shape[0])) __pyx_t_16 = 0;
+    if (__pyx_t_27 < 0) {
+      __pyx_t_27 += __pyx_v_vit_track1.shape[0];
+      if (unlikely(__pyx_t_27 < 0)) __pyx_t_16 = 0;
+    } else if (unlikely(__pyx_t_27 >= __pyx_v_vit_track1.shape[0])) __pyx_t_16 = 0;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 898, __pyx_L1_error)
+      __PYX_ERR(0, 900, __pyx_L1_error)
     }
-    *((long *) ( /* dim=0 */ (__pyx_v_vit_track1.data + __pyx_t_100 * __pyx_v_vit_track1.strides[0]) )) = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_98 * __pyx_v_det1.strides[0]) ) + __pyx_t_99 * __pyx_v_det1.strides[1]) )));
+    *((long *) ( /* dim=0 */ (__pyx_v_vit_track1.data + __pyx_t_27 * __pyx_v_vit_track1.strides[0]) )) = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det1.data + __pyx_t_45 * __pyx_v_det1.strides[0]) ) + __pyx_t_46 * __pyx_v_det1.strides[1]) )));
 
-    /* "soapcw/soapcw.pyx":899
+    /* "soapcw/soapcw.pyx":901
  *             vit_trackr[t] = previous # insert previous step
  *             vit_track1[t] = det1[t][previous]
  *             vit_track2[t] = det2[t][previous]             # <<<<<<<<<<<<<<
  *             vit_track3[t] = det3[t][previous]
  *             previous = prev[t][previous]
  */
-    __pyx_t_101 = __pyx_v_t;
-    __pyx_t_102 = __pyx_v_previous;
+    __pyx_t_46 = __pyx_v_t;
+    __pyx_t_45 = __pyx_v_previous;
     __pyx_t_16 = -1;
-    if (__pyx_t_101 < 0) {
-      __pyx_t_101 += __pyx_v_det2.shape[0];
-      if (unlikely(__pyx_t_101 < 0)) __pyx_t_16 = 0;
-    } else if (unlikely(__pyx_t_101 >= __pyx_v_det2.shape[0])) __pyx_t_16 = 0;
-    if (__pyx_t_102 < 0) {
-      __pyx_t_102 += __pyx_v_det2.shape[1];
-      if (unlikely(__pyx_t_102 < 0)) __pyx_t_16 = 1;
-    } else if (unlikely(__pyx_t_102 >= __pyx_v_det2.shape[1])) __pyx_t_16 = 1;
+    if (__pyx_t_46 < 0) {
+      __pyx_t_46 += __pyx_v_det2.shape[0];
+      if (unlikely(__pyx_t_46 < 0)) __pyx_t_16 = 0;
+    } else if (unlikely(__pyx_t_46 >= __pyx_v_det2.shape[0])) __pyx_t_16 = 0;
+    if (__pyx_t_45 < 0) {
+      __pyx_t_45 += __pyx_v_det2.shape[1];
+      if (unlikely(__pyx_t_45 < 0)) __pyx_t_16 = 1;
+    } else if (unlikely(__pyx_t_45 >= __pyx_v_det2.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 899, __pyx_L1_error)
+      __PYX_ERR(0, 901, __pyx_L1_error)
     }
-    __pyx_t_103 = __pyx_v_t;
+    __pyx_t_27 = __pyx_v_t;
     __pyx_t_16 = -1;
-    if (__pyx_t_103 < 0) {
-      __pyx_t_103 += __pyx_v_vit_track2.shape[0];
-      if (unlikely(__pyx_t_103 < 0)) __pyx_t_16 = 0;
-    } else if (unlikely(__pyx_t_103 >= __pyx_v_vit_track2.shape[0])) __pyx_t_16 = 0;
+    if (__pyx_t_27 < 0) {
+      __pyx_t_27 += __pyx_v_vit_track2.shape[0];
+      if (unlikely(__pyx_t_27 < 0)) __pyx_t_16 = 0;
+    } else if (unlikely(__pyx_t_27 >= __pyx_v_vit_track2.shape[0])) __pyx_t_16 = 0;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 899, __pyx_L1_error)
+      __PYX_ERR(0, 901, __pyx_L1_error)
     }
-    *((long *) ( /* dim=0 */ (__pyx_v_vit_track2.data + __pyx_t_103 * __pyx_v_vit_track2.strides[0]) )) = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_101 * __pyx_v_det2.strides[0]) ) + __pyx_t_102 * __pyx_v_det2.strides[1]) )));
+    *((long *) ( /* dim=0 */ (__pyx_v_vit_track2.data + __pyx_t_27 * __pyx_v_vit_track2.strides[0]) )) = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det2.data + __pyx_t_46 * __pyx_v_det2.strides[0]) ) + __pyx_t_45 * __pyx_v_det2.strides[1]) )));
 
-    /* "soapcw/soapcw.pyx":900
+    /* "soapcw/soapcw.pyx":902
  *             vit_track1[t] = det1[t][previous]
  *             vit_track2[t] = det2[t][previous]
  *             vit_track3[t] = det3[t][previous]             # <<<<<<<<<<<<<<
  *             previous = prev[t][previous]
  * 
  */
-    __pyx_t_104 = __pyx_v_t;
-    __pyx_t_105 = __pyx_v_previous;
+    __pyx_t_45 = __pyx_v_t;
+    __pyx_t_46 = __pyx_v_previous;
     __pyx_t_16 = -1;
-    if (__pyx_t_104 < 0) {
-      __pyx_t_104 += __pyx_v_det3.shape[0];
-      if (unlikely(__pyx_t_104 < 0)) __pyx_t_16 = 0;
-    } else if (unlikely(__pyx_t_104 >= __pyx_v_det3.shape[0])) __pyx_t_16 = 0;
-    if (__pyx_t_105 < 0) {
-      __pyx_t_105 += __pyx_v_det3.shape[1];
-      if (unlikely(__pyx_t_105 < 0)) __pyx_t_16 = 1;
-    } else if (unlikely(__pyx_t_105 >= __pyx_v_det3.shape[1])) __pyx_t_16 = 1;
+    if (__pyx_t_45 < 0) {
+      __pyx_t_45 += __pyx_v_det3.shape[0];
+      if (unlikely(__pyx_t_45 < 0)) __pyx_t_16 = 0;
+    } else if (unlikely(__pyx_t_45 >= __pyx_v_det3.shape[0])) __pyx_t_16 = 0;
+    if (__pyx_t_46 < 0) {
+      __pyx_t_46 += __pyx_v_det3.shape[1];
+      if (unlikely(__pyx_t_46 < 0)) __pyx_t_16 = 1;
+    } else if (unlikely(__pyx_t_46 >= __pyx_v_det3.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 900, __pyx_L1_error)
+      __PYX_ERR(0, 902, __pyx_L1_error)
     }
-    __pyx_t_106 = __pyx_v_t;
+    __pyx_t_27 = __pyx_v_t;
     __pyx_t_16 = -1;
-    if (__pyx_t_106 < 0) {
-      __pyx_t_106 += __pyx_v_vit_track3.shape[0];
-      if (unlikely(__pyx_t_106 < 0)) __pyx_t_16 = 0;
-    } else if (unlikely(__pyx_t_106 >= __pyx_v_vit_track3.shape[0])) __pyx_t_16 = 0;
+    if (__pyx_t_27 < 0) {
+      __pyx_t_27 += __pyx_v_vit_track3.shape[0];
+      if (unlikely(__pyx_t_27 < 0)) __pyx_t_16 = 0;
+    } else if (unlikely(__pyx_t_27 >= __pyx_v_vit_track3.shape[0])) __pyx_t_16 = 0;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 900, __pyx_L1_error)
+      __PYX_ERR(0, 902, __pyx_L1_error)
     }
-    *((long *) ( /* dim=0 */ (__pyx_v_vit_track3.data + __pyx_t_106 * __pyx_v_vit_track3.strides[0]) )) = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det3.data + __pyx_t_104 * __pyx_v_det3.strides[0]) ) + __pyx_t_105 * __pyx_v_det3.strides[1]) )));
+    *((long *) ( /* dim=0 */ (__pyx_v_vit_track3.data + __pyx_t_27 * __pyx_v_vit_track3.strides[0]) )) = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_det3.data + __pyx_t_45 * __pyx_v_det3.strides[0]) ) + __pyx_t_46 * __pyx_v_det3.strides[1]) )));
 
-    /* "soapcw/soapcw.pyx":901
+    /* "soapcw/soapcw.pyx":903
  *             vit_track2[t] = det2[t][previous]
  *             vit_track3[t] = det3[t][previous]
  *             previous = prev[t][previous]             # <<<<<<<<<<<<<<
  * 
  *         self.vit_track1    = np.array(vit_track1)
  */
-    __pyx_t_107 = __pyx_v_t;
-    __pyx_t_108 = __pyx_v_previous;
+    __pyx_t_46 = __pyx_v_t;
+    __pyx_t_45 = __pyx_v_previous;
     __pyx_t_16 = -1;
-    if (__pyx_t_107 < 0) {
-      __pyx_t_107 += __pyx_v_prev.shape[0];
-      if (unlikely(__pyx_t_107 < 0)) __pyx_t_16 = 0;
-    } else if (unlikely(__pyx_t_107 >= __pyx_v_prev.shape[0])) __pyx_t_16 = 0;
-    if (__pyx_t_108 < 0) {
-      __pyx_t_108 += __pyx_v_prev.shape[1];
-      if (unlikely(__pyx_t_108 < 0)) __pyx_t_16 = 1;
-    } else if (unlikely(__pyx_t_108 >= __pyx_v_prev.shape[1])) __pyx_t_16 = 1;
+    if (__pyx_t_46 < 0) {
+      __pyx_t_46 += __pyx_v_prev.shape[0];
+      if (unlikely(__pyx_t_46 < 0)) __pyx_t_16 = 0;
+    } else if (unlikely(__pyx_t_46 >= __pyx_v_prev.shape[0])) __pyx_t_16 = 0;
+    if (__pyx_t_45 < 0) {
+      __pyx_t_45 += __pyx_v_prev.shape[1];
+      if (unlikely(__pyx_t_45 < 0)) __pyx_t_16 = 1;
+    } else if (unlikely(__pyx_t_45 >= __pyx_v_prev.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 901, __pyx_L1_error)
+      __PYX_ERR(0, 903, __pyx_L1_error)
     }
-    __pyx_v_previous = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_107 * __pyx_v_prev.strides[0]) ) + __pyx_t_108 * __pyx_v_prev.strides[1]) )));
+    __pyx_v_previous = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prev.data + __pyx_t_46 * __pyx_v_prev.strides[0]) ) + __pyx_t_45 * __pyx_v_prev.strides[1]) )));
   }
 
-  /* "soapcw/soapcw.pyx":903
+  /* "soapcw/soapcw.pyx":905
  *             previous = prev[t][previous]
  * 
  *         self.vit_track1    = np.array(vit_track1)             # <<<<<<<<<<<<<<
  *         self.vit_track2    = np.array(vit_track2)
  *         self.vit_track3    = np.array(vit_track3)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 903, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 905, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 903, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 905, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_vit_track1, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 903, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_vit_track1, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 905, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_13);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_13, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_6, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 903, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 905, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track1, __pyx_t_3) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track1, __pyx_t_3) < 0) __PYX_ERR(0, 905, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":904
+  /* "soapcw/soapcw.pyx":906
  * 
  *         self.vit_track1    = np.array(vit_track1)
  *         self.vit_track2    = np.array(vit_track2)             # <<<<<<<<<<<<<<
  *         self.vit_track3    = np.array(vit_track3)
  *         self.vit_track = np.array(vit_trackr)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 904, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 906, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 904, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 906, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_vit_track2, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 904, __pyx_L1_error)
+  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_vit_track2, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 906, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_13);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 904, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 906, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track2, __pyx_t_3) < 0) __PYX_ERR(0, 904, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track2, __pyx_t_3) < 0) __PYX_ERR(0, 906, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":905
+  /* "soapcw/soapcw.pyx":907
  *         self.vit_track1    = np.array(vit_track1)
  *         self.vit_track2    = np.array(vit_track2)
  *         self.vit_track3    = np.array(vit_track3)             # <<<<<<<<<<<<<<
  *         self.vit_track = np.array(vit_trackr)
  *         self.V            = np.array(val)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 905, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 907, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 905, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 907, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_vit_track3, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 905, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_vit_track3, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 907, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_13);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_13, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_6, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 905, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 907, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track3, __pyx_t_3) < 0) __PYX_ERR(0, 905, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track3, __pyx_t_3) < 0) __PYX_ERR(0, 907, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":906
+  /* "soapcw/soapcw.pyx":908
  *         self.vit_track2    = np.array(vit_track2)
  *         self.vit_track3    = np.array(vit_track3)
  *         self.vit_track = np.array(vit_trackr)             # <<<<<<<<<<<<<<
  *         self.V            = np.array(val)
  *         self.prev         = np.array(prev)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 906, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 908, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 906, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_vit_trackr, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 906, __pyx_L1_error)
+  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_vit_trackr, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 908, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_13);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 906, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track, __pyx_t_3) < 0) __PYX_ERR(0, 906, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track, __pyx_t_3) < 0) __PYX_ERR(0, 908, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":907
+  /* "soapcw/soapcw.pyx":909
  *         self.vit_track3    = np.array(vit_track3)
  *         self.vit_track = np.array(vit_trackr)
  *         self.V            = np.array(val)             # <<<<<<<<<<<<<<
  *         self.prev         = np.array(prev)
  *         self.max_end_prob = max_prob
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 907, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 909, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 907, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 909, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_val, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 907, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_val, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 909, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_13);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_13, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_6, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 907, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 909, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_V, __pyx_t_3) < 0) __PYX_ERR(0, 907, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_V, __pyx_t_3) < 0) __PYX_ERR(0, 909, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":908
+  /* "soapcw/soapcw.pyx":910
  *         self.vit_track = np.array(vit_trackr)
  *         self.V            = np.array(val)
  *         self.prev         = np.array(prev)             # <<<<<<<<<<<<<<
  *         self.max_end_prob = max_prob
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_prev, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_prev, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_13);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prev, __pyx_t_3) < 0) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prev, __pyx_t_3) < 0) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":909
+  /* "soapcw/soapcw.pyx":911
  *         self.V            = np.array(val)
  *         self.prev         = np.array(prev)
  *         self.max_end_prob = max_prob             # <<<<<<<<<<<<<<
  * 
  *         #return np.array(vit_track1), np.array(vit_track2), np.array(vit_track3), np.array(vit_trackr), np.array(val),np.array(prev), max_prob
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_prob); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 909, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_prob); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 911, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_max_end_prob, __pyx_t_3) < 0) __PYX_ERR(0, 909, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_max_end_prob, __pyx_t_3) < 0) __PYX_ERR(0, 911, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":758
+  /* "soapcw/soapcw.pyx":760
  *     #--------------------------------------------------------
  * 
  *     def run(self,tr1, obs11, obs21, obs31):             # <<<<<<<<<<<<<<
  *         """
  *         viterbi algorithm for multiple detectors 2 at the moment
  */
 
@@ -19271,16 +19418,16 @@
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
   __PYX_XDEC_MEMVIEW(&__pyx_t_12, 1);
   __Pyx_XDECREF(__pyx_t_13);
   __PYX_XDEC_MEMVIEW(&__pyx_t_14, 1);
-  __Pyx_XDECREF(__pyx_t_78);
-  __PYX_XDEC_MEMVIEW(&__pyx_t_79, 1);
+  __Pyx_XDECREF(__pyx_t_48);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_49, 1);
   __Pyx_AddTraceback("soapcw.soapcw.three_detector.run", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_tr, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_obs1, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_obs2, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_obs3, 1);
@@ -19297,15 +19444,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_vit_track2, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_vit_track3, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":915
+/* "soapcw/soapcw.pyx":917
  * class single_detector_mem_n(object):
  * 
  *     def __init__(self, tr, obs, prog = False):             # <<<<<<<<<<<<<<
  *         '''
  * 
  */
 
@@ -19314,14 +19461,17 @@
 static char __pyx_doc_6soapcw_6soapcw_21single_detector_mem_n___init__[] = "\n        \n        Find single detector algorithm with a memory, uses the summed pixel power as statistic\n\n        initialising viterbi class\n        ";
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_21single_detector_mem_n_1__init__ = {"__init__", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_21single_detector_mem_n_1__init__, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6soapcw_6soapcw_21single_detector_mem_n___init__};
 static PyObject *__pyx_pw_6soapcw_6soapcw_21single_detector_mem_n_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_tr = 0;
   PyObject *__pyx_v_obs = 0;
   PyObject *__pyx_v_prog = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr,&__pyx_n_s_obs,&__pyx_n_s_prog,0};
     PyObject* values[4] = {0,0,0,0};
     values[3] = ((PyObject *)((PyObject *)Py_False));
@@ -19345,31 +19495,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 4, 1); __PYX_ERR(0, 915, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 4, 1); __PYX_ERR(0, 917, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 4, 2); __PYX_ERR(0, 915, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 4, 2); __PYX_ERR(0, 917, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_prog);
           if (value) { values[3] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 915, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 917, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
@@ -19381,15 +19531,15 @@
     __pyx_v_self = values[0];
     __pyx_v_tr = values[1];
     __pyx_v_obs = values[2];
     __pyx_v_prog = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 915, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 917, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.single_detector_mem_n.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_21single_detector_mem_n___init__(__pyx_self, __pyx_v_self, __pyx_v_tr, __pyx_v_obs, __pyx_v_prog);
 
@@ -19402,33 +19552,36 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "soapcw/soapcw.pyx":922
+  /* "soapcw/soapcw.pyx":924
  *         initialising viterbi class
  *         '''
  *         self.prog = prog             # <<<<<<<<<<<<<<
  *         self.tracks = self.run(tr, obs)
  * 
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prog, __pyx_v_prog) < 0) __PYX_ERR(0, 922, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prog, __pyx_v_prog) < 0) __PYX_ERR(0, 924, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":923
+  /* "soapcw/soapcw.pyx":925
  *         '''
  *         self.prog = prog
  *         self.tracks = self.run(tr, obs)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_run); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 923, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_run); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 925, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -19437,48 +19590,48 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_tr, __pyx_v_obs};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 925, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_tr, __pyx_v_obs};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 925, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 923, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 925, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_3) {
       __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
     }
     __Pyx_INCREF(__pyx_v_tr);
     __Pyx_GIVEREF(__pyx_v_tr);
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_tr);
     __Pyx_INCREF(__pyx_v_obs);
     __Pyx_GIVEREF(__pyx_v_obs);
     PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_obs);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 925, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tracks, __pyx_t_1) < 0) __PYX_ERR(0, 923, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tracks, __pyx_t_1) < 0) __PYX_ERR(0, 925, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":915
+  /* "soapcw/soapcw.pyx":917
  * class single_detector_mem_n(object):
  * 
  *     def __init__(self, tr, obs, prog = False):             # <<<<<<<<<<<<<<
  *         '''
  * 
  */
 
@@ -19494,15 +19647,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":930
+/* "soapcw/soapcw.pyx":932
  *     #------------------------------------------------------------------------
  * 
  *     def run(self, tr, obs):             # <<<<<<<<<<<<<<
  *         ''' Run viterbi algroithm with memory of n
  *         the amount of memory is determined by the transition matrix
  */
 
@@ -19510,14 +19663,17 @@
 static PyObject *__pyx_pw_6soapcw_6soapcw_21single_detector_mem_n_3run(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static char __pyx_doc_6soapcw_6soapcw_21single_detector_mem_n_2run[] = " Run viterbi algroithm with memory of n\n        the amount of memory is determined by the transition matrix\n        args\n        -------\n        tr : array\n            transition matrix, any dimension greater that 1 - type: array\n        obs: array\n            observation - type: array\n        \n        returns\n        -------\n        vit_track: array\n            optimum path through data\n        val: array\n            values of viterbi\n        prev: array\n            previous positions of viterbi\n        ";
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_21single_detector_mem_n_3run = {"run", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_21single_detector_mem_n_3run, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6soapcw_6soapcw_21single_detector_mem_n_2run};
 static PyObject *__pyx_pw_6soapcw_6soapcw_21single_detector_mem_n_3run(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_tr = 0;
   PyObject *__pyx_v_obs = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("run (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr,&__pyx_n_s_obs,0};
     PyObject* values[3] = {0,0,0};
     if (unlikely(__pyx_kwds)) {
@@ -19538,40 +19694,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run", 1, 3, 3, 1); __PYX_ERR(0, 930, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run", 1, 3, 3, 1); __PYX_ERR(0, 932, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run", 1, 3, 3, 2); __PYX_ERR(0, 930, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run", 1, 3, 3, 2); __PYX_ERR(0, 932, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "run") < 0)) __PYX_ERR(0, 930, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "run") < 0)) __PYX_ERR(0, 932, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_tr = values[1];
     __pyx_v_obs = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("run", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 930, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("run", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 932, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.single_detector_mem_n.run", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_21single_detector_mem_n_2run(__pyx_self, __pyx_v_self, __pyx_v_tr, __pyx_v_obs);
 
@@ -19632,973 +19788,976 @@
   PyObject *__pyx_t_18 = NULL;
   PyObject *__pyx_t_19 = NULL;
   Py_ssize_t __pyx_t_20;
   int __pyx_t_21;
   int __pyx_t_22;
   int __pyx_t_23;
   double __pyx_t_24;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("run", 0);
 
-  /* "soapcw/soapcw.pyx":950
+  /* "soapcw/soapcw.pyx":952
  *         '''
  * 
  *         if len(np.shape(tr))<=1:             # <<<<<<<<<<<<<<
  *             raise Exception("ERROR: Please use a transition matrix with dimensions larger than one")
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 950, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 952, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 950, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 952, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_tr) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_tr);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 950, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 952, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 950, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 952, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_5 = ((__pyx_t_4 <= 1) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "soapcw/soapcw.pyx":951
+    /* "soapcw/soapcw.pyx":953
  * 
  *         if len(np.shape(tr))<=1:
  *             raise Exception("ERROR: Please use a transition matrix with dimensions larger than one")             # <<<<<<<<<<<<<<
  * 
  *         #np.insert(obs,0,-1e6,axis=1)
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])), __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 951, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])), __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 953, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 951, __pyx_L1_error)
+    __PYX_ERR(0, 953, __pyx_L1_error)
 
-    /* "soapcw/soapcw.pyx":950
+    /* "soapcw/soapcw.pyx":952
  *         '''
  * 
  *         if len(np.shape(tr))<=1:             # <<<<<<<<<<<<<<
  *             raise Exception("ERROR: Please use a transition matrix with dimensions larger than one")
  * 
  */
   }
 
-  /* "soapcw/soapcw.pyx":959
+  /* "soapcw/soapcw.pyx":961
  *         #cdef double[:, :] obs = obs1
  * 
  *         range_tr = np.arange(len(tr))             # <<<<<<<<<<<<<<
  *         cdef int n = len(tr)
  *         shape = np.shape(tr)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 959, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 961, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_arange); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 959, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_arange); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 961, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = PyObject_Length(__pyx_v_tr); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 959, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 959, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_v_tr); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 961, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 961, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 959, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 961, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_range_tr = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":960
+  /* "soapcw/soapcw.pyx":962
  * 
  *         range_tr = np.arange(len(tr))
  *         cdef int n = len(tr)             # <<<<<<<<<<<<<<
  *         shape = np.shape(tr)
  *         cdef int length = len(shape)
  */
-  __pyx_t_4 = PyObject_Length(__pyx_v_tr); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 960, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_v_tr); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 962, __pyx_L1_error)
   __pyx_v_n = __pyx_t_4;
 
-  /* "soapcw/soapcw.pyx":961
+  /* "soapcw/soapcw.pyx":963
  *         range_tr = np.arange(len(tr))
  *         cdef int n = len(tr)
  *         shape = np.shape(tr)             # <<<<<<<<<<<<<<
  *         cdef int length = len(shape)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 961, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 963, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 961, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 963, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_tr) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_tr);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 961, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 963, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_shape = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":962
+  /* "soapcw/soapcw.pyx":964
  *         cdef int n = len(tr)
  *         shape = np.shape(tr)
  *         cdef int length = len(shape)             # <<<<<<<<<<<<<<
  * 
  *         dimensions = (len(obs),len(obs[0]))
  */
-  __pyx_t_4 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 962, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 964, __pyx_L1_error)
   __pyx_v_length = __pyx_t_4;
 
-  /* "soapcw/soapcw.pyx":964
+  /* "soapcw/soapcw.pyx":966
  *         cdef int length = len(shape)
  * 
  *         dimensions = (len(obs),len(obs[0]))             # <<<<<<<<<<<<<<
  *         dimensions = list(dimensions)
  * 
  */
-  __pyx_t_4 = PyObject_Length(__pyx_v_obs); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 964, __pyx_L1_error)
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 964, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_v_obs); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 966, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 964, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obs, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 964, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 964, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 964, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
   __pyx_t_1 = 0;
   __pyx_t_3 = 0;
   __pyx_v_dimensions = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":965
+  /* "soapcw/soapcw.pyx":967
  * 
  *         dimensions = (len(obs),len(obs[0]))
  *         dimensions = list(dimensions)             # <<<<<<<<<<<<<<
  * 
  *         cdef int length_t = dimensions[0]
  */
-  __pyx_t_2 = PySequence_List(__pyx_v_dimensions); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 965, __pyx_L1_error)
+  __pyx_t_2 = PySequence_List(__pyx_v_dimensions); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 967, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF_SET(__pyx_v_dimensions, __pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":967
+  /* "soapcw/soapcw.pyx":969
  *         dimensions = list(dimensions)
  * 
  *         cdef int length_t = dimensions[0]             # <<<<<<<<<<<<<<
  *         cdef int width = dimensions[1]
  * 
  */
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dimensions, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dimensions, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 969, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 969, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_length_t = __pyx_t_7;
 
-  /* "soapcw/soapcw.pyx":968
+  /* "soapcw/soapcw.pyx":970
  * 
  *         cdef int length_t = dimensions[0]
  *         cdef int width = dimensions[1]             # <<<<<<<<<<<<<<
  * 
  *         cdef int i
  */
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dimensions, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 968, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dimensions, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 970, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 968, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 970, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_width = __pyx_t_7;
 
-  /* "soapcw/soapcw.pyx":978
+  /* "soapcw/soapcw.pyx":980
  *         cdef double temp
  * 
  *         for i in range(len(shape)-1):             # <<<<<<<<<<<<<<
  *             dimensions.append(n)
  * 
  */
-  __pyx_t_4 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 978, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 980, __pyx_L1_error)
   __pyx_t_8 = (__pyx_t_4 - 1);
   __pyx_t_4 = __pyx_t_8;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_4; __pyx_t_7+=1) {
     __pyx_v_i = __pyx_t_7;
 
-    /* "soapcw/soapcw.pyx":979
+    /* "soapcw/soapcw.pyx":981
  * 
  *         for i in range(len(shape)-1):
  *             dimensions.append(n)             # <<<<<<<<<<<<<<
  * 
  *         dimensions = tuple(dimensions)
  */
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 979, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 981, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_9 = __Pyx_PyObject_Append(__pyx_v_dimensions, __pyx_t_2); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 979, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_Append(__pyx_v_dimensions, __pyx_t_2); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 981, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
 
-  /* "soapcw/soapcw.pyx":981
+  /* "soapcw/soapcw.pyx":983
  *             dimensions.append(n)
  * 
  *         dimensions = tuple(dimensions)             # <<<<<<<<<<<<<<
  * 
  *         val    = np.ones(dimensions)*-1e6
  */
-  __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_v_dimensions); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 981, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_v_dimensions); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 983, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF_SET(__pyx_v_dimensions, __pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":983
+  /* "soapcw/soapcw.pyx":985
  *         dimensions = tuple(dimensions)
  * 
  *         val    = np.ones(dimensions)*-1e6             # <<<<<<<<<<<<<<
  *         prev   = np.ones(dimensions)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 983, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 985, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ones); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 983, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ones); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_3, __pyx_v_dimensions) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_dimensions);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 983, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 985, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_float_neg_1e6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 983, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_float_neg_1e6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_val = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":984
+  /* "soapcw/soapcw.pyx":986
  * 
  *         val    = np.ones(dimensions)*-1e6
  *         prev   = np.ones(dimensions)             # <<<<<<<<<<<<<<
  * 
  *         range_j = list(itertools.product(range(n),repeat=length-1))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 984, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 986, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 984, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 986, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_dimensions) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_dimensions);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 984, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 986, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_prev = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":986
+  /* "soapcw/soapcw.pyx":988
  *         prev   = np.ones(dimensions)
  * 
  *         range_j = list(itertools.product(range(n),repeat=length-1))             # <<<<<<<<<<<<<<
  * 
  *         for i in range(width):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_itertools); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 986, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_itertools); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_product); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 986, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_product); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 986, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 986, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 986, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 986, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = __Pyx_PyInt_From_long((__pyx_v_length - 1)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 986, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_From_long((__pyx_v_length - 1)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_repeat, __pyx_t_6) < 0) __PYX_ERR(0, 986, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_repeat, __pyx_t_6) < 0) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 986, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 986, __pyx_L1_error)
+  __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_range_j = ((PyObject*)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":988
+  /* "soapcw/soapcw.pyx":990
  *         range_j = list(itertools.product(range(n),repeat=length-1))
  * 
  *         for i in range(width):             # <<<<<<<<<<<<<<
  *             for j in range_j:
  *                 val[0][i][j]    = obs[0][i]
  */
   __pyx_t_7 = __pyx_v_width;
   __pyx_t_10 = __pyx_t_7;
   for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
     __pyx_v_i = __pyx_t_11;
 
-    /* "soapcw/soapcw.pyx":989
+    /* "soapcw/soapcw.pyx":991
  * 
  *         for i in range(width):
  *             for j in range_j:             # <<<<<<<<<<<<<<
  *                 val[0][i][j]    = obs[0][i]
  *                 prev[0][i][j]   = np.nan
  */
     __pyx_t_2 = __pyx_v_range_j; __Pyx_INCREF(__pyx_t_2); __pyx_t_8 = 0;
     for (;;) {
       if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_2)) break;
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-      __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_6); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 989, __pyx_L1_error)
+      __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_6); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 991, __pyx_L1_error)
       #else
-      __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 989, __pyx_L1_error)
+      __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 991, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       #endif
       __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_6);
       __pyx_t_6 = 0;
 
-      /* "soapcw/soapcw.pyx":990
+      /* "soapcw/soapcw.pyx":992
  *         for i in range(width):
  *             for j in range_j:
  *                 val[0][i][j]    = obs[0][i]             # <<<<<<<<<<<<<<
  *                 prev[0][i][j]   = np.nan
  * 
  */
-      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_obs, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 990, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_obs, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 992, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 992, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 990, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 992, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 990, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 992, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_v_j, __pyx_t_1) < 0)) __PYX_ERR(0, 990, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_v_j, __pyx_t_1) < 0)) __PYX_ERR(0, 992, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "soapcw/soapcw.pyx":991
+      /* "soapcw/soapcw.pyx":993
  *             for j in range_j:
  *                 val[0][i][j]    = obs[0][i]
  *                 prev[0][i][j]   = np.nan             # <<<<<<<<<<<<<<
  * 
  *         cdef float pbar = 0
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 991, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 993, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_nan); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 991, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_nan); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 993, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_prev, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 991, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_prev, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 993, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 991, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 993, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_t_6, __pyx_v_j, __pyx_t_3) < 0)) __PYX_ERR(0, 991, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_6, __pyx_v_j, __pyx_t_3) < 0)) __PYX_ERR(0, 993, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "soapcw/soapcw.pyx":989
+      /* "soapcw/soapcw.pyx":991
  * 
  *         for i in range(width):
  *             for j in range_j:             # <<<<<<<<<<<<<<
  *                 val[0][i][j]    = obs[0][i]
  *                 prev[0][i][j]   = np.nan
  */
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
 
-  /* "soapcw/soapcw.pyx":993
+  /* "soapcw/soapcw.pyx":995
  *                 prev[0][i][j]   = np.nan
  * 
  *         cdef float pbar = 0             # <<<<<<<<<<<<<<
  *         for t in range(1,length_t):
  *             obst = obs[t]
  */
   __pyx_v_pbar = 0.0;
 
-  /* "soapcw/soapcw.pyx":994
+  /* "soapcw/soapcw.pyx":996
  * 
  *         cdef float pbar = 0
  *         for t in range(1,length_t):             # <<<<<<<<<<<<<<
  *             obst = obs[t]
  *             valt = val[t-1]
  */
   __pyx_t_7 = __pyx_v_length_t;
   __pyx_t_10 = __pyx_t_7;
   for (__pyx_t_11 = 1; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
     __pyx_v_t = __pyx_t_11;
 
-    /* "soapcw/soapcw.pyx":995
+    /* "soapcw/soapcw.pyx":997
  *         cdef float pbar = 0
  *         for t in range(1,length_t):
  *             obst = obs[t]             # <<<<<<<<<<<<<<
  *             valt = val[t-1]
  *             pt = t/float(length_t)*100.
  */
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 995, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_obs, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 997, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_XDECREF_SET(__pyx_v_obst, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":996
+    /* "soapcw/soapcw.pyx":998
  *         for t in range(1,length_t):
  *             obst = obs[t]
  *             valt = val[t-1]             # <<<<<<<<<<<<<<
  *             pt = t/float(length_t)*100.
  *             for i in range(width):
  */
     __pyx_t_12 = (__pyx_v_t - 1);
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_val, __pyx_t_12, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 996, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_val, __pyx_t_12, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 998, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_XDECREF_SET(__pyx_v_valt, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":997
+    /* "soapcw/soapcw.pyx":999
  *             obst = obs[t]
  *             valt = val[t-1]
  *             pt = t/float(length_t)*100.             # <<<<<<<<<<<<<<
  *             for i in range(width):
  *                 for j in range_j:
  */
     if (unlikely(((double)__pyx_v_length_t) == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-      __PYX_ERR(0, 997, __pyx_L1_error)
+      __PYX_ERR(0, 999, __pyx_L1_error)
     }
     __pyx_v_pt = ((((double)__pyx_v_t) / ((double)__pyx_v_length_t)) * 100.);
 
-    /* "soapcw/soapcw.pyx":998
+    /* "soapcw/soapcw.pyx":1000
  *             valt = val[t-1]
  *             pt = t/float(length_t)*100.
  *             for i in range(width):             # <<<<<<<<<<<<<<
  *                 for j in range_j:
  *                     cond = True
  */
     __pyx_t_13 = __pyx_v_width;
     __pyx_t_14 = __pyx_t_13;
     for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
       __pyx_v_i = __pyx_t_15;
 
-      /* "soapcw/soapcw.pyx":999
+      /* "soapcw/soapcw.pyx":1001
  *             pt = t/float(length_t)*100.
  *             for i in range(width):
  *                 for j in range_j:             # <<<<<<<<<<<<<<
  *                     cond = True
  *                     for c in range(1,len(j)+1):
  */
       __pyx_t_2 = __pyx_v_range_j; __Pyx_INCREF(__pyx_t_2); __pyx_t_8 = 0;
       for (;;) {
         if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 999, __pyx_L1_error)
+        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1001, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 999, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1001, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
         __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_3);
         __pyx_t_3 = 0;
 
-        /* "soapcw/soapcw.pyx":1000
+        /* "soapcw/soapcw.pyx":1002
  *             for i in range(width):
  *                 for j in range_j:
  *                     cond = True             # <<<<<<<<<<<<<<
  *                     for c in range(1,len(j)+1):
  *                         b = i+np.sum(j[:c])-len(j[:c])
  */
         __pyx_v_cond = 1;
 
-        /* "soapcw/soapcw.pyx":1001
+        /* "soapcw/soapcw.pyx":1003
  *                 for j in range_j:
  *                     cond = True
  *                     for c in range(1,len(j)+1):             # <<<<<<<<<<<<<<
  *                         b = i+np.sum(j[:c])-len(j[:c])
  *                         if b >= 0 and b<width:
  */
-        __pyx_t_4 = PyObject_Length(__pyx_v_j); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1001, __pyx_L1_error)
+        __pyx_t_4 = PyObject_Length(__pyx_v_j); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1003, __pyx_L1_error)
         __pyx_t_16 = (__pyx_t_4 + 1);
         __pyx_t_4 = __pyx_t_16;
         for (__pyx_t_17 = 1; __pyx_t_17 < __pyx_t_4; __pyx_t_17+=1) {
           __pyx_v_c = __pyx_t_17;
 
-          /* "soapcw/soapcw.pyx":1002
+          /* "soapcw/soapcw.pyx":1004
  *                     cond = True
  *                     for c in range(1,len(j)+1):
  *                         b = i+np.sum(j[:c])-len(j[:c])             # <<<<<<<<<<<<<<
  *                         if b >= 0 and b<width:
  *                             continue
  */
-          __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1002, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1004, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1002, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1004, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1002, __pyx_L1_error)
+          __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1004, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_18);
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_j, 0, __pyx_v_c, NULL, NULL, NULL, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1002, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_j, 0, __pyx_v_c, NULL, NULL, NULL, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1004, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __pyx_t_19 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_18))) {
             __pyx_t_19 = PyMethod_GET_SELF(__pyx_t_18);
             if (likely(__pyx_t_19)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
               __Pyx_INCREF(__pyx_t_19);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_18, function);
             }
           }
           __pyx_t_6 = (__pyx_t_19) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_19, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_t_1);
           __Pyx_XDECREF(__pyx_t_19); __pyx_t_19 = 0;
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1002, __pyx_L1_error)
+          if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1004, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-          __pyx_t_18 = PyNumber_Add(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1002, __pyx_L1_error)
+          __pyx_t_18 = PyNumber_Add(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1004, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_18);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_v_j, 0, __pyx_v_c, NULL, NULL, NULL, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1002, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_v_j, 0, __pyx_v_c, NULL, NULL, NULL, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1004, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_20 = PyObject_Length(__pyx_t_6); if (unlikely(__pyx_t_20 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1002, __pyx_L1_error)
+          __pyx_t_20 = PyObject_Length(__pyx_t_6); if (unlikely(__pyx_t_20 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1004, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_20); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1002, __pyx_L1_error)
+          __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_20); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1004, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_3 = PyNumber_Subtract(__pyx_t_18, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1002, __pyx_L1_error)
+          __pyx_t_3 = PyNumber_Subtract(__pyx_t_18, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1004, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_XDECREF_SET(__pyx_v_b, __pyx_t_3);
           __pyx_t_3 = 0;
 
-          /* "soapcw/soapcw.pyx":1003
+          /* "soapcw/soapcw.pyx":1005
  *                     for c in range(1,len(j)+1):
  *                         b = i+np.sum(j[:c])-len(j[:c])
  *                         if b >= 0 and b<width:             # <<<<<<<<<<<<<<
  *                             continue
  *                         else:
  */
-          __pyx_t_3 = PyObject_RichCompare(__pyx_v_b, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1003, __pyx_L1_error)
-          __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 1003, __pyx_L1_error)
+          __pyx_t_3 = PyObject_RichCompare(__pyx_v_b, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1005, __pyx_L1_error)
+          __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 1005, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           if (__pyx_t_21) {
           } else {
             __pyx_t_5 = __pyx_t_21;
             goto __pyx_L19_bool_binop_done;
           }
-          __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_width); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1003, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_width); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1005, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_6 = PyObject_RichCompare(__pyx_v_b, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1003, __pyx_L1_error)
+          __pyx_t_6 = PyObject_RichCompare(__pyx_v_b, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1005, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 1003, __pyx_L1_error)
+          __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 1005, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_5 = __pyx_t_21;
           __pyx_L19_bool_binop_done:;
           if (__pyx_t_5) {
 
-            /* "soapcw/soapcw.pyx":1004
+            /* "soapcw/soapcw.pyx":1006
  *                         b = i+np.sum(j[:c])-len(j[:c])
  *                         if b >= 0 and b<width:
  *                             continue             # <<<<<<<<<<<<<<
  *                         else:
  *                             cond = False
  */
             goto __pyx_L16_continue;
 
-            /* "soapcw/soapcw.pyx":1003
+            /* "soapcw/soapcw.pyx":1005
  *                     for c in range(1,len(j)+1):
  *                         b = i+np.sum(j[:c])-len(j[:c])
  *                         if b >= 0 and b<width:             # <<<<<<<<<<<<<<
  *                             continue
  *                         else:
  */
           }
 
-          /* "soapcw/soapcw.pyx":1006
+          /* "soapcw/soapcw.pyx":1008
  *                             continue
  *                         else:
  *                             cond = False             # <<<<<<<<<<<<<<
  *                             break
  *                     if cond:
  */
           /*else*/ {
             __pyx_v_cond = 0;
 
-            /* "soapcw/soapcw.pyx":1007
+            /* "soapcw/soapcw.pyx":1009
  *                         else:
  *                             cond = False
  *                             break             # <<<<<<<<<<<<<<
  *                     if cond:
  *                         temp = -1e6
  */
             goto __pyx_L17_break;
           }
           __pyx_L16_continue:;
         }
         __pyx_L17_break:;
 
-        /* "soapcw/soapcw.pyx":1008
+        /* "soapcw/soapcw.pyx":1010
  *                             cond = False
  *                             break
  *                     if cond:             # <<<<<<<<<<<<<<
  *                         temp = -1e6
  *                         for k in range(n):
  */
         __pyx_t_5 = (__pyx_v_cond != 0);
         if (__pyx_t_5) {
 
-          /* "soapcw/soapcw.pyx":1009
+          /* "soapcw/soapcw.pyx":1011
  *                             break
  *                     if cond:
  *                         temp = -1e6             # <<<<<<<<<<<<<<
  *                         for k in range(n):
  *                             m = list(j[1:])
  */
           __pyx_v_temp = -1e6;
 
-          /* "soapcw/soapcw.pyx":1010
+          /* "soapcw/soapcw.pyx":1012
  *                     if cond:
  *                         temp = -1e6
  *                         for k in range(n):             # <<<<<<<<<<<<<<
  *                             m = list(j[1:])
  *                             m.append(k)
  */
           __pyx_t_17 = __pyx_v_n;
           __pyx_t_22 = __pyx_t_17;
           for (__pyx_t_23 = 0; __pyx_t_23 < __pyx_t_22; __pyx_t_23+=1) {
             __pyx_v_k = __pyx_t_23;
 
-            /* "soapcw/soapcw.pyx":1011
+            /* "soapcw/soapcw.pyx":1013
  *                         temp = -1e6
  *                         for k in range(n):
  *                             m = list(j[1:])             # <<<<<<<<<<<<<<
  *                             m.append(k)
  *                             if t<length:
  */
-            __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_v_j, 1, 0, NULL, NULL, &__pyx_slice__8, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1011, __pyx_L1_error)
+            __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_v_j, 1, 0, NULL, NULL, &__pyx_slice__8, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1013, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_3 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1011, __pyx_L1_error)
+            __pyx_t_3 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1013, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
             __Pyx_XDECREF_SET(__pyx_v_m, __pyx_t_3);
             __pyx_t_3 = 0;
 
-            /* "soapcw/soapcw.pyx":1012
+            /* "soapcw/soapcw.pyx":1014
  *                         for k in range(n):
  *                             m = list(j[1:])
  *                             m.append(k)             # <<<<<<<<<<<<<<
  *                             if t<length:
  *                                 for n1 in range(len(m)):
  */
-            __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1012, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1014, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_9 = __Pyx_PyObject_Append(__pyx_v_m, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 1012, __pyx_L1_error)
+            __pyx_t_9 = __Pyx_PyObject_Append(__pyx_v_m, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 1014, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-            /* "soapcw/soapcw.pyx":1013
+            /* "soapcw/soapcw.pyx":1015
  *                             m = list(j[1:])
  *                             m.append(k)
  *                             if t<length:             # <<<<<<<<<<<<<<
  *                                 for n1 in range(len(m)):
  *                                     if n1>=t-1:
  */
             __pyx_t_5 = ((__pyx_v_t < __pyx_v_length) != 0);
             if (__pyx_t_5) {
 
-              /* "soapcw/soapcw.pyx":1014
+              /* "soapcw/soapcw.pyx":1016
  *                             m.append(k)
  *                             if t<length:
  *                                 for n1 in range(len(m)):             # <<<<<<<<<<<<<<
  *                                     if n1>=t-1:
  *                                         m[n1] = 1
  */
-              __pyx_t_16 = PyObject_Length(__pyx_v_m); if (unlikely(__pyx_t_16 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1014, __pyx_L1_error)
+              __pyx_t_16 = PyObject_Length(__pyx_v_m); if (unlikely(__pyx_t_16 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1016, __pyx_L1_error)
               __pyx_t_4 = __pyx_t_16;
               for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_4; __pyx_t_20+=1) {
                 __pyx_v_n1 = __pyx_t_20;
 
-                /* "soapcw/soapcw.pyx":1015
+                /* "soapcw/soapcw.pyx":1017
  *                             if t<length:
  *                                 for n1 in range(len(m)):
  *                                     if n1>=t-1:             # <<<<<<<<<<<<<<
  *                                         m[n1] = 1
  *                             m = tuple(m)
  */
                 __pyx_t_5 = ((__pyx_v_n1 >= (__pyx_v_t - 1)) != 0);
                 if (__pyx_t_5) {
 
-                  /* "soapcw/soapcw.pyx":1016
+                  /* "soapcw/soapcw.pyx":1018
  *                                 for n1 in range(len(m)):
  *                                     if n1>=t-1:
  *                                         m[n1] = 1             # <<<<<<<<<<<<<<
  *                             m = tuple(m)
  *                             value = obst[i] + tr[j[0]][m] + valt[i+j[0]-1][m]
  */
-                  if (unlikely(__Pyx_SetItemInt(__pyx_v_m, __pyx_v_n1, __pyx_int_1, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) < 0)) __PYX_ERR(0, 1016, __pyx_L1_error)
+                  if (unlikely(__Pyx_SetItemInt(__pyx_v_m, __pyx_v_n1, __pyx_int_1, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) < 0)) __PYX_ERR(0, 1018, __pyx_L1_error)
 
-                  /* "soapcw/soapcw.pyx":1015
+                  /* "soapcw/soapcw.pyx":1017
  *                             if t<length:
  *                                 for n1 in range(len(m)):
  *                                     if n1>=t-1:             # <<<<<<<<<<<<<<
  *                                         m[n1] = 1
  *                             m = tuple(m)
  */
                 }
               }
 
-              /* "soapcw/soapcw.pyx":1013
+              /* "soapcw/soapcw.pyx":1015
  *                             m = list(j[1:])
  *                             m.append(k)
  *                             if t<length:             # <<<<<<<<<<<<<<
  *                                 for n1 in range(len(m)):
  *                                     if n1>=t-1:
  */
             }
 
-            /* "soapcw/soapcw.pyx":1017
+            /* "soapcw/soapcw.pyx":1019
  *                                     if n1>=t-1:
  *                                         m[n1] = 1
  *                             m = tuple(m)             # <<<<<<<<<<<<<<
  *                             value = obst[i] + tr[j[0]][m] + valt[i+j[0]-1][m]
  * 
  */
-            __pyx_t_3 = __Pyx_PySequence_Tuple(__pyx_v_m); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1017, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_PySequence_Tuple(__pyx_v_m); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1019, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF_SET(__pyx_v_m, __pyx_t_3);
             __pyx_t_3 = 0;
 
-            /* "soapcw/soapcw.pyx":1018
+            /* "soapcw/soapcw.pyx":1020
  *                                         m[n1] = 1
  *                             m = tuple(m)
  *                             value = obst[i] + tr[j[0]][m] + valt[i+j[0]-1][m]             # <<<<<<<<<<<<<<
  * 
  * 
  */
-            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obst, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_obst, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_j, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_j, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_18 = __Pyx_PyObject_GetItem(__pyx_v_tr, __pyx_t_6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_18 = __Pyx_PyObject_GetItem(__pyx_v_tr, __pyx_t_6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_18);
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-            __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_18, __pyx_v_m); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_18, __pyx_v_m); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
             __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-            __pyx_t_18 = PyNumber_Add(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_18 = PyNumber_Add(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_18);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-            __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_j, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_j, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_1 = PyNumber_Add(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_1 = PyNumber_Add(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_valt, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_valt, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_m); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_m); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __pyx_t_1 = PyNumber_Add(__pyx_t_18, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_1 = PyNumber_Add(__pyx_t_18, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            __pyx_t_24 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_24 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1018, __pyx_L1_error)
+            __pyx_t_24 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_24 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1020, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
             __pyx_v_value = __pyx_t_24;
 
-            /* "soapcw/soapcw.pyx":1021
+            /* "soapcw/soapcw.pyx":1023
  * 
  * 
  *                             if value>temp:             # <<<<<<<<<<<<<<
  *                                 temp = value
  *                                 val[t][i][j] = temp
  */
             __pyx_t_5 = ((__pyx_v_value > __pyx_v_temp) != 0);
             if (__pyx_t_5) {
 
-              /* "soapcw/soapcw.pyx":1022
+              /* "soapcw/soapcw.pyx":1024
  * 
  *                             if value>temp:
  *                                 temp = value             # <<<<<<<<<<<<<<
  *                                 val[t][i][j] = temp
  *                                 prev[t][i][j] = k
  */
               __pyx_v_temp = __pyx_v_value;
 
-              /* "soapcw/soapcw.pyx":1023
+              /* "soapcw/soapcw.pyx":1025
  *                             if value>temp:
  *                                 temp = value
  *                                 val[t][i][j] = temp             # <<<<<<<<<<<<<<
  *                                 prev[t][i][j] = k
  * 
  */
-              __pyx_t_1 = PyFloat_FromDouble(__pyx_v_temp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1023, __pyx_L1_error)
+              __pyx_t_1 = PyFloat_FromDouble(__pyx_v_temp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1025, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_1);
-              __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_val, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1023, __pyx_L1_error)
+              __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_val, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1025, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_3);
-              __pyx_t_18 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1023, __pyx_L1_error)
+              __pyx_t_18 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1025, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_18);
               __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-              if (unlikely(PyObject_SetItem(__pyx_t_18, __pyx_v_j, __pyx_t_1) < 0)) __PYX_ERR(0, 1023, __pyx_L1_error)
+              if (unlikely(PyObject_SetItem(__pyx_t_18, __pyx_v_j, __pyx_t_1) < 0)) __PYX_ERR(0, 1025, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
               __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-              /* "soapcw/soapcw.pyx":1024
+              /* "soapcw/soapcw.pyx":1026
  *                                 temp = value
  *                                 val[t][i][j] = temp
  *                                 prev[t][i][j] = k             # <<<<<<<<<<<<<<
  * 
  *             if self.prog == True:
  */
-              __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1024, __pyx_L1_error)
+              __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1026, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_1);
-              __pyx_t_18 = __Pyx_GetItemInt(__pyx_v_prev, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1024, __pyx_L1_error)
+              __pyx_t_18 = __Pyx_GetItemInt(__pyx_v_prev, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1026, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_18);
-              __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_18, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
+              __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_18, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1026, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_3);
               __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-              if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_v_j, __pyx_t_1) < 0)) __PYX_ERR(0, 1024, __pyx_L1_error)
+              if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_v_j, __pyx_t_1) < 0)) __PYX_ERR(0, 1026, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
               __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-              /* "soapcw/soapcw.pyx":1021
+              /* "soapcw/soapcw.pyx":1023
  * 
  * 
  *                             if value>temp:             # <<<<<<<<<<<<<<
  *                                 temp = value
  *                                 val[t][i][j] = temp
  */
             }
           }
 
-          /* "soapcw/soapcw.pyx":1008
+          /* "soapcw/soapcw.pyx":1010
  *                             cond = False
  *                             break
  *                     if cond:             # <<<<<<<<<<<<<<
  *                         temp = -1e6
  *                         for k in range(n):
  */
         }
 
-        /* "soapcw/soapcw.pyx":999
+        /* "soapcw/soapcw.pyx":1001
  *             pt = t/float(length_t)*100.
  *             for i in range(width):
  *                 for j in range_j:             # <<<<<<<<<<<<<<
  *                     cond = True
  *                     for c in range(1,len(j)+1):
  */
       }
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
 
-    /* "soapcw/soapcw.pyx":1026
+    /* "soapcw/soapcw.pyx":1028
  *                                 prev[t][i][j] = k
  * 
  *             if self.prog == True:             # <<<<<<<<<<<<<<
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prog); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1026, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prog); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1028, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1026, __pyx_L1_error)
+    __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1028, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1026, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1028, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_5) {
 
-      /* "soapcw/soapcw.pyx":1027
+      /* "soapcw/soapcw.pyx":1029
  * 
  *             if self.prog == True:
  *                 if pt>pbar:             # <<<<<<<<<<<<<<
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  */
       __pyx_t_5 = ((__pyx_v_pt > __pyx_v_pbar) != 0);
       if (__pyx_t_5) {
 
-        /* "soapcw/soapcw.pyx":1028
+        /* "soapcw/soapcw.pyx":1030
  *             if self.prog == True:
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))             # <<<<<<<<<<<<<<
  *                     stdout.flush()
  *                     pbar+=100./length_t
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_stdout); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1028, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_stdout); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1030, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1028, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1030, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u__4, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1028, __pyx_L1_error)
+        __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u__4, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1030, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
-        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1028, __pyx_L1_error)
+        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1030, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_19 = __Pyx_PyObject_CallOneArg(__pyx_builtin_round, __pyx_t_6); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1028, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyObject_CallOneArg(__pyx_builtin_round, __pyx_t_6); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1030, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_t_6 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_18))) {
           __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_18);
           if (likely(__pyx_t_6)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
@@ -20606,15 +20765,15 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_18, function);
           }
         }
         __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_6, __pyx_t_19) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_t_19);
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1028, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1030, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
         __pyx_t_18 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_18)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -20622,488 +20781,488 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_1 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_18, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
         __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1028, __pyx_L1_error)
+        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1030, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-        /* "soapcw/soapcw.pyx":1029
+        /* "soapcw/soapcw.pyx":1031
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()             # <<<<<<<<<<<<<<
  *                     pbar+=100./length_t
  * 
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_stdout); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1029, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_stdout); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1031, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_flush); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1029, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_flush); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_t_3 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
           __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
           if (likely(__pyx_t_3)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
             __Pyx_INCREF(__pyx_t_3);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_2, function);
           }
         }
         __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1029, __pyx_L1_error)
+        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1031, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-        /* "soapcw/soapcw.pyx":1030
+        /* "soapcw/soapcw.pyx":1032
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  *                     pbar+=100./length_t             # <<<<<<<<<<<<<<
  * 
  *         cdef int previous   = 1
  */
         if (unlikely(__pyx_v_length_t == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-          __PYX_ERR(0, 1030, __pyx_L1_error)
+          __PYX_ERR(0, 1032, __pyx_L1_error)
         }
         __pyx_v_pbar = (__pyx_v_pbar + (100. / ((double)__pyx_v_length_t)));
 
-        /* "soapcw/soapcw.pyx":1027
+        /* "soapcw/soapcw.pyx":1029
  * 
  *             if self.prog == True:
  *                 if pt>pbar:             # <<<<<<<<<<<<<<
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  */
       }
 
-      /* "soapcw/soapcw.pyx":1026
+      /* "soapcw/soapcw.pyx":1028
  *                                 prev[t][i][j] = k
  * 
  *             if self.prog == True:             # <<<<<<<<<<<<<<
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  */
     }
   }
 
-  /* "soapcw/soapcw.pyx":1032
+  /* "soapcw/soapcw.pyx":1034
  *                     pbar+=100./length_t
  * 
  *         cdef int previous   = 1             # <<<<<<<<<<<<<<
  *         previous_1 = None
  *         vit_track   = [0]
  */
   __pyx_v_previous = 1;
 
-  /* "soapcw/soapcw.pyx":1033
+  /* "soapcw/soapcw.pyx":1035
  * 
  *         cdef int previous   = 1
  *         previous_1 = None             # <<<<<<<<<<<<<<
  *         vit_track   = [0]
  * 
  */
   __Pyx_INCREF(Py_None);
   __pyx_v_previous_1 = Py_None;
 
-  /* "soapcw/soapcw.pyx":1034
+  /* "soapcw/soapcw.pyx":1036
  *         cdef int previous   = 1
  *         previous_1 = None
  *         vit_track   = [0]             # <<<<<<<<<<<<<<
  * 
  *         #cdef double max_end_prob = max(val[length-1][i] for i in range(width))
  */
-  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1036, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
   __pyx_v_vit_track = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1038
+  /* "soapcw/soapcw.pyx":1040
  *         #cdef double max_end_prob = max(val[length-1][i] for i in range(width))
  * 
  *         temp = -1e6             # <<<<<<<<<<<<<<
  *         for i in range(width):
  *             for j in range_j:
  */
   __pyx_v_temp = -1e6;
 
-  /* "soapcw/soapcw.pyx":1039
+  /* "soapcw/soapcw.pyx":1041
  * 
  *         temp = -1e6
  *         for i in range(width):             # <<<<<<<<<<<<<<
  *             for j in range_j:
  *                 value = val[-1][i][j]
  */
   __pyx_t_7 = __pyx_v_width;
   __pyx_t_10 = __pyx_t_7;
   for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
     __pyx_v_i = __pyx_t_11;
 
-    /* "soapcw/soapcw.pyx":1040
+    /* "soapcw/soapcw.pyx":1042
  *         temp = -1e6
  *         for i in range(width):
  *             for j in range_j:             # <<<<<<<<<<<<<<
  *                 value = val[-1][i][j]
  *                 if value>temp:
  */
     __pyx_t_1 = __pyx_v_range_j; __Pyx_INCREF(__pyx_t_1); __pyx_t_8 = 0;
     for (;;) {
       if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_1)) break;
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_2); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1040, __pyx_L1_error)
+      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_2); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1042, __pyx_L1_error)
       #else
-      __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1040, __pyx_L1_error)
+      __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1042, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       #endif
       __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_2);
       __pyx_t_2 = 0;
 
-      /* "soapcw/soapcw.pyx":1041
+      /* "soapcw/soapcw.pyx":1043
  *         for i in range(width):
  *             for j in range_j:
  *                 value = val[-1][i][j]             # <<<<<<<<<<<<<<
  *                 if value>temp:
  *                     temp = value
  */
-      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_val, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1041, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_val, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1043, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1041, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1043, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1041, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1043, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_24 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_24 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1041, __pyx_L1_error)
+      __pyx_t_24 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_24 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1043, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_v_value = __pyx_t_24;
 
-      /* "soapcw/soapcw.pyx":1042
+      /* "soapcw/soapcw.pyx":1044
  *             for j in range_j:
  *                 value = val[-1][i][j]
  *                 if value>temp:             # <<<<<<<<<<<<<<
  *                     temp = value
  *                     vit_track[0] = i
  */
       __pyx_t_5 = ((__pyx_v_value > __pyx_v_temp) != 0);
       if (__pyx_t_5) {
 
-        /* "soapcw/soapcw.pyx":1043
+        /* "soapcw/soapcw.pyx":1045
  *                 value = val[-1][i][j]
  *                 if value>temp:
  *                     temp = value             # <<<<<<<<<<<<<<
  *                     vit_track[0] = i
  *                     previous = i
  */
         __pyx_v_temp = __pyx_v_value;
 
-        /* "soapcw/soapcw.pyx":1044
+        /* "soapcw/soapcw.pyx":1046
  *                 if value>temp:
  *                     temp = value
  *                     vit_track[0] = i             # <<<<<<<<<<<<<<
  *                     previous = i
  *                     previous_1 = j
  */
-        __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1044, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1046, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_vit_track, 0, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 1044, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_vit_track, 0, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 1046, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-        /* "soapcw/soapcw.pyx":1045
+        /* "soapcw/soapcw.pyx":1047
  *                     temp = value
  *                     vit_track[0] = i
  *                     previous = i             # <<<<<<<<<<<<<<
  *                     previous_1 = j
  *                     previous_2 = int(prev[-1][i][j])
  */
         __pyx_v_previous = __pyx_v_i;
 
-        /* "soapcw/soapcw.pyx":1046
+        /* "soapcw/soapcw.pyx":1048
  *                     vit_track[0] = i
  *                     previous = i
  *                     previous_1 = j             # <<<<<<<<<<<<<<
  *                     previous_2 = int(prev[-1][i][j])
  * 
  */
         __Pyx_INCREF(__pyx_v_j);
         __Pyx_DECREF_SET(__pyx_v_previous_1, __pyx_v_j);
 
-        /* "soapcw/soapcw.pyx":1047
+        /* "soapcw/soapcw.pyx":1049
  *                     previous = i
  *                     previous_1 = j
  *                     previous_2 = int(prev[-1][i][j])             # <<<<<<<<<<<<<<
  * 
  * 
  */
-        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_prev, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1047, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_prev, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1047, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1047, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1047, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF_SET(__pyx_v_previous_2, __pyx_t_3);
         __pyx_t_3 = 0;
 
-        /* "soapcw/soapcw.pyx":1042
+        /* "soapcw/soapcw.pyx":1044
  *             for j in range_j:
  *                 value = val[-1][i][j]
  *                 if value>temp:             # <<<<<<<<<<<<<<
  *                     temp = value
  *                     vit_track[0] = i
  */
       }
 
-      /* "soapcw/soapcw.pyx":1040
+      /* "soapcw/soapcw.pyx":1042
  *         temp = -1e6
  *         for i in range(width):
  *             for j in range_j:             # <<<<<<<<<<<<<<
  *                 value = val[-1][i][j]
  *                 if value>temp:
  */
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
 
-  /* "soapcw/soapcw.pyx":1050
+  /* "soapcw/soapcw.pyx":1052
  * 
  * 
  *         for t in range(length_t-2,-1,-1):             # <<<<<<<<<<<<<<
  *             vit_track.append(previous+previous_1[0]-1)
  *             previous += previous_1[0]-1
  */
   for (__pyx_t_7 = (__pyx_v_length_t - 2); __pyx_t_7 > -1; __pyx_t_7-=1) {
     __pyx_v_t = __pyx_t_7;
 
-    /* "soapcw/soapcw.pyx":1051
+    /* "soapcw/soapcw.pyx":1053
  * 
  *         for t in range(length_t-2,-1,-1):
  *             vit_track.append(previous+previous_1[0]-1)             # <<<<<<<<<<<<<<
  *             previous += previous_1[0]-1
  *             previous_1 = list(previous_1[1:])
  */
-    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_previous); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1051, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_previous); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1053, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_previous_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1051, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_previous_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1053, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1051, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1053, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1051, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1053, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_vit_track, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 1051, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_vit_track, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 1053, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "soapcw/soapcw.pyx":1052
+    /* "soapcw/soapcw.pyx":1054
  *         for t in range(length_t-2,-1,-1):
  *             vit_track.append(previous+previous_1[0]-1)
  *             previous += previous_1[0]-1             # <<<<<<<<<<<<<<
  *             previous_1 = list(previous_1[1:])
  *             previous_1.append(int(previous_2))
  */
-    __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_previous); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_previous); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1054, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_previous_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_previous_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1054, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1054, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1054, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_10 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1054, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_previous = __pyx_t_10;
 
-    /* "soapcw/soapcw.pyx":1053
+    /* "soapcw/soapcw.pyx":1055
  *             vit_track.append(previous+previous_1[0]-1)
  *             previous += previous_1[0]-1
  *             previous_1 = list(previous_1[1:])             # <<<<<<<<<<<<<<
  *             previous_1.append(int(previous_2))
  *             previous_1 = tuple(previous_1)
  */
-    __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_previous_1, 1, 0, NULL, NULL, &__pyx_slice__8, 1, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1053, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_previous_1, 1, 0, NULL, NULL, &__pyx_slice__8, 1, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1055, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1053, __pyx_L1_error)
+    __pyx_t_1 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF_SET(__pyx_v_previous_1, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":1054
+    /* "soapcw/soapcw.pyx":1056
  *             previous += previous_1[0]-1
  *             previous_1 = list(previous_1[1:])
  *             previous_1.append(int(previous_2))             # <<<<<<<<<<<<<<
  *             previous_1 = tuple(previous_1)
  *             previous_2 = prev[t][previous][previous_1]
  */
-    if (unlikely(!__pyx_v_previous_2)) { __Pyx_RaiseUnboundLocalError("previous_2"); __PYX_ERR(0, 1054, __pyx_L1_error) }
-    __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_v_previous_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1054, __pyx_L1_error)
+    if (unlikely(!__pyx_v_previous_2)) { __Pyx_RaiseUnboundLocalError("previous_2"); __PYX_ERR(0, 1056, __pyx_L1_error) }
+    __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_v_previous_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1056, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = __Pyx_PyObject_Append(__pyx_v_previous_1, __pyx_t_1); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 1054, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_Append(__pyx_v_previous_1, __pyx_t_1); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 1056, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":1055
+    /* "soapcw/soapcw.pyx":1057
  *             previous_1 = list(previous_1[1:])
  *             previous_1.append(int(previous_2))
  *             previous_1 = tuple(previous_1)             # <<<<<<<<<<<<<<
  *             previous_2 = prev[t][previous][previous_1]
  * 
  */
-    __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_v_previous_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_v_previous_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1057, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF_SET(__pyx_v_previous_1, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":1056
+    /* "soapcw/soapcw.pyx":1058
  *             previous_1.append(int(previous_2))
  *             previous_1 = tuple(previous_1)
  *             previous_2 = prev[t][previous][previous_1]             # <<<<<<<<<<<<<<
  * 
  *         vit_track = vit_track[::-1]
  */
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_prev, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1056, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_prev, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_previous, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1056, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_previous, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1058, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_previous_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1056, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_previous_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF_SET(__pyx_v_previous_2, __pyx_t_1);
     __pyx_t_1 = 0;
   }
 
-  /* "soapcw/soapcw.pyx":1058
+  /* "soapcw/soapcw.pyx":1060
  *             previous_2 = prev[t][previous][previous_1]
  * 
  *         vit_track = vit_track[::-1]             # <<<<<<<<<<<<<<
  * 
  *         self.vit_track = np.array(vit_track)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_vit_track, __pyx_slice__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_vit_track, __pyx_slice__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF_SET(__pyx_v_vit_track, ((PyObject*)__pyx_t_1));
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1060
+  /* "soapcw/soapcw.pyx":1062
  *         vit_track = vit_track[::-1]
  * 
  *         self.vit_track = np.array(vit_track)             # <<<<<<<<<<<<<<
  *         self.V = np.array(val)
  *         self.prev = np.array(prev)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1060, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1060, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_vit_track) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_vit_track);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1060, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track, __pyx_t_1) < 0) __PYX_ERR(0, 1060, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track, __pyx_t_1) < 0) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1061
+  /* "soapcw/soapcw.pyx":1063
  * 
  *         self.vit_track = np.array(vit_track)
  *         self.V = np.array(val)             # <<<<<<<<<<<<<<
  *         self.prev = np.array(prev)
  *         self.max_end_prob = None # needs to be fixed
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_val) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_val);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_V, __pyx_t_1) < 0) __PYX_ERR(0, 1061, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_V, __pyx_t_1) < 0) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1062
+  /* "soapcw/soapcw.pyx":1064
  *         self.vit_track = np.array(vit_track)
  *         self.V = np.array(val)
  *         self.prev = np.array(prev)             # <<<<<<<<<<<<<<
  *         self.max_end_prob = None # needs to be fixed
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1064, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1064, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_prev) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_prev);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1064, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prev, __pyx_t_1) < 0) __PYX_ERR(0, 1062, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prev, __pyx_t_1) < 0) __PYX_ERR(0, 1064, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1063
+  /* "soapcw/soapcw.pyx":1065
  *         self.V = np.array(val)
  *         self.prev = np.array(prev)
  *         self.max_end_prob = None # needs to be fixed             # <<<<<<<<<<<<<<
  * 
  *         #return (vit_track,val,prev)
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_max_end_prob, Py_None) < 0) __PYX_ERR(0, 1063, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_max_end_prob, Py_None) < 0) __PYX_ERR(0, 1065, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":930
+  /* "soapcw/soapcw.pyx":932
  *     #------------------------------------------------------------------------
  * 
  *     def run(self, tr, obs):             # <<<<<<<<<<<<<<
  *         ''' Run viterbi algroithm with memory of n
  *         the amount of memory is determined by the transition matrix
  */
 
@@ -21135,15 +21294,15 @@
   __Pyx_XDECREF(__pyx_v_vit_track);
   __Pyx_XDECREF(__pyx_v_previous_2);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":1069
+/* "soapcw/soapcw.pyx":1071
  * class two_detector_mem_n(object):
  * 
  *     def __init__(self, tr, obs1, obs2, prog = False):             # <<<<<<<<<<<<<<
  *         '''
  *         initialising viterbi class
  */
 
@@ -21153,14 +21312,17 @@
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_18two_detector_mem_n_1__init__ = {"__init__", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_18two_detector_mem_n_1__init__, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6soapcw_6soapcw_18two_detector_mem_n___init__};
 static PyObject *__pyx_pw_6soapcw_6soapcw_18two_detector_mem_n_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_tr = 0;
   PyObject *__pyx_v_obs1 = 0;
   PyObject *__pyx_v_obs2 = 0;
   PyObject *__pyx_v_prog = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr,&__pyx_n_s_obs1,&__pyx_n_s_obs2,&__pyx_n_s_prog,0};
     PyObject* values[5] = {0,0,0,0,0};
     values[4] = ((PyObject *)((PyObject *)Py_False));
@@ -21186,37 +21348,37 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, 1); __PYX_ERR(0, 1069, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, 1); __PYX_ERR(0, 1071, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, 2); __PYX_ERR(0, 1069, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, 2); __PYX_ERR(0, 1071, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, 3); __PYX_ERR(0, 1069, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, 3); __PYX_ERR(0, 1071, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_prog);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1069, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1071, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -21230,15 +21392,15 @@
     __pyx_v_tr = values[1];
     __pyx_v_obs1 = values[2];
     __pyx_v_obs2 = values[3];
     __pyx_v_prog = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1069, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1071, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.two_detector_mem_n.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_18two_detector_mem_n___init__(__pyx_self, __pyx_v_self, __pyx_v_tr, __pyx_v_obs1, __pyx_v_obs2, __pyx_v_prog);
 
@@ -21251,33 +21413,36 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "soapcw/soapcw.pyx":1073
+  /* "soapcw/soapcw.pyx":1075
  *         initialising viterbi class
  *         '''
  *         self.prog = prog             # <<<<<<<<<<<<<<
  *         self.tracks = self.run(tr, obs1, obs2)
  * 
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prog, __pyx_v_prog) < 0) __PYX_ERR(0, 1073, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prog, __pyx_v_prog) < 0) __PYX_ERR(0, 1075, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":1074
+  /* "soapcw/soapcw.pyx":1076
  *         '''
  *         self.prog = prog
  *         self.tracks = self.run(tr, obs1, obs2)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_run); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1074, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_run); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1076, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -21286,51 +21451,51 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_tr, __pyx_v_obs1, __pyx_v_obs2};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1074, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1076, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_tr, __pyx_v_obs1, __pyx_v_obs2};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1074, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1076, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1074, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1076, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_3) {
       __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
     }
     __Pyx_INCREF(__pyx_v_tr);
     __Pyx_GIVEREF(__pyx_v_tr);
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_tr);
     __Pyx_INCREF(__pyx_v_obs1);
     __Pyx_GIVEREF(__pyx_v_obs1);
     PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_obs1);
     __Pyx_INCREF(__pyx_v_obs2);
     __Pyx_GIVEREF(__pyx_v_obs2);
     PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_4, __pyx_v_obs2);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1074, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1076, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tracks, __pyx_t_1) < 0) __PYX_ERR(0, 1074, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tracks, __pyx_t_1) < 0) __PYX_ERR(0, 1076, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1069
+  /* "soapcw/soapcw.pyx":1071
  * class two_detector_mem_n(object):
  * 
  *     def __init__(self, tr, obs1, obs2, prog = False):             # <<<<<<<<<<<<<<
  *         '''
  *         initialising viterbi class
  */
 
@@ -21346,15 +21511,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":1082
+/* "soapcw/soapcw.pyx":1084
  * 
  * 
  *     def run(self, tr, obs11, obs22):             # <<<<<<<<<<<<<<
  *         ''' Run viterbi algroithm with memory of n
  *         the amount of memory is determined by the transition matrix
  */
 
@@ -21363,14 +21528,17 @@
 static char __pyx_doc_6soapcw_6soapcw_18two_detector_mem_n_2run[] = " Run viterbi algroithm with memory of n\n        the amount of memory is determined by the transition matrix\n        args\n        -------\n        tr : transition matrix, any dimension greater that 1 - type: array\n        obs: observation - type: array\n        \n        returns\n        -------\n        vit_track: optimum path through data\n        ";
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_18two_detector_mem_n_3run = {"run", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_18two_detector_mem_n_3run, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6soapcw_6soapcw_18two_detector_mem_n_2run};
 static PyObject *__pyx_pw_6soapcw_6soapcw_18two_detector_mem_n_3run(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_tr = 0;
   PyObject *__pyx_v_obs11 = 0;
   PyObject *__pyx_v_obs22 = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("run (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr,&__pyx_n_s_obs11,&__pyx_n_s_obs22,0};
     PyObject* values[4] = {0,0,0,0};
     if (unlikely(__pyx_kwds)) {
@@ -21393,31 +21561,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run", 1, 4, 4, 1); __PYX_ERR(0, 1082, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run", 1, 4, 4, 1); __PYX_ERR(0, 1084, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs11)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run", 1, 4, 4, 2); __PYX_ERR(0, 1082, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run", 1, 4, 4, 2); __PYX_ERR(0, 1084, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs22)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("run", 1, 4, 4, 3); __PYX_ERR(0, 1082, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("run", 1, 4, 4, 3); __PYX_ERR(0, 1084, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "run") < 0)) __PYX_ERR(0, 1082, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "run") < 0)) __PYX_ERR(0, 1084, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -21426,15 +21594,15 @@
     __pyx_v_self = values[0];
     __pyx_v_tr = values[1];
     __pyx_v_obs11 = values[2];
     __pyx_v_obs22 = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("run", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1082, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("run", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1084, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.two_detector_mem_n.run", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_18two_detector_mem_n_2run(__pyx_self, __pyx_v_self, __pyx_v_tr, __pyx_v_obs11, __pyx_v_obs22);
 
@@ -21520,207 +21688,210 @@
   Py_ssize_t __pyx_t_34;
   Py_ssize_t __pyx_t_35;
   int __pyx_t_36;
   int __pyx_t_37;
   int __pyx_t_38;
   int __pyx_t_39;
   int __pyx_t_40;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("run", 0);
 
-  /* "soapcw/soapcw.pyx":1095
+  /* "soapcw/soapcw.pyx":1097
  *         '''
  * 
  *         if len(np.shape(tr))<=1:             # <<<<<<<<<<<<<<
  *             raise Exception("ERROR: Please use a transition matrix with dimensions larger than one")
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1095, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1097, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1095, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1097, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_tr) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_tr);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1097, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1095, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1097, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_5 = ((__pyx_t_4 <= 1) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "soapcw/soapcw.pyx":1096
+    /* "soapcw/soapcw.pyx":1098
  * 
  *         if len(np.shape(tr))<=1:
  *             raise Exception("ERROR: Please use a transition matrix with dimensions larger than one")             # <<<<<<<<<<<<<<
  * 
  *         range_tr = np.arange(len(tr))
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])), __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1096, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])), __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1098, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1096, __pyx_L1_error)
+    __PYX_ERR(0, 1098, __pyx_L1_error)
 
-    /* "soapcw/soapcw.pyx":1095
+    /* "soapcw/soapcw.pyx":1097
  *         '''
  * 
  *         if len(np.shape(tr))<=1:             # <<<<<<<<<<<<<<
  *             raise Exception("ERROR: Please use a transition matrix with dimensions larger than one")
  * 
  */
   }
 
-  /* "soapcw/soapcw.pyx":1098
+  /* "soapcw/soapcw.pyx":1100
  *             raise Exception("ERROR: Please use a transition matrix with dimensions larger than one")
  * 
  *         range_tr = np.arange(len(tr))             # <<<<<<<<<<<<<<
  * 
  *         cdef double[:, :] obs1 = obs11
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1098, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1100, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_arange); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1098, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_arange); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1100, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = PyObject_Length(__pyx_v_tr); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1098, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1098, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_v_tr); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1100, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1100, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1098, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_range_tr = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1100
+  /* "soapcw/soapcw.pyx":1102
  *         range_tr = np.arange(len(tr))
  * 
  *         cdef double[:, :] obs1 = obs11             # <<<<<<<<<<<<<<
  *         cdef double[:, :] obs2 = obs22
  * 
  */
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1100, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1102, __pyx_L1_error)
   __pyx_v_obs1 = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "soapcw/soapcw.pyx":1101
+  /* "soapcw/soapcw.pyx":1103
  * 
  *         cdef double[:, :] obs1 = obs11
  *         cdef double[:, :] obs2 = obs22             # <<<<<<<<<<<<<<
  * 
  *         cdef int n      = len(tr)
  */
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs22, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1101, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_obs22, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1103, __pyx_L1_error)
   __pyx_v_obs2 = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "soapcw/soapcw.pyx":1103
+  /* "soapcw/soapcw.pyx":1105
  *         cdef double[:, :] obs2 = obs22
  * 
  *         cdef int n      = len(tr)             # <<<<<<<<<<<<<<
  *         shape           = np.shape(tr)
  *         cdef int length = len(shape)
  */
-  __pyx_t_4 = PyObject_Length(__pyx_v_tr); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1103, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_v_tr); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1105, __pyx_L1_error)
   __pyx_v_n = __pyx_t_4;
 
-  /* "soapcw/soapcw.pyx":1104
+  /* "soapcw/soapcw.pyx":1106
  * 
  *         cdef int n      = len(tr)
  *         shape           = np.shape(tr)             # <<<<<<<<<<<<<<
  *         cdef int length = len(shape)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1104, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1106, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1104, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1106, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_tr) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_tr);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1104, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1106, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_shape = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1105
+  /* "soapcw/soapcw.pyx":1107
  *         cdef int n      = len(tr)
  *         shape           = np.shape(tr)
  *         cdef int length = len(shape)             # <<<<<<<<<<<<<<
  * 
  *         dimensions = (min(len(obs1),len(obs2)),min(len(obs1[0]),len(obs2[0])))
  */
-  __pyx_t_4 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1105, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1107, __pyx_L1_error)
   __pyx_v_length = __pyx_t_4;
 
-  /* "soapcw/soapcw.pyx":1107
+  /* "soapcw/soapcw.pyx":1109
  *         cdef int length = len(shape)
  * 
  *         dimensions = (min(len(obs1),len(obs2)),min(len(obs1[0]),len(obs2[0])))             # <<<<<<<<<<<<<<
  *         dimensions = list(dimensions)
  * 
  */
   __pyx_t_8 = __Pyx_MemoryView_Len(__pyx_v_obs2); 
   __pyx_t_9 = __Pyx_MemoryView_Len(__pyx_v_obs1); 
   if (((__pyx_t_8 < __pyx_t_9) != 0)) {
     __pyx_t_4 = __pyx_t_8;
   } else {
     __pyx_t_4 = __pyx_t_9;
   }
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1107, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_10.data = __pyx_v_obs2.data;
   __pyx_t_10.memview = __pyx_v_obs2.memview;
   __PYX_INC_MEMVIEW(&__pyx_t_10, 0);
   {
     Py_ssize_t __pyx_tmp_idx = 0;
         Py_ssize_t __pyx_tmp_shape = __pyx_v_obs2.shape[0];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_obs2.strides[0];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
-        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
+        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 0)");
-            __PYX_ERR(0, 1107, __pyx_L1_error)
+            __PYX_ERR(0, 1109, __pyx_L1_error)
         }
         __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
 __pyx_t_10.shape[0] = __pyx_v_obs2.shape[1];
 __pyx_t_10.strides[0] = __pyx_v_obs2.strides[1];
     __pyx_t_10.suboffsets[0] = -1;
@@ -21734,18 +21905,18 @@
   __PYX_INC_MEMVIEW(&__pyx_t_10, 0);
   {
     Py_ssize_t __pyx_tmp_idx = 0;
         Py_ssize_t __pyx_tmp_shape = __pyx_v_obs1.shape[0];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_obs1.strides[0];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
-        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
+        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 0)");
-            __PYX_ERR(0, 1107, __pyx_L1_error)
+            __PYX_ERR(0, 1109, __pyx_L1_error)
         }
         __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
 __pyx_t_10.shape[0] = __pyx_v_obs1.shape[1];
 __pyx_t_10.strides[0] = __pyx_v_obs1.strides[1];
     __pyx_t_10.suboffsets[0] = -1;
@@ -21755,318 +21926,318 @@
   __pyx_t_10.memview = NULL;
   __pyx_t_10.data = NULL;
   if (((__pyx_t_8 < __pyx_t_9) != 0)) {
     __pyx_t_4 = __pyx_t_8;
   } else {
     __pyx_t_4 = __pyx_t_9;
   }
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1107, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1107, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
   __pyx_t_1 = 0;
   __pyx_t_3 = 0;
   __pyx_v_dimensions = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1108
+  /* "soapcw/soapcw.pyx":1110
  * 
  *         dimensions = (min(len(obs1),len(obs2)),min(len(obs1[0]),len(obs2[0])))
  *         dimensions = list(dimensions)             # <<<<<<<<<<<<<<
  * 
  *         cdef int length_t = dimensions[0]
  */
-  __pyx_t_2 = PySequence_List(__pyx_v_dimensions); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1108, __pyx_L1_error)
+  __pyx_t_2 = PySequence_List(__pyx_v_dimensions); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1110, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF_SET(__pyx_v_dimensions, __pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1110
+  /* "soapcw/soapcw.pyx":1112
  *         dimensions = list(dimensions)
  * 
  *         cdef int length_t = dimensions[0]             # <<<<<<<<<<<<<<
  *         cdef int width = dimensions[1]
  * 
  */
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dimensions, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1110, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dimensions, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1112, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1110, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1112, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_length_t = __pyx_t_11;
 
-  /* "soapcw/soapcw.pyx":1111
+  /* "soapcw/soapcw.pyx":1113
  * 
  *         cdef int length_t = dimensions[0]
  *         cdef int width = dimensions[1]             # <<<<<<<<<<<<<<
  * 
  *         cdef int i
  */
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dimensions, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1111, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dimensions, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1113, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1111, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1113, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_width = __pyx_t_11;
 
-  /* "soapcw/soapcw.pyx":1124
+  /* "soapcw/soapcw.pyx":1126
  * 
  * 
  *         for i in range(len(shape)-3):             # <<<<<<<<<<<<<<
  *             dimensions.append(n)
  * 
  */
-  __pyx_t_4 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1124, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1126, __pyx_L1_error)
   __pyx_t_12 = (__pyx_t_4 - 3);
   __pyx_t_4 = __pyx_t_12;
   for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_4; __pyx_t_11+=1) {
     __pyx_v_i = __pyx_t_11;
 
-    /* "soapcw/soapcw.pyx":1125
+    /* "soapcw/soapcw.pyx":1127
  * 
  *         for i in range(len(shape)-3):
  *             dimensions.append(n)             # <<<<<<<<<<<<<<
  * 
  *         dimensions = tuple(dimensions)
  */
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1125, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1127, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_13 = __Pyx_PyObject_Append(__pyx_v_dimensions, __pyx_t_2); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1125, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_Append(__pyx_v_dimensions, __pyx_t_2); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1127, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
 
-  /* "soapcw/soapcw.pyx":1127
+  /* "soapcw/soapcw.pyx":1129
  *             dimensions.append(n)
  * 
  *         dimensions = tuple(dimensions)             # <<<<<<<<<<<<<<
  * 
  *         val    = np.ones(dimensions)*-1e6
  */
-  __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_v_dimensions); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_v_dimensions); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1129, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF_SET(__pyx_v_dimensions, __pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1129
+  /* "soapcw/soapcw.pyx":1131
  *         dimensions = tuple(dimensions)
  * 
  *         val    = np.ones(dimensions)*-1e6             # <<<<<<<<<<<<<<
  *         prev   = np.ones(dimensions)
  *         pos1   = np.ones(dimensions)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1129, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1131, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ones); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1129, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ones); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1131, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_3, __pyx_v_dimensions) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_dimensions);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1129, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1131, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_float_neg_1e6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1129, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_float_neg_1e6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1131, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_val = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1130
+  /* "soapcw/soapcw.pyx":1132
  * 
  *         val    = np.ones(dimensions)*-1e6
  *         prev   = np.ones(dimensions)             # <<<<<<<<<<<<<<
  *         pos1   = np.ones(dimensions)
  *         pos2   = np.ones(dimensions)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1130, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1130, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_dimensions) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_dimensions);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1130, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_prev = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1131
+  /* "soapcw/soapcw.pyx":1133
  *         val    = np.ones(dimensions)*-1e6
  *         prev   = np.ones(dimensions)
  *         pos1   = np.ones(dimensions)             # <<<<<<<<<<<<<<
  *         pos2   = np.ones(dimensions)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1131, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ones); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1131, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ones); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_dimensions) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_dimensions);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1131, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_pos1 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1132
+  /* "soapcw/soapcw.pyx":1134
  *         prev   = np.ones(dimensions)
  *         pos1   = np.ones(dimensions)
  *         pos2   = np.ones(dimensions)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1132, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_dimensions) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_dimensions);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1132, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_pos2 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1135
+  /* "soapcw/soapcw.pyx":1137
  * 
  * 
  *         range_j = list(itertools.product(range(n),repeat=length-3))             # <<<<<<<<<<<<<<
  * 
  *         for i in range(width):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_itertools); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1135, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_itertools); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_product); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1135, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_product); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1135, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1135, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1135, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1135, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = __Pyx_PyInt_From_long((__pyx_v_length - 3)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1135, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_From_long((__pyx_v_length - 3)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_repeat, __pyx_t_6) < 0) __PYX_ERR(0, 1135, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_repeat, __pyx_t_6) < 0) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1135, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1135, __pyx_L1_error)
+  __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_range_j = ((PyObject*)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1137
+  /* "soapcw/soapcw.pyx":1139
  *         range_j = list(itertools.product(range(n),repeat=length-3))
  * 
  *         for i in range(width):             # <<<<<<<<<<<<<<
  *             for j in range_j:
  *                 temp = -1e6
  */
   __pyx_t_11 = __pyx_v_width;
   __pyx_t_14 = __pyx_t_11;
   for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
     __pyx_v_i = __pyx_t_15;
 
-    /* "soapcw/soapcw.pyx":1138
+    /* "soapcw/soapcw.pyx":1140
  * 
  *         for i in range(width):
  *             for j in range_j:             # <<<<<<<<<<<<<<
  *                 temp = -1e6
  *                 for k in range(n):
  */
     __pyx_t_2 = __pyx_v_range_j; __Pyx_INCREF(__pyx_t_2); __pyx_t_12 = 0;
     for (;;) {
       if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_2)) break;
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-      __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_12); __Pyx_INCREF(__pyx_t_6); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1138, __pyx_L1_error)
+      __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_12); __Pyx_INCREF(__pyx_t_6); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1140, __pyx_L1_error)
       #else
-      __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1138, __pyx_L1_error)
+      __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1140, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       #endif
       __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_6);
       __pyx_t_6 = 0;
 
-      /* "soapcw/soapcw.pyx":1139
+      /* "soapcw/soapcw.pyx":1141
  *         for i in range(width):
  *             for j in range_j:
  *                 temp = -1e6             # <<<<<<<<<<<<<<
  *                 for k in range(n):
  *                     if i+k-1>=0 and i+k-1<width:
  */
       __pyx_v_temp = -1e6;
 
-      /* "soapcw/soapcw.pyx":1140
+      /* "soapcw/soapcw.pyx":1142
  *             for j in range_j:
  *                 temp = -1e6
  *                 for k in range(n):             # <<<<<<<<<<<<<<
  *                     if i+k-1>=0 and i+k-1<width:
  *                         for m in range(n):
  */
       __pyx_t_16 = __pyx_v_n;
       __pyx_t_17 = __pyx_t_16;
       for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
         __pyx_v_k = __pyx_t_18;
 
-        /* "soapcw/soapcw.pyx":1141
+        /* "soapcw/soapcw.pyx":1143
  *                 temp = -1e6
  *                 for k in range(n):
  *                     if i+k-1>=0 and i+k-1<width:             # <<<<<<<<<<<<<<
  *                         for m in range(n):
  *                             if i+m-1>=0 and i+m-1<width:
  */
         __pyx_t_19 = ((((__pyx_v_i + __pyx_v_k) - 1) >= 0) != 0);
@@ -22076,27 +22247,27 @@
           goto __pyx_L13_bool_binop_done;
         }
         __pyx_t_19 = ((((__pyx_v_i + __pyx_v_k) - 1) < __pyx_v_width) != 0);
         __pyx_t_5 = __pyx_t_19;
         __pyx_L13_bool_binop_done:;
         if (__pyx_t_5) {
 
-          /* "soapcw/soapcw.pyx":1142
+          /* "soapcw/soapcw.pyx":1144
  *                 for k in range(n):
  *                     if i+k-1>=0 and i+k-1<width:
  *                         for m in range(n):             # <<<<<<<<<<<<<<
  *                             if i+m-1>=0 and i+m-1<width:
  *                                 value = obs1[0][i+k-1] + obs2[0][i+m-1] + tr[tuple(np.ones(len(shape)-2).astype('int'))][k][m]
  */
           __pyx_t_20 = __pyx_v_n;
           __pyx_t_21 = __pyx_t_20;
           for (__pyx_t_22 = 0; __pyx_t_22 < __pyx_t_21; __pyx_t_22+=1) {
             __pyx_v_m = __pyx_t_22;
 
-            /* "soapcw/soapcw.pyx":1143
+            /* "soapcw/soapcw.pyx":1145
  *                     if i+k-1>=0 and i+k-1<width:
  *                         for m in range(n):
  *                             if i+m-1>=0 and i+m-1<width:             # <<<<<<<<<<<<<<
  *                                 value = obs1[0][i+k-1] + obs2[0][i+m-1] + tr[tuple(np.ones(len(shape)-2).astype('int'))][k][m]
  *                                 if value>temp:
  */
             __pyx_t_19 = ((((__pyx_v_i + __pyx_v_m) - 1) >= 0) != 0);
@@ -22106,15 +22277,15 @@
               goto __pyx_L18_bool_binop_done;
             }
             __pyx_t_19 = ((((__pyx_v_i + __pyx_v_m) - 1) < __pyx_v_width) != 0);
             __pyx_t_5 = __pyx_t_19;
             __pyx_L18_bool_binop_done:;
             if (__pyx_t_5) {
 
-              /* "soapcw/soapcw.pyx":1144
+              /* "soapcw/soapcw.pyx":1146
  *                         for m in range(n):
  *                             if i+m-1>=0 and i+m-1<width:
  *                                 value = obs1[0][i+k-1] + obs2[0][i+m-1] + tr[tuple(np.ones(len(shape)-2).astype('int'))][k][m]             # <<<<<<<<<<<<<<
  *                                 if value>temp:
  *                                     temp = value
  */
               __pyx_t_23 = 0;
@@ -22126,252 +22297,252 @@
               } else if (unlikely(__pyx_t_23 >= __pyx_v_obs1.shape[0])) __pyx_t_25 = 0;
               if (__pyx_t_24 < 0) {
                 __pyx_t_24 += __pyx_v_obs1.shape[1];
                 if (unlikely(__pyx_t_24 < 0)) __pyx_t_25 = 1;
               } else if (unlikely(__pyx_t_24 >= __pyx_v_obs1.shape[1])) __pyx_t_25 = 1;
               if (unlikely(__pyx_t_25 != -1)) {
                 __Pyx_RaiseBufferIndexError(__pyx_t_25);
-                __PYX_ERR(0, 1144, __pyx_L1_error)
+                __PYX_ERR(0, 1146, __pyx_L1_error)
               }
               __pyx_t_26 = 0;
               __pyx_t_27 = ((__pyx_v_i + __pyx_v_m) - 1);
               __pyx_t_25 = -1;
               if (__pyx_t_26 < 0) {
                 __pyx_t_26 += __pyx_v_obs2.shape[0];
                 if (unlikely(__pyx_t_26 < 0)) __pyx_t_25 = 0;
               } else if (unlikely(__pyx_t_26 >= __pyx_v_obs2.shape[0])) __pyx_t_25 = 0;
               if (__pyx_t_27 < 0) {
                 __pyx_t_27 += __pyx_v_obs2.shape[1];
                 if (unlikely(__pyx_t_27 < 0)) __pyx_t_25 = 1;
               } else if (unlikely(__pyx_t_27 >= __pyx_v_obs2.shape[1])) __pyx_t_25 = 1;
               if (unlikely(__pyx_t_25 != -1)) {
                 __Pyx_RaiseBufferIndexError(__pyx_t_25);
-                __PYX_ERR(0, 1144, __pyx_L1_error)
+                __PYX_ERR(0, 1146, __pyx_L1_error)
               }
-              __pyx_t_6 = PyFloat_FromDouble(((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1.data + __pyx_t_23 * __pyx_v_obs1.strides[0]) ) + __pyx_t_24 * __pyx_v_obs1.strides[1]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs2.data + __pyx_t_26 * __pyx_v_obs2.strides[0]) ) + __pyx_t_27 * __pyx_v_obs2.strides[1]) ))))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1144, __pyx_L1_error)
+              __pyx_t_6 = PyFloat_FromDouble(((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs1.data + __pyx_t_23 * __pyx_v_obs1.strides[0]) ) + __pyx_t_24 * __pyx_v_obs1.strides[1]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_obs2.data + __pyx_t_26 * __pyx_v_obs2.strides[0]) ) + __pyx_t_27 * __pyx_v_obs2.strides[1]) ))))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_6);
-              __Pyx_GetModuleGlobalName(__pyx_t_28, __pyx_n_s_np); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 1144, __pyx_L1_error)
+              __Pyx_GetModuleGlobalName(__pyx_t_28, __pyx_n_s_np); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_28);
-              __pyx_t_29 = __Pyx_PyObject_GetAttrStr(__pyx_t_28, __pyx_n_s_ones); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1144, __pyx_L1_error)
+              __pyx_t_29 = __Pyx_PyObject_GetAttrStr(__pyx_t_28, __pyx_n_s_ones); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_29);
               __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
-              __pyx_t_4 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1144, __pyx_L1_error)
-              __pyx_t_28 = PyInt_FromSsize_t((__pyx_t_4 - 2)); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 1144, __pyx_L1_error)
+              __pyx_t_4 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1146, __pyx_L1_error)
+              __pyx_t_28 = PyInt_FromSsize_t((__pyx_t_4 - 2)); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_28);
               __pyx_t_30 = NULL;
               if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_29))) {
                 __pyx_t_30 = PyMethod_GET_SELF(__pyx_t_29);
                 if (likely(__pyx_t_30)) {
                   PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_29);
                   __Pyx_INCREF(__pyx_t_30);
                   __Pyx_INCREF(function);
                   __Pyx_DECREF_SET(__pyx_t_29, function);
                 }
               }
               __pyx_t_3 = (__pyx_t_30) ? __Pyx_PyObject_Call2Args(__pyx_t_29, __pyx_t_30, __pyx_t_28) : __Pyx_PyObject_CallOneArg(__pyx_t_29, __pyx_t_28);
               __Pyx_XDECREF(__pyx_t_30); __pyx_t_30 = 0;
               __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
-              if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1144, __pyx_L1_error)
+              if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_3);
               __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-              __pyx_t_29 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1144, __pyx_L1_error)
+              __pyx_t_29 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_29);
               __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
               __pyx_t_3 = NULL;
               if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_29))) {
                 __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_29);
                 if (likely(__pyx_t_3)) {
                   PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_29);
                   __Pyx_INCREF(__pyx_t_3);
                   __Pyx_INCREF(function);
                   __Pyx_DECREF_SET(__pyx_t_29, function);
                 }
               }
               __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_29, __pyx_t_3, __pyx_n_u_int) : __Pyx_PyObject_CallOneArg(__pyx_t_29, __pyx_n_u_int);
               __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L1_error)
+              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_1);
               __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-              __pyx_t_29 = __Pyx_PySequence_Tuple(__pyx_t_1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1144, __pyx_L1_error)
+              __pyx_t_29 = __Pyx_PySequence_Tuple(__pyx_t_1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_29);
               __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-              __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_tr, __pyx_t_29); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L1_error)
+              __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_tr, __pyx_t_29); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_1);
               __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-              __pyx_t_29 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1144, __pyx_L1_error)
+              __pyx_t_29 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_29);
               __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-              __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_29, __pyx_v_m, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L1_error)
+              __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_29, __pyx_v_m, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_1);
               __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-              __pyx_t_29 = PyNumber_Add(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1144, __pyx_L1_error)
+              __pyx_t_29 = PyNumber_Add(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_29);
               __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
               __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-              __pyx_t_31 = __pyx_PyFloat_AsDouble(__pyx_t_29); if (unlikely((__pyx_t_31 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1144, __pyx_L1_error)
+              __pyx_t_31 = __pyx_PyFloat_AsDouble(__pyx_t_29); if (unlikely((__pyx_t_31 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1146, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
               __pyx_v_value = __pyx_t_31;
 
-              /* "soapcw/soapcw.pyx":1145
+              /* "soapcw/soapcw.pyx":1147
  *                             if i+m-1>=0 and i+m-1<width:
  *                                 value = obs1[0][i+k-1] + obs2[0][i+m-1] + tr[tuple(np.ones(len(shape)-2).astype('int'))][k][m]
  *                                 if value>temp:             # <<<<<<<<<<<<<<
  *                                     temp = value
  *                                     val[0][i][j]    = value
  */
               __pyx_t_5 = ((__pyx_v_value > __pyx_v_temp) != 0);
               if (__pyx_t_5) {
 
-                /* "soapcw/soapcw.pyx":1146
+                /* "soapcw/soapcw.pyx":1148
  *                                 value = obs1[0][i+k-1] + obs2[0][i+m-1] + tr[tuple(np.ones(len(shape)-2).astype('int'))][k][m]
  *                                 if value>temp:
  *                                     temp = value             # <<<<<<<<<<<<<<
  *                                     val[0][i][j]    = value
  *                                     prev[0][i][j]   = np.nan
  */
                 __pyx_v_temp = __pyx_v_value;
 
-                /* "soapcw/soapcw.pyx":1147
+                /* "soapcw/soapcw.pyx":1149
  *                                 if value>temp:
  *                                     temp = value
  *                                     val[0][i][j]    = value             # <<<<<<<<<<<<<<
  *                                     prev[0][i][j]   = np.nan
  *                                     pos1[0][i][j]   = k
  */
-                __pyx_t_29 = PyFloat_FromDouble(__pyx_v_value); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1147, __pyx_L1_error)
+                __pyx_t_29 = PyFloat_FromDouble(__pyx_v_value); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1149, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_29);
-                __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1147, __pyx_L1_error)
+                __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1149, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_1);
-                __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1147, __pyx_L1_error)
+                __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1149, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_6);
                 __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-                if (unlikely(PyObject_SetItem(__pyx_t_6, __pyx_v_j, __pyx_t_29) < 0)) __PYX_ERR(0, 1147, __pyx_L1_error)
+                if (unlikely(PyObject_SetItem(__pyx_t_6, __pyx_v_j, __pyx_t_29) < 0)) __PYX_ERR(0, 1149, __pyx_L1_error)
                 __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                 __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
 
-                /* "soapcw/soapcw.pyx":1148
+                /* "soapcw/soapcw.pyx":1150
  *                                     temp = value
  *                                     val[0][i][j]    = value
  *                                     prev[0][i][j]   = np.nan             # <<<<<<<<<<<<<<
  *                                     pos1[0][i][j]   = k
  *                                     pos2[0][i][j]   = m
  */
-                __Pyx_GetModuleGlobalName(__pyx_t_29, __pyx_n_s_np); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1148, __pyx_L1_error)
+                __Pyx_GetModuleGlobalName(__pyx_t_29, __pyx_n_s_np); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1150, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_29);
-                __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_nan); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1148, __pyx_L1_error)
+                __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_nan); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1150, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_6);
                 __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-                __pyx_t_29 = __Pyx_GetItemInt(__pyx_v_prev, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1148, __pyx_L1_error)
+                __pyx_t_29 = __Pyx_GetItemInt(__pyx_v_prev, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1150, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_29);
-                __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_29, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1148, __pyx_L1_error)
+                __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_29, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1150, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_1);
                 __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-                if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_j, __pyx_t_6) < 0)) __PYX_ERR(0, 1148, __pyx_L1_error)
+                if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_j, __pyx_t_6) < 0)) __PYX_ERR(0, 1150, __pyx_L1_error)
                 __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                 __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-                /* "soapcw/soapcw.pyx":1149
+                /* "soapcw/soapcw.pyx":1151
  *                                     val[0][i][j]    = value
  *                                     prev[0][i][j]   = np.nan
  *                                     pos1[0][i][j]   = k             # <<<<<<<<<<<<<<
  *                                     pos2[0][i][j]   = m
  * 
  */
-                __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1149, __pyx_L1_error)
+                __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1151, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_6);
-                __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pos1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1149, __pyx_L1_error)
+                __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pos1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1151, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_1);
-                __pyx_t_29 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1149, __pyx_L1_error)
+                __pyx_t_29 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1151, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_29);
                 __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-                if (unlikely(PyObject_SetItem(__pyx_t_29, __pyx_v_j, __pyx_t_6) < 0)) __PYX_ERR(0, 1149, __pyx_L1_error)
+                if (unlikely(PyObject_SetItem(__pyx_t_29, __pyx_v_j, __pyx_t_6) < 0)) __PYX_ERR(0, 1151, __pyx_L1_error)
                 __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
                 __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-                /* "soapcw/soapcw.pyx":1150
+                /* "soapcw/soapcw.pyx":1152
  *                                     prev[0][i][j]   = np.nan
  *                                     pos1[0][i][j]   = k
  *                                     pos2[0][i][j]   = m             # <<<<<<<<<<<<<<
  * 
  *         pbar = 0
  */
-                __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_m); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1150, __pyx_L1_error)
+                __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_m); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1152, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_6);
-                __pyx_t_29 = __Pyx_GetItemInt(__pyx_v_pos2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1150, __pyx_L1_error)
+                __pyx_t_29 = __Pyx_GetItemInt(__pyx_v_pos2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1152, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_29);
-                __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_29, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1150, __pyx_L1_error)
+                __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_29, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1152, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_1);
                 __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-                if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_j, __pyx_t_6) < 0)) __PYX_ERR(0, 1150, __pyx_L1_error)
+                if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_j, __pyx_t_6) < 0)) __PYX_ERR(0, 1152, __pyx_L1_error)
                 __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                 __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-                /* "soapcw/soapcw.pyx":1145
+                /* "soapcw/soapcw.pyx":1147
  *                             if i+m-1>=0 and i+m-1<width:
  *                                 value = obs1[0][i+k-1] + obs2[0][i+m-1] + tr[tuple(np.ones(len(shape)-2).astype('int'))][k][m]
  *                                 if value>temp:             # <<<<<<<<<<<<<<
  *                                     temp = value
  *                                     val[0][i][j]    = value
  */
               }
 
-              /* "soapcw/soapcw.pyx":1143
+              /* "soapcw/soapcw.pyx":1145
  *                     if i+k-1>=0 and i+k-1<width:
  *                         for m in range(n):
  *                             if i+m-1>=0 and i+m-1<width:             # <<<<<<<<<<<<<<
  *                                 value = obs1[0][i+k-1] + obs2[0][i+m-1] + tr[tuple(np.ones(len(shape)-2).astype('int'))][k][m]
  *                                 if value>temp:
  */
             }
           }
 
-          /* "soapcw/soapcw.pyx":1141
+          /* "soapcw/soapcw.pyx":1143
  *                 temp = -1e6
  *                 for k in range(n):
  *                     if i+k-1>=0 and i+k-1<width:             # <<<<<<<<<<<<<<
  *                         for m in range(n):
  *                             if i+m-1>=0 and i+m-1<width:
  */
         }
       }
 
-      /* "soapcw/soapcw.pyx":1138
+      /* "soapcw/soapcw.pyx":1140
  * 
  *         for i in range(width):
  *             for j in range_j:             # <<<<<<<<<<<<<<
  *                 temp = -1e6
  *                 for k in range(n):
  */
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
 
-  /* "soapcw/soapcw.pyx":1152
+  /* "soapcw/soapcw.pyx":1154
  *                                     pos2[0][i][j]   = m
  * 
  *         pbar = 0             # <<<<<<<<<<<<<<
  *         for t in range(1,length_t):
  *             obs1t = obs1[t]
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_v_pbar = __pyx_int_0;
 
-  /* "soapcw/soapcw.pyx":1153
+  /* "soapcw/soapcw.pyx":1155
  * 
  *         pbar = 0
  *         for t in range(1,length_t):             # <<<<<<<<<<<<<<
  *             obs1t = obs1[t]
  *             obs2t = obs2[t]
  */
   __pyx_t_11 = __pyx_v_length_t;
   __pyx_t_14 = __pyx_t_11;
   for (__pyx_t_15 = 1; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
     __pyx_v_t = __pyx_t_15;
 
-    /* "soapcw/soapcw.pyx":1154
+    /* "soapcw/soapcw.pyx":1156
  *         pbar = 0
  *         for t in range(1,length_t):
  *             obs1t = obs1[t]             # <<<<<<<<<<<<<<
  *             obs2t = obs2[t]
  *             valt = val[t-1]
  */
     __pyx_t_10.data = __pyx_v_obs1.data;
@@ -22379,35 +22550,35 @@
     __PYX_INC_MEMVIEW(&__pyx_t_10, 0);
     {
     Py_ssize_t __pyx_tmp_idx = __pyx_v_t;
         Py_ssize_t __pyx_tmp_shape = __pyx_v_obs1.shape[0];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_obs1.strides[0];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
-        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
+        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 0)");
-            __PYX_ERR(0, 1154, __pyx_L1_error)
+            __PYX_ERR(0, 1156, __pyx_L1_error)
         }
         __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
 __pyx_t_10.shape[0] = __pyx_v_obs1.shape[1];
 __pyx_t_10.strides[0] = __pyx_v_obs1.strides[1];
     __pyx_t_10.suboffsets[0] = -1;
 
-__pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1154, __pyx_L1_error)
+__pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1156, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
     __Pyx_XDECREF_SET(__pyx_v_obs1t, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":1155
+    /* "soapcw/soapcw.pyx":1157
  *         for t in range(1,length_t):
  *             obs1t = obs1[t]
  *             obs2t = obs2[t]             # <<<<<<<<<<<<<<
  *             valt = val[t-1]
  *             pt = t/float(length_t)*100.
  */
     __pyx_t_10.data = __pyx_v_obs2.data;
@@ -22415,164 +22586,164 @@
     __PYX_INC_MEMVIEW(&__pyx_t_10, 0);
     {
     Py_ssize_t __pyx_tmp_idx = __pyx_v_t;
         Py_ssize_t __pyx_tmp_shape = __pyx_v_obs2.shape[0];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_obs2.strides[0];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
-        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
+        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 0)");
-            __PYX_ERR(0, 1155, __pyx_L1_error)
+            __PYX_ERR(0, 1157, __pyx_L1_error)
         }
         __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
 __pyx_t_10.shape[0] = __pyx_v_obs2.shape[1];
 __pyx_t_10.strides[0] = __pyx_v_obs2.strides[1];
     __pyx_t_10.suboffsets[0] = -1;
 
-__pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1155, __pyx_L1_error)
+__pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1157, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
     __Pyx_XDECREF_SET(__pyx_v_obs2t, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":1156
+    /* "soapcw/soapcw.pyx":1158
  *             obs1t = obs1[t]
  *             obs2t = obs2[t]
  *             valt = val[t-1]             # <<<<<<<<<<<<<<
  *             pt = t/float(length_t)*100.
  *             for i in range(width):
  */
     __pyx_t_32 = (__pyx_v_t - 1);
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_val, __pyx_t_32, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1156, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_val, __pyx_t_32, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1158, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_XDECREF_SET(__pyx_v_valt, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":1157
+    /* "soapcw/soapcw.pyx":1159
  *             obs2t = obs2[t]
  *             valt = val[t-1]
  *             pt = t/float(length_t)*100.             # <<<<<<<<<<<<<<
  *             for i in range(width):
  *                 for j in range_j:
  */
     if (unlikely(((double)__pyx_v_length_t) == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-      __PYX_ERR(0, 1157, __pyx_L1_error)
+      __PYX_ERR(0, 1159, __pyx_L1_error)
     }
     __pyx_v_pt = ((((double)__pyx_v_t) / ((double)__pyx_v_length_t)) * 100.);
 
-    /* "soapcw/soapcw.pyx":1158
+    /* "soapcw/soapcw.pyx":1160
  *             valt = val[t-1]
  *             pt = t/float(length_t)*100.
  *             for i in range(width):             # <<<<<<<<<<<<<<
  *                 for j in range_j:
  *                     cond = True
  */
     __pyx_t_16 = __pyx_v_width;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_i = __pyx_t_18;
 
-      /* "soapcw/soapcw.pyx":1159
+      /* "soapcw/soapcw.pyx":1161
  *             pt = t/float(length_t)*100.
  *             for i in range(width):
  *                 for j in range_j:             # <<<<<<<<<<<<<<
  *                     cond = True
  *                     for c in range(1,len(j)+1):
  */
       __pyx_t_2 = __pyx_v_range_j; __Pyx_INCREF(__pyx_t_2); __pyx_t_12 = 0;
       for (;;) {
         if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_12); __Pyx_INCREF(__pyx_t_6); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1159, __pyx_L1_error)
+        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_12); __Pyx_INCREF(__pyx_t_6); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1161, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1159, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1161, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
         __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_6);
         __pyx_t_6 = 0;
 
-        /* "soapcw/soapcw.pyx":1160
+        /* "soapcw/soapcw.pyx":1162
  *             for i in range(width):
  *                 for j in range_j:
  *                     cond = True             # <<<<<<<<<<<<<<
  *                     for c in range(1,len(j)+1):
  *                         b = i+np.sum(j[:c])-len(j[:c])
  */
         __pyx_v_cond = 1;
 
-        /* "soapcw/soapcw.pyx":1161
+        /* "soapcw/soapcw.pyx":1163
  *                 for j in range_j:
  *                     cond = True
  *                     for c in range(1,len(j)+1):             # <<<<<<<<<<<<<<
  *                         b = i+np.sum(j[:c])-len(j[:c])
  *                         if b >= 0 and b<width:
  */
-        __pyx_t_4 = PyObject_Length(__pyx_v_j); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1161, __pyx_L1_error)
+        __pyx_t_4 = PyObject_Length(__pyx_v_j); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1163, __pyx_L1_error)
         __pyx_t_33 = (__pyx_t_4 + 1);
         __pyx_t_4 = __pyx_t_33;
         for (__pyx_t_34 = 1; __pyx_t_34 < __pyx_t_4; __pyx_t_34+=1) {
           __pyx_v_c = __pyx_t_34;
 
-          /* "soapcw/soapcw.pyx":1162
+          /* "soapcw/soapcw.pyx":1164
  *                     cond = True
  *                     for c in range(1,len(j)+1):
  *                         b = i+np.sum(j[:c])-len(j[:c])             # <<<<<<<<<<<<<<
  *                         if b >= 0 and b<width:
  *                             continue
  */
-          __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1162, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1164, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __Pyx_GetModuleGlobalName(__pyx_t_29, __pyx_n_s_np); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1162, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_29, __pyx_n_s_np); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1164, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_29);
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1162, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1164, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-          __pyx_t_29 = __Pyx_PyObject_GetSlice(__pyx_v_j, 0, __pyx_v_c, NULL, NULL, NULL, 0, 1, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1162, __pyx_L1_error)
+          __pyx_t_29 = __Pyx_PyObject_GetSlice(__pyx_v_j, 0, __pyx_v_c, NULL, NULL, NULL, 0, 1, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1164, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_29);
           __pyx_t_28 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
             __pyx_t_28 = PyMethod_GET_SELF(__pyx_t_3);
             if (likely(__pyx_t_28)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
               __Pyx_INCREF(__pyx_t_28);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_3, function);
             }
           }
           __pyx_t_1 = (__pyx_t_28) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_28, __pyx_t_29) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_29);
           __Pyx_XDECREF(__pyx_t_28); __pyx_t_28 = 0;
           __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1162, __pyx_L1_error)
+          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1164, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1162, __pyx_L1_error)
+          __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1164, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_j, 0, __pyx_v_c, NULL, NULL, NULL, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1162, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_j, 0, __pyx_v_c, NULL, NULL, NULL, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1164, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_35 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_35 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1162, __pyx_L1_error)
+          __pyx_t_35 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_35 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1164, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_35); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1162, __pyx_L1_error)
+          __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_35); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1164, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_6 = PyNumber_Subtract(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1162, __pyx_L1_error)
+          __pyx_t_6 = PyNumber_Subtract(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1164, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          __pyx_t_20 = __Pyx_PyInt_As_int(__pyx_t_6); if (unlikely((__pyx_t_20 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1162, __pyx_L1_error)
+          __pyx_t_20 = __Pyx_PyInt_As_int(__pyx_t_6); if (unlikely((__pyx_t_20 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1164, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_v_b = __pyx_t_20;
 
-          /* "soapcw/soapcw.pyx":1163
+          /* "soapcw/soapcw.pyx":1165
  *                     for c in range(1,len(j)+1):
  *                         b = i+np.sum(j[:c])-len(j[:c])
  *                         if b >= 0 and b<width:             # <<<<<<<<<<<<<<
  *                             continue
  *                         else:
  */
           __pyx_t_19 = ((__pyx_v_b >= 0) != 0);
@@ -22582,198 +22753,198 @@
             goto __pyx_L30_bool_binop_done;
           }
           __pyx_t_19 = ((__pyx_v_b < __pyx_v_width) != 0);
           __pyx_t_5 = __pyx_t_19;
           __pyx_L30_bool_binop_done:;
           if (__pyx_t_5) {
 
-            /* "soapcw/soapcw.pyx":1164
+            /* "soapcw/soapcw.pyx":1166
  *                         b = i+np.sum(j[:c])-len(j[:c])
  *                         if b >= 0 and b<width:
  *                             continue             # <<<<<<<<<<<<<<
  *                         else:
  *                             cond = False
  */
             goto __pyx_L27_continue;
 
-            /* "soapcw/soapcw.pyx":1163
+            /* "soapcw/soapcw.pyx":1165
  *                     for c in range(1,len(j)+1):
  *                         b = i+np.sum(j[:c])-len(j[:c])
  *                         if b >= 0 and b<width:             # <<<<<<<<<<<<<<
  *                             continue
  *                         else:
  */
           }
 
-          /* "soapcw/soapcw.pyx":1166
+          /* "soapcw/soapcw.pyx":1168
  *                             continue
  *                         else:
  *                             cond = False             # <<<<<<<<<<<<<<
  *                             break
  *                     if cond:
  */
           /*else*/ {
             __pyx_v_cond = 0;
 
-            /* "soapcw/soapcw.pyx":1167
+            /* "soapcw/soapcw.pyx":1169
  *                         else:
  *                             cond = False
  *                             break             # <<<<<<<<<<<<<<
  *                     if cond:
  *                         temp = -1e6
  */
             goto __pyx_L28_break;
           }
           __pyx_L27_continue:;
         }
         __pyx_L28_break:;
 
-        /* "soapcw/soapcw.pyx":1168
+        /* "soapcw/soapcw.pyx":1170
  *                             cond = False
  *                             break
  *                     if cond:             # <<<<<<<<<<<<<<
  *                         temp = -1e6
  *                         for j1 in range(n):
  */
         __pyx_t_5 = (__pyx_v_cond != 0);
         if (__pyx_t_5) {
 
-          /* "soapcw/soapcw.pyx":1169
+          /* "soapcw/soapcw.pyx":1171
  *                             break
  *                     if cond:
  *                         temp = -1e6             # <<<<<<<<<<<<<<
  *                         for j1 in range(n):
  *                             a = list(j[1:])
  */
           __pyx_v_temp = -1e6;
 
-          /* "soapcw/soapcw.pyx":1170
+          /* "soapcw/soapcw.pyx":1172
  *                     if cond:
  *                         temp = -1e6
  *                         for j1 in range(n):             # <<<<<<<<<<<<<<
  *                             a = list(j[1:])
  *                             a.append(j1)
  */
           __pyx_t_20 = __pyx_v_n;
           __pyx_t_21 = __pyx_t_20;
           for (__pyx_t_22 = 0; __pyx_t_22 < __pyx_t_21; __pyx_t_22+=1) {
             __pyx_v_j1 = __pyx_t_22;
 
-            /* "soapcw/soapcw.pyx":1171
+            /* "soapcw/soapcw.pyx":1173
  *                         temp = -1e6
  *                         for j1 in range(n):
  *                             a = list(j[1:])             # <<<<<<<<<<<<<<
  *                             a.append(j1)
  *                             if t<length:
  */
-            __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_v_j, 1, 0, NULL, NULL, &__pyx_slice__8, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1171, __pyx_L1_error)
+            __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_v_j, 1, 0, NULL, NULL, &__pyx_slice__8, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1173, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_1 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1171, __pyx_L1_error)
+            __pyx_t_1 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1173, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
             __Pyx_XDECREF_SET(__pyx_v_a, __pyx_t_1);
             __pyx_t_1 = 0;
 
-            /* "soapcw/soapcw.pyx":1172
+            /* "soapcw/soapcw.pyx":1174
  *                         for j1 in range(n):
  *                             a = list(j[1:])
  *                             a.append(j1)             # <<<<<<<<<<<<<<
  *                             if t<length:
  *                                 for n1 in range(len(a)):
  */
-            __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_j1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1172, __pyx_L1_error)
+            __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_j1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1174, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_1);
-            __pyx_t_13 = __Pyx_PyObject_Append(__pyx_v_a, __pyx_t_1); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1172, __pyx_L1_error)
+            __pyx_t_13 = __Pyx_PyObject_Append(__pyx_v_a, __pyx_t_1); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1174, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-            /* "soapcw/soapcw.pyx":1173
+            /* "soapcw/soapcw.pyx":1175
  *                             a = list(j[1:])
  *                             a.append(j1)
  *                             if t<length:             # <<<<<<<<<<<<<<
  *                                 for n1 in range(len(a)):
  *                                     if n1>=t-1:
  */
             __pyx_t_5 = ((__pyx_v_t < __pyx_v_length) != 0);
             if (__pyx_t_5) {
 
-              /* "soapcw/soapcw.pyx":1174
+              /* "soapcw/soapcw.pyx":1176
  *                             a.append(j1)
  *                             if t<length:
  *                                 for n1 in range(len(a)):             # <<<<<<<<<<<<<<
  *                                     if n1>=t-1:
  *                                         a[n1] = 1
  */
-              __pyx_t_33 = PyObject_Length(__pyx_v_a); if (unlikely(__pyx_t_33 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1174, __pyx_L1_error)
+              __pyx_t_33 = PyObject_Length(__pyx_v_a); if (unlikely(__pyx_t_33 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1176, __pyx_L1_error)
               __pyx_t_4 = __pyx_t_33;
               for (__pyx_t_25 = 0; __pyx_t_25 < __pyx_t_4; __pyx_t_25+=1) {
                 __pyx_v_n1 = __pyx_t_25;
 
-                /* "soapcw/soapcw.pyx":1175
+                /* "soapcw/soapcw.pyx":1177
  *                             if t<length:
  *                                 for n1 in range(len(a)):
  *                                     if n1>=t-1:             # <<<<<<<<<<<<<<
  *                                         a[n1] = 1
  *                             a = tuple(a)
  */
                 __pyx_t_5 = ((__pyx_v_n1 >= (__pyx_v_t - 1)) != 0);
                 if (__pyx_t_5) {
 
-                  /* "soapcw/soapcw.pyx":1176
+                  /* "soapcw/soapcw.pyx":1178
  *                                 for n1 in range(len(a)):
  *                                     if n1>=t-1:
  *                                         a[n1] = 1             # <<<<<<<<<<<<<<
  *                             a = tuple(a)
  *                             for k in range(n):
  */
-                  if (unlikely(__Pyx_SetItemInt(__pyx_v_a, __pyx_v_n1, __pyx_int_1, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0)) __PYX_ERR(0, 1176, __pyx_L1_error)
+                  if (unlikely(__Pyx_SetItemInt(__pyx_v_a, __pyx_v_n1, __pyx_int_1, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0)) __PYX_ERR(0, 1178, __pyx_L1_error)
 
-                  /* "soapcw/soapcw.pyx":1175
+                  /* "soapcw/soapcw.pyx":1177
  *                             if t<length:
  *                                 for n1 in range(len(a)):
  *                                     if n1>=t-1:             # <<<<<<<<<<<<<<
  *                                         a[n1] = 1
  *                             a = tuple(a)
  */
                 }
               }
 
-              /* "soapcw/soapcw.pyx":1173
+              /* "soapcw/soapcw.pyx":1175
  *                             a = list(j[1:])
  *                             a.append(j1)
  *                             if t<length:             # <<<<<<<<<<<<<<
  *                                 for n1 in range(len(a)):
  *                                     if n1>=t-1:
  */
             }
 
-            /* "soapcw/soapcw.pyx":1177
+            /* "soapcw/soapcw.pyx":1179
  *                                     if n1>=t-1:
  *                                         a[n1] = 1
  *                             a = tuple(a)             # <<<<<<<<<<<<<<
  *                             for k in range(n):
  *                                 if i+k-1>=0 and i+k-1<width:
  */
-            __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_v_a); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)
+            __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_v_a); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1179, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF_SET(__pyx_v_a, __pyx_t_1);
             __pyx_t_1 = 0;
 
-            /* "soapcw/soapcw.pyx":1178
+            /* "soapcw/soapcw.pyx":1180
  *                                         a[n1] = 1
  *                             a = tuple(a)
  *                             for k in range(n):             # <<<<<<<<<<<<<<
  *                                 if i+k-1>=0 and i+k-1<width:
  *                                     for m in range(n):
  */
             __pyx_t_25 = __pyx_v_n;
             __pyx_t_36 = __pyx_t_25;
             for (__pyx_t_37 = 0; __pyx_t_37 < __pyx_t_36; __pyx_t_37+=1) {
               __pyx_v_k = __pyx_t_37;
 
-              /* "soapcw/soapcw.pyx":1179
+              /* "soapcw/soapcw.pyx":1181
  *                             a = tuple(a)
  *                             for k in range(n):
  *                                 if i+k-1>=0 and i+k-1<width:             # <<<<<<<<<<<<<<
  *                                     for m in range(n):
  *                                         if i+m-1>=0 and i+m-1<width:
  */
               __pyx_t_19 = ((((__pyx_v_i + __pyx_v_k) - 1) >= 0) != 0);
@@ -22783,27 +22954,27 @@
                 goto __pyx_L42_bool_binop_done;
               }
               __pyx_t_19 = ((((__pyx_v_i + __pyx_v_k) - 1) < __pyx_v_width) != 0);
               __pyx_t_5 = __pyx_t_19;
               __pyx_L42_bool_binop_done:;
               if (__pyx_t_5) {
 
-                /* "soapcw/soapcw.pyx":1180
+                /* "soapcw/soapcw.pyx":1182
  *                             for k in range(n):
  *                                 if i+k-1>=0 and i+k-1<width:
  *                                     for m in range(n):             # <<<<<<<<<<<<<<
  *                                         if i+m-1>=0 and i+m-1<width:
  *                                             value = obs1t[i+k-1] + obs2t[i+m-1] + tr[j][j1][k][m] + valt[i+j[0]-1][a]
  */
                 __pyx_t_38 = __pyx_v_n;
                 __pyx_t_39 = __pyx_t_38;
                 for (__pyx_t_40 = 0; __pyx_t_40 < __pyx_t_39; __pyx_t_40+=1) {
                   __pyx_v_m = __pyx_t_40;
 
-                  /* "soapcw/soapcw.pyx":1181
+                  /* "soapcw/soapcw.pyx":1183
  *                                 if i+k-1>=0 and i+k-1<width:
  *                                     for m in range(n):
  *                                         if i+m-1>=0 and i+m-1<width:             # <<<<<<<<<<<<<<
  *                                             value = obs1t[i+k-1] + obs2t[i+m-1] + tr[j][j1][k][m] + valt[i+j[0]-1][a]
  *                                             if value > temp:
  */
                   __pyx_t_19 = ((((__pyx_v_i + __pyx_v_m) - 1) >= 0) != 0);
@@ -22813,259 +22984,259 @@
                     goto __pyx_L47_bool_binop_done;
                   }
                   __pyx_t_19 = ((((__pyx_v_i + __pyx_v_m) - 1) < __pyx_v_width) != 0);
                   __pyx_t_5 = __pyx_t_19;
                   __pyx_L47_bool_binop_done:;
                   if (__pyx_t_5) {
 
-                    /* "soapcw/soapcw.pyx":1182
+                    /* "soapcw/soapcw.pyx":1184
  *                                     for m in range(n):
  *                                         if i+m-1>=0 and i+m-1<width:
  *                                             value = obs1t[i+k-1] + obs2t[i+m-1] + tr[j][j1][k][m] + valt[i+j[0]-1][a]             # <<<<<<<<<<<<<<
  *                                             if value > temp:
  *                                                 temp = value
  */
                     __pyx_t_32 = ((__pyx_v_i + __pyx_v_k) - 1);
-                    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_obs1t, __pyx_t_32, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_obs1t, __pyx_t_32, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_1);
                     __pyx_t_32 = ((__pyx_v_i + __pyx_v_m) - 1);
-                    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_obs2t, __pyx_t_32, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_obs2t, __pyx_t_32, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_6);
-                    __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_3);
                     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-                    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_tr, __pyx_v_j); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_tr, __pyx_v_j); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_6);
-                    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_j1, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_j1, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_1);
                     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-                    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_6);
                     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-                    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_m, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_m, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_1);
                     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-                    __pyx_t_6 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_6 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_6);
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-                    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_1);
-                    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_j, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_j, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_3);
-                    __pyx_t_29 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_29 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_29);
                     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                    __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_29, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_29, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_3);
                     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-                    __pyx_t_29 = __Pyx_PyObject_GetItem(__pyx_v_valt, __pyx_t_3); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_29 = __Pyx_PyObject_GetItem(__pyx_v_valt, __pyx_t_3); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_29);
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_29, __pyx_v_a); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_29, __pyx_v_a); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_3);
                     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-                    __pyx_t_29 = PyNumber_Add(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_29 = PyNumber_Add(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_29);
                     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                    __pyx_t_31 = __pyx_PyFloat_AsDouble(__pyx_t_29); if (unlikely((__pyx_t_31 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1182, __pyx_L1_error)
+                    __pyx_t_31 = __pyx_PyFloat_AsDouble(__pyx_t_29); if (unlikely((__pyx_t_31 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1184, __pyx_L1_error)
                     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
                     __pyx_v_value = __pyx_t_31;
 
-                    /* "soapcw/soapcw.pyx":1183
+                    /* "soapcw/soapcw.pyx":1185
  *                                         if i+m-1>=0 and i+m-1<width:
  *                                             value = obs1t[i+k-1] + obs2t[i+m-1] + tr[j][j1][k][m] + valt[i+j[0]-1][a]
  *                                             if value > temp:             # <<<<<<<<<<<<<<
  *                                                 temp = value
  *                                                 val[t][i][j]  = temp
  */
                     __pyx_t_5 = ((__pyx_v_value > __pyx_v_temp) != 0);
                     if (__pyx_t_5) {
 
-                      /* "soapcw/soapcw.pyx":1184
+                      /* "soapcw/soapcw.pyx":1186
  *                                             value = obs1t[i+k-1] + obs2t[i+m-1] + tr[j][j1][k][m] + valt[i+j[0]-1][a]
  *                                             if value > temp:
  *                                                 temp = value             # <<<<<<<<<<<<<<
  *                                                 val[t][i][j]  = temp
  *                                                 prev[t][i][j] = j1
  */
                       __pyx_v_temp = __pyx_v_value;
 
-                      /* "soapcw/soapcw.pyx":1185
+                      /* "soapcw/soapcw.pyx":1187
  *                                             if value > temp:
  *                                                 temp = value
  *                                                 val[t][i][j]  = temp             # <<<<<<<<<<<<<<
  *                                                 prev[t][i][j] = j1
  *                                                 pos1[t][i][j] = k
  */
-                      __pyx_t_29 = PyFloat_FromDouble(__pyx_v_temp); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1185, __pyx_L1_error)
+                      __pyx_t_29 = PyFloat_FromDouble(__pyx_v_temp); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1187, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_29);
-                      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_val, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1185, __pyx_L1_error)
+                      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_val, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1187, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1185, __pyx_L1_error)
+                      __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1187, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_6);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      if (unlikely(PyObject_SetItem(__pyx_t_6, __pyx_v_j, __pyx_t_29) < 0)) __PYX_ERR(0, 1185, __pyx_L1_error)
+                      if (unlikely(PyObject_SetItem(__pyx_t_6, __pyx_v_j, __pyx_t_29) < 0)) __PYX_ERR(0, 1187, __pyx_L1_error)
                       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                       __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
 
-                      /* "soapcw/soapcw.pyx":1186
+                      /* "soapcw/soapcw.pyx":1188
  *                                                 temp = value
  *                                                 val[t][i][j]  = temp
  *                                                 prev[t][i][j] = j1             # <<<<<<<<<<<<<<
  *                                                 pos1[t][i][j] = k
  *                                                 pos2[t][i][j] = m
  */
-                      __pyx_t_29 = __Pyx_PyInt_From_int(__pyx_v_j1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1186, __pyx_L1_error)
+                      __pyx_t_29 = __Pyx_PyInt_From_int(__pyx_v_j1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1188, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_29);
-                      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_prev, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1186, __pyx_L1_error)
+                      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_prev, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1188, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_6);
-                      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1186, __pyx_L1_error)
+                      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1188, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-                      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_v_j, __pyx_t_29) < 0)) __PYX_ERR(0, 1186, __pyx_L1_error)
+                      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_v_j, __pyx_t_29) < 0)) __PYX_ERR(0, 1188, __pyx_L1_error)
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                       __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
 
-                      /* "soapcw/soapcw.pyx":1187
+                      /* "soapcw/soapcw.pyx":1189
  *                                                 val[t][i][j]  = temp
  *                                                 prev[t][i][j] = j1
  *                                                 pos1[t][i][j] = k             # <<<<<<<<<<<<<<
  *                                                 pos2[t][i][j] = m
  *                         """
  */
-                      __pyx_t_29 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1187, __pyx_L1_error)
+                      __pyx_t_29 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1189, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_29);
-                      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_pos1, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1187, __pyx_L1_error)
+                      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_pos1, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1189, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1187, __pyx_L1_error)
+                      __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1189, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_6);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      if (unlikely(PyObject_SetItem(__pyx_t_6, __pyx_v_j, __pyx_t_29) < 0)) __PYX_ERR(0, 1187, __pyx_L1_error)
+                      if (unlikely(PyObject_SetItem(__pyx_t_6, __pyx_v_j, __pyx_t_29) < 0)) __PYX_ERR(0, 1189, __pyx_L1_error)
                       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                       __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
 
-                      /* "soapcw/soapcw.pyx":1188
+                      /* "soapcw/soapcw.pyx":1190
  *                                                 prev[t][i][j] = j1
  *                                                 pos1[t][i][j] = k
  *                                                 pos2[t][i][j] = m             # <<<<<<<<<<<<<<
  *                         """
  *                         for k in range(length):
  */
-                      __pyx_t_29 = __Pyx_PyInt_From_int(__pyx_v_m); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1188, __pyx_L1_error)
+                      __pyx_t_29 = __Pyx_PyInt_From_int(__pyx_v_m); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1190, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_29);
-                      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_pos2, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1188, __pyx_L1_error)
+                      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_pos2, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1190, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_6);
-                      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1188, __pyx_L1_error)
+                      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1190, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-                      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_v_j, __pyx_t_29) < 0)) __PYX_ERR(0, 1188, __pyx_L1_error)
+                      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_v_j, __pyx_t_29) < 0)) __PYX_ERR(0, 1190, __pyx_L1_error)
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                       __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
 
-                      /* "soapcw/soapcw.pyx":1183
+                      /* "soapcw/soapcw.pyx":1185
  *                                         if i+m-1>=0 and i+m-1<width:
  *                                             value = obs1t[i+k-1] + obs2t[i+m-1] + tr[j][j1][k][m] + valt[i+j[0]-1][a]
  *                                             if value > temp:             # <<<<<<<<<<<<<<
  *                                                 temp = value
  *                                                 val[t][i][j]  = temp
  */
                     }
 
-                    /* "soapcw/soapcw.pyx":1181
+                    /* "soapcw/soapcw.pyx":1183
  *                                 if i+k-1>=0 and i+k-1<width:
  *                                     for m in range(n):
  *                                         if i+m-1>=0 and i+m-1<width:             # <<<<<<<<<<<<<<
  *                                             value = obs1t[i+k-1] + obs2t[i+m-1] + tr[j][j1][k][m] + valt[i+j[0]-1][a]
  *                                             if value > temp:
  */
                   }
                 }
 
-                /* "soapcw/soapcw.pyx":1179
+                /* "soapcw/soapcw.pyx":1181
  *                             a = tuple(a)
  *                             for k in range(n):
  *                                 if i+k-1>=0 and i+k-1<width:             # <<<<<<<<<<<<<<
  *                                     for m in range(n):
  *                                         if i+m-1>=0 and i+m-1<width:
  */
               }
             }
           }
 
-          /* "soapcw/soapcw.pyx":1168
+          /* "soapcw/soapcw.pyx":1170
  *                             cond = False
  *                             break
  *                     if cond:             # <<<<<<<<<<<<<<
  *                         temp = -1e6
  *                         for j1 in range(n):
  */
         }
 
-        /* "soapcw/soapcw.pyx":1159
+        /* "soapcw/soapcw.pyx":1161
  *             pt = t/float(length_t)*100.
  *             for i in range(width):
  *                 for j in range_j:             # <<<<<<<<<<<<<<
  *                     cond = True
  *                     for c in range(1,len(j)+1):
  */
       }
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
 
-    /* "soapcw/soapcw.pyx":1205
+    /* "soapcw/soapcw.pyx":1207
  *                         """
  * 
  *             if self.prog == True:             # <<<<<<<<<<<<<<
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prog); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1205, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prog); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1207, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_29 = PyObject_RichCompare(__pyx_t_2, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_29); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1205, __pyx_L1_error)
+    __pyx_t_29 = PyObject_RichCompare(__pyx_t_2, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_29); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1207, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_29); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1205, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_29); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1207, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
     if (__pyx_t_5) {
 
-      /* "soapcw/soapcw.pyx":1206
+      /* "soapcw/soapcw.pyx":1208
  * 
  *             if self.prog == True:
  *                 if pt>pbar:             # <<<<<<<<<<<<<<
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  */
-      __pyx_t_29 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1206, __pyx_L1_error)
+      __pyx_t_29 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1208, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_29);
-      __pyx_t_2 = PyObject_RichCompare(__pyx_t_29, __pyx_v_pbar, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1206, __pyx_L1_error)
+      __pyx_t_2 = PyObject_RichCompare(__pyx_t_29, __pyx_v_pbar, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1208, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1206, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1208, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       if (__pyx_t_5) {
 
-        /* "soapcw/soapcw.pyx":1207
+        /* "soapcw/soapcw.pyx":1209
  *             if self.prog == True:
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))             # <<<<<<<<<<<<<<
  *                     stdout.flush()
  *                     pbar+=100./length_t
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_29, __pyx_n_s_stdout); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1207, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_29, __pyx_n_s_stdout); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1209, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_29);
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1207, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1209, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u__4, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1207, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u__4, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1209, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_1 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)
+        __pyx_t_1 = PyFloat_FromDouble(__pyx_v_pt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_28 = __Pyx_PyObject_CallOneArg(__pyx_builtin_round, __pyx_t_1); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 1207, __pyx_L1_error)
+        __pyx_t_28 = __Pyx_PyObject_CallOneArg(__pyx_builtin_round, __pyx_t_1); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 1209, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_28);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_t_1 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
           __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
           if (likely(__pyx_t_1)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -23073,15 +23244,15 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_6, function);
           }
         }
         __pyx_t_29 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_t_28) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_28);
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
-        if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1207, __pyx_L1_error)
+        if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1209, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_29);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_t_6 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_6)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -23089,698 +23260,698 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_29) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_29);
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1207, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-        /* "soapcw/soapcw.pyx":1208
+        /* "soapcw/soapcw.pyx":1210
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()             # <<<<<<<<<<<<<<
  *                     pbar+=100./length_t
  * 
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_stdout); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1208, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_stdout); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1210, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_29 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_flush); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1208, __pyx_L1_error)
+        __pyx_t_29 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_flush); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1210, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_29);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_t_3 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_29))) {
           __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_29);
           if (likely(__pyx_t_3)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_29);
             __Pyx_INCREF(__pyx_t_3);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_29, function);
           }
         }
         __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_29, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_29);
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1208, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1210, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-        /* "soapcw/soapcw.pyx":1209
+        /* "soapcw/soapcw.pyx":1211
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  *                     pbar+=100./length_t             # <<<<<<<<<<<<<<
  * 
  *         previous   = 1
  */
         if (unlikely(__pyx_v_length_t == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-          __PYX_ERR(0, 1209, __pyx_L1_error)
+          __PYX_ERR(0, 1211, __pyx_L1_error)
         }
-        __pyx_t_2 = PyFloat_FromDouble((100. / ((double)__pyx_v_length_t))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L1_error)
+        __pyx_t_2 = PyFloat_FromDouble((100. / ((double)__pyx_v_length_t))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1211, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_29 = PyNumber_InPlaceAdd(__pyx_v_pbar, __pyx_t_2); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1209, __pyx_L1_error)
+        __pyx_t_29 = PyNumber_InPlaceAdd(__pyx_v_pbar, __pyx_t_2); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1211, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_29);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF_SET(__pyx_v_pbar, __pyx_t_29);
         __pyx_t_29 = 0;
 
-        /* "soapcw/soapcw.pyx":1206
+        /* "soapcw/soapcw.pyx":1208
  * 
  *             if self.prog == True:
  *                 if pt>pbar:             # <<<<<<<<<<<<<<
  *                     stdout.write('\r{} %'.format(round(pt)))
  *                     stdout.flush()
  */
       }
 
-      /* "soapcw/soapcw.pyx":1205
+      /* "soapcw/soapcw.pyx":1207
  *                         """
  * 
  *             if self.prog == True:             # <<<<<<<<<<<<<<
  *                 if pt>pbar:
  *                     stdout.write('\r{} %'.format(round(pt)))
  */
     }
   }
 
-  /* "soapcw/soapcw.pyx":1211
+  /* "soapcw/soapcw.pyx":1213
  *                     pbar+=100./length_t
  * 
  *         previous   = 1             # <<<<<<<<<<<<<<
  *         previous_1 = None
  *         vit_track1  = [0]
  */
   __Pyx_INCREF(__pyx_int_1);
   __pyx_v_previous = __pyx_int_1;
 
-  /* "soapcw/soapcw.pyx":1212
+  /* "soapcw/soapcw.pyx":1214
  * 
  *         previous   = 1
  *         previous_1 = None             # <<<<<<<<<<<<<<
  *         vit_track1  = [0]
  *         vit_track2  = [0]
  */
   __Pyx_INCREF(Py_None);
   __pyx_v_previous_1 = Py_None;
 
-  /* "soapcw/soapcw.pyx":1213
+  /* "soapcw/soapcw.pyx":1215
  *         previous   = 1
  *         previous_1 = None
  *         vit_track1  = [0]             # <<<<<<<<<<<<<<
  *         vit_track2  = [0]
  *         vit_trackr  = [0]
  */
-  __pyx_t_29 = PyList_New(1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1213, __pyx_L1_error)
+  __pyx_t_29 = PyList_New(1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1215, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_29);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyList_SET_ITEM(__pyx_t_29, 0, __pyx_int_0);
   __pyx_v_vit_track1 = ((PyObject*)__pyx_t_29);
   __pyx_t_29 = 0;
 
-  /* "soapcw/soapcw.pyx":1214
+  /* "soapcw/soapcw.pyx":1216
  *         previous_1 = None
  *         vit_track1  = [0]
  *         vit_track2  = [0]             # <<<<<<<<<<<<<<
  *         vit_trackr  = [0]
  * 
  */
-  __pyx_t_29 = PyList_New(1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1214, __pyx_L1_error)
+  __pyx_t_29 = PyList_New(1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1216, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_29);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyList_SET_ITEM(__pyx_t_29, 0, __pyx_int_0);
   __pyx_v_vit_track2 = ((PyObject*)__pyx_t_29);
   __pyx_t_29 = 0;
 
-  /* "soapcw/soapcw.pyx":1215
+  /* "soapcw/soapcw.pyx":1217
  *         vit_track1  = [0]
  *         vit_track2  = [0]
  *         vit_trackr  = [0]             # <<<<<<<<<<<<<<
  * 
  *         temp = -1e6
  */
-  __pyx_t_29 = PyList_New(1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1215, __pyx_L1_error)
+  __pyx_t_29 = PyList_New(1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1217, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_29);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyList_SET_ITEM(__pyx_t_29, 0, __pyx_int_0);
   __pyx_v_vit_trackr = ((PyObject*)__pyx_t_29);
   __pyx_t_29 = 0;
 
-  /* "soapcw/soapcw.pyx":1217
+  /* "soapcw/soapcw.pyx":1219
  *         vit_trackr  = [0]
  * 
  *         temp = -1e6             # <<<<<<<<<<<<<<
  *         for i in range(width):
  *             for j in range_j:
  */
   __pyx_v_temp = -1e6;
 
-  /* "soapcw/soapcw.pyx":1218
+  /* "soapcw/soapcw.pyx":1220
  * 
  *         temp = -1e6
  *         for i in range(width):             # <<<<<<<<<<<<<<
  *             for j in range_j:
  *                 value = val[-1][i][j]
  */
   __pyx_t_11 = __pyx_v_width;
   __pyx_t_14 = __pyx_t_11;
   for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
     __pyx_v_i = __pyx_t_15;
 
-    /* "soapcw/soapcw.pyx":1219
+    /* "soapcw/soapcw.pyx":1221
  *         temp = -1e6
  *         for i in range(width):
  *             for j in range_j:             # <<<<<<<<<<<<<<
  *                 value = val[-1][i][j]
  *                 if value>temp:
  */
     __pyx_t_29 = __pyx_v_range_j; __Pyx_INCREF(__pyx_t_29); __pyx_t_12 = 0;
     for (;;) {
       if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_29)) break;
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_29, __pyx_t_12); __Pyx_INCREF(__pyx_t_2); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1219, __pyx_L1_error)
+      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_29, __pyx_t_12); __Pyx_INCREF(__pyx_t_2); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1221, __pyx_L1_error)
       #else
-      __pyx_t_2 = PySequence_ITEM(__pyx_t_29, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1219, __pyx_L1_error)
+      __pyx_t_2 = PySequence_ITEM(__pyx_t_29, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1221, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       #endif
       __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_2);
       __pyx_t_2 = 0;
 
-      /* "soapcw/soapcw.pyx":1220
+      /* "soapcw/soapcw.pyx":1222
  *         for i in range(width):
  *             for j in range_j:
  *                 value = val[-1][i][j]             # <<<<<<<<<<<<<<
  *                 if value>temp:
  *                     temp = value
  */
-      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_val, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1220, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_val, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1222, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1220, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1222, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1220, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1222, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_31 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_31 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1220, __pyx_L1_error)
+      __pyx_t_31 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_31 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1222, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_v_value = __pyx_t_31;
 
-      /* "soapcw/soapcw.pyx":1221
+      /* "soapcw/soapcw.pyx":1223
  *             for j in range_j:
  *                 value = val[-1][i][j]
  *                 if value>temp:             # <<<<<<<<<<<<<<
  *                     temp = value
  *                     vit_trackr[0] = i
  */
       __pyx_t_5 = ((__pyx_v_value > __pyx_v_temp) != 0);
       if (__pyx_t_5) {
 
-        /* "soapcw/soapcw.pyx":1222
+        /* "soapcw/soapcw.pyx":1224
  *                 value = val[-1][i][j]
  *                 if value>temp:
  *                     temp = value             # <<<<<<<<<<<<<<
  *                     vit_trackr[0] = i
  *                     vit_track1[0] = i+pos1[-1][i][j]-1
  */
         __pyx_v_temp = __pyx_v_value;
 
-        /* "soapcw/soapcw.pyx":1223
+        /* "soapcw/soapcw.pyx":1225
  *                 if value>temp:
  *                     temp = value
  *                     vit_trackr[0] = i             # <<<<<<<<<<<<<<
  *                     vit_track1[0] = i+pos1[-1][i][j]-1
  *                     vit_track2[0] = i+pos2[-1][i][j]-1
  */
-        __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1223, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1225, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_vit_trackr, 0, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 1223, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_vit_trackr, 0, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 1225, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-        /* "soapcw/soapcw.pyx":1224
+        /* "soapcw/soapcw.pyx":1226
  *                     temp = value
  *                     vit_trackr[0] = i
  *                     vit_track1[0] = i+pos1[-1][i][j]-1             # <<<<<<<<<<<<<<
  *                     vit_track2[0] = i+pos2[-1][i][j]-1
  *                     previous = i
  */
-        __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1224, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1226, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_pos1, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1224, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_pos1, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1226, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1224, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1226, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_j); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1224, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_j); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1226, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1224, __pyx_L1_error)
+        __pyx_t_6 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1226, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1224, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1226, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_vit_track1, 0, __pyx_t_3, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 1224, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_vit_track1, 0, __pyx_t_3, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 1226, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-        /* "soapcw/soapcw.pyx":1225
+        /* "soapcw/soapcw.pyx":1227
  *                     vit_trackr[0] = i
  *                     vit_track1[0] = i+pos1[-1][i][j]-1
  *                     vit_track2[0] = i+pos2[-1][i][j]-1             # <<<<<<<<<<<<<<
  *                     previous = i
  *                     previous_1 = j
  */
-        __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1225, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1227, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_pos2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1225, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_pos2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1227, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1225, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1227, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_j); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1225, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_j); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1227, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = PyNumber_Add(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1225, __pyx_L1_error)
+        __pyx_t_2 = PyNumber_Add(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1227, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1225, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1227, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_vit_track2, 0, __pyx_t_6, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 1225, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_vit_track2, 0, __pyx_t_6, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 1227, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "soapcw/soapcw.pyx":1226
+        /* "soapcw/soapcw.pyx":1228
  *                     vit_track1[0] = i+pos1[-1][i][j]-1
  *                     vit_track2[0] = i+pos2[-1][i][j]-1
  *                     previous = i             # <<<<<<<<<<<<<<
  *                     previous_1 = j
  *                     previous_2 = int(prev[-1][i][j])
  */
-        __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1226, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1228, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF_SET(__pyx_v_previous, __pyx_t_6);
         __pyx_t_6 = 0;
 
-        /* "soapcw/soapcw.pyx":1227
+        /* "soapcw/soapcw.pyx":1229
  *                     vit_track2[0] = i+pos2[-1][i][j]-1
  *                     previous = i
  *                     previous_1 = j             # <<<<<<<<<<<<<<
  *                     previous_2 = int(prev[-1][i][j])
  * 
  */
         __Pyx_INCREF(__pyx_v_j);
         __Pyx_DECREF_SET(__pyx_v_previous_1, __pyx_v_j);
 
-        /* "soapcw/soapcw.pyx":1228
+        /* "soapcw/soapcw.pyx":1230
  *                     previous = i
  *                     previous_1 = j
  *                     previous_2 = int(prev[-1][i][j])             # <<<<<<<<<<<<<<
  * 
  * 
  */
-        __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_prev, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1228, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_prev, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1230, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1228, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1230, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_j); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1228, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_j); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1230, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1228, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1230, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_XDECREF_SET(__pyx_v_previous_2, __pyx_t_2);
         __pyx_t_2 = 0;
 
-        /* "soapcw/soapcw.pyx":1221
+        /* "soapcw/soapcw.pyx":1223
  *             for j in range_j:
  *                 value = val[-1][i][j]
  *                 if value>temp:             # <<<<<<<<<<<<<<
  *                     temp = value
  *                     vit_trackr[0] = i
  */
       }
 
-      /* "soapcw/soapcw.pyx":1219
+      /* "soapcw/soapcw.pyx":1221
  *         temp = -1e6
  *         for i in range(width):
  *             for j in range_j:             # <<<<<<<<<<<<<<
  *                 value = val[-1][i][j]
  *                 if value>temp:
  */
     }
     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
   }
 
-  /* "soapcw/soapcw.pyx":1231
+  /* "soapcw/soapcw.pyx":1233
  * 
  * 
  *         for t in range(length_t-2,-1,-1):             # <<<<<<<<<<<<<<
  *             vit_trackr.append(previous+previous_1[0]-1)
  *             previous += previous_1[0]-1
  */
   for (__pyx_t_11 = (__pyx_v_length_t - 2); __pyx_t_11 > -1; __pyx_t_11-=1) {
     __pyx_v_t = __pyx_t_11;
 
-    /* "soapcw/soapcw.pyx":1232
+    /* "soapcw/soapcw.pyx":1234
  * 
  *         for t in range(length_t-2,-1,-1):
  *             vit_trackr.append(previous+previous_1[0]-1)             # <<<<<<<<<<<<<<
  *             previous += previous_1[0]-1
  *             previous_1 = list(previous_1[1:])
  */
-    __pyx_t_29 = __Pyx_GetItemInt(__pyx_v_previous_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1232, __pyx_L1_error)
+    __pyx_t_29 = __Pyx_GetItemInt(__pyx_v_previous_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1234, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_29);
-    __pyx_t_2 = PyNumber_Add(__pyx_v_previous, __pyx_t_29); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1232, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Add(__pyx_v_previous, __pyx_t_29); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1234, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-    __pyx_t_29 = __Pyx_PyInt_SubtractObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1232, __pyx_L1_error)
+    __pyx_t_29 = __Pyx_PyInt_SubtractObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1234, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_29);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_13 = __Pyx_PyList_Append(__pyx_v_vit_trackr, __pyx_t_29); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1232, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyList_Append(__pyx_v_vit_trackr, __pyx_t_29); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1234, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
 
-    /* "soapcw/soapcw.pyx":1233
+    /* "soapcw/soapcw.pyx":1235
  *         for t in range(length_t-2,-1,-1):
  *             vit_trackr.append(previous+previous_1[0]-1)
  *             previous += previous_1[0]-1             # <<<<<<<<<<<<<<
  *             previous_1 = list(previous_1[1:])
  *             previous_1.append(int(previous_2))
  */
-    __pyx_t_29 = __Pyx_GetItemInt(__pyx_v_previous_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1233, __pyx_L1_error)
+    __pyx_t_29 = __Pyx_GetItemInt(__pyx_v_previous_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1235, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_29);
-    __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_t_29, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1233, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_t_29, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1235, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-    __pyx_t_29 = PyNumber_InPlaceAdd(__pyx_v_previous, __pyx_t_2); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1233, __pyx_L1_error)
+    __pyx_t_29 = PyNumber_InPlaceAdd(__pyx_v_previous, __pyx_t_2); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1235, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_29);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF_SET(__pyx_v_previous, __pyx_t_29);
     __pyx_t_29 = 0;
 
-    /* "soapcw/soapcw.pyx":1234
+    /* "soapcw/soapcw.pyx":1236
  *             vit_trackr.append(previous+previous_1[0]-1)
  *             previous += previous_1[0]-1
  *             previous_1 = list(previous_1[1:])             # <<<<<<<<<<<<<<
  *             previous_1.append(int(previous_2))
  *             previous_1 = tuple(previous_1)
  */
-    __pyx_t_29 = __Pyx_PyObject_GetSlice(__pyx_v_previous_1, 1, 0, NULL, NULL, &__pyx_slice__8, 1, 0, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1234, __pyx_L1_error)
+    __pyx_t_29 = __Pyx_PyObject_GetSlice(__pyx_v_previous_1, 1, 0, NULL, NULL, &__pyx_slice__8, 1, 0, 1); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1236, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_29);
-    __pyx_t_2 = PySequence_List(__pyx_t_29); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1234, __pyx_L1_error)
+    __pyx_t_2 = PySequence_List(__pyx_t_29); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1236, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
     __Pyx_DECREF_SET(__pyx_v_previous_1, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":1235
+    /* "soapcw/soapcw.pyx":1237
  *             previous += previous_1[0]-1
  *             previous_1 = list(previous_1[1:])
  *             previous_1.append(int(previous_2))             # <<<<<<<<<<<<<<
  *             previous_1 = tuple(previous_1)
  *             vit_track1.append(previous+pos1[t][previous][previous_1]-1)
  */
-    if (unlikely(!__pyx_v_previous_2)) { __Pyx_RaiseUnboundLocalError("previous_2"); __PYX_ERR(0, 1235, __pyx_L1_error) }
-    __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_v_previous_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1235, __pyx_L1_error)
+    if (unlikely(!__pyx_v_previous_2)) { __Pyx_RaiseUnboundLocalError("previous_2"); __PYX_ERR(0, 1237, __pyx_L1_error) }
+    __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_v_previous_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_13 = __Pyx_PyObject_Append(__pyx_v_previous_1, __pyx_t_2); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1235, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_Append(__pyx_v_previous_1, __pyx_t_2); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1237, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":1236
+    /* "soapcw/soapcw.pyx":1238
  *             previous_1 = list(previous_1[1:])
  *             previous_1.append(int(previous_2))
  *             previous_1 = tuple(previous_1)             # <<<<<<<<<<<<<<
  *             vit_track1.append(previous+pos1[t][previous][previous_1]-1)
  *             vit_track2.append(previous+pos2[t][previous][previous_1]-1)
  */
-    __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_v_previous_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1236, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_v_previous_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1238, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF_SET(__pyx_v_previous_1, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":1237
+    /* "soapcw/soapcw.pyx":1239
  *             previous_1.append(int(previous_2))
  *             previous_1 = tuple(previous_1)
  *             vit_track1.append(previous+pos1[t][previous][previous_1]-1)             # <<<<<<<<<<<<<<
  *             vit_track2.append(previous+pos2[t][previous][previous_1]-1)
  *             previous_2 = prev[t][previous][previous_1]
  */
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_pos1, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1237, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_pos1, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1239, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_29 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_previous); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1237, __pyx_L1_error)
+    __pyx_t_29 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_previous); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1239, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_29);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_29, __pyx_v_previous_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1237, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_29, __pyx_v_previous_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1239, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-    __pyx_t_29 = PyNumber_Add(__pyx_v_previous, __pyx_t_2); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1237, __pyx_L1_error)
+    __pyx_t_29 = PyNumber_Add(__pyx_v_previous, __pyx_t_2); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1239, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_29);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_t_29, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1237, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_t_29, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1239, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-    __pyx_t_13 = __Pyx_PyList_Append(__pyx_v_vit_track1, __pyx_t_2); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1237, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyList_Append(__pyx_v_vit_track1, __pyx_t_2); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1239, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":1238
+    /* "soapcw/soapcw.pyx":1240
  *             previous_1 = tuple(previous_1)
  *             vit_track1.append(previous+pos1[t][previous][previous_1]-1)
  *             vit_track2.append(previous+pos2[t][previous][previous_1]-1)             # <<<<<<<<<<<<<<
  *             previous_2 = prev[t][previous][previous_1]
  * 
  */
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_pos2, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1238, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_pos2, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1240, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_29 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_previous); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1238, __pyx_L1_error)
+    __pyx_t_29 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_previous); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1240, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_29);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_29, __pyx_v_previous_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1238, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_29, __pyx_v_previous_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1240, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-    __pyx_t_29 = PyNumber_Add(__pyx_v_previous, __pyx_t_2); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1238, __pyx_L1_error)
+    __pyx_t_29 = PyNumber_Add(__pyx_v_previous, __pyx_t_2); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1240, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_29);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_t_29, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1238, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_t_29, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1240, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-    __pyx_t_13 = __Pyx_PyList_Append(__pyx_v_vit_track2, __pyx_t_2); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1238, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyList_Append(__pyx_v_vit_track2, __pyx_t_2); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1240, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":1239
+    /* "soapcw/soapcw.pyx":1241
  *             vit_track1.append(previous+pos1[t][previous][previous_1]-1)
  *             vit_track2.append(previous+pos2[t][previous][previous_1]-1)
  *             previous_2 = prev[t][previous][previous_1]             # <<<<<<<<<<<<<<
  * 
  *         vit_trackr = vit_trackr[::-1]
  */
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_prev, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1239, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_prev, __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_29 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_previous); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1239, __pyx_L1_error)
+    __pyx_t_29 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_previous); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_29);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_29, __pyx_v_previous_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1239, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_29, __pyx_v_previous_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
     __Pyx_XDECREF_SET(__pyx_v_previous_2, __pyx_t_2);
     __pyx_t_2 = 0;
   }
 
-  /* "soapcw/soapcw.pyx":1241
+  /* "soapcw/soapcw.pyx":1243
  *             previous_2 = prev[t][previous][previous_1]
  * 
  *         vit_trackr = vit_trackr[::-1]             # <<<<<<<<<<<<<<
  *         vit_track1 = vit_track1[::-1]
  *         vit_track2 = vit_track2[::-1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_vit_trackr, __pyx_slice__9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1241, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_vit_trackr, __pyx_slice__9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1243, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF_SET(__pyx_v_vit_trackr, ((PyObject*)__pyx_t_2));
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1242
+  /* "soapcw/soapcw.pyx":1244
  * 
  *         vit_trackr = vit_trackr[::-1]
  *         vit_track1 = vit_track1[::-1]             # <<<<<<<<<<<<<<
  *         vit_track2 = vit_track2[::-1]
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_vit_track1, __pyx_slice__9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1242, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_vit_track1, __pyx_slice__9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1244, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF_SET(__pyx_v_vit_track1, ((PyObject*)__pyx_t_2));
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1243
+  /* "soapcw/soapcw.pyx":1245
  *         vit_trackr = vit_trackr[::-1]
  *         vit_track1 = vit_track1[::-1]
  *         vit_track2 = vit_track2[::-1]             # <<<<<<<<<<<<<<
  * 
  *         self.vit_track1 = np.array(vit_track1)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_vit_track2, __pyx_slice__9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1243, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_vit_track2, __pyx_slice__9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1245, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF_SET(__pyx_v_vit_track2, ((PyObject*)__pyx_t_2));
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1245
+  /* "soapcw/soapcw.pyx":1247
  *         vit_track2 = vit_track2[::-1]
  * 
  *         self.vit_track1 = np.array(vit_track1)             # <<<<<<<<<<<<<<
  *         self.vit_track2 = np.array(vit_track2)
  *         self.vit_track = np.array(vit_trackr)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_29, __pyx_n_s_np); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1245, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_29, __pyx_n_s_np); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1247, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_29);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1245, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1247, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
   __pyx_t_29 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_29 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_29)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_29);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_2 = (__pyx_t_29) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_29, __pyx_v_vit_track1) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_vit_track1);
   __Pyx_XDECREF(__pyx_t_29); __pyx_t_29 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1245, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1247, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track1, __pyx_t_2) < 0) __PYX_ERR(0, 1245, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track1, __pyx_t_2) < 0) __PYX_ERR(0, 1247, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1246
+  /* "soapcw/soapcw.pyx":1248
  * 
  *         self.vit_track1 = np.array(vit_track1)
  *         self.vit_track2 = np.array(vit_track2)             # <<<<<<<<<<<<<<
  *         self.vit_track = np.array(vit_trackr)
  *         self.V = np.array(val)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1246, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1248, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_29 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1246, __pyx_L1_error)
+  __pyx_t_29 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1248, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_29);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_29))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_29);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_29);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_29, function);
     }
   }
   __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_29, __pyx_t_6, __pyx_v_vit_track2) : __Pyx_PyObject_CallOneArg(__pyx_t_29, __pyx_v_vit_track2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1246, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1248, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track2, __pyx_t_2) < 0) __PYX_ERR(0, 1246, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track2, __pyx_t_2) < 0) __PYX_ERR(0, 1248, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1247
+  /* "soapcw/soapcw.pyx":1249
  *         self.vit_track1 = np.array(vit_track1)
  *         self.vit_track2 = np.array(vit_track2)
  *         self.vit_track = np.array(vit_trackr)             # <<<<<<<<<<<<<<
  *         self.V = np.array(val)
  *         self.prev = np.array(prev)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_29, __pyx_n_s_np); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1247, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_29, __pyx_n_s_np); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1249, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_29);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1247, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1249, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
   __pyx_t_29 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_29 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_29)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_29);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_2 = (__pyx_t_29) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_29, __pyx_v_vit_trackr) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_vit_trackr);
   __Pyx_XDECREF(__pyx_t_29); __pyx_t_29 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1247, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1249, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track, __pyx_t_2) < 0) __PYX_ERR(0, 1247, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track, __pyx_t_2) < 0) __PYX_ERR(0, 1249, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1248
+  /* "soapcw/soapcw.pyx":1250
  *         self.vit_track2 = np.array(vit_track2)
  *         self.vit_track = np.array(vit_trackr)
  *         self.V = np.array(val)             # <<<<<<<<<<<<<<
  *         self.prev = np.array(prev)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1248, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1250, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_29 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1248, __pyx_L1_error)
+  __pyx_t_29 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1250, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_29);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_29))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_29);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_29);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_29, function);
     }
   }
   __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_29, __pyx_t_6, __pyx_v_val) : __Pyx_PyObject_CallOneArg(__pyx_t_29, __pyx_v_val);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1248, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1250, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_V, __pyx_t_2) < 0) __PYX_ERR(0, 1248, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_V, __pyx_t_2) < 0) __PYX_ERR(0, 1250, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1249
+  /* "soapcw/soapcw.pyx":1251
  *         self.vit_track = np.array(vit_trackr)
  *         self.V = np.array(val)
  *         self.prev = np.array(prev)             # <<<<<<<<<<<<<<
  * 
  *         #return (vit_track1,vit_track2,vit_trackr,val,prev)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_29, __pyx_n_s_np); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1249, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_29, __pyx_n_s_np); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 1251, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_29);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1249, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1251, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
   __pyx_t_29 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_29 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_29)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_29);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_2 = (__pyx_t_29) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_29, __pyx_v_prev) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_prev);
   __Pyx_XDECREF(__pyx_t_29); __pyx_t_29 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1249, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1251, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prev, __pyx_t_2) < 0) __PYX_ERR(0, 1249, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prev, __pyx_t_2) < 0) __PYX_ERR(0, 1251, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1082
+  /* "soapcw/soapcw.pyx":1084
  * 
  * 
  *     def run(self, tr, obs11, obs22):             # <<<<<<<<<<<<<<
  *         ''' Run viterbi algroithm with memory of n
  *         the amount of memory is determined by the transition matrix
  */
 
@@ -23823,15 +23994,15 @@
   __Pyx_XDECREF(__pyx_v_vit_trackr);
   __Pyx_XDECREF(__pyx_v_previous_2);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":1262
+/* "soapcw/soapcw.pyx":1264
  * class single_detector_gaps(object):
  * 
  *     def __init__(self, tr, obs,times,tsft):             # <<<<<<<<<<<<<<
  *         """
  *         single detector viterbi algorithm where the data can include large gaps in data
  */
 
@@ -23841,14 +24012,17 @@
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_1__init__ = {"__init__", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_20single_detector_gaps_1__init__, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6soapcw_6soapcw_20single_detector_gaps___init__};
 static PyObject *__pyx_pw_6soapcw_6soapcw_20single_detector_gaps_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_tr = 0;
   PyObject *__pyx_v_obs = 0;
   PyObject *__pyx_v_times = 0;
   PyObject *__pyx_v_tsft = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr,&__pyx_n_s_obs,&__pyx_n_s_times,&__pyx_n_s_tsft,0};
     PyObject* values[5] = {0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
@@ -23873,37 +24047,37 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, 1); __PYX_ERR(0, 1262, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, 1); __PYX_ERR(0, 1264, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obs)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, 2); __PYX_ERR(0, 1262, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, 2); __PYX_ERR(0, 1264, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_times)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, 3); __PYX_ERR(0, 1262, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, 3); __PYX_ERR(0, 1264, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tsft)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, 4); __PYX_ERR(0, 1262, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, 4); __PYX_ERR(0, 1264, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1262, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1264, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -23914,15 +24088,15 @@
     __pyx_v_tr = values[1];
     __pyx_v_obs = values[2];
     __pyx_v_times = values[3];
     __pyx_v_tsft = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1262, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1264, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.single_detector_gaps.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_20single_detector_gaps___init__(__pyx_self, __pyx_v_self, __pyx_v_tr, __pyx_v_obs, __pyx_v_times, __pyx_v_tsft);
 
@@ -23936,49 +24110,52 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *(*__pyx_t_6)(PyObject *);
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "soapcw/soapcw.pyx":1284
+  /* "soapcw/soapcw.pyx":1286
  *             list of the times corresponding to each of the path elements
  *         """
  *         self.vits, self.sts, self.gps = self.vit_gaps(obs, times, tr=tr, tsft=tsft)             # <<<<<<<<<<<<<<
  *         self.vit_track, self.vit_track_times = self.get_track(self.vits, self.sts, self.gps,tsft=tsft)
  *         self.max_end_prob = max(self.vits[-1].V[-1])
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_vit_gaps); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1284, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_vit_gaps); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1286, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1284, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1286, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v_obs);
   __Pyx_GIVEREF(__pyx_v_obs);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_obs);
   __Pyx_INCREF(__pyx_v_times);
   __Pyx_GIVEREF(__pyx_v_times);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_times);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1284, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1286, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_tr, __pyx_v_tr) < 0) __PYX_ERR(0, 1284, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_tsft, __pyx_v_tsft) < 0) __PYX_ERR(0, 1284, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1284, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_tr, __pyx_v_tr) < 0) __PYX_ERR(0, 1286, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_tsft, __pyx_v_tsft) < 0) __PYX_ERR(0, 1286, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1286, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
     PyObject* sequence = __pyx_t_4;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 3)) {
       if (size > 3) __Pyx_RaiseTooManyValuesError(3);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 1284, __pyx_L1_error)
+      __PYX_ERR(0, 1286, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
       __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
       __pyx_t_1 = PyTuple_GET_ITEM(sequence, 2); 
     } else {
@@ -23986,162 +24163,162 @@
       __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
       __pyx_t_1 = PyList_GET_ITEM(sequence, 2); 
     }
     __Pyx_INCREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_t_1);
     #else
-    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1284, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1286, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1284, __pyx_L1_error)
+    __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1286, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1284, __pyx_L1_error)
+    __pyx_t_1 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1286, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     #endif
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1284, __pyx_L1_error)
+    __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1286, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext;
     index = 0; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_3);
     index = 1; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_2);
     index = 2; __pyx_t_1 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_1)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_1);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_6(__pyx_t_5), 3) < 0) __PYX_ERR(0, 1284, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_6(__pyx_t_5), 3) < 0) __PYX_ERR(0, 1286, __pyx_L1_error)
     __pyx_t_6 = NULL;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     goto __pyx_L4_unpacking_done;
     __pyx_L3_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_6 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 1284, __pyx_L1_error)
+    __PYX_ERR(0, 1286, __pyx_L1_error)
     __pyx_L4_unpacking_done:;
   }
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vits, __pyx_t_3) < 0) __PYX_ERR(0, 1284, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vits, __pyx_t_3) < 0) __PYX_ERR(0, 1286, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_sts, __pyx_t_2) < 0) __PYX_ERR(0, 1284, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_sts, __pyx_t_2) < 0) __PYX_ERR(0, 1286, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_gps, __pyx_t_1) < 0) __PYX_ERR(0, 1284, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_gps, __pyx_t_1) < 0) __PYX_ERR(0, 1286, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1285
+  /* "soapcw/soapcw.pyx":1287
  *         """
  *         self.vits, self.sts, self.gps = self.vit_gaps(obs, times, tr=tr, tsft=tsft)
  *         self.vit_track, self.vit_track_times = self.get_track(self.vits, self.sts, self.gps,tsft=tsft)             # <<<<<<<<<<<<<<
  *         self.max_end_prob = max(self.vits[-1].V[-1])
  * 
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_track); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1285, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_track); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1287, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_vits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1285, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_vits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1287, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_sts); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1285, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_sts); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1287, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gps); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1285, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gps); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1287, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1285, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1287, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_3);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1285, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1287, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_tsft, __pyx_v_tsft) < 0) __PYX_ERR(0, 1285, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1285, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_tsft, __pyx_v_tsft) < 0) __PYX_ERR(0, 1287, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1287, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
     PyObject* sequence = __pyx_t_2;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 2)) {
       if (size > 2) __Pyx_RaiseTooManyValuesError(2);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 1285, __pyx_L1_error)
+      __PYX_ERR(0, 1287, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
       __pyx_t_5 = PyTuple_GET_ITEM(sequence, 1); 
     } else {
       __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
       __pyx_t_5 = PyList_GET_ITEM(sequence, 1); 
     }
     __Pyx_INCREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_t_5);
     #else
-    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1285, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1287, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1285, __pyx_L1_error)
+    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1287, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     #endif
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_4 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1285, __pyx_L1_error)
+    __pyx_t_4 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1287, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext;
     index = 0; __pyx_t_3 = __pyx_t_6(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_3);
     index = 1; __pyx_t_5 = __pyx_t_6(__pyx_t_4); if (unlikely(!__pyx_t_5)) goto __pyx_L5_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_5);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_6(__pyx_t_4), 2) < 0) __PYX_ERR(0, 1285, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_6(__pyx_t_4), 2) < 0) __PYX_ERR(0, 1287, __pyx_L1_error)
     __pyx_t_6 = NULL;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     goto __pyx_L6_unpacking_done;
     __pyx_L5_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_6 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 1285, __pyx_L1_error)
+    __PYX_ERR(0, 1287, __pyx_L1_error)
     __pyx_L6_unpacking_done:;
   }
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track, __pyx_t_3) < 0) __PYX_ERR(0, 1285, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track, __pyx_t_3) < 0) __PYX_ERR(0, 1287, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track_times, __pyx_t_5) < 0) __PYX_ERR(0, 1285, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_vit_track_times, __pyx_t_5) < 0) __PYX_ERR(0, 1287, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "soapcw/soapcw.pyx":1286
+  /* "soapcw/soapcw.pyx":1288
  *         self.vits, self.sts, self.gps = self.vit_gaps(obs, times, tr=tr, tsft=tsft)
  *         self.vit_track, self.vit_track_times = self.get_track(self.vits, self.sts, self.gps,tsft=tsft)
  *         self.max_end_prob = max(self.vits[-1].V[-1])             # <<<<<<<<<<<<<<
  * 
  *     def max_track(self,tr,length,diff,bnd,ind,band_width):
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_vits); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1286, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_vits); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1286, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_V); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1286, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_V); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1286, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_max, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1286, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_max, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_max_end_prob, __pyx_t_2) < 0) __PYX_ERR(0, 1286, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_max_end_prob, __pyx_t_2) < 0) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1262
+  /* "soapcw/soapcw.pyx":1264
  * class single_detector_gaps(object):
  * 
  *     def __init__(self, tr, obs,times,tsft):             # <<<<<<<<<<<<<<
  *         """
  *         single detector viterbi algorithm where the data can include large gaps in data
  */
 
@@ -24158,15 +24335,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":1288
+/* "soapcw/soapcw.pyx":1290
  *         self.max_end_prob = max(self.vits[-1].V[-1])
  * 
  *     def max_track(self,tr,length,diff,bnd,ind,band_width):             # <<<<<<<<<<<<<<
  *         tr_val = np.arange(len(tr)).astype(int) - np.floor(len(tr)/2).astype(int)
  *         result = [seq for seq in itertools.combinations_with_replacement(tr_val, length) if sum(seq) == diff]
  */
 
@@ -24177,14 +24354,17 @@
   CYTHON_UNUSED PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_tr = 0;
   PyObject *__pyx_v_length = 0;
   PyObject *__pyx_v_diff = 0;
   CYTHON_UNUSED PyObject *__pyx_v_bnd = 0;
   PyObject *__pyx_v_ind = 0;
   PyObject *__pyx_v_band_width = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("max_track (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr,&__pyx_n_s_length,&__pyx_n_s_diff,&__pyx_n_s_bnd,&__pyx_n_s_ind,&__pyx_n_s_band_width,0};
     PyObject* values[7] = {0,0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
@@ -24213,49 +24393,49 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, 1); __PYX_ERR(0, 1288, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, 1); __PYX_ERR(0, 1290, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_length)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, 2); __PYX_ERR(0, 1288, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, 2); __PYX_ERR(0, 1290, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_diff)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, 3); __PYX_ERR(0, 1288, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, 3); __PYX_ERR(0, 1290, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_bnd)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, 4); __PYX_ERR(0, 1288, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, 4); __PYX_ERR(0, 1290, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_ind)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, 5); __PYX_ERR(0, 1288, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, 5); __PYX_ERR(0, 1290, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_band_width)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, 6); __PYX_ERR(0, 1288, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, 6); __PYX_ERR(0, 1290, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "max_track") < 0)) __PYX_ERR(0, 1288, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "max_track") < 0)) __PYX_ERR(0, 1290, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -24270,15 +24450,15 @@
     __pyx_v_diff = values[3];
     __pyx_v_bnd = values[4];
     __pyx_v_ind = values[5];
     __pyx_v_band_width = values[6];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1288, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("max_track", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1290, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.single_detector_gaps.max_track", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_20single_detector_gaps_2max_track(__pyx_self, __pyx_v_self, __pyx_v_tr, __pyx_v_length, __pyx_v_diff, __pyx_v_bnd, __pyx_v_ind, __pyx_v_band_width);
 
@@ -24309,127 +24489,130 @@
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   PyObject *(*__pyx_t_9)(PyObject *);
   int __pyx_t_10;
   int __pyx_t_11;
   Py_ssize_t __pyx_t_12;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("max_track", 0);
 
-  /* "soapcw/soapcw.pyx":1289
+  /* "soapcw/soapcw.pyx":1291
  * 
  *     def max_track(self,tr,length,diff,bnd,ind,band_width):
  *         tr_val = np.arange(len(tr)).astype(int) - np.floor(len(tr)/2).astype(int)             # <<<<<<<<<<<<<<
  *         result = [seq for seq in itertools.combinations_with_replacement(tr_val, length) if sum(seq) == diff]
  *         max_seq = None
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_arange); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_arange); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = PyObject_Length(__pyx_v_tr); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1289, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_v_tr); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1291, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_4, ((PyObject *)(&PyInt_Type)));
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_floor); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_floor); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = PyObject_Length(__pyx_v_tr); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1289, __pyx_L1_error)
-  __pyx_t_3 = PyFloat_FromDouble((((double)__pyx_t_5) / 2.0)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_v_tr); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1291, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble((((double)__pyx_t_5) / 2.0)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_7 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_7)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_7);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_2 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_6, ((PyObject *)(&PyInt_Type)));
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyNumber_Subtract(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1289, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Subtract(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_tr_val = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "soapcw/soapcw.pyx":1290
+  /* "soapcw/soapcw.pyx":1292
  *     def max_track(self,tr,length,diff,bnd,ind,band_width):
  *         tr_val = np.arange(len(tr)).astype(int) - np.floor(len(tr)/2).astype(int)
  *         result = [seq for seq in itertools.combinations_with_replacement(tr_val, length) if sum(seq) == diff]             # <<<<<<<<<<<<<<
  *         max_seq = None
  *         thresh = -np.inf
  */
   { /* enter inner scope */
-    __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1290, __pyx_L5_error)
+    __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1292, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_itertools); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1290, __pyx_L5_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_itertools); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1292, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_combinations_with_replacement); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1290, __pyx_L5_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_combinations_with_replacement); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1292, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_1 = NULL;
     __pyx_t_8 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_1)) {
@@ -24439,205 +24622,205 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_8 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_tr_val, __pyx_v_length};
-      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1290, __pyx_L5_error)
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1292, __pyx_L5_error)
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GOTREF(__pyx_t_4);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_tr_val, __pyx_v_length};
-      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1290, __pyx_L5_error)
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1292, __pyx_L5_error)
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GOTREF(__pyx_t_4);
     } else
     #endif
     {
-      __pyx_t_3 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1290, __pyx_L5_error)
+      __pyx_t_3 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1292, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_3);
       if (__pyx_t_1) {
         __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
       }
       __Pyx_INCREF(__pyx_v_tr_val);
       __Pyx_GIVEREF(__pyx_v_tr_val);
       PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_8, __pyx_v_tr_val);
       __Pyx_INCREF(__pyx_v_length);
       __Pyx_GIVEREF(__pyx_v_length);
       PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_8, __pyx_v_length);
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1290, __pyx_L5_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1292, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
       __pyx_t_2 = __pyx_t_4; __Pyx_INCREF(__pyx_t_2); __pyx_t_5 = 0;
       __pyx_t_9 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1290, __pyx_L5_error)
+      __pyx_t_5 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1292, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_9 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1290, __pyx_L5_error)
+      __pyx_t_9 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1292, __pyx_L5_error)
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     for (;;) {
       if (likely(!__pyx_t_9)) {
         if (likely(PyList_CheckExact(__pyx_t_2))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_2)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1290, __pyx_L5_error)
+          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1292, __pyx_L5_error)
           #else
-          __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1290, __pyx_L5_error)
+          __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1292, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_4);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1290, __pyx_L5_error)
+          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1292, __pyx_L5_error)
           #else
-          __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1290, __pyx_L5_error)
+          __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1292, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_4);
           #endif
         }
       } else {
         __pyx_t_4 = __pyx_t_9(__pyx_t_2);
         if (unlikely(!__pyx_t_4)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 1290, __pyx_L5_error)
+            else __PYX_ERR(0, 1292, __pyx_L5_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_4);
       }
       __Pyx_XDECREF_SET(__pyx_8genexpr9__pyx_v_seq, __pyx_t_4);
       __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_8genexpr9__pyx_v_seq); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1290, __pyx_L5_error)
+      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_8genexpr9__pyx_v_seq); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1292, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_v_diff, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1290, __pyx_L5_error)
+      __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_v_diff, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1292, __pyx_L5_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1290, __pyx_L5_error)
+      __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1292, __pyx_L5_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_10) {
-        if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_8genexpr9__pyx_v_seq))) __PYX_ERR(0, 1290, __pyx_L5_error)
+        if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_8genexpr9__pyx_v_seq))) __PYX_ERR(0, 1292, __pyx_L5_error)
       }
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_8genexpr9__pyx_v_seq); __pyx_8genexpr9__pyx_v_seq = 0;
     goto __pyx_L9_exit_scope;
     __pyx_L5_error:;
     __Pyx_XDECREF(__pyx_8genexpr9__pyx_v_seq); __pyx_8genexpr9__pyx_v_seq = 0;
     goto __pyx_L1_error;
     __pyx_L9_exit_scope:;
   } /* exit inner scope */
   __pyx_v_result = ((PyObject*)__pyx_t_6);
   __pyx_t_6 = 0;
 
-  /* "soapcw/soapcw.pyx":1291
+  /* "soapcw/soapcw.pyx":1293
  *         tr_val = np.arange(len(tr)).astype(int) - np.floor(len(tr)/2).astype(int)
  *         result = [seq for seq in itertools.combinations_with_replacement(tr_val, length) if sum(seq) == diff]
  *         max_seq = None             # <<<<<<<<<<<<<<
  *         thresh = -np.inf
  *         thresh2 = -np.inf
  */
   __Pyx_INCREF(Py_None);
   __pyx_v_max_seq = Py_None;
 
-  /* "soapcw/soapcw.pyx":1292
+  /* "soapcw/soapcw.pyx":1294
  *         result = [seq for seq in itertools.combinations_with_replacement(tr_val, length) if sum(seq) == diff]
  *         max_seq = None
  *         thresh = -np.inf             # <<<<<<<<<<<<<<
  *         thresh2 = -np.inf
  *         #print ind,bnd, diff, [np.cumsum(s)+ind for s in result]
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1292, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1294, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_inf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1292, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_inf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1294, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyNumber_Negative(__pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1292, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Negative(__pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1294, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_thresh = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "soapcw/soapcw.pyx":1293
+  /* "soapcw/soapcw.pyx":1295
  *         max_seq = None
  *         thresh = -np.inf
  *         thresh2 = -np.inf             # <<<<<<<<<<<<<<
  *         #print ind,bnd, diff, [np.cumsum(s)+ind for s in result]
  *         for seq in result:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1293, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_inf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1293, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_inf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyNumber_Negative(__pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1293, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Negative(__pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_thresh2 = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "soapcw/soapcw.pyx":1295
+  /* "soapcw/soapcw.pyx":1297
  *         thresh2 = -np.inf
  *         #print ind,bnd, diff, [np.cumsum(s)+ind for s in result]
  *         for seq in result:             # <<<<<<<<<<<<<<
  *             #print seq
  *             abspath = np.array(np.cumsum(seq) + ind)
  */
   __pyx_t_6 = __pyx_v_result; __Pyx_INCREF(__pyx_t_6); __pyx_t_5 = 0;
   for (;;) {
     if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_6)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_2 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1295, __pyx_L1_error)
+    __pyx_t_2 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1297, __pyx_L1_error)
     #else
-    __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1295, __pyx_L1_error)
+    __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1297, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     #endif
     __Pyx_XDECREF_SET(__pyx_v_seq, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":1297
+    /* "soapcw/soapcw.pyx":1299
  *         for seq in result:
  *             #print seq
  *             abspath = np.array(np.cumsum(seq) + ind)             # <<<<<<<<<<<<<<
  *             if np.any(abspath < 0) == True or np.any(abspath >= band_width) == True:
  *                 continue
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1297, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1297, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1297, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_cumsum); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1297, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_cumsum); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_1, __pyx_v_seq) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_seq);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1297, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Add(__pyx_t_3, __pyx_v_ind); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1297, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Add(__pyx_t_3, __pyx_v_ind); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -24645,213 +24828,213 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_7);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1297, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_XDECREF_SET(__pyx_v_abspath, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "soapcw/soapcw.pyx":1298
+    /* "soapcw/soapcw.pyx":1300
  *             #print seq
  *             abspath = np.array(np.cumsum(seq) + ind)
  *             if np.any(abspath < 0) == True or np.any(abspath >= band_width) == True:             # <<<<<<<<<<<<<<
  *                 continue
  *             else:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1298, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1300, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_any); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1298, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_any); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1300, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyObject_RichCompare(__pyx_v_abspath, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1298, __pyx_L1_error)
+    __pyx_t_4 = PyObject_RichCompare(__pyx_v_abspath, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1300, __pyx_L1_error)
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1298, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1300, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyObject_RichCompare(__pyx_t_2, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1298, __pyx_L1_error)
+    __pyx_t_7 = PyObject_RichCompare(__pyx_t_2, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1300, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1298, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1300, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     if (!__pyx_t_11) {
     } else {
       __pyx_t_10 = __pyx_t_11;
       goto __pyx_L13_bool_binop_done;
     }
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1298, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1300, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1298, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1300, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyObject_RichCompare(__pyx_v_abspath, __pyx_v_band_width, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1298, __pyx_L1_error)
+    __pyx_t_2 = PyObject_RichCompare(__pyx_v_abspath, __pyx_v_band_width, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1300, __pyx_L1_error)
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_7 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1298, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1300, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyObject_RichCompare(__pyx_t_7, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1298, __pyx_L1_error)
+    __pyx_t_4 = PyObject_RichCompare(__pyx_t_7, Py_True, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1300, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1298, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1300, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_10 = __pyx_t_11;
     __pyx_L13_bool_binop_done:;
     if (__pyx_t_10) {
 
-      /* "soapcw/soapcw.pyx":1299
+      /* "soapcw/soapcw.pyx":1301
  *             abspath = np.array(np.cumsum(seq) + ind)
  *             if np.any(abspath < 0) == True or np.any(abspath >= band_width) == True:
  *                 continue             # <<<<<<<<<<<<<<
  *             else:
  *                 s = sum([tr[elem+1] for elem in seq])
  */
       goto __pyx_L10_continue;
 
-      /* "soapcw/soapcw.pyx":1298
+      /* "soapcw/soapcw.pyx":1300
  *             #print seq
  *             abspath = np.array(np.cumsum(seq) + ind)
  *             if np.any(abspath < 0) == True or np.any(abspath >= band_width) == True:             # <<<<<<<<<<<<<<
  *                 continue
  *             else:
  */
     }
 
-    /* "soapcw/soapcw.pyx":1301
+    /* "soapcw/soapcw.pyx":1303
  *                 continue
  *             else:
  *                 s = sum([tr[elem+1] for elem in seq])             # <<<<<<<<<<<<<<
  *                 l = len(np.where(np.array(seq) == 0)[0])
  *                 if s > thresh:
  */
     /*else*/ {
       { /* enter inner scope */
-        __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1301, __pyx_L17_error)
+        __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1303, __pyx_L17_error)
         __Pyx_GOTREF(__pyx_t_4);
         if (likely(PyList_CheckExact(__pyx_v_seq)) || PyTuple_CheckExact(__pyx_v_seq)) {
           __pyx_t_7 = __pyx_v_seq; __Pyx_INCREF(__pyx_t_7); __pyx_t_12 = 0;
           __pyx_t_9 = NULL;
         } else {
-          __pyx_t_12 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_v_seq); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1301, __pyx_L17_error)
+          __pyx_t_12 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_v_seq); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1303, __pyx_L17_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __pyx_t_9 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1301, __pyx_L17_error)
+          __pyx_t_9 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1303, __pyx_L17_error)
         }
         for (;;) {
           if (likely(!__pyx_t_9)) {
             if (likely(PyList_CheckExact(__pyx_t_7))) {
               if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_7)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_2 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_12); __Pyx_INCREF(__pyx_t_2); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1301, __pyx_L17_error)
+              __pyx_t_2 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_12); __Pyx_INCREF(__pyx_t_2); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1303, __pyx_L17_error)
               #else
-              __pyx_t_2 = PySequence_ITEM(__pyx_t_7, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1301, __pyx_L17_error)
+              __pyx_t_2 = PySequence_ITEM(__pyx_t_7, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1303, __pyx_L17_error)
               __Pyx_GOTREF(__pyx_t_2);
               #endif
             } else {
               if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_12); __Pyx_INCREF(__pyx_t_2); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1301, __pyx_L17_error)
+              __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_12); __Pyx_INCREF(__pyx_t_2); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1303, __pyx_L17_error)
               #else
-              __pyx_t_2 = PySequence_ITEM(__pyx_t_7, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1301, __pyx_L17_error)
+              __pyx_t_2 = PySequence_ITEM(__pyx_t_7, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1303, __pyx_L17_error)
               __Pyx_GOTREF(__pyx_t_2);
               #endif
             }
           } else {
             __pyx_t_2 = __pyx_t_9(__pyx_t_7);
             if (unlikely(!__pyx_t_2)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 1301, __pyx_L17_error)
+                else __PYX_ERR(0, 1303, __pyx_L17_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_2);
           }
           __Pyx_XDECREF_SET(__pyx_9genexpr10__pyx_v_elem, __pyx_t_2);
           __pyx_t_2 = 0;
-          __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_9genexpr10__pyx_v_elem, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1301, __pyx_L17_error)
+          __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_9genexpr10__pyx_v_elem, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1303, __pyx_L17_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_tr, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1301, __pyx_L17_error)
+          __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_tr, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1303, __pyx_L17_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1301, __pyx_L17_error)
+          if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1303, __pyx_L17_error)
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         }
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_elem); __pyx_9genexpr10__pyx_v_elem = 0;
         goto __pyx_L20_exit_scope;
         __pyx_L17_error:;
         __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_elem); __pyx_9genexpr10__pyx_v_elem = 0;
         goto __pyx_L1_error;
         __pyx_L20_exit_scope:;
       } /* exit inner scope */
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1301, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1303, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_XDECREF_SET(__pyx_v_s, __pyx_t_7);
       __pyx_t_7 = 0;
 
-      /* "soapcw/soapcw.pyx":1302
+      /* "soapcw/soapcw.pyx":1304
  *             else:
  *                 s = sum([tr[elem+1] for elem in seq])
  *                 l = len(np.where(np.array(seq) == 0)[0])             # <<<<<<<<<<<<<<
  *                 if s > thresh:
  *                     max_seq = np.insert(abspath,0,ind)[:-1]
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1302, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1304, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_where); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1302, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_where); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1304, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1302, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1304, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1302, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1304, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_2)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_2);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_v_seq) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_seq);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1302, __pyx_L1_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1304, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_4, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1302, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_4, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1304, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -24859,46 +25042,46 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_7 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1302, __pyx_L1_error)
+      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1304, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1302, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1304, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_12 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1302, __pyx_L1_error)
+      __pyx_t_12 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1304, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_v_l = __pyx_t_12;
 
-      /* "soapcw/soapcw.pyx":1303
+      /* "soapcw/soapcw.pyx":1305
  *                 s = sum([tr[elem+1] for elem in seq])
  *                 l = len(np.where(np.array(seq) == 0)[0])
  *                 if s > thresh:             # <<<<<<<<<<<<<<
  *                     max_seq = np.insert(abspath,0,ind)[:-1]
  *                     thresh = s
  */
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_s, __pyx_v_thresh, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1303, __pyx_L1_error)
-      __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1303, __pyx_L1_error)
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_s, __pyx_v_thresh, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1305, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1305, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_10) {
 
-        /* "soapcw/soapcw.pyx":1304
+        /* "soapcw/soapcw.pyx":1306
  *                 l = len(np.where(np.array(seq) == 0)[0])
  *                 if s > thresh:
  *                     max_seq = np.insert(abspath,0,ind)[:-1]             # <<<<<<<<<<<<<<
  *                     thresh = s
  *                 elif s == thresh and l > thresh2:
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1304, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1306, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_insert); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1304, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_insert); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1306, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __pyx_t_7 = NULL;
         __pyx_t_8 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
           __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_1);
           if (likely(__pyx_t_7)) {
@@ -24908,108 +25091,108 @@
             __Pyx_DECREF_SET(__pyx_t_1, function);
             __pyx_t_8 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_1)) {
           PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_v_abspath, __pyx_int_0, __pyx_v_ind};
-          __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1304, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1306, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_GOTREF(__pyx_t_3);
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
           PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_v_abspath, __pyx_int_0, __pyx_v_ind};
-          __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1304, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1306, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_GOTREF(__pyx_t_3);
         } else
         #endif
         {
-          __pyx_t_4 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1304, __pyx_L1_error)
+          __pyx_t_4 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1306, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           if (__pyx_t_7) {
             __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7); __pyx_t_7 = NULL;
           }
           __Pyx_INCREF(__pyx_v_abspath);
           __Pyx_GIVEREF(__pyx_v_abspath);
           PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_8, __pyx_v_abspath);
           __Pyx_INCREF(__pyx_int_0);
           __Pyx_GIVEREF(__pyx_int_0);
           PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_8, __pyx_int_0);
           __Pyx_INCREF(__pyx_v_ind);
           __Pyx_GIVEREF(__pyx_v_ind);
           PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_8, __pyx_v_ind);
-          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1304, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1306, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         }
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, -1L, NULL, NULL, &__pyx_slice__10, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1304, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, -1L, NULL, NULL, &__pyx_slice__10, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1306, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF_SET(__pyx_v_max_seq, __pyx_t_1);
         __pyx_t_1 = 0;
 
-        /* "soapcw/soapcw.pyx":1305
+        /* "soapcw/soapcw.pyx":1307
  *                 if s > thresh:
  *                     max_seq = np.insert(abspath,0,ind)[:-1]
  *                     thresh = s             # <<<<<<<<<<<<<<
  *                 elif s == thresh and l > thresh2:
  *                     max_seq = np.insert(abspath,0,ind)[:-1]
  */
         __Pyx_INCREF(__pyx_v_s);
         __Pyx_DECREF_SET(__pyx_v_thresh, __pyx_v_s);
 
-        /* "soapcw/soapcw.pyx":1303
+        /* "soapcw/soapcw.pyx":1305
  *                 s = sum([tr[elem+1] for elem in seq])
  *                 l = len(np.where(np.array(seq) == 0)[0])
  *                 if s > thresh:             # <<<<<<<<<<<<<<
  *                     max_seq = np.insert(abspath,0,ind)[:-1]
  *                     thresh = s
  */
         goto __pyx_L21;
       }
 
-      /* "soapcw/soapcw.pyx":1306
+      /* "soapcw/soapcw.pyx":1308
  *                     max_seq = np.insert(abspath,0,ind)[:-1]
  *                     thresh = s
  *                 elif s == thresh and l > thresh2:             # <<<<<<<<<<<<<<
  *                     max_seq = np.insert(abspath,0,ind)[:-1]
  *                     thresh = s
  */
-      __pyx_t_1 = PyObject_RichCompare(__pyx_v_s, __pyx_v_thresh, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1306, __pyx_L1_error)
-      __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1306, __pyx_L1_error)
+      __pyx_t_1 = PyObject_RichCompare(__pyx_v_s, __pyx_v_thresh, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1308, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1308, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (__pyx_t_11) {
       } else {
         __pyx_t_10 = __pyx_t_11;
         goto __pyx_L22_bool_binop_done;
       }
-      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_l); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1306, __pyx_L1_error)
+      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_l); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1308, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_v_thresh2, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1306, __pyx_L1_error)
+      __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_v_thresh2, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1308, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1306, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1308, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_t_10 = __pyx_t_11;
       __pyx_L22_bool_binop_done:;
       if (__pyx_t_10) {
 
-        /* "soapcw/soapcw.pyx":1307
+        /* "soapcw/soapcw.pyx":1309
  *                     thresh = s
  *                 elif s == thresh and l > thresh2:
  *                     max_seq = np.insert(abspath,0,ind)[:-1]             # <<<<<<<<<<<<<<
  *                     thresh = s
  *                     thresh2 = l
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1307, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1309, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_insert); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1307, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_insert); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1309, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_t_1 = NULL;
         __pyx_t_8 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
           __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
           if (likely(__pyx_t_1)) {
@@ -25019,119 +25202,119 @@
             __Pyx_DECREF_SET(__pyx_t_4, function);
             __pyx_t_8 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[4] = {__pyx_t_1, __pyx_v_abspath, __pyx_int_0, __pyx_v_ind};
-          __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1307, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1309, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_GOTREF(__pyx_t_3);
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[4] = {__pyx_t_1, __pyx_v_abspath, __pyx_int_0, __pyx_v_ind};
-          __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1307, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1309, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_GOTREF(__pyx_t_3);
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1307, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1309, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_1) {
             __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1); __pyx_t_1 = NULL;
           }
           __Pyx_INCREF(__pyx_v_abspath);
           __Pyx_GIVEREF(__pyx_v_abspath);
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_8, __pyx_v_abspath);
           __Pyx_INCREF(__pyx_int_0);
           __Pyx_GIVEREF(__pyx_int_0);
           PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_8, __pyx_int_0);
           __Pyx_INCREF(__pyx_v_ind);
           __Pyx_GIVEREF(__pyx_v_ind);
           PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_8, __pyx_v_ind);
-          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1307, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1309, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, -1L, NULL, NULL, &__pyx_slice__10, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1307, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, -1L, NULL, NULL, &__pyx_slice__10, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1309, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF_SET(__pyx_v_max_seq, __pyx_t_4);
         __pyx_t_4 = 0;
 
-        /* "soapcw/soapcw.pyx":1308
+        /* "soapcw/soapcw.pyx":1310
  *                 elif s == thresh and l > thresh2:
  *                     max_seq = np.insert(abspath,0,ind)[:-1]
  *                     thresh = s             # <<<<<<<<<<<<<<
  *                     thresh2 = l
  * 
  */
         __Pyx_INCREF(__pyx_v_s);
         __Pyx_DECREF_SET(__pyx_v_thresh, __pyx_v_s);
 
-        /* "soapcw/soapcw.pyx":1309
+        /* "soapcw/soapcw.pyx":1311
  *                     max_seq = np.insert(abspath,0,ind)[:-1]
  *                     thresh = s
  *                     thresh2 = l             # <<<<<<<<<<<<<<
  * 
  *         return max_seq,s
  */
-        __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_l); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1309, __pyx_L1_error)
+        __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_l); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1311, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF_SET(__pyx_v_thresh2, __pyx_t_4);
         __pyx_t_4 = 0;
 
-        /* "soapcw/soapcw.pyx":1306
+        /* "soapcw/soapcw.pyx":1308
  *                     max_seq = np.insert(abspath,0,ind)[:-1]
  *                     thresh = s
  *                 elif s == thresh and l > thresh2:             # <<<<<<<<<<<<<<
  *                     max_seq = np.insert(abspath,0,ind)[:-1]
  *                     thresh = s
  */
       }
       __pyx_L21:;
     }
 
-    /* "soapcw/soapcw.pyx":1295
+    /* "soapcw/soapcw.pyx":1297
  *         thresh2 = -np.inf
  *         #print ind,bnd, diff, [np.cumsum(s)+ind for s in result]
  *         for seq in result:             # <<<<<<<<<<<<<<
  *             #print seq
  *             abspath = np.array(np.cumsum(seq) + ind)
  */
     __pyx_L10_continue:;
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "soapcw/soapcw.pyx":1311
+  /* "soapcw/soapcw.pyx":1313
  *                     thresh2 = l
  * 
  *         return max_seq,s             # <<<<<<<<<<<<<<
  * 
  *     def gap_run(self,viterbi, band_width, diff, tsft, tr):
  */
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_s)) { __Pyx_RaiseUnboundLocalError("s"); __PYX_ERR(0, 1311, __pyx_L1_error) }
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1311, __pyx_L1_error)
+  if (unlikely(!__pyx_v_s)) { __Pyx_RaiseUnboundLocalError("s"); __PYX_ERR(0, 1313, __pyx_L1_error) }
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1313, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_max_seq);
   __Pyx_GIVEREF(__pyx_v_max_seq);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_max_seq);
   __Pyx_INCREF(__pyx_v_s);
   __Pyx_GIVEREF(__pyx_v_s);
   PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_v_s);
   __pyx_r = __pyx_t_6;
   __pyx_t_6 = 0;
   goto __pyx_L0;
 
-  /* "soapcw/soapcw.pyx":1288
+  /* "soapcw/soapcw.pyx":1290
  *         self.max_end_prob = max(self.vits[-1].V[-1])
  * 
  *     def max_track(self,tr,length,diff,bnd,ind,band_width):             # <<<<<<<<<<<<<<
  *         tr_val = np.arange(len(tr)).astype(int) - np.floor(len(tr)/2).astype(int)
  *         result = [seq for seq in itertools.combinations_with_replacement(tr_val, length) if sum(seq) == diff]
  */
 
@@ -25157,15 +25340,15 @@
   __Pyx_XDECREF(__pyx_8genexpr9__pyx_v_seq);
   __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_elem);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":1313
+/* "soapcw/soapcw.pyx":1315
  *         return max_seq,s
  * 
  *     def gap_run(self,viterbi, band_width, diff, tsft, tr):             # <<<<<<<<<<<<<<
  *         length = diff - 1
  *         max_vals = np.zeros(band_width)
  */
 
@@ -25175,14 +25358,17 @@
 static PyObject *__pyx_pw_6soapcw_6soapcw_20single_detector_gaps_5gap_run(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_viterbi = 0;
   PyObject *__pyx_v_band_width = 0;
   PyObject *__pyx_v_diff = 0;
   CYTHON_UNUSED PyObject *__pyx_v_tsft = 0;
   PyObject *__pyx_v_tr = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("gap_run (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_viterbi,&__pyx_n_s_band_width,&__pyx_n_s_diff,&__pyx_n_s_tsft,&__pyx_n_s_tr,0};
     PyObject* values[6] = {0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
@@ -25209,43 +25395,43 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_viterbi)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("gap_run", 1, 6, 6, 1); __PYX_ERR(0, 1313, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("gap_run", 1, 6, 6, 1); __PYX_ERR(0, 1315, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_band_width)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("gap_run", 1, 6, 6, 2); __PYX_ERR(0, 1313, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("gap_run", 1, 6, 6, 2); __PYX_ERR(0, 1315, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_diff)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("gap_run", 1, 6, 6, 3); __PYX_ERR(0, 1313, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("gap_run", 1, 6, 6, 3); __PYX_ERR(0, 1315, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tsft)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("gap_run", 1, 6, 6, 4); __PYX_ERR(0, 1313, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("gap_run", 1, 6, 6, 4); __PYX_ERR(0, 1315, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("gap_run", 1, 6, 6, 5); __PYX_ERR(0, 1313, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("gap_run", 1, 6, 6, 5); __PYX_ERR(0, 1315, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gap_run") < 0)) __PYX_ERR(0, 1313, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gap_run") < 0)) __PYX_ERR(0, 1315, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -25258,15 +25444,15 @@
     __pyx_v_band_width = values[2];
     __pyx_v_diff = values[3];
     __pyx_v_tsft = values[4];
     __pyx_v_tr = values[5];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("gap_run", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1313, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("gap_run", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1315, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.single_detector_gaps.gap_run", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_20single_detector_gaps_4gap_run(__pyx_self, __pyx_v_self, __pyx_v_viterbi, __pyx_v_band_width, __pyx_v_diff, __pyx_v_tsft, __pyx_v_tr);
 
@@ -25298,71 +25484,74 @@
   Py_ssize_t __pyx_t_5;
   PyObject *(*__pyx_t_6)(PyObject *);
   int __pyx_t_7;
   Py_ssize_t __pyx_t_8;
   PyObject *(*__pyx_t_9)(PyObject *);
   int __pyx_t_10;
   PyObject *__pyx_t_11 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("gap_run", 0);
 
-  /* "soapcw/soapcw.pyx":1314
+  /* "soapcw/soapcw.pyx":1316
  * 
  *     def gap_run(self,viterbi, band_width, diff, tsft, tr):
  *         length = diff - 1             # <<<<<<<<<<<<<<
  *         max_vals = np.zeros(band_width)
  *         max_paths = np.zeros((band_width,length))
  */
-  __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_v_diff, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1314, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_v_diff, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1316, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_length = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1315
+  /* "soapcw/soapcw.pyx":1317
  *     def gap_run(self,viterbi, band_width, diff, tsft, tr):
  *         length = diff - 1
  *         max_vals = np.zeros(band_width)             # <<<<<<<<<<<<<<
  *         max_paths = np.zeros((band_width,length))
  *         #print band_width, length
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1315, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1317, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1315, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1317, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_band_width) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_band_width);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1315, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1317, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_max_vals = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1316
+  /* "soapcw/soapcw.pyx":1318
  *         length = diff - 1
  *         max_vals = np.zeros(band_width)
  *         max_paths = np.zeros((band_width,length))             # <<<<<<<<<<<<<<
  *         #print band_width, length
  *         for bnd in range(band_width):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1316, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1318, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1316, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1318, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1316, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1318, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_band_width);
   __Pyx_GIVEREF(__pyx_v_band_width);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_band_width);
   __Pyx_INCREF(__pyx_v_length);
   __Pyx_GIVEREF(__pyx_v_length);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_length);
@@ -25375,363 +25564,363 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1316, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1318, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_max_paths = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1318
+  /* "soapcw/soapcw.pyx":1320
  *         max_paths = np.zeros((band_width,length))
  *         #print band_width, length
  *         for bnd in range(band_width):             # <<<<<<<<<<<<<<
  *             low = bnd - length
  *             high = bnd + length + 1
  */
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_band_width); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1318, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_band_width); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_5 = 0;
     __pyx_t_6 = NULL;
   } else {
-    __pyx_t_5 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1318, __pyx_L1_error)
+    __pyx_t_5 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1320, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1318, __pyx_L1_error)
+    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1320, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_6)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1318, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1320, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1318, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1318, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1320, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1318, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_6(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1318, __pyx_L1_error)
+          else __PYX_ERR(0, 1320, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_bnd, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":1319
+    /* "soapcw/soapcw.pyx":1321
  *         #print band_width, length
  *         for bnd in range(band_width):
  *             low = bnd - length             # <<<<<<<<<<<<<<
  *             high = bnd + length + 1
  *             if low < 0:
  */
-    __pyx_t_1 = PyNumber_Subtract(__pyx_v_bnd, __pyx_v_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1319, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Subtract(__pyx_v_bnd, __pyx_v_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1321, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_XDECREF_SET(__pyx_v_low, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":1320
+    /* "soapcw/soapcw.pyx":1322
  *         for bnd in range(band_width):
  *             low = bnd - length
  *             high = bnd + length + 1             # <<<<<<<<<<<<<<
  *             if low < 0:
  *                 low = 0
  */
-    __pyx_t_1 = PyNumber_Add(__pyx_v_bnd, __pyx_v_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_v_bnd, __pyx_v_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1322, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1320, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1322, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF_SET(__pyx_v_high, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "soapcw/soapcw.pyx":1321
+    /* "soapcw/soapcw.pyx":1323
  *             low = bnd - length
  *             high = bnd + length + 1
  *             if low < 0:             # <<<<<<<<<<<<<<
  *                 low = 0
  *             if high >= band_width:
  */
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_low, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1321, __pyx_L1_error)
-    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1321, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_v_low, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1323, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1323, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_7) {
 
-      /* "soapcw/soapcw.pyx":1322
+      /* "soapcw/soapcw.pyx":1324
  *             high = bnd + length + 1
  *             if low < 0:
  *                 low = 0             # <<<<<<<<<<<<<<
  *             if high >= band_width:
  *                 high = band_width
  */
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_DECREF_SET(__pyx_v_low, __pyx_int_0);
 
-      /* "soapcw/soapcw.pyx":1321
+      /* "soapcw/soapcw.pyx":1323
  *             low = bnd - length
  *             high = bnd + length + 1
  *             if low < 0:             # <<<<<<<<<<<<<<
  *                 low = 0
  *             if high >= band_width:
  */
     }
 
-    /* "soapcw/soapcw.pyx":1323
+    /* "soapcw/soapcw.pyx":1325
  *             if low < 0:
  *                 low = 0
  *             if high >= band_width:             # <<<<<<<<<<<<<<
  *                 high = band_width
  *             thres = 0
  */
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_high, __pyx_v_band_width, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1323, __pyx_L1_error)
-    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1323, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_v_high, __pyx_v_band_width, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1325, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1325, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_7) {
 
-      /* "soapcw/soapcw.pyx":1324
+      /* "soapcw/soapcw.pyx":1326
  *                 low = 0
  *             if high >= band_width:
  *                 high = band_width             # <<<<<<<<<<<<<<
  *             thres = 0
  *             vend = viterbi.V[-1,low:high]
  */
       __Pyx_INCREF(__pyx_v_band_width);
       __Pyx_DECREF_SET(__pyx_v_high, __pyx_v_band_width);
 
-      /* "soapcw/soapcw.pyx":1323
+      /* "soapcw/soapcw.pyx":1325
  *             if low < 0:
  *                 low = 0
  *             if high >= band_width:             # <<<<<<<<<<<<<<
  *                 high = band_width
  *             thres = 0
  */
     }
 
-    /* "soapcw/soapcw.pyx":1325
+    /* "soapcw/soapcw.pyx":1327
  *             if high >= band_width:
  *                 high = band_width
  *             thres = 0             # <<<<<<<<<<<<<<
  *             vend = viterbi.V[-1,low:high]
  * 
  */
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_XDECREF_SET(__pyx_v_thres, __pyx_int_0);
 
-    /* "soapcw/soapcw.pyx":1326
+    /* "soapcw/soapcw.pyx":1328
  *                 high = band_width
  *             thres = 0
  *             vend = viterbi.V[-1,low:high]             # <<<<<<<<<<<<<<
  * 
  *             val = 0
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_V); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1326, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_V); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1328, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = PySlice_New(__pyx_v_low, __pyx_v_high, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1326, __pyx_L1_error)
+    __pyx_t_1 = PySlice_New(__pyx_v_low, __pyx_v_high, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1328, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1326, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1328, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_int_neg_1);
     __Pyx_GIVEREF(__pyx_int_neg_1);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_int_neg_1);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1326, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1328, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_XDECREF_SET(__pyx_v_vend, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":1328
+    /* "soapcw/soapcw.pyx":1330
  *             vend = viterbi.V[-1,low:high]
  * 
  *             val = 0             # <<<<<<<<<<<<<<
  *             ind = 0
  *             for j in range(len(vend)):
  */
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_XDECREF_SET(__pyx_v_val, __pyx_int_0);
 
-    /* "soapcw/soapcw.pyx":1329
+    /* "soapcw/soapcw.pyx":1331
  * 
  *             val = 0
  *             ind = 0             # <<<<<<<<<<<<<<
  *             for j in range(len(vend)):
  *                 if vend[j] > thres:
  */
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_XDECREF_SET(__pyx_v_ind, __pyx_int_0);
 
-    /* "soapcw/soapcw.pyx":1330
+    /* "soapcw/soapcw.pyx":1332
  *             val = 0
  *             ind = 0
  *             for j in range(len(vend)):             # <<<<<<<<<<<<<<
  *                 if vend[j] > thres:
  *                     val = vend[j]
  */
-    __pyx_t_8 = PyObject_Length(__pyx_v_vend); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1330, __pyx_L1_error)
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1330, __pyx_L1_error)
+    __pyx_t_8 = PyObject_Length(__pyx_v_vend); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1332, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1332, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1330, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1332, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
       __pyx_t_1 = __pyx_t_4; __Pyx_INCREF(__pyx_t_1); __pyx_t_8 = 0;
       __pyx_t_9 = NULL;
     } else {
-      __pyx_t_8 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1330, __pyx_L1_error)
+      __pyx_t_8 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1332, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_9 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1330, __pyx_L1_error)
+      __pyx_t_9 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1332, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     for (;;) {
       if (likely(!__pyx_t_9)) {
         if (likely(PyList_CheckExact(__pyx_t_1))) {
           if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_4); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1330, __pyx_L1_error)
+          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_4); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1332, __pyx_L1_error)
           #else
-          __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1330, __pyx_L1_error)
+          __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1332, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           #endif
         } else {
           if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_4); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1330, __pyx_L1_error)
+          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_4); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1332, __pyx_L1_error)
           #else
-          __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1330, __pyx_L1_error)
+          __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1332, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           #endif
         }
       } else {
         __pyx_t_4 = __pyx_t_9(__pyx_t_1);
         if (unlikely(!__pyx_t_4)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 1330, __pyx_L1_error)
+            else __PYX_ERR(0, 1332, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_4);
       }
       __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_4);
       __pyx_t_4 = 0;
 
-      /* "soapcw/soapcw.pyx":1331
+      /* "soapcw/soapcw.pyx":1333
  *             ind = 0
  *             for j in range(len(vend)):
  *                 if vend[j] > thres:             # <<<<<<<<<<<<<<
  *                     val = vend[j]
  *                     ind = low + j
  */
-      __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_vend, __pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1331, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_vend, __pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1333, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_v_thres, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1331, __pyx_L1_error)
+      __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_v_thres, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1333, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1331, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1333, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_7) {
 
-        /* "soapcw/soapcw.pyx":1332
+        /* "soapcw/soapcw.pyx":1334
  *             for j in range(len(vend)):
  *                 if vend[j] > thres:
  *                     val = vend[j]             # <<<<<<<<<<<<<<
  *                     ind = low + j
  *                     thres = vend[j]
  */
-        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_vend, __pyx_v_j); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1332, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_vend, __pyx_v_j); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1334, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF_SET(__pyx_v_val, __pyx_t_3);
         __pyx_t_3 = 0;
 
-        /* "soapcw/soapcw.pyx":1333
+        /* "soapcw/soapcw.pyx":1335
  *                 if vend[j] > thres:
  *                     val = vend[j]
  *                     ind = low + j             # <<<<<<<<<<<<<<
  *                     thres = vend[j]
  *             diff_ind = bnd-ind
  */
-        __pyx_t_3 = PyNumber_Add(__pyx_v_low, __pyx_v_j); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1333, __pyx_L1_error)
+        __pyx_t_3 = PyNumber_Add(__pyx_v_low, __pyx_v_j); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1335, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF_SET(__pyx_v_ind, __pyx_t_3);
         __pyx_t_3 = 0;
 
-        /* "soapcw/soapcw.pyx":1334
+        /* "soapcw/soapcw.pyx":1336
  *                     val = vend[j]
  *                     ind = low + j
  *                     thres = vend[j]             # <<<<<<<<<<<<<<
  *             diff_ind = bnd-ind
  *             gaptrack = self.max_track(tr,length,diff_ind,bnd,ind,band_width)
  */
-        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_vend, __pyx_v_j); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1334, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_vend, __pyx_v_j); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1336, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF_SET(__pyx_v_thres, __pyx_t_3);
         __pyx_t_3 = 0;
 
-        /* "soapcw/soapcw.pyx":1331
+        /* "soapcw/soapcw.pyx":1333
  *             ind = 0
  *             for j in range(len(vend)):
  *                 if vend[j] > thres:             # <<<<<<<<<<<<<<
  *                     val = vend[j]
  *                     ind = low + j
  */
       }
 
-      /* "soapcw/soapcw.pyx":1330
+      /* "soapcw/soapcw.pyx":1332
  *             val = 0
  *             ind = 0
  *             for j in range(len(vend)):             # <<<<<<<<<<<<<<
  *                 if vend[j] > thres:
  *                     val = vend[j]
  */
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":1335
+    /* "soapcw/soapcw.pyx":1337
  *                     ind = low + j
  *                     thres = vend[j]
  *             diff_ind = bnd-ind             # <<<<<<<<<<<<<<
  *             gaptrack = self.max_track(tr,length,diff_ind,bnd,ind,band_width)
  *             #print bnd,ind,low,high,diff_ind,length,gaptrack
  */
-    __pyx_t_1 = PyNumber_Subtract(__pyx_v_bnd, __pyx_v_ind); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1335, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Subtract(__pyx_v_bnd, __pyx_v_ind); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_XDECREF_SET(__pyx_v_diff_ind, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":1336
+    /* "soapcw/soapcw.pyx":1338
  *                     thres = vend[j]
  *             diff_ind = bnd-ind
  *             gaptrack = self.max_track(tr,length,diff_ind,bnd,ind,band_width)             # <<<<<<<<<<<<<<
  *             #print bnd,ind,low,high,diff_ind,length,gaptrack
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_max_track); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1336, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_max_track); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = NULL;
     __pyx_t_10 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -25740,29 +25929,29 @@
         __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_10 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[7] = {__pyx_t_4, __pyx_v_tr, __pyx_v_length, __pyx_v_diff_ind, __pyx_v_bnd, __pyx_v_ind, __pyx_v_band_width};
-      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_10, 6+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1336, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_10, 6+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1338, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[7] = {__pyx_t_4, __pyx_v_tr, __pyx_v_length, __pyx_v_diff_ind, __pyx_v_bnd, __pyx_v_ind, __pyx_v_band_width};
-      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_10, 6+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1336, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_10, 6+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1338, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     {
-      __pyx_t_11 = PyTuple_New(6+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1336, __pyx_L1_error)
+      __pyx_t_11 = PyTuple_New(6+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1338, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       if (__pyx_t_4) {
         __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_4); __pyx_t_4 = NULL;
       }
       __Pyx_INCREF(__pyx_v_tr);
       __Pyx_GIVEREF(__pyx_v_tr);
       PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_10, __pyx_v_tr);
@@ -25777,107 +25966,107 @@
       PyTuple_SET_ITEM(__pyx_t_11, 3+__pyx_t_10, __pyx_v_bnd);
       __Pyx_INCREF(__pyx_v_ind);
       __Pyx_GIVEREF(__pyx_v_ind);
       PyTuple_SET_ITEM(__pyx_t_11, 4+__pyx_t_10, __pyx_v_ind);
       __Pyx_INCREF(__pyx_v_band_width);
       __Pyx_GIVEREF(__pyx_v_band_width);
       PyTuple_SET_ITEM(__pyx_t_11, 5+__pyx_t_10, __pyx_v_band_width);
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1336, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1338, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF_SET(__pyx_v_gaptrack, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":1339
+    /* "soapcw/soapcw.pyx":1341
  *             #print bnd,ind,low,high,diff_ind,length,gaptrack
  * 
  *             max_paths[bnd] = np.array(gaptrack[0])             # <<<<<<<<<<<<<<
  *             max_vals[bnd] = gaptrack[1] + val + length*2
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1339, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1339, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_gaptrack, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1339, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_gaptrack, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
     __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1339, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_v_max_paths, __pyx_v_bnd, __pyx_t_1) < 0)) __PYX_ERR(0, 1339, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_max_paths, __pyx_v_bnd, __pyx_t_1) < 0)) __PYX_ERR(0, 1341, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "soapcw/soapcw.pyx":1340
+    /* "soapcw/soapcw.pyx":1342
  * 
  *             max_paths[bnd] = np.array(gaptrack[0])
  *             max_vals[bnd] = gaptrack[1] + val + length*2             # <<<<<<<<<<<<<<
  * 
  *         return max_vals, max_paths
  */
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_gaptrack, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1340, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_gaptrack, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1342, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_11 = PyNumber_Add(__pyx_t_1, __pyx_v_val); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1340, __pyx_L1_error)
+    __pyx_t_11 = PyNumber_Add(__pyx_t_1, __pyx_v_val); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1342, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Multiply(__pyx_v_length, __pyx_int_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1340, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Multiply(__pyx_v_length, __pyx_int_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1342, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PyNumber_Add(__pyx_t_11, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1340, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Add(__pyx_t_11, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1342, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_v_max_vals, __pyx_v_bnd, __pyx_t_3) < 0)) __PYX_ERR(0, 1340, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_max_vals, __pyx_v_bnd, __pyx_t_3) < 0)) __PYX_ERR(0, 1342, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "soapcw/soapcw.pyx":1318
+    /* "soapcw/soapcw.pyx":1320
  *         max_paths = np.zeros((band_width,length))
  *         #print band_width, length
  *         for bnd in range(band_width):             # <<<<<<<<<<<<<<
  *             low = bnd - length
  *             high = bnd + length + 1
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1342
+  /* "soapcw/soapcw.pyx":1344
  *             max_vals[bnd] = gaptrack[1] + val + length*2
  * 
  *         return max_vals, max_paths             # <<<<<<<<<<<<<<
  * 
  *     def find_path(self,prev,end_ind):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1342, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1344, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v_max_vals);
   __Pyx_GIVEREF(__pyx_v_max_vals);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_max_vals);
   __Pyx_INCREF(__pyx_v_max_paths);
   __Pyx_GIVEREF(__pyx_v_max_paths);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_max_paths);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "soapcw/soapcw.pyx":1313
+  /* "soapcw/soapcw.pyx":1315
  *         return max_seq,s
  * 
  *     def gap_run(self,viterbi, band_width, diff, tsft, tr):             # <<<<<<<<<<<<<<
  *         length = diff - 1
  *         max_vals = np.zeros(band_width)
  */
 
@@ -25905,29 +26094,32 @@
   __Pyx_XDECREF(__pyx_v_diff_ind);
   __Pyx_XDECREF(__pyx_v_gaptrack);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":1344
+/* "soapcw/soapcw.pyx":1346
  *         return max_vals, max_paths
  * 
  *     def find_path(self,prev,end_ind):             # <<<<<<<<<<<<<<
  *         length = len(prev)
  *         previous = prev[-1][end_ind]
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6soapcw_6soapcw_20single_detector_gaps_7find_path(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_7find_path = {"find_path", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_20single_detector_gaps_7find_path, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_6soapcw_6soapcw_20single_detector_gaps_7find_path(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   CYTHON_UNUSED PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_prev = 0;
   PyObject *__pyx_v_end_ind = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("find_path (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_prev,&__pyx_n_s_end_ind,0};
     PyObject* values[3] = {0,0,0};
     if (unlikely(__pyx_kwds)) {
@@ -25948,40 +26140,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_prev)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("find_path", 1, 3, 3, 1); __PYX_ERR(0, 1344, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("find_path", 1, 3, 3, 1); __PYX_ERR(0, 1346, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_end_ind)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("find_path", 1, 3, 3, 2); __PYX_ERR(0, 1344, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("find_path", 1, 3, 3, 2); __PYX_ERR(0, 1346, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "find_path") < 0)) __PYX_ERR(0, 1344, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "find_path") < 0)) __PYX_ERR(0, 1346, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_prev = values[1];
     __pyx_v_end_ind = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("find_path", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1344, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("find_path", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1346, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.single_detector_gaps.find_path", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_20single_detector_gaps_6find_path(__pyx_self, __pyx_v_self, __pyx_v_prev, __pyx_v_end_ind);
 
@@ -26000,200 +26192,203 @@
   Py_ssize_t __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *(*__pyx_t_7)(PyObject *);
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("find_path", 0);
 
-  /* "soapcw/soapcw.pyx":1345
+  /* "soapcw/soapcw.pyx":1347
  * 
  *     def find_path(self,prev,end_ind):
  *         length = len(prev)             # <<<<<<<<<<<<<<
  *         previous = prev[-1][end_ind]
- *         vit_track =  np.zeros(length,dtype=np.int)
+ *         vit_track =  np.zeros(length,dtype=np.int32)
  */
-  __pyx_t_1 = PyObject_Length(__pyx_v_prev); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1345, __pyx_L1_error)
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1345, __pyx_L1_error)
+  __pyx_t_1 = PyObject_Length(__pyx_v_prev); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1347, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_v_length = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "soapcw/soapcw.pyx":1346
+  /* "soapcw/soapcw.pyx":1348
  *     def find_path(self,prev,end_ind):
  *         length = len(prev)
  *         previous = prev[-1][end_ind]             # <<<<<<<<<<<<<<
- *         vit_track =  np.zeros(length,dtype=np.int)
+ *         vit_track =  np.zeros(length,dtype=np.int32)
  *         vit_track[-1] = end_ind
  */
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_prev, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1346, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_prev, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1348, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_end_ind); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1346, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_end_ind); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1348, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_previous = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":1347
+  /* "soapcw/soapcw.pyx":1349
  *         length = len(prev)
  *         previous = prev[-1][end_ind]
- *         vit_track =  np.zeros(length,dtype=np.int)             # <<<<<<<<<<<<<<
+ *         vit_track =  np.zeros(length,dtype=np.int32)             # <<<<<<<<<<<<<<
  *         vit_track[-1] = end_ind
  *         for t in range(length-2,-1,-1):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_length);
   __Pyx_GIVEREF(__pyx_v_length);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_length);
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 1347, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 1349, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_vit_track = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "soapcw/soapcw.pyx":1348
+  /* "soapcw/soapcw.pyx":1350
  *         previous = prev[-1][end_ind]
- *         vit_track =  np.zeros(length,dtype=np.int)
+ *         vit_track =  np.zeros(length,dtype=np.int32)
  *         vit_track[-1] = end_ind             # <<<<<<<<<<<<<<
  *         for t in range(length-2,-1,-1):
  *             vit_track[t] = previous # insert previous step
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_vit_track, -1L, __pyx_v_end_ind, long, 1, __Pyx_PyInt_From_long, 0, 1, 1) < 0)) __PYX_ERR(0, 1348, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_vit_track, -1L, __pyx_v_end_ind, long, 1, __Pyx_PyInt_From_long, 0, 1, 1) < 0)) __PYX_ERR(0, 1350, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":1349
- *         vit_track =  np.zeros(length,dtype=np.int)
+  /* "soapcw/soapcw.pyx":1351
+ *         vit_track =  np.zeros(length,dtype=np.int32)
  *         vit_track[-1] = end_ind
  *         for t in range(length-2,-1,-1):             # <<<<<<<<<<<<<<
  *             vit_track[t] = previous # insert previous step
  *             previous = prev[t][previous]
  */
-  __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_length, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1349, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_length, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1349, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_neg_1);
   __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1349, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
     __pyx_t_4 = __pyx_t_6; __Pyx_INCREF(__pyx_t_4); __pyx_t_1 = 0;
     __pyx_t_7 = NULL;
   } else {
-    __pyx_t_1 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1349, __pyx_L1_error)
+    __pyx_t_1 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1351, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_7 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1349, __pyx_L1_error)
+    __pyx_t_7 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1351, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   for (;;) {
     if (likely(!__pyx_t_7)) {
       if (likely(PyList_CheckExact(__pyx_t_4))) {
         if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_4)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_1); __Pyx_INCREF(__pyx_t_6); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 1349, __pyx_L1_error)
+        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_1); __Pyx_INCREF(__pyx_t_6); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 1351, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_4, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1349, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_4, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1351, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
       } else {
         if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_1); __Pyx_INCREF(__pyx_t_6); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 1349, __pyx_L1_error)
+        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_1); __Pyx_INCREF(__pyx_t_6); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 1351, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_4, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1349, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_4, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1351, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
       }
     } else {
       __pyx_t_6 = __pyx_t_7(__pyx_t_4);
       if (unlikely(!__pyx_t_6)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1349, __pyx_L1_error)
+          else __PYX_ERR(0, 1351, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_6);
     }
     __Pyx_XDECREF_SET(__pyx_v_t, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "soapcw/soapcw.pyx":1350
+    /* "soapcw/soapcw.pyx":1352
  *         vit_track[-1] = end_ind
  *         for t in range(length-2,-1,-1):
  *             vit_track[t] = previous # insert previous step             # <<<<<<<<<<<<<<
  *             previous = prev[t][previous]
  * 
  */
-    if (unlikely(PyObject_SetItem(__pyx_v_vit_track, __pyx_v_t, __pyx_v_previous) < 0)) __PYX_ERR(0, 1350, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_vit_track, __pyx_v_t, __pyx_v_previous) < 0)) __PYX_ERR(0, 1352, __pyx_L1_error)
 
-    /* "soapcw/soapcw.pyx":1351
+    /* "soapcw/soapcw.pyx":1353
  *         for t in range(length-2,-1,-1):
  *             vit_track[t] = previous # insert previous step
  *             previous = prev[t][previous]             # <<<<<<<<<<<<<<
  * 
  *         return vit_track
  */
-    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_prev, __pyx_v_t); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1351, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_prev, __pyx_v_t); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1353, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_previous); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1351, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_previous); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1353, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF_SET(__pyx_v_previous, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "soapcw/soapcw.pyx":1349
- *         vit_track =  np.zeros(length,dtype=np.int)
+    /* "soapcw/soapcw.pyx":1351
+ *         vit_track =  np.zeros(length,dtype=np.int32)
  *         vit_track[-1] = end_ind
  *         for t in range(length-2,-1,-1):             # <<<<<<<<<<<<<<
  *             vit_track[t] = previous # insert previous step
  *             previous = prev[t][previous]
  */
   }
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "soapcw/soapcw.pyx":1353
+  /* "soapcw/soapcw.pyx":1355
  *             previous = prev[t][previous]
  * 
  *         return vit_track             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_vit_track);
   __pyx_r = __pyx_v_vit_track;
   goto __pyx_L0;
 
-  /* "soapcw/soapcw.pyx":1344
+  /* "soapcw/soapcw.pyx":1346
  *         return max_vals, max_paths
  * 
  *     def find_path(self,prev,end_ind):             # <<<<<<<<<<<<<<
  *         length = len(prev)
  *         previous = prev[-1][end_ind]
  */
 
@@ -26212,15 +26407,15 @@
   __Pyx_XDECREF(__pyx_v_vit_track);
   __Pyx_XDECREF(__pyx_v_t);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":1356
+/* "soapcw/soapcw.pyx":1358
  * 
  * 
  *     def vit_gaps(self,data1,epochs1,tr,tsft):             # <<<<<<<<<<<<<<
  * 
  *         band_width = len(data1[0])
  */
 
@@ -26229,14 +26424,17 @@
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_9vit_gaps = {"vit_gaps", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_20single_detector_gaps_9vit_gaps, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_6soapcw_6soapcw_20single_detector_gaps_9vit_gaps(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_data1 = 0;
   PyObject *__pyx_v_epochs1 = 0;
   PyObject *__pyx_v_tr = 0;
   PyObject *__pyx_v_tsft = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("vit_gaps (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_data1,&__pyx_n_s_epochs1,&__pyx_n_s_tr,&__pyx_n_s_tsft,0};
     PyObject* values[5] = {0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
@@ -26261,37 +26459,37 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_data1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("vit_gaps", 1, 5, 5, 1); __PYX_ERR(0, 1356, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("vit_gaps", 1, 5, 5, 1); __PYX_ERR(0, 1358, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_epochs1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("vit_gaps", 1, 5, 5, 2); __PYX_ERR(0, 1356, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("vit_gaps", 1, 5, 5, 2); __PYX_ERR(0, 1358, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("vit_gaps", 1, 5, 5, 3); __PYX_ERR(0, 1356, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("vit_gaps", 1, 5, 5, 3); __PYX_ERR(0, 1358, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tsft)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("vit_gaps", 1, 5, 5, 4); __PYX_ERR(0, 1356, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("vit_gaps", 1, 5, 5, 4); __PYX_ERR(0, 1358, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vit_gaps") < 0)) __PYX_ERR(0, 1356, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vit_gaps") < 0)) __PYX_ERR(0, 1358, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -26302,15 +26500,15 @@
     __pyx_v_data1 = values[1];
     __pyx_v_epochs1 = values[2];
     __pyx_v_tr = values[3];
     __pyx_v_tsft = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("vit_gaps", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1356, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("vit_gaps", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1358, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.single_detector_gaps.vit_gaps", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_20single_detector_gaps_8vit_gaps(__pyx_self, __pyx_v_self, __pyx_v_data1, __pyx_v_epochs1, __pyx_v_tr, __pyx_v_tsft);
 
@@ -26350,655 +26548,658 @@
   int __pyx_t_10;
   PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
   PyObject *__pyx_t_13 = NULL;
   PyObject *__pyx_t_14 = NULL;
   int __pyx_t_15;
   PyObject *(*__pyx_t_16)(PyObject *);
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("vit_gaps", 0);
 
-  /* "soapcw/soapcw.pyx":1358
+  /* "soapcw/soapcw.pyx":1360
  *     def vit_gaps(self,data1,epochs1,tr,tsft):
  * 
  *         band_width = len(data1[0])             # <<<<<<<<<<<<<<
  *         vit = []
  *         starts = []
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_data1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1358, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_data1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1358, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1360, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1358, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_band_width = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1359
+  /* "soapcw/soapcw.pyx":1361
  * 
  *         band_width = len(data1[0])
  *         vit = []             # <<<<<<<<<<<<<<
  *         starts = []
  *         gappaths = []
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1359, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_vit = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1360
+  /* "soapcw/soapcw.pyx":1362
  *         band_width = len(data1[0])
  *         vit = []
  *         starts = []             # <<<<<<<<<<<<<<
  *         gappaths = []
  *         gapend = 0
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1360, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1362, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_starts = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1361
+  /* "soapcw/soapcw.pyx":1363
  *         vit = []
  *         starts = []
  *         gappaths = []             # <<<<<<<<<<<<<<
  *         gapend = 0
  *         vitstart = epochs1[0]
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1361, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1363, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_gappaths = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1362
+  /* "soapcw/soapcw.pyx":1364
  *         starts = []
  *         gappaths = []
  *         gapend = 0             # <<<<<<<<<<<<<<
  *         vitstart = epochs1[0]
  *         max_vals = None
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_v_gapend = __pyx_int_0;
 
-  /* "soapcw/soapcw.pyx":1363
+  /* "soapcw/soapcw.pyx":1365
  *         gappaths = []
  *         gapend = 0
  *         vitstart = epochs1[0]             # <<<<<<<<<<<<<<
  *         max_vals = None
  * 
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_epochs1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1363, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_epochs1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_vitstart = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1364
+  /* "soapcw/soapcw.pyx":1366
  *         gapend = 0
  *         vitstart = epochs1[0]
  *         max_vals = None             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_INCREF(Py_None);
   __pyx_v_max_vals = Py_None;
 
-  /* "soapcw/soapcw.pyx":1367
+  /* "soapcw/soapcw.pyx":1369
  * 
  * 
  *         data = []             # <<<<<<<<<<<<<<
  *         epochs = []
  *         for i,idx in enumerate(epochs1):
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1367, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1369, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_data = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1368
+  /* "soapcw/soapcw.pyx":1370
  * 
  *         data = []
  *         epochs = []             # <<<<<<<<<<<<<<
  *         for i,idx in enumerate(epochs1):
  *             if i == 0 or i == len(epochs1)-1:
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1368, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1370, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_epochs = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1369
+  /* "soapcw/soapcw.pyx":1371
  *         data = []
  *         epochs = []
  *         for i,idx in enumerate(epochs1):             # <<<<<<<<<<<<<<
  *             if i == 0 or i == len(epochs1)-1:
  *                 data.append(data1[i])
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_t_1 = __pyx_int_0;
   if (likely(PyList_CheckExact(__pyx_v_epochs1)) || PyTuple_CheckExact(__pyx_v_epochs1)) {
     __pyx_t_3 = __pyx_v_epochs1; __Pyx_INCREF(__pyx_t_3); __pyx_t_2 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_epochs1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1369, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_epochs1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1371, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1369, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1371, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_3))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1369, __pyx_L1_error)
+        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1371, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1369, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1371, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1369, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1371, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1369, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1371, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       }
     } else {
       __pyx_t_5 = __pyx_t_4(__pyx_t_3);
       if (unlikely(!__pyx_t_5)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1369, __pyx_L1_error)
+          else __PYX_ERR(0, 1371, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_5);
     }
     __Pyx_XDECREF_SET(__pyx_v_idx, __pyx_t_5);
     __pyx_t_5 = 0;
     __Pyx_INCREF(__pyx_t_1);
     __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
-    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1369, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1371, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1);
     __pyx_t_1 = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "soapcw/soapcw.pyx":1370
+    /* "soapcw/soapcw.pyx":1372
  *         epochs = []
  *         for i,idx in enumerate(epochs1):
  *             if i == 0 or i == len(epochs1)-1:             # <<<<<<<<<<<<<<
  *                 data.append(data1[i])
  *                 epochs.append(idx)
  */
-    __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_i, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1370, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_i, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1372, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1370, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1372, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (!__pyx_t_7) {
     } else {
       __pyx_t_6 = __pyx_t_7;
       goto __pyx_L6_bool_binop_done;
     }
-    __pyx_t_8 = PyObject_Length(__pyx_v_epochs1); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1370, __pyx_L1_error)
-    __pyx_t_5 = PyInt_FromSsize_t((__pyx_t_8 - 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1370, __pyx_L1_error)
+    __pyx_t_8 = PyObject_Length(__pyx_v_epochs1); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1372, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t((__pyx_t_8 - 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1372, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_9 = PyObject_RichCompare(__pyx_v_i, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1370, __pyx_L1_error)
+    __pyx_t_9 = PyObject_RichCompare(__pyx_v_i, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1372, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1370, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1372, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_6 = __pyx_t_7;
     __pyx_L6_bool_binop_done:;
     if (__pyx_t_6) {
 
-      /* "soapcw/soapcw.pyx":1371
+      /* "soapcw/soapcw.pyx":1373
  *         for i,idx in enumerate(epochs1):
  *             if i == 0 or i == len(epochs1)-1:
  *                 data.append(data1[i])             # <<<<<<<<<<<<<<
  *                 epochs.append(idx)
  *             elif i > 0 and i != len(epochs1)-1:
  */
-      __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_data1, __pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1371, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_data1, __pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1373, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_data, __pyx_t_9); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1371, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_data, __pyx_t_9); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1373, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-      /* "soapcw/soapcw.pyx":1372
+      /* "soapcw/soapcw.pyx":1374
  *             if i == 0 or i == len(epochs1)-1:
  *                 data.append(data1[i])
  *                 epochs.append(idx)             # <<<<<<<<<<<<<<
  *             elif i > 0 and i != len(epochs1)-1:
  *                 diff = epochs1[i]-epochs1[i-1]
  */
-      __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_epochs, __pyx_v_idx); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1372, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_epochs, __pyx_v_idx); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1374, __pyx_L1_error)
 
-      /* "soapcw/soapcw.pyx":1370
+      /* "soapcw/soapcw.pyx":1372
  *         epochs = []
  *         for i,idx in enumerate(epochs1):
  *             if i == 0 or i == len(epochs1)-1:             # <<<<<<<<<<<<<<
  *                 data.append(data1[i])
  *                 epochs.append(idx)
  */
       goto __pyx_L5;
     }
 
-    /* "soapcw/soapcw.pyx":1373
+    /* "soapcw/soapcw.pyx":1375
  *                 data.append(data1[i])
  *                 epochs.append(idx)
  *             elif i > 0 and i != len(epochs1)-1:             # <<<<<<<<<<<<<<
  *                 diff = epochs1[i]-epochs1[i-1]
  *                 if diff == 2:
  */
-    __pyx_t_9 = PyObject_RichCompare(__pyx_v_i, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1373, __pyx_L1_error)
-    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1373, __pyx_L1_error)
+    __pyx_t_9 = PyObject_RichCompare(__pyx_v_i, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1375, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1375, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     if (__pyx_t_7) {
     } else {
       __pyx_t_6 = __pyx_t_7;
       goto __pyx_L8_bool_binop_done;
     }
-    __pyx_t_8 = PyObject_Length(__pyx_v_epochs1); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1373, __pyx_L1_error)
-    __pyx_t_9 = PyInt_FromSsize_t((__pyx_t_8 - 1)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1373, __pyx_L1_error)
+    __pyx_t_8 = PyObject_Length(__pyx_v_epochs1); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1375, __pyx_L1_error)
+    __pyx_t_9 = PyInt_FromSsize_t((__pyx_t_8 - 1)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1375, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_5 = PyObject_RichCompare(__pyx_v_i, __pyx_t_9, Py_NE); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1373, __pyx_L1_error)
+    __pyx_t_5 = PyObject_RichCompare(__pyx_v_i, __pyx_t_9, Py_NE); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1375, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1373, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1375, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_6 = __pyx_t_7;
     __pyx_L8_bool_binop_done:;
     if (__pyx_t_6) {
 
-      /* "soapcw/soapcw.pyx":1374
+      /* "soapcw/soapcw.pyx":1376
  *                 epochs.append(idx)
  *             elif i > 0 and i != len(epochs1)-1:
  *                 diff = epochs1[i]-epochs1[i-1]             # <<<<<<<<<<<<<<
  *                 if diff == 2:
  *                     data.append(np.ones(band_width)*2)
  */
-      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_epochs1, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1374, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_epochs1, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1376, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_9 = __Pyx_PyInt_SubtractObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1374, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyInt_SubtractObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1376, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_epochs1, __pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1374, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_epochs1, __pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1376, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = PyNumber_Subtract(__pyx_t_5, __pyx_t_11); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1374, __pyx_L1_error)
+      __pyx_t_9 = PyNumber_Subtract(__pyx_t_5, __pyx_t_11); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1376, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_XDECREF_SET(__pyx_v_diff, __pyx_t_9);
       __pyx_t_9 = 0;
 
-      /* "soapcw/soapcw.pyx":1375
+      /* "soapcw/soapcw.pyx":1377
  *             elif i > 0 and i != len(epochs1)-1:
  *                 diff = epochs1[i]-epochs1[i-1]
  *                 if diff == 2:             # <<<<<<<<<<<<<<
  *                     data.append(np.ones(band_width)*2)
  *                     epochs.append(idx-tsft)
  */
-      __pyx_t_9 = __Pyx_PyInt_EqObjC(__pyx_v_diff, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1375, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyInt_EqObjC(__pyx_v_diff, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1377, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1375, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1377, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       if (__pyx_t_6) {
 
-        /* "soapcw/soapcw.pyx":1376
+        /* "soapcw/soapcw.pyx":1378
  *                 diff = epochs1[i]-epochs1[i-1]
  *                 if diff == 2:
  *                     data.append(np.ones(band_width)*2)             # <<<<<<<<<<<<<<
  *                     epochs.append(idx-tsft)
  *                     data.append(data1[i])
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1376, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1378, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_ones); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1376, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_ones); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1378, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __pyx_t_11 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
           __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_5);
           if (likely(__pyx_t_11)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
             __Pyx_INCREF(__pyx_t_11);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_5, function);
           }
         }
         __pyx_t_9 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_11, __pyx_v_band_width) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_band_width);
         __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-        if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1376, __pyx_L1_error)
+        if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1378, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_5 = PyNumber_Multiply(__pyx_t_9, __pyx_int_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1376, __pyx_L1_error)
+        __pyx_t_5 = PyNumber_Multiply(__pyx_t_9, __pyx_int_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1378, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_data, __pyx_t_5); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1376, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_data, __pyx_t_5); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1378, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "soapcw/soapcw.pyx":1377
+        /* "soapcw/soapcw.pyx":1379
  *                 if diff == 2:
  *                     data.append(np.ones(band_width)*2)
  *                     epochs.append(idx-tsft)             # <<<<<<<<<<<<<<
  *                     data.append(data1[i])
  *                     epochs.append(idx)
  */
-        __pyx_t_5 = PyNumber_Subtract(__pyx_v_idx, __pyx_v_tsft); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1377, __pyx_L1_error)
+        __pyx_t_5 = PyNumber_Subtract(__pyx_v_idx, __pyx_v_tsft); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1379, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_epochs, __pyx_t_5); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1377, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_epochs, __pyx_t_5); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1379, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "soapcw/soapcw.pyx":1378
+        /* "soapcw/soapcw.pyx":1380
  *                     data.append(np.ones(band_width)*2)
  *                     epochs.append(idx-tsft)
  *                     data.append(data1[i])             # <<<<<<<<<<<<<<
  *                     epochs.append(idx)
  *                 else:
  */
-        __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_data1, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1378, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_data1, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1380, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_data, __pyx_t_5); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1378, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_data, __pyx_t_5); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1380, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "soapcw/soapcw.pyx":1379
+        /* "soapcw/soapcw.pyx":1381
  *                     epochs.append(idx-tsft)
  *                     data.append(data1[i])
  *                     epochs.append(idx)             # <<<<<<<<<<<<<<
  *                 else:
  *                     data.append(data1[i])
  */
-        __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_epochs, __pyx_v_idx); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1379, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_epochs, __pyx_v_idx); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1381, __pyx_L1_error)
 
-        /* "soapcw/soapcw.pyx":1375
+        /* "soapcw/soapcw.pyx":1377
  *             elif i > 0 and i != len(epochs1)-1:
  *                 diff = epochs1[i]-epochs1[i-1]
  *                 if diff == 2:             # <<<<<<<<<<<<<<
  *                     data.append(np.ones(band_width)*2)
  *                     epochs.append(idx-tsft)
  */
         goto __pyx_L10;
       }
 
-      /* "soapcw/soapcw.pyx":1381
+      /* "soapcw/soapcw.pyx":1383
  *                     epochs.append(idx)
  *                 else:
  *                     data.append(data1[i])             # <<<<<<<<<<<<<<
  *                     epochs.append(idx)
  *         data = np.array(data)
  */
       /*else*/ {
-        __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_data1, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1381, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_data1, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1383, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_data, __pyx_t_5); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1381, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_data, __pyx_t_5); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1383, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "soapcw/soapcw.pyx":1382
+        /* "soapcw/soapcw.pyx":1384
  *                 else:
  *                     data.append(data1[i])
  *                     epochs.append(idx)             # <<<<<<<<<<<<<<
  *         data = np.array(data)
  *         epochs = np.array(epochs)
  */
-        __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_epochs, __pyx_v_idx); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1382, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_epochs, __pyx_v_idx); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1384, __pyx_L1_error)
       }
       __pyx_L10:;
 
-      /* "soapcw/soapcw.pyx":1373
+      /* "soapcw/soapcw.pyx":1375
  *                 data.append(data1[i])
  *                 epochs.append(idx)
  *             elif i > 0 and i != len(epochs1)-1:             # <<<<<<<<<<<<<<
  *                 diff = epochs1[i]-epochs1[i-1]
  *                 if diff == 2:
  */
     }
     __pyx_L5:;
 
-    /* "soapcw/soapcw.pyx":1369
+    /* "soapcw/soapcw.pyx":1371
  *         data = []
  *         epochs = []
  *         for i,idx in enumerate(epochs1):             # <<<<<<<<<<<<<<
  *             if i == 0 or i == len(epochs1)-1:
  *                 data.append(data1[i])
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1383
+  /* "soapcw/soapcw.pyx":1385
  *                     data.append(data1[i])
  *                     epochs.append(idx)
  *         data = np.array(data)             # <<<<<<<<<<<<<<
  *         epochs = np.array(epochs)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1383, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1385, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1383, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1385, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_3, __pyx_v_data) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_data);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1383, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1385, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF_SET(__pyx_v_data, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1384
+  /* "soapcw/soapcw.pyx":1386
  *                     epochs.append(idx)
  *         data = np.array(data)
  *         epochs = np.array(epochs)             # <<<<<<<<<<<<<<
  * 
  *         for i,idx in enumerate(epochs):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1384, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1386, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1384, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1386, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_v_epochs) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_epochs);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1384, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1386, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_epochs, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1386
+  /* "soapcw/soapcw.pyx":1388
  *         epochs = np.array(epochs)
  * 
  *         for i,idx in enumerate(epochs):             # <<<<<<<<<<<<<<
  *             if i == 0 :
  *                 pass
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_t_1 = __pyx_int_0;
   if (likely(PyList_CheckExact(__pyx_v_epochs)) || PyTuple_CheckExact(__pyx_v_epochs)) {
     __pyx_t_3 = __pyx_v_epochs; __Pyx_INCREF(__pyx_t_3); __pyx_t_2 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_epochs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1386, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_epochs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1388, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1386, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1388, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_3))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1386, __pyx_L1_error)
+        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1388, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1386, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1388, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1386, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1388, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1386, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1388, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       }
     } else {
       __pyx_t_5 = __pyx_t_4(__pyx_t_3);
       if (unlikely(!__pyx_t_5)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1386, __pyx_L1_error)
+          else __PYX_ERR(0, 1388, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_5);
     }
     __Pyx_XDECREF_SET(__pyx_v_idx, __pyx_t_5);
     __pyx_t_5 = 0;
     __Pyx_INCREF(__pyx_t_1);
     __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
-    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1386, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1388, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1);
     __pyx_t_1 = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "soapcw/soapcw.pyx":1387
+    /* "soapcw/soapcw.pyx":1389
  * 
  *         for i,idx in enumerate(epochs):
  *             if i == 0 :             # <<<<<<<<<<<<<<
  *                 pass
  *             elif i > 0:# and i != len(epochs)-1:
  */
-    __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_i, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1387, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_i, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1389, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1387, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1389, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_6) {
       goto __pyx_L13;
     }
 
-    /* "soapcw/soapcw.pyx":1389
+    /* "soapcw/soapcw.pyx":1391
  *             if i == 0 :
  *                 pass
  *             elif i > 0:# and i != len(epochs)-1:             # <<<<<<<<<<<<<<
  *                 diff = epochs[i]-epochs[i-1]
  *                 diff_ind = int(diff/tsft)
  */
-    __pyx_t_5 = PyObject_RichCompare(__pyx_v_i, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1389, __pyx_L1_error)
-    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1389, __pyx_L1_error)
+    __pyx_t_5 = PyObject_RichCompare(__pyx_v_i, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1391, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1391, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_6) {
 
-      /* "soapcw/soapcw.pyx":1390
+      /* "soapcw/soapcw.pyx":1392
  *                 pass
  *             elif i > 0:# and i != len(epochs)-1:
  *                 diff = epochs[i]-epochs[i-1]             # <<<<<<<<<<<<<<
  *                 diff_ind = int(diff/tsft)
  *                 if diff_ind >= 2 and diff_ind < band_width + 1:
  */
-      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_epochs, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1390, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_epochs, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1392, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_9 = __Pyx_PyInt_SubtractObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1390, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyInt_SubtractObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1392, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_epochs, __pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1390, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_epochs, __pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1392, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = PyNumber_Subtract(__pyx_t_5, __pyx_t_11); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1390, __pyx_L1_error)
+      __pyx_t_9 = PyNumber_Subtract(__pyx_t_5, __pyx_t_11); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1392, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_XDECREF_SET(__pyx_v_diff, __pyx_t_9);
       __pyx_t_9 = 0;
 
-      /* "soapcw/soapcw.pyx":1391
+      /* "soapcw/soapcw.pyx":1393
  *             elif i > 0:# and i != len(epochs)-1:
  *                 diff = epochs[i]-epochs[i-1]
  *                 diff_ind = int(diff/tsft)             # <<<<<<<<<<<<<<
  *                 if diff_ind >= 2 and diff_ind < band_width + 1:
  *                     if max_vals is not None:
  */
-      __pyx_t_9 = __Pyx_PyNumber_Divide(__pyx_v_diff, __pyx_v_tsft); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1391, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyNumber_Divide(__pyx_v_diff, __pyx_v_tsft); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1393, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_11 = __Pyx_PyNumber_Int(__pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1391, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyNumber_Int(__pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1393, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_XDECREF_SET(__pyx_v_diff_ind, __pyx_t_11);
       __pyx_t_11 = 0;
 
-      /* "soapcw/soapcw.pyx":1392
+      /* "soapcw/soapcw.pyx":1394
  *                 diff = epochs[i]-epochs[i-1]
  *                 diff_ind = int(diff/tsft)
  *                 if diff_ind >= 2 and diff_ind < band_width + 1:             # <<<<<<<<<<<<<<
  *                     if max_vals is not None:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))
  */
-      __pyx_t_11 = PyObject_RichCompare(__pyx_v_diff_ind, __pyx_int_2, Py_GE); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1392, __pyx_L1_error)
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1392, __pyx_L1_error)
+      __pyx_t_11 = PyObject_RichCompare(__pyx_v_diff_ind, __pyx_int_2, Py_GE); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1394, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1394, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       if (__pyx_t_7) {
       } else {
         __pyx_t_6 = __pyx_t_7;
         goto __pyx_L15_bool_binop_done;
       }
-      __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_band_width, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1392, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_band_width, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1394, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_9 = PyObject_RichCompare(__pyx_v_diff_ind, __pyx_t_11, Py_LT); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1392, __pyx_L1_error)
+      __pyx_t_9 = PyObject_RichCompare(__pyx_v_diff_ind, __pyx_t_11, Py_LT); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1394, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1392, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1394, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __pyx_t_6 = __pyx_t_7;
       __pyx_L15_bool_binop_done:;
       if (__pyx_t_6) {
 
-        /* "soapcw/soapcw.pyx":1393
+        /* "soapcw/soapcw.pyx":1395
  *                 diff_ind = int(diff/tsft)
  *                 if diff_ind >= 2 and diff_ind < band_width + 1:
  *                     if max_vals is not None:             # <<<<<<<<<<<<<<
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart - tsft)
  */
         __pyx_t_6 = (__pyx_v_max_vals != Py_None);
         __pyx_t_7 = (__pyx_t_6 != 0);
         if (__pyx_t_7) {
 
-          /* "soapcw/soapcw.pyx":1394
+          /* "soapcw/soapcw.pyx":1396
  *                 if diff_ind >= 2 and diff_ind < band_width + 1:
  *                     if max_vals is not None:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))             # <<<<<<<<<<<<<<
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart - tsft)
  *                         vitstart = idx
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_single_detector); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1394, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_single_detector); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1396, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
-          __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1394, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1396, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
-          __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_vstack); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1394, __pyx_L1_error)
+          __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_vstack); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1396, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          __pyx_t_12 = __Pyx_PyObject_GetSlice(__pyx_v_data, 0, 0, &__pyx_v_gapend, &__pyx_v_i, NULL, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1394, __pyx_L1_error)
+          __pyx_t_12 = __Pyx_PyObject_GetSlice(__pyx_v_data, 0, 0, &__pyx_v_gapend, &__pyx_v_i, NULL, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1396, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
-          __pyx_t_14 = PyList_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1394, __pyx_L1_error)
+          __pyx_t_14 = PyList_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1396, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
           __Pyx_INCREF(__pyx_v_max_vals);
           __Pyx_GIVEREF(__pyx_v_max_vals);
           PyList_SET_ITEM(__pyx_t_14, 0, __pyx_v_max_vals);
           __Pyx_GIVEREF(__pyx_t_12);
           PyList_SET_ITEM(__pyx_t_14, 1, __pyx_t_12);
           __pyx_t_12 = 0;
@@ -27011,15 +27212,15 @@
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_13, function);
             }
           }
           __pyx_t_5 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_12, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_14);
           __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1394, __pyx_L1_error)
+          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1396, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
           __pyx_t_13 = NULL;
           __pyx_t_15 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
             __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_11);
             if (likely(__pyx_t_13)) {
@@ -27029,126 +27230,126 @@
               __Pyx_DECREF_SET(__pyx_t_11, function);
               __pyx_t_15 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_11)) {
             PyObject *__pyx_temp[3] = {__pyx_t_13, __pyx_v_tr, __pyx_t_5};
-            __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1394, __pyx_L1_error)
+            __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1396, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
             __Pyx_GOTREF(__pyx_t_9);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_11)) {
             PyObject *__pyx_temp[3] = {__pyx_t_13, __pyx_v_tr, __pyx_t_5};
-            __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1394, __pyx_L1_error)
+            __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1396, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
             __Pyx_GOTREF(__pyx_t_9);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           } else
           #endif
           {
-            __pyx_t_14 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1394, __pyx_L1_error)
+            __pyx_t_14 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1396, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_14);
             if (__pyx_t_13) {
               __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_13); __pyx_t_13 = NULL;
             }
             __Pyx_INCREF(__pyx_v_tr);
             __Pyx_GIVEREF(__pyx_v_tr);
             PyTuple_SET_ITEM(__pyx_t_14, 0+__pyx_t_15, __pyx_v_tr);
             __Pyx_GIVEREF(__pyx_t_5);
             PyTuple_SET_ITEM(__pyx_t_14, 1+__pyx_t_15, __pyx_t_5);
             __pyx_t_5 = 0;
-            __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_14, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1394, __pyx_L1_error)
+            __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_14, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1396, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_9);
             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
           }
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
           __Pyx_XDECREF_SET(__pyx_v_viterbi, __pyx_t_9);
           __pyx_t_9 = 0;
 
-          /* "soapcw/soapcw.pyx":1395
+          /* "soapcw/soapcw.pyx":1397
  *                     if max_vals is not None:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart - tsft)             # <<<<<<<<<<<<<<
  *                         vitstart = idx
  *                     else:
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1395, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1397, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_arange); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1395, __pyx_L1_error)
+          __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_arange); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1397, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1395, __pyx_L1_error)
+          __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1397, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_8 = PyObject_Length(__pyx_t_11); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1395, __pyx_L1_error)
+          __pyx_t_8 = PyObject_Length(__pyx_t_11); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1397, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_11 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1395, __pyx_L1_error)
+          __pyx_t_11 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1397, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __pyx_t_5 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_14);
             if (likely(__pyx_t_5)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
               __Pyx_INCREF(__pyx_t_5);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_14, function);
             }
           }
           __pyx_t_9 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_5, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_11);
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1395, __pyx_L1_error)
+          if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1397, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __pyx_t_14 = PyNumber_Multiply(__pyx_t_9, __pyx_v_tsft); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1395, __pyx_L1_error)
+          __pyx_t_14 = PyNumber_Multiply(__pyx_t_9, __pyx_v_tsft); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1397, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_9 = PyNumber_Add(__pyx_t_14, __pyx_v_vitstart); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1395, __pyx_L1_error)
+          __pyx_t_9 = PyNumber_Add(__pyx_t_14, __pyx_v_vitstart); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1397, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __pyx_t_14 = PyNumber_Subtract(__pyx_t_9, __pyx_v_tsft); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1395, __pyx_L1_error)
+          __pyx_t_14 = PyNumber_Subtract(__pyx_t_9, __pyx_v_tsft); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1397, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_starts, __pyx_t_14); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1395, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_starts, __pyx_t_14); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1397, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
 
-          /* "soapcw/soapcw.pyx":1396
+          /* "soapcw/soapcw.pyx":1398
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart - tsft)
  *                         vitstart = idx             # <<<<<<<<<<<<<<
  *                     else:
  *                         viterbi = single_detector(tr, data[gapend:i])
  */
           __Pyx_INCREF(__pyx_v_idx);
           __Pyx_DECREF_SET(__pyx_v_vitstart, __pyx_v_idx);
 
-          /* "soapcw/soapcw.pyx":1393
+          /* "soapcw/soapcw.pyx":1395
  *                 diff_ind = int(diff/tsft)
  *                 if diff_ind >= 2 and diff_ind < band_width + 1:
  *                     if max_vals is not None:             # <<<<<<<<<<<<<<
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart - tsft)
  */
           goto __pyx_L17;
         }
 
-        /* "soapcw/soapcw.pyx":1398
+        /* "soapcw/soapcw.pyx":1400
  *                         vitstart = idx
  *                     else:
  *                         viterbi = single_detector(tr, data[gapend:i])             # <<<<<<<<<<<<<<
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart)
  *                         vitstart = idx
  */
         /*else*/ {
-          __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_single_detector); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1398, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_single_detector); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1400, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_v_data, 0, 0, &__pyx_v_gapend, &__pyx_v_i, NULL, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1398, __pyx_L1_error)
+          __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_v_data, 0, 0, &__pyx_v_gapend, &__pyx_v_i, NULL, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1400, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __pyx_t_5 = NULL;
           __pyx_t_15 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_9);
             if (likely(__pyx_t_5)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
@@ -27157,131 +27358,131 @@
               __Pyx_DECREF_SET(__pyx_t_9, function);
               __pyx_t_15 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_9)) {
             PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_tr, __pyx_t_11};
-            __pyx_t_14 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1398, __pyx_L1_error)
+            __pyx_t_14 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1400, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_GOTREF(__pyx_t_14);
             __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
             PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_tr, __pyx_t_11};
-            __pyx_t_14 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1398, __pyx_L1_error)
+            __pyx_t_14 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1400, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_GOTREF(__pyx_t_14);
             __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
           } else
           #endif
           {
-            __pyx_t_13 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1398, __pyx_L1_error)
+            __pyx_t_13 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1400, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_13);
             if (__pyx_t_5) {
               __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_5); __pyx_t_5 = NULL;
             }
             __Pyx_INCREF(__pyx_v_tr);
             __Pyx_GIVEREF(__pyx_v_tr);
             PyTuple_SET_ITEM(__pyx_t_13, 0+__pyx_t_15, __pyx_v_tr);
             __Pyx_GIVEREF(__pyx_t_11);
             PyTuple_SET_ITEM(__pyx_t_13, 1+__pyx_t_15, __pyx_t_11);
             __pyx_t_11 = 0;
-            __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_13, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1398, __pyx_L1_error)
+            __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_13, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1400, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_14);
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
           }
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_XDECREF_SET(__pyx_v_viterbi, __pyx_t_14);
           __pyx_t_14 = 0;
 
-          /* "soapcw/soapcw.pyx":1399
+          /* "soapcw/soapcw.pyx":1401
  *                     else:
  *                         viterbi = single_detector(tr, data[gapend:i])
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart)             # <<<<<<<<<<<<<<
  *                         vitstart = idx
  * 
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1399, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1401, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_arange); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1399, __pyx_L1_error)
+          __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_arange); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1401, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1399, __pyx_L1_error)
+          __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1401, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_8 = PyObject_Length(__pyx_t_9); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1399, __pyx_L1_error)
+          __pyx_t_8 = PyObject_Length(__pyx_t_9); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1401, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1399, __pyx_L1_error)
+          __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1401, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __pyx_t_11 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
             __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_13);
             if (likely(__pyx_t_11)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
               __Pyx_INCREF(__pyx_t_11);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_13, function);
             }
           }
           __pyx_t_14 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_11, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_9);
           __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1399, __pyx_L1_error)
+          if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1401, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __pyx_t_13 = PyNumber_Multiply(__pyx_t_14, __pyx_v_tsft); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1399, __pyx_L1_error)
+          __pyx_t_13 = PyNumber_Multiply(__pyx_t_14, __pyx_v_tsft); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1401, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __pyx_t_14 = PyNumber_Add(__pyx_t_13, __pyx_v_vitstart); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1399, __pyx_L1_error)
+          __pyx_t_14 = PyNumber_Add(__pyx_t_13, __pyx_v_vitstart); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1401, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_starts, __pyx_t_14); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1399, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_starts, __pyx_t_14); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1401, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
 
-          /* "soapcw/soapcw.pyx":1400
+          /* "soapcw/soapcw.pyx":1402
  *                         viterbi = single_detector(tr, data[gapend:i])
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart)
  *                         vitstart = idx             # <<<<<<<<<<<<<<
  * 
  *                     vit.append(viterbi)
  */
           __Pyx_INCREF(__pyx_v_idx);
           __Pyx_DECREF_SET(__pyx_v_vitstart, __pyx_v_idx);
         }
         __pyx_L17:;
 
-        /* "soapcw/soapcw.pyx":1402
+        /* "soapcw/soapcw.pyx":1404
  *                         vitstart = idx
  * 
  *                     vit.append(viterbi)             # <<<<<<<<<<<<<<
  *                     gapend = i
  *                     max_vals, max_paths = self.gap_run(viterbi, band_width, diff_ind, tsft, tr)
  */
-        __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_vit, __pyx_v_viterbi); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1402, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_vit, __pyx_v_viterbi); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1404, __pyx_L1_error)
 
-        /* "soapcw/soapcw.pyx":1403
+        /* "soapcw/soapcw.pyx":1405
  * 
  *                     vit.append(viterbi)
  *                     gapend = i             # <<<<<<<<<<<<<<
  *                     max_vals, max_paths = self.gap_run(viterbi, band_width, diff_ind, tsft, tr)
  *                     #print max_vals, max_paths
  */
         __Pyx_INCREF(__pyx_v_i);
         __Pyx_DECREF_SET(__pyx_v_gapend, __pyx_v_i);
 
-        /* "soapcw/soapcw.pyx":1404
+        /* "soapcw/soapcw.pyx":1406
  *                     vit.append(viterbi)
  *                     gapend = i
  *                     max_vals, max_paths = self.gap_run(viterbi, band_width, diff_ind, tsft, tr)             # <<<<<<<<<<<<<<
  *                     #print max_vals, max_paths
  *                     gappaths.append(max_paths)
  */
-        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gap_run); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1404, __pyx_L1_error)
+        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gap_run); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1406, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_13);
         __pyx_t_9 = NULL;
         __pyx_t_15 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
           __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_13);
           if (likely(__pyx_t_9)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
@@ -27290,29 +27491,29 @@
             __Pyx_DECREF_SET(__pyx_t_13, function);
             __pyx_t_15 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_13)) {
           PyObject *__pyx_temp[6] = {__pyx_t_9, __pyx_v_viterbi, __pyx_v_band_width, __pyx_v_diff_ind, __pyx_v_tsft, __pyx_v_tr};
-          __pyx_t_14 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1404, __pyx_L1_error)
+          __pyx_t_14 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1406, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_GOTREF(__pyx_t_14);
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
           PyObject *__pyx_temp[6] = {__pyx_t_9, __pyx_v_viterbi, __pyx_v_band_width, __pyx_v_diff_ind, __pyx_v_tsft, __pyx_v_tr};
-          __pyx_t_14 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1404, __pyx_L1_error)
+          __pyx_t_14 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1406, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_GOTREF(__pyx_t_14);
         } else
         #endif
         {
-          __pyx_t_11 = PyTuple_New(5+__pyx_t_15); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1404, __pyx_L1_error)
+          __pyx_t_11 = PyTuple_New(5+__pyx_t_15); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1406, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           if (__pyx_t_9) {
             __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
           }
           __Pyx_INCREF(__pyx_v_viterbi);
           __Pyx_GIVEREF(__pyx_v_viterbi);
           PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_15, __pyx_v_viterbi);
@@ -27324,112 +27525,112 @@
           PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_15, __pyx_v_diff_ind);
           __Pyx_INCREF(__pyx_v_tsft);
           __Pyx_GIVEREF(__pyx_v_tsft);
           PyTuple_SET_ITEM(__pyx_t_11, 3+__pyx_t_15, __pyx_v_tsft);
           __Pyx_INCREF(__pyx_v_tr);
           __Pyx_GIVEREF(__pyx_v_tr);
           PyTuple_SET_ITEM(__pyx_t_11, 4+__pyx_t_15, __pyx_v_tr);
-          __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_11, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1404, __pyx_L1_error)
+          __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_11, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1406, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         }
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         if ((likely(PyTuple_CheckExact(__pyx_t_14))) || (PyList_CheckExact(__pyx_t_14))) {
           PyObject* sequence = __pyx_t_14;
           Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
           if (unlikely(size != 2)) {
             if (size > 2) __Pyx_RaiseTooManyValuesError(2);
             else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-            __PYX_ERR(0, 1404, __pyx_L1_error)
+            __PYX_ERR(0, 1406, __pyx_L1_error)
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
           if (likely(PyTuple_CheckExact(sequence))) {
             __pyx_t_13 = PyTuple_GET_ITEM(sequence, 0); 
             __pyx_t_11 = PyTuple_GET_ITEM(sequence, 1); 
           } else {
             __pyx_t_13 = PyList_GET_ITEM(sequence, 0); 
             __pyx_t_11 = PyList_GET_ITEM(sequence, 1); 
           }
           __Pyx_INCREF(__pyx_t_13);
           __Pyx_INCREF(__pyx_t_11);
           #else
-          __pyx_t_13 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1404, __pyx_L1_error)
+          __pyx_t_13 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1406, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
-          __pyx_t_11 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1404, __pyx_L1_error)
+          __pyx_t_11 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1406, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           #endif
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
         } else {
           Py_ssize_t index = -1;
-          __pyx_t_9 = PyObject_GetIter(__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1404, __pyx_L1_error)
+          __pyx_t_9 = PyObject_GetIter(__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1406, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
           __pyx_t_16 = Py_TYPE(__pyx_t_9)->tp_iternext;
           index = 0; __pyx_t_13 = __pyx_t_16(__pyx_t_9); if (unlikely(!__pyx_t_13)) goto __pyx_L18_unpacking_failed;
           __Pyx_GOTREF(__pyx_t_13);
           index = 1; __pyx_t_11 = __pyx_t_16(__pyx_t_9); if (unlikely(!__pyx_t_11)) goto __pyx_L18_unpacking_failed;
           __Pyx_GOTREF(__pyx_t_11);
-          if (__Pyx_IternextUnpackEndCheck(__pyx_t_16(__pyx_t_9), 2) < 0) __PYX_ERR(0, 1404, __pyx_L1_error)
+          if (__Pyx_IternextUnpackEndCheck(__pyx_t_16(__pyx_t_9), 2) < 0) __PYX_ERR(0, 1406, __pyx_L1_error)
           __pyx_t_16 = NULL;
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           goto __pyx_L19_unpacking_done;
           __pyx_L18_unpacking_failed:;
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __pyx_t_16 = NULL;
           if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-          __PYX_ERR(0, 1404, __pyx_L1_error)
+          __PYX_ERR(0, 1406, __pyx_L1_error)
           __pyx_L19_unpacking_done:;
         }
         __Pyx_DECREF_SET(__pyx_v_max_vals, __pyx_t_13);
         __pyx_t_13 = 0;
         __Pyx_XDECREF_SET(__pyx_v_max_paths, __pyx_t_11);
         __pyx_t_11 = 0;
 
-        /* "soapcw/soapcw.pyx":1406
+        /* "soapcw/soapcw.pyx":1408
  *                     max_vals, max_paths = self.gap_run(viterbi, band_width, diff_ind, tsft, tr)
  *                     #print max_vals, max_paths
  *                     gappaths.append(max_paths)             # <<<<<<<<<<<<<<
  *                     if i == len(epochs)-1:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:]]))
  */
-        __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_gappaths, __pyx_v_max_paths); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1406, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_gappaths, __pyx_v_max_paths); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1408, __pyx_L1_error)
 
-        /* "soapcw/soapcw.pyx":1407
+        /* "soapcw/soapcw.pyx":1409
  *                     #print max_vals, max_paths
  *                     gappaths.append(max_paths)
  *                     if i == len(epochs)-1:             # <<<<<<<<<<<<<<
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + idx - tsft)
  */
-        __pyx_t_8 = PyObject_Length(__pyx_v_epochs); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1407, __pyx_L1_error)
-        __pyx_t_14 = PyInt_FromSsize_t((__pyx_t_8 - 1)); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1407, __pyx_L1_error)
+        __pyx_t_8 = PyObject_Length(__pyx_v_epochs); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1409, __pyx_L1_error)
+        __pyx_t_14 = PyInt_FromSsize_t((__pyx_t_8 - 1)); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1409, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_14);
-        __pyx_t_11 = PyObject_RichCompare(__pyx_v_i, __pyx_t_14, Py_EQ); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1407, __pyx_L1_error)
+        __pyx_t_11 = PyObject_RichCompare(__pyx_v_i, __pyx_t_14, Py_EQ); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1409, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1407, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1409, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         if (__pyx_t_7) {
 
-          /* "soapcw/soapcw.pyx":1408
+          /* "soapcw/soapcw.pyx":1410
  *                     gappaths.append(max_paths)
  *                     if i == len(epochs)-1:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:]]))             # <<<<<<<<<<<<<<
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + idx - tsft)
  *                         vit.append(viterbi)
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_single_detector); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1408, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_single_detector); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1410, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
-          __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1408, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1410, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_vstack); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1408, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_vstack); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1410, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_9 = __Pyx_PyObject_GetSlice(__pyx_v_data, 0, 0, &__pyx_v_gapend, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1408, __pyx_L1_error)
+          __pyx_t_9 = __Pyx_PyObject_GetSlice(__pyx_v_data, 0, 0, &__pyx_v_gapend, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1410, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_12 = PyList_New(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1408, __pyx_L1_error)
+          __pyx_t_12 = PyList_New(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1410, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           __Pyx_INCREF(__pyx_v_max_vals);
           __Pyx_GIVEREF(__pyx_v_max_vals);
           PyList_SET_ITEM(__pyx_t_12, 0, __pyx_v_max_vals);
           __Pyx_GIVEREF(__pyx_t_9);
           PyList_SET_ITEM(__pyx_t_12, 1, __pyx_t_9);
           __pyx_t_9 = 0;
@@ -27442,15 +27643,15 @@
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_5, function);
             }
           }
           __pyx_t_13 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_9, __pyx_t_12) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_12);
           __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1408, __pyx_L1_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1410, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __pyx_t_5 = NULL;
           __pyx_t_15 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_14);
             if (likely(__pyx_t_5)) {
@@ -27460,178 +27661,178 @@
               __Pyx_DECREF_SET(__pyx_t_14, function);
               __pyx_t_15 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_14)) {
             PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_tr, __pyx_t_13};
-            __pyx_t_11 = __Pyx_PyFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1408, __pyx_L1_error)
+            __pyx_t_11 = __Pyx_PyFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1410, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_GOTREF(__pyx_t_11);
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_14)) {
             PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_tr, __pyx_t_13};
-            __pyx_t_11 = __Pyx_PyCFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1408, __pyx_L1_error)
+            __pyx_t_11 = __Pyx_PyCFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1410, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_GOTREF(__pyx_t_11);
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
           } else
           #endif
           {
-            __pyx_t_12 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1408, __pyx_L1_error)
+            __pyx_t_12 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1410, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
             if (__pyx_t_5) {
               __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_5); __pyx_t_5 = NULL;
             }
             __Pyx_INCREF(__pyx_v_tr);
             __Pyx_GIVEREF(__pyx_v_tr);
             PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_15, __pyx_v_tr);
             __Pyx_GIVEREF(__pyx_t_13);
             PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_15, __pyx_t_13);
             __pyx_t_13 = 0;
-            __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_12, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1408, __pyx_L1_error)
+            __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_12, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1410, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_11);
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
           }
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_DECREF_SET(__pyx_v_viterbi, __pyx_t_11);
           __pyx_t_11 = 0;
 
-          /* "soapcw/soapcw.pyx":1409
+          /* "soapcw/soapcw.pyx":1411
  *                     if i == len(epochs)-1:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + idx - tsft)             # <<<<<<<<<<<<<<
  *                         vit.append(viterbi)
  * 
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1409, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1411, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
-          __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_arange); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1409, __pyx_L1_error)
+          __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_arange); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1411, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1409, __pyx_L1_error)
+          __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1411, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
-          __pyx_t_8 = PyObject_Length(__pyx_t_14); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1409, __pyx_L1_error)
+          __pyx_t_8 = PyObject_Length(__pyx_t_14); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1411, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __pyx_t_14 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1409, __pyx_L1_error)
+          __pyx_t_14 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1411, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
           __pyx_t_13 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_12))) {
             __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_12);
             if (likely(__pyx_t_13)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
               __Pyx_INCREF(__pyx_t_13);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_12, function);
             }
           }
           __pyx_t_11 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_13, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_14);
           __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1409, __pyx_L1_error)
+          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1411, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          __pyx_t_12 = PyNumber_Multiply(__pyx_t_11, __pyx_v_tsft); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1409, __pyx_L1_error)
+          __pyx_t_12 = PyNumber_Multiply(__pyx_t_11, __pyx_v_tsft); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1411, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_11 = PyNumber_Add(__pyx_t_12, __pyx_v_idx); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1409, __pyx_L1_error)
+          __pyx_t_11 = PyNumber_Add(__pyx_t_12, __pyx_v_idx); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1411, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          __pyx_t_12 = PyNumber_Subtract(__pyx_t_11, __pyx_v_tsft); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1409, __pyx_L1_error)
+          __pyx_t_12 = PyNumber_Subtract(__pyx_t_11, __pyx_v_tsft); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1411, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_starts, __pyx_t_12); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1409, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_starts, __pyx_t_12); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1411, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-          /* "soapcw/soapcw.pyx":1410
+          /* "soapcw/soapcw.pyx":1412
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + idx - tsft)
  *                         vit.append(viterbi)             # <<<<<<<<<<<<<<
  * 
  *                 elif diff_ind >= band_width + 1:
  */
-          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_vit, __pyx_v_viterbi); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1410, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_vit, __pyx_v_viterbi); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1412, __pyx_L1_error)
 
-          /* "soapcw/soapcw.pyx":1407
+          /* "soapcw/soapcw.pyx":1409
  *                     #print max_vals, max_paths
  *                     gappaths.append(max_paths)
  *                     if i == len(epochs)-1:             # <<<<<<<<<<<<<<
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + idx - tsft)
  */
         }
 
-        /* "soapcw/soapcw.pyx":1392
+        /* "soapcw/soapcw.pyx":1394
  *                 diff = epochs[i]-epochs[i-1]
  *                 diff_ind = int(diff/tsft)
  *                 if diff_ind >= 2 and diff_ind < band_width + 1:             # <<<<<<<<<<<<<<
  *                     if max_vals is not None:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))
  */
         goto __pyx_L14;
       }
 
-      /* "soapcw/soapcw.pyx":1412
+      /* "soapcw/soapcw.pyx":1414
  *                         vit.append(viterbi)
  * 
  *                 elif diff_ind >= band_width + 1:             # <<<<<<<<<<<<<<
  * 
  *                     diff1 = band_width + 1
  */
-      __pyx_t_12 = __Pyx_PyInt_AddObjC(__pyx_v_band_width, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1412, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyInt_AddObjC(__pyx_v_band_width, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1414, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
-      __pyx_t_11 = PyObject_RichCompare(__pyx_v_diff_ind, __pyx_t_12, Py_GE); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1412, __pyx_L1_error)
+      __pyx_t_11 = PyObject_RichCompare(__pyx_v_diff_ind, __pyx_t_12, Py_GE); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1414, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1412, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1414, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       if (__pyx_t_7) {
 
-        /* "soapcw/soapcw.pyx":1414
+        /* "soapcw/soapcw.pyx":1416
  *                 elif diff_ind >= band_width + 1:
  * 
  *                     diff1 = band_width + 1             # <<<<<<<<<<<<<<
  *                     if max_vals is not None:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))
  */
-        __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_band_width, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1414, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_band_width, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1416, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_XDECREF_SET(__pyx_v_diff1, __pyx_t_11);
         __pyx_t_11 = 0;
 
-        /* "soapcw/soapcw.pyx":1415
+        /* "soapcw/soapcw.pyx":1417
  * 
  *                     diff1 = band_width + 1
  *                     if max_vals is not None:             # <<<<<<<<<<<<<<
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart - tsft)
  */
         __pyx_t_7 = (__pyx_v_max_vals != Py_None);
         __pyx_t_6 = (__pyx_t_7 != 0);
         if (__pyx_t_6) {
 
-          /* "soapcw/soapcw.pyx":1416
+          /* "soapcw/soapcw.pyx":1418
  *                     diff1 = band_width + 1
  *                     if max_vals is not None:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))             # <<<<<<<<<<<<<<
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart - tsft)
  *                         vitstart = idx
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_single_detector); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1416, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_single_detector); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1418, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
-          __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1416, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1418, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_vstack); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1416, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_vstack); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1418, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __pyx_t_13 = __Pyx_PyObject_GetSlice(__pyx_v_data, 0, 0, &__pyx_v_gapend, &__pyx_v_i, NULL, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1416, __pyx_L1_error)
+          __pyx_t_13 = __Pyx_PyObject_GetSlice(__pyx_v_data, 0, 0, &__pyx_v_gapend, &__pyx_v_i, NULL, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1418, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
-          __pyx_t_9 = PyList_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1416, __pyx_L1_error)
+          __pyx_t_9 = PyList_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1418, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_INCREF(__pyx_v_max_vals);
           __Pyx_GIVEREF(__pyx_v_max_vals);
           PyList_SET_ITEM(__pyx_t_9, 0, __pyx_v_max_vals);
           __Pyx_GIVEREF(__pyx_t_13);
           PyList_SET_ITEM(__pyx_t_9, 1, __pyx_t_13);
           __pyx_t_13 = 0;
@@ -27644,15 +27845,15 @@
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_5, function);
             }
           }
           __pyx_t_14 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_13, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_9);
           __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1416, __pyx_L1_error)
+          if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1418, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __pyx_t_5 = NULL;
           __pyx_t_15 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_12))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_12);
             if (likely(__pyx_t_5)) {
@@ -27662,126 +27863,126 @@
               __Pyx_DECREF_SET(__pyx_t_12, function);
               __pyx_t_15 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_12)) {
             PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_tr, __pyx_t_14};
-            __pyx_t_11 = __Pyx_PyFunction_FastCall(__pyx_t_12, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1416, __pyx_L1_error)
+            __pyx_t_11 = __Pyx_PyFunction_FastCall(__pyx_t_12, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1418, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_GOTREF(__pyx_t_11);
             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_12)) {
             PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_tr, __pyx_t_14};
-            __pyx_t_11 = __Pyx_PyCFunction_FastCall(__pyx_t_12, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1416, __pyx_L1_error)
+            __pyx_t_11 = __Pyx_PyCFunction_FastCall(__pyx_t_12, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1418, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_GOTREF(__pyx_t_11);
             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
           } else
           #endif
           {
-            __pyx_t_9 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1416, __pyx_L1_error)
+            __pyx_t_9 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1418, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_9);
             if (__pyx_t_5) {
               __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_5); __pyx_t_5 = NULL;
             }
             __Pyx_INCREF(__pyx_v_tr);
             __Pyx_GIVEREF(__pyx_v_tr);
             PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_15, __pyx_v_tr);
             __Pyx_GIVEREF(__pyx_t_14);
             PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_15, __pyx_t_14);
             __pyx_t_14 = 0;
-            __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_9, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1416, __pyx_L1_error)
+            __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_9, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1418, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_11);
             __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           }
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
           __Pyx_XDECREF_SET(__pyx_v_viterbi, __pyx_t_11);
           __pyx_t_11 = 0;
 
-          /* "soapcw/soapcw.pyx":1417
+          /* "soapcw/soapcw.pyx":1419
  *                     if max_vals is not None:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart - tsft)             # <<<<<<<<<<<<<<
  *                         vitstart = idx
  *                     else:
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1417, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1419, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
-          __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_arange); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1417, __pyx_L1_error)
+          __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_arange); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1419, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1417, __pyx_L1_error)
+          __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1419, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
-          __pyx_t_8 = PyObject_Length(__pyx_t_12); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1417, __pyx_L1_error)
+          __pyx_t_8 = PyObject_Length(__pyx_t_12); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1419, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          __pyx_t_12 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1417, __pyx_L1_error)
+          __pyx_t_12 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1419, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           __pyx_t_14 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
             __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_9);
             if (likely(__pyx_t_14)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
               __Pyx_INCREF(__pyx_t_14);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_9, function);
             }
           }
           __pyx_t_11 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_14, __pyx_t_12) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_12);
           __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1417, __pyx_L1_error)
+          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1419, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_9 = PyNumber_Multiply(__pyx_t_11, __pyx_v_tsft); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1417, __pyx_L1_error)
+          __pyx_t_9 = PyNumber_Multiply(__pyx_t_11, __pyx_v_tsft); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1419, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_11 = PyNumber_Add(__pyx_t_9, __pyx_v_vitstart); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1417, __pyx_L1_error)
+          __pyx_t_11 = PyNumber_Add(__pyx_t_9, __pyx_v_vitstart); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1419, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_9 = PyNumber_Subtract(__pyx_t_11, __pyx_v_tsft); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1417, __pyx_L1_error)
+          __pyx_t_9 = PyNumber_Subtract(__pyx_t_11, __pyx_v_tsft); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1419, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_starts, __pyx_t_9); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1417, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_starts, __pyx_t_9); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1419, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-          /* "soapcw/soapcw.pyx":1418
+          /* "soapcw/soapcw.pyx":1420
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart - tsft)
  *                         vitstart = idx             # <<<<<<<<<<<<<<
  *                     else:
  *                         viterbi = single_detector(tr, data[gapend:i])
  */
           __Pyx_INCREF(__pyx_v_idx);
           __Pyx_DECREF_SET(__pyx_v_vitstart, __pyx_v_idx);
 
-          /* "soapcw/soapcw.pyx":1415
+          /* "soapcw/soapcw.pyx":1417
  * 
  *                     diff1 = band_width + 1
  *                     if max_vals is not None:             # <<<<<<<<<<<<<<
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:i]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart - tsft)
  */
           goto __pyx_L21;
         }
 
-        /* "soapcw/soapcw.pyx":1420
+        /* "soapcw/soapcw.pyx":1422
  *                         vitstart = idx
  *                     else:
  *                         viterbi = single_detector(tr, data[gapend:i])             # <<<<<<<<<<<<<<
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart)
  *                         vitstart = idx
  */
         /*else*/ {
-          __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_single_detector); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1420, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_single_detector); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1422, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_12 = __Pyx_PyObject_GetSlice(__pyx_v_data, 0, 0, &__pyx_v_gapend, &__pyx_v_i, NULL, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1420, __pyx_L1_error)
+          __pyx_t_12 = __Pyx_PyObject_GetSlice(__pyx_v_data, 0, 0, &__pyx_v_gapend, &__pyx_v_i, NULL, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1422, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           __pyx_t_14 = NULL;
           __pyx_t_15 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
             __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_11);
             if (likely(__pyx_t_14)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
@@ -27790,131 +27991,131 @@
               __Pyx_DECREF_SET(__pyx_t_11, function);
               __pyx_t_15 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_11)) {
             PyObject *__pyx_temp[3] = {__pyx_t_14, __pyx_v_tr, __pyx_t_12};
-            __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1420, __pyx_L1_error)
+            __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1422, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
             __Pyx_GOTREF(__pyx_t_9);
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_11)) {
             PyObject *__pyx_temp[3] = {__pyx_t_14, __pyx_v_tr, __pyx_t_12};
-            __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1420, __pyx_L1_error)
+            __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1422, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
             __Pyx_GOTREF(__pyx_t_9);
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
           } else
           #endif
           {
-            __pyx_t_5 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1420, __pyx_L1_error)
+            __pyx_t_5 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1422, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_5);
             if (__pyx_t_14) {
               __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_14); __pyx_t_14 = NULL;
             }
             __Pyx_INCREF(__pyx_v_tr);
             __Pyx_GIVEREF(__pyx_v_tr);
             PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_15, __pyx_v_tr);
             __Pyx_GIVEREF(__pyx_t_12);
             PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_15, __pyx_t_12);
             __pyx_t_12 = 0;
-            __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_5, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1420, __pyx_L1_error)
+            __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_5, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1422, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_9);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
           __Pyx_XDECREF_SET(__pyx_v_viterbi, __pyx_t_9);
           __pyx_t_9 = 0;
 
-          /* "soapcw/soapcw.pyx":1421
+          /* "soapcw/soapcw.pyx":1423
  *                     else:
  *                         viterbi = single_detector(tr, data[gapend:i])
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart)             # <<<<<<<<<<<<<<
  *                         vitstart = idx
  * 
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1421, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1423, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_arange); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1421, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_arange); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1423, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1421, __pyx_L1_error)
+          __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1423, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_8 = PyObject_Length(__pyx_t_11); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1421, __pyx_L1_error)
+          __pyx_t_8 = PyObject_Length(__pyx_t_11); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1423, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_11 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1421, __pyx_L1_error)
+          __pyx_t_11 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1423, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __pyx_t_12 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_5);
             if (likely(__pyx_t_12)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
               __Pyx_INCREF(__pyx_t_12);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_5, function);
             }
           }
           __pyx_t_9 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_12, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_11);
           __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1421, __pyx_L1_error)
+          if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1423, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __pyx_t_5 = PyNumber_Multiply(__pyx_t_9, __pyx_v_tsft); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1421, __pyx_L1_error)
+          __pyx_t_5 = PyNumber_Multiply(__pyx_t_9, __pyx_v_tsft); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1423, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_9 = PyNumber_Add(__pyx_t_5, __pyx_v_vitstart); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1421, __pyx_L1_error)
+          __pyx_t_9 = PyNumber_Add(__pyx_t_5, __pyx_v_vitstart); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1423, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_starts, __pyx_t_9); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1421, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_starts, __pyx_t_9); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1423, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-          /* "soapcw/soapcw.pyx":1422
+          /* "soapcw/soapcw.pyx":1424
  *                         viterbi = single_detector(tr, data[gapend:i])
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + vitstart)
  *                         vitstart = idx             # <<<<<<<<<<<<<<
  * 
  * 
  */
           __Pyx_INCREF(__pyx_v_idx);
           __Pyx_DECREF_SET(__pyx_v_vitstart, __pyx_v_idx);
         }
         __pyx_L21:;
 
-        /* "soapcw/soapcw.pyx":1425
+        /* "soapcw/soapcw.pyx":1427
  * 
  * 
  *                     vit.append(viterbi)             # <<<<<<<<<<<<<<
  *                     gapend = i
  *                     max_vals, max_paths = self.gap_run(viterbi, band_width , diff1, tsft, tr)
  */
-        __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_vit, __pyx_v_viterbi); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1425, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_vit, __pyx_v_viterbi); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1427, __pyx_L1_error)
 
-        /* "soapcw/soapcw.pyx":1426
+        /* "soapcw/soapcw.pyx":1428
  * 
  *                     vit.append(viterbi)
  *                     gapend = i             # <<<<<<<<<<<<<<
  *                     max_vals, max_paths = self.gap_run(viterbi, band_width , diff1, tsft, tr)
  *                     #print max_vals, max_paths
  */
         __Pyx_INCREF(__pyx_v_i);
         __Pyx_DECREF_SET(__pyx_v_gapend, __pyx_v_i);
 
-        /* "soapcw/soapcw.pyx":1427
+        /* "soapcw/soapcw.pyx":1429
  *                     vit.append(viterbi)
  *                     gapend = i
  *                     max_vals, max_paths = self.gap_run(viterbi, band_width , diff1, tsft, tr)             # <<<<<<<<<<<<<<
  *                     #print max_vals, max_paths
  *                     gappaths.append(max_paths)
  */
-        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gap_run); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1427, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gap_run); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1429, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __pyx_t_11 = NULL;
         __pyx_t_15 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
           __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_5);
           if (likely(__pyx_t_11)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -27923,29 +28124,29 @@
             __Pyx_DECREF_SET(__pyx_t_5, function);
             __pyx_t_15 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_5)) {
           PyObject *__pyx_temp[6] = {__pyx_t_11, __pyx_v_viterbi, __pyx_v_band_width, __pyx_v_diff1, __pyx_v_tsft, __pyx_v_tr};
-          __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1427, __pyx_L1_error)
+          __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1429, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
           __Pyx_GOTREF(__pyx_t_9);
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
           PyObject *__pyx_temp[6] = {__pyx_t_11, __pyx_v_viterbi, __pyx_v_band_width, __pyx_v_diff1, __pyx_v_tsft, __pyx_v_tr};
-          __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1427, __pyx_L1_error)
+          __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1429, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
           __Pyx_GOTREF(__pyx_t_9);
         } else
         #endif
         {
-          __pyx_t_12 = PyTuple_New(5+__pyx_t_15); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1427, __pyx_L1_error)
+          __pyx_t_12 = PyTuple_New(5+__pyx_t_15); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1429, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           if (__pyx_t_11) {
             __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_11); __pyx_t_11 = NULL;
           }
           __Pyx_INCREF(__pyx_v_viterbi);
           __Pyx_GIVEREF(__pyx_v_viterbi);
           PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_15, __pyx_v_viterbi);
@@ -27957,112 +28158,112 @@
           PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_15, __pyx_v_diff1);
           __Pyx_INCREF(__pyx_v_tsft);
           __Pyx_GIVEREF(__pyx_v_tsft);
           PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_15, __pyx_v_tsft);
           __Pyx_INCREF(__pyx_v_tr);
           __Pyx_GIVEREF(__pyx_v_tr);
           PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_15, __pyx_v_tr);
-          __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_12, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1427, __pyx_L1_error)
+          __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_12, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1429, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         }
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         if ((likely(PyTuple_CheckExact(__pyx_t_9))) || (PyList_CheckExact(__pyx_t_9))) {
           PyObject* sequence = __pyx_t_9;
           Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
           if (unlikely(size != 2)) {
             if (size > 2) __Pyx_RaiseTooManyValuesError(2);
             else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-            __PYX_ERR(0, 1427, __pyx_L1_error)
+            __PYX_ERR(0, 1429, __pyx_L1_error)
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
           if (likely(PyTuple_CheckExact(sequence))) {
             __pyx_t_5 = PyTuple_GET_ITEM(sequence, 0); 
             __pyx_t_12 = PyTuple_GET_ITEM(sequence, 1); 
           } else {
             __pyx_t_5 = PyList_GET_ITEM(sequence, 0); 
             __pyx_t_12 = PyList_GET_ITEM(sequence, 1); 
           }
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(__pyx_t_12);
           #else
-          __pyx_t_5 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1427, __pyx_L1_error)
+          __pyx_t_5 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1429, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_12 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1427, __pyx_L1_error)
+          __pyx_t_12 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1429, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           #endif
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         } else {
           Py_ssize_t index = -1;
-          __pyx_t_11 = PyObject_GetIter(__pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1427, __pyx_L1_error)
+          __pyx_t_11 = PyObject_GetIter(__pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1429, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __pyx_t_16 = Py_TYPE(__pyx_t_11)->tp_iternext;
           index = 0; __pyx_t_5 = __pyx_t_16(__pyx_t_11); if (unlikely(!__pyx_t_5)) goto __pyx_L22_unpacking_failed;
           __Pyx_GOTREF(__pyx_t_5);
           index = 1; __pyx_t_12 = __pyx_t_16(__pyx_t_11); if (unlikely(!__pyx_t_12)) goto __pyx_L22_unpacking_failed;
           __Pyx_GOTREF(__pyx_t_12);
-          if (__Pyx_IternextUnpackEndCheck(__pyx_t_16(__pyx_t_11), 2) < 0) __PYX_ERR(0, 1427, __pyx_L1_error)
+          if (__Pyx_IternextUnpackEndCheck(__pyx_t_16(__pyx_t_11), 2) < 0) __PYX_ERR(0, 1429, __pyx_L1_error)
           __pyx_t_16 = NULL;
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
           goto __pyx_L23_unpacking_done;
           __pyx_L22_unpacking_failed:;
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
           __pyx_t_16 = NULL;
           if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-          __PYX_ERR(0, 1427, __pyx_L1_error)
+          __PYX_ERR(0, 1429, __pyx_L1_error)
           __pyx_L23_unpacking_done:;
         }
         __Pyx_DECREF_SET(__pyx_v_max_vals, __pyx_t_5);
         __pyx_t_5 = 0;
         __Pyx_XDECREF_SET(__pyx_v_max_paths, __pyx_t_12);
         __pyx_t_12 = 0;
 
-        /* "soapcw/soapcw.pyx":1429
+        /* "soapcw/soapcw.pyx":1431
  *                     max_vals, max_paths = self.gap_run(viterbi, band_width , diff1, tsft, tr)
  *                     #print max_vals, max_paths
  *                     gappaths.append(max_paths)             # <<<<<<<<<<<<<<
  *                     if i == len(epochs)-1:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:]]))
  */
-        __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_gappaths, __pyx_v_max_paths); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1429, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_gappaths, __pyx_v_max_paths); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1431, __pyx_L1_error)
 
-        /* "soapcw/soapcw.pyx":1430
+        /* "soapcw/soapcw.pyx":1432
  *                     #print max_vals, max_paths
  *                     gappaths.append(max_paths)
  *                     if i == len(epochs)-1:             # <<<<<<<<<<<<<<
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + idx - tsft)
  */
-        __pyx_t_8 = PyObject_Length(__pyx_v_epochs); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1430, __pyx_L1_error)
-        __pyx_t_9 = PyInt_FromSsize_t((__pyx_t_8 - 1)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1430, __pyx_L1_error)
+        __pyx_t_8 = PyObject_Length(__pyx_v_epochs); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1432, __pyx_L1_error)
+        __pyx_t_9 = PyInt_FromSsize_t((__pyx_t_8 - 1)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1432, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_12 = PyObject_RichCompare(__pyx_v_i, __pyx_t_9, Py_EQ); __Pyx_XGOTREF(__pyx_t_12); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1430, __pyx_L1_error)
+        __pyx_t_12 = PyObject_RichCompare(__pyx_v_i, __pyx_t_9, Py_EQ); __Pyx_XGOTREF(__pyx_t_12); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1432, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_12); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1430, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_12); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1432, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         if (__pyx_t_6) {
 
-          /* "soapcw/soapcw.pyx":1431
+          /* "soapcw/soapcw.pyx":1433
  *                     gappaths.append(max_paths)
  *                     if i == len(epochs)-1:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:]]))             # <<<<<<<<<<<<<<
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + idx - tsft)
  *                         vit.append(viterbi)
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_single_detector); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1431, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_single_detector); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1433, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1431, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1433, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_vstack); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1431, __pyx_L1_error)
+          __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_vstack); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1433, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_v_data, 0, 0, &__pyx_v_gapend, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1431, __pyx_L1_error)
+          __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_v_data, 0, 0, &__pyx_v_gapend, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1433, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_13 = PyList_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1431, __pyx_L1_error)
+          __pyx_t_13 = PyList_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1433, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_INCREF(__pyx_v_max_vals);
           __Pyx_GIVEREF(__pyx_v_max_vals);
           PyList_SET_ITEM(__pyx_t_13, 0, __pyx_v_max_vals);
           __Pyx_GIVEREF(__pyx_t_11);
           PyList_SET_ITEM(__pyx_t_13, 1, __pyx_t_11);
           __pyx_t_11 = 0;
@@ -28075,15 +28276,15 @@
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_14, function);
             }
           }
           __pyx_t_5 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_11, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_13);
           __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1431, __pyx_L1_error)
+          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1433, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
           __pyx_t_14 = NULL;
           __pyx_t_15 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
             __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_9);
             if (likely(__pyx_t_14)) {
@@ -28093,181 +28294,181 @@
               __Pyx_DECREF_SET(__pyx_t_9, function);
               __pyx_t_15 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_9)) {
             PyObject *__pyx_temp[3] = {__pyx_t_14, __pyx_v_tr, __pyx_t_5};
-            __pyx_t_12 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1431, __pyx_L1_error)
+            __pyx_t_12 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1433, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
             __Pyx_GOTREF(__pyx_t_12);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
             PyObject *__pyx_temp[3] = {__pyx_t_14, __pyx_v_tr, __pyx_t_5};
-            __pyx_t_12 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1431, __pyx_L1_error)
+            __pyx_t_12 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1433, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
             __Pyx_GOTREF(__pyx_t_12);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           } else
           #endif
           {
-            __pyx_t_13 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1431, __pyx_L1_error)
+            __pyx_t_13 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1433, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_13);
             if (__pyx_t_14) {
               __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_14); __pyx_t_14 = NULL;
             }
             __Pyx_INCREF(__pyx_v_tr);
             __Pyx_GIVEREF(__pyx_v_tr);
             PyTuple_SET_ITEM(__pyx_t_13, 0+__pyx_t_15, __pyx_v_tr);
             __Pyx_GIVEREF(__pyx_t_5);
             PyTuple_SET_ITEM(__pyx_t_13, 1+__pyx_t_15, __pyx_t_5);
             __pyx_t_5 = 0;
-            __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_13, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1431, __pyx_L1_error)
+            __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_13, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1433, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
           }
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_DECREF_SET(__pyx_v_viterbi, __pyx_t_12);
           __pyx_t_12 = 0;
 
-          /* "soapcw/soapcw.pyx":1432
+          /* "soapcw/soapcw.pyx":1434
  *                     if i == len(epochs)-1:
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + idx - tsft)             # <<<<<<<<<<<<<<
  *                         vit.append(viterbi)
  * 
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1432, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1434, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_arange); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1432, __pyx_L1_error)
+          __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_arange); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1434, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1432, __pyx_L1_error)
+          __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_viterbi, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1434, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_8 = PyObject_Length(__pyx_t_9); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1432, __pyx_L1_error)
+          __pyx_t_8 = PyObject_Length(__pyx_t_9); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1434, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1432, __pyx_L1_error)
+          __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1434, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __pyx_t_5 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_13);
             if (likely(__pyx_t_5)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
               __Pyx_INCREF(__pyx_t_5);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_13, function);
             }
           }
           __pyx_t_12 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_5, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_9);
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1432, __pyx_L1_error)
+          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1434, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __pyx_t_13 = PyNumber_Multiply(__pyx_t_12, __pyx_v_tsft); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1432, __pyx_L1_error)
+          __pyx_t_13 = PyNumber_Multiply(__pyx_t_12, __pyx_v_tsft); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1434, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          __pyx_t_12 = PyNumber_Add(__pyx_t_13, __pyx_v_idx); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1432, __pyx_L1_error)
+          __pyx_t_12 = PyNumber_Add(__pyx_t_13, __pyx_v_idx); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1434, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __pyx_t_13 = PyNumber_Subtract(__pyx_t_12, __pyx_v_tsft); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1432, __pyx_L1_error)
+          __pyx_t_13 = PyNumber_Subtract(__pyx_t_12, __pyx_v_tsft); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1434, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_starts, __pyx_t_13); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1432, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_starts, __pyx_t_13); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1434, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
-          /* "soapcw/soapcw.pyx":1433
+          /* "soapcw/soapcw.pyx":1435
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + idx - tsft)
  *                         vit.append(viterbi)             # <<<<<<<<<<<<<<
  * 
  *                 else:
  */
-          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_vit, __pyx_v_viterbi); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1433, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_vit, __pyx_v_viterbi); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1435, __pyx_L1_error)
 
-          /* "soapcw/soapcw.pyx":1430
+          /* "soapcw/soapcw.pyx":1432
  *                     #print max_vals, max_paths
  *                     gappaths.append(max_paths)
  *                     if i == len(epochs)-1:             # <<<<<<<<<<<<<<
  *                         viterbi = single_detector(tr, np.vstack([max_vals,data[gapend:]]))
  *                         starts.append(np.arange(len(viterbi.vit_track))*tsft + idx - tsft)
  */
         }
 
-        /* "soapcw/soapcw.pyx":1412
+        /* "soapcw/soapcw.pyx":1414
  *                         vit.append(viterbi)
  * 
  *                 elif diff_ind >= band_width + 1:             # <<<<<<<<<<<<<<
  * 
  *                     diff1 = band_width + 1
  */
         goto __pyx_L14;
       }
 
-      /* "soapcw/soapcw.pyx":1436
+      /* "soapcw/soapcw.pyx":1438
  * 
  *                 else:
  *                     continue             # <<<<<<<<<<<<<<
  * 
  *         return vit,starts, gappaths
  */
       /*else*/ {
         goto __pyx_L11_continue;
       }
       __pyx_L14:;
 
-      /* "soapcw/soapcw.pyx":1389
+      /* "soapcw/soapcw.pyx":1391
  *             if i == 0 :
  *                 pass
  *             elif i > 0:# and i != len(epochs)-1:             # <<<<<<<<<<<<<<
  *                 diff = epochs[i]-epochs[i-1]
  *                 diff_ind = int(diff/tsft)
  */
     }
     __pyx_L13:;
 
-    /* "soapcw/soapcw.pyx":1386
+    /* "soapcw/soapcw.pyx":1388
  *         epochs = np.array(epochs)
  * 
  *         for i,idx in enumerate(epochs):             # <<<<<<<<<<<<<<
  *             if i == 0 :
  *                 pass
  */
     __pyx_L11_continue:;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1438
+  /* "soapcw/soapcw.pyx":1440
  *                     continue
  * 
  *         return vit,starts, gappaths             # <<<<<<<<<<<<<<
  * 
  *     def get_track(self,vit,starts,gappaths,tsft=1):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1438, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_vit);
   __Pyx_GIVEREF(__pyx_v_vit);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_vit);
   __Pyx_INCREF(__pyx_v_starts);
   __Pyx_GIVEREF(__pyx_v_starts);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_starts);
   __Pyx_INCREF(__pyx_v_gappaths);
   __Pyx_GIVEREF(__pyx_v_gappaths);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_gappaths);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "soapcw/soapcw.pyx":1356
+  /* "soapcw/soapcw.pyx":1358
  * 
  * 
  *     def vit_gaps(self,data1,epochs1,tr,tsft):             # <<<<<<<<<<<<<<
  * 
  *         band_width = len(data1[0])
  */
 
@@ -28301,15 +28502,15 @@
   __Pyx_XDECREF(__pyx_v_max_paths);
   __Pyx_XDECREF(__pyx_v_diff1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "soapcw/soapcw.pyx":1440
+/* "soapcw/soapcw.pyx":1442
  *         return vit,starts, gappaths
  * 
  *     def get_track(self,vit,starts,gappaths,tsft=1):             # <<<<<<<<<<<<<<
  *         vit_track = []
  *         vit_track_time = []
  */
 
@@ -28318,14 +28519,17 @@
 static PyMethodDef __pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_11get_track = {"get_track", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6soapcw_6soapcw_20single_detector_gaps_11get_track, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_6soapcw_6soapcw_20single_detector_gaps_11get_track(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_vit = 0;
   PyObject *__pyx_v_starts = 0;
   PyObject *__pyx_v_gappaths = 0;
   PyObject *__pyx_v_tsft = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("get_track (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_vit,&__pyx_n_s_starts,&__pyx_n_s_gappaths,&__pyx_n_s_tsft,0};
     PyObject* values[5] = {0,0,0,0,0};
     values[4] = ((PyObject *)((PyObject *)__pyx_int_1));
@@ -28351,37 +28555,37 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_vit)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_track", 0, 4, 5, 1); __PYX_ERR(0, 1440, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_track", 0, 4, 5, 1); __PYX_ERR(0, 1442, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_starts)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_track", 0, 4, 5, 2); __PYX_ERR(0, 1440, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_track", 0, 4, 5, 2); __PYX_ERR(0, 1442, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_gappaths)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_track", 0, 4, 5, 3); __PYX_ERR(0, 1440, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_track", 0, 4, 5, 3); __PYX_ERR(0, 1442, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tsft);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_track") < 0)) __PYX_ERR(0, 1440, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_track") < 0)) __PYX_ERR(0, 1442, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -28395,15 +28599,15 @@
     __pyx_v_vit = values[1];
     __pyx_v_starts = values[2];
     __pyx_v_gappaths = values[3];
     __pyx_v_tsft = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_track", 0, 4, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1440, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("get_track", 0, 4, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1442, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("soapcw.soapcw.single_detector_gaps.get_track", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6soapcw_6soapcw_20single_detector_gaps_10get_track(__pyx_self, __pyx_v_self, __pyx_v_vit, __pyx_v_starts, __pyx_v_gappaths, __pyx_v_tsft);
 
@@ -28431,156 +28635,159 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_t_10;
   PyObject *__pyx_t_11 = NULL;
   int __pyx_t_12;
   Py_ssize_t __pyx_t_13;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_track", 0);
 
-  /* "soapcw/soapcw.pyx":1441
+  /* "soapcw/soapcw.pyx":1443
  * 
  *     def get_track(self,vit,starts,gappaths,tsft=1):
  *         vit_track = []             # <<<<<<<<<<<<<<
  *         vit_track_time = []
  *         gpb = False
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1441, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1443, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_vit_track = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1442
+  /* "soapcw/soapcw.pyx":1444
  *     def get_track(self,vit,starts,gappaths,tsft=1):
  *         vit_track = []
  *         vit_track_time = []             # <<<<<<<<<<<<<<
  *         gpb = False
  *         gp = None
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1442, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1444, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_vit_track_time = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1443
+  /* "soapcw/soapcw.pyx":1445
  *         vit_track = []
  *         vit_track_time = []
  *         gpb = False             # <<<<<<<<<<<<<<
  *         gp = None
  *         if len(starts) > 1:
  */
   __pyx_v_gpb = 0;
 
-  /* "soapcw/soapcw.pyx":1444
+  /* "soapcw/soapcw.pyx":1446
  *         vit_track_time = []
  *         gpb = False
  *         gp = None             # <<<<<<<<<<<<<<
  *         if len(starts) > 1:
  *             for v in range(len(starts))[::-1]:
  */
   __Pyx_INCREF(Py_None);
   __pyx_v_gp = Py_None;
 
-  /* "soapcw/soapcw.pyx":1445
+  /* "soapcw/soapcw.pyx":1447
  *         gpb = False
  *         gp = None
  *         if len(starts) > 1:             # <<<<<<<<<<<<<<
  *             for v in range(len(starts))[::-1]:
  *                 if gpb:
  */
-  __pyx_t_2 = PyObject_Length(__pyx_v_starts); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1445, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_v_starts); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1447, __pyx_L1_error)
   __pyx_t_3 = ((__pyx_t_2 > 1) != 0);
   if (__pyx_t_3) {
 
-    /* "soapcw/soapcw.pyx":1446
+    /* "soapcw/soapcw.pyx":1448
  *         gp = None
  *         if len(starts) > 1:
  *             for v in range(len(starts))[::-1]:             # <<<<<<<<<<<<<<
  *                 if gpb:
  *                     p1 = self.find_path(vit[v].prev,int(vit_track[-1]))[::-1]
  */
-    __pyx_t_2 = PyObject_Length(__pyx_v_starts); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1446, __pyx_L1_error)
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1446, __pyx_L1_error)
+    __pyx_t_2 = PyObject_Length(__pyx_v_starts); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1448, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1448, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1446, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1448, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_slice__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1446, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_slice__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1448, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
       __pyx_t_4 = __pyx_t_1; __Pyx_INCREF(__pyx_t_4); __pyx_t_2 = 0;
       __pyx_t_5 = NULL;
     } else {
-      __pyx_t_2 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1446, __pyx_L1_error)
+      __pyx_t_2 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1448, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1446, __pyx_L1_error)
+      __pyx_t_5 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1448, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     for (;;) {
       if (likely(!__pyx_t_5)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1446, __pyx_L1_error)
+          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1448, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1446, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1448, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         } else {
           if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1446, __pyx_L1_error)
+          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1448, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1446, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1448, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         }
       } else {
         __pyx_t_1 = __pyx_t_5(__pyx_t_4);
         if (unlikely(!__pyx_t_1)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 1446, __pyx_L1_error)
+            else __PYX_ERR(0, 1448, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_1);
       }
       __Pyx_XDECREF_SET(__pyx_v_v, __pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "soapcw/soapcw.pyx":1447
+      /* "soapcw/soapcw.pyx":1449
  *         if len(starts) > 1:
  *             for v in range(len(starts))[::-1]:
  *                 if gpb:             # <<<<<<<<<<<<<<
  *                     p1 = self.find_path(vit[v].prev,int(vit_track[-1]))[::-1]
  *                     vit_track.extend(p1[1:])
  */
       __pyx_t_3 = (__pyx_v_gpb != 0);
       if (__pyx_t_3) {
 
-        /* "soapcw/soapcw.pyx":1448
+        /* "soapcw/soapcw.pyx":1450
  *             for v in range(len(starts))[::-1]:
  *                 if gpb:
  *                     p1 = self.find_path(vit[v].prev,int(vit_track[-1]))[::-1]             # <<<<<<<<<<<<<<
  *                     vit_track.extend(p1[1:])
  *                     vit_track_time.extend(starts[v][::-1][1:])
  */
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_find_path); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1448, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_find_path); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1450, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_vit, __pyx_v_v); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1448, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_vit, __pyx_v_v); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1450, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_prev); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1448, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_prev); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1450, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_vit_track, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1448, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_vit_track, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1450, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_9 = __Pyx_PyNumber_Int(__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1448, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyNumber_Int(__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1450, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __pyx_t_7 = NULL;
         __pyx_t_10 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
           __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
           if (likely(__pyx_t_7)) {
@@ -28590,295 +28797,295 @@
             __Pyx_DECREF_SET(__pyx_t_6, function);
             __pyx_t_10 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_6)) {
           PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_t_8, __pyx_t_9};
-          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1448, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1450, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
           PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_t_8, __pyx_t_9};
-          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1448, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1450, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         } else
         #endif
         {
-          __pyx_t_11 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1448, __pyx_L1_error)
+          __pyx_t_11 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1450, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           if (__pyx_t_7) {
             __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_7); __pyx_t_7 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_8);
           PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_10, __pyx_t_8);
           __Pyx_GIVEREF(__pyx_t_9);
           PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_10, __pyx_t_9);
           __pyx_t_8 = 0;
           __pyx_t_9 = 0;
-          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1448, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1450, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         }
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_slice__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1448, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_slice__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1450, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF_SET(__pyx_v_p1, __pyx_t_6);
         __pyx_t_6 = 0;
 
-        /* "soapcw/soapcw.pyx":1449
+        /* "soapcw/soapcw.pyx":1451
  *                 if gpb:
  *                     p1 = self.find_path(vit[v].prev,int(vit_track[-1]))[::-1]
  *                     vit_track.extend(p1[1:])             # <<<<<<<<<<<<<<
  *                     vit_track_time.extend(starts[v][::-1][1:])
  *                 else:
  */
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_vit_track, __pyx_n_s_extend); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1449, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_vit_track, __pyx_n_s_extend); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1451, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_v_p1, 1, 0, NULL, NULL, &__pyx_slice__8, 1, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1449, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_v_p1, 1, 0, NULL, NULL, &__pyx_slice__8, 1, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1451, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __pyx_t_9 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
           __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_1);
           if (likely(__pyx_t_9)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
             __Pyx_INCREF(__pyx_t_9);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_1, function);
           }
         }
         __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_9, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_11);
         __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1449, __pyx_L1_error)
+        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1451, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "soapcw/soapcw.pyx":1450
+        /* "soapcw/soapcw.pyx":1452
  *                     p1 = self.find_path(vit[v].prev,int(vit_track[-1]))[::-1]
  *                     vit_track.extend(p1[1:])
  *                     vit_track_time.extend(starts[v][::-1][1:])             # <<<<<<<<<<<<<<
  *                 else:
  *                     p1 = vit[v].vit_track[::-1]
  */
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_starts, __pyx_v_v); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1450, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_starts, __pyx_v_v); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1452, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_slice__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1450, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_slice__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1452, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_t_1, 1, 0, NULL, NULL, &__pyx_slice__8, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1450, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_t_1, 1, 0, NULL, NULL, &__pyx_slice__8, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1452, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_12 = __Pyx_PyList_Extend(__pyx_v_vit_track_time, __pyx_t_6); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 1450, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyList_Extend(__pyx_v_vit_track_time, __pyx_t_6); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 1452, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "soapcw/soapcw.pyx":1447
+        /* "soapcw/soapcw.pyx":1449
  *         if len(starts) > 1:
  *             for v in range(len(starts))[::-1]:
  *                 if gpb:             # <<<<<<<<<<<<<<
  *                     p1 = self.find_path(vit[v].prev,int(vit_track[-1]))[::-1]
  *                     vit_track.extend(p1[1:])
  */
         goto __pyx_L6;
       }
 
-      /* "soapcw/soapcw.pyx":1452
+      /* "soapcw/soapcw.pyx":1454
  *                     vit_track_time.extend(starts[v][::-1][1:])
  *                 else:
  *                     p1 = vit[v].vit_track[::-1]             # <<<<<<<<<<<<<<
  *                     vit_track.extend(p1)
  *                     vit_track_time.extend(starts[v][::-1])
  */
       /*else*/ {
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_vit, __pyx_v_v); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1452, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_vit, __pyx_v_v); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1454, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1452, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1454, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_slice__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1452, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_slice__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1454, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF_SET(__pyx_v_p1, __pyx_t_6);
         __pyx_t_6 = 0;
 
-        /* "soapcw/soapcw.pyx":1453
+        /* "soapcw/soapcw.pyx":1455
  *                 else:
  *                     p1 = vit[v].vit_track[::-1]
  *                     vit_track.extend(p1)             # <<<<<<<<<<<<<<
  *                     vit_track_time.extend(starts[v][::-1])
  *                 st = vit_track[-1]
  */
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_vit_track, __pyx_n_s_extend); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1453, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_vit_track, __pyx_n_s_extend); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1455, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_t_11 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
           __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_1);
           if (likely(__pyx_t_11)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
             __Pyx_INCREF(__pyx_t_11);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_1, function);
           }
         }
         __pyx_t_6 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_11, __pyx_v_p1) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_p1);
         __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1453, __pyx_L1_error)
+        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1455, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "soapcw/soapcw.pyx":1454
+        /* "soapcw/soapcw.pyx":1456
  *                     p1 = vit[v].vit_track[::-1]
  *                     vit_track.extend(p1)
  *                     vit_track_time.extend(starts[v][::-1])             # <<<<<<<<<<<<<<
  *                 st = vit_track[-1]
  *                 if v-1 >= 0:
  */
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_starts, __pyx_v_v); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1454, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_starts, __pyx_v_v); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1456, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_slice__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1454, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_slice__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1456, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_12 = __Pyx_PyList_Extend(__pyx_v_vit_track_time, __pyx_t_1); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 1454, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyList_Extend(__pyx_v_vit_track_time, __pyx_t_1); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 1456, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       }
       __pyx_L6:;
 
-      /* "soapcw/soapcw.pyx":1455
+      /* "soapcw/soapcw.pyx":1457
  *                     vit_track.extend(p1)
  *                     vit_track_time.extend(starts[v][::-1])
  *                 st = vit_track[-1]             # <<<<<<<<<<<<<<
  *                 if v-1 >= 0:
  *                     gp = gappaths[v-1][st][::-1]
  */
-      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_vit_track, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1455, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_vit_track, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1457, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_XDECREF_SET(__pyx_v_st, __pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "soapcw/soapcw.pyx":1456
+      /* "soapcw/soapcw.pyx":1458
  *                     vit_track_time.extend(starts[v][::-1])
  *                 st = vit_track[-1]
  *                 if v-1 >= 0:             # <<<<<<<<<<<<<<
  *                     gp = gappaths[v-1][st][::-1]
  *                     vit_track.extend(gp)
  */
-      __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_v_v, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1456, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_v_v, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1458, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = PyObject_RichCompare(__pyx_t_1, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1456, __pyx_L1_error)
+      __pyx_t_6 = PyObject_RichCompare(__pyx_t_1, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1458, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1456, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1458, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (__pyx_t_3) {
 
-        /* "soapcw/soapcw.pyx":1457
+        /* "soapcw/soapcw.pyx":1459
  *                 st = vit_track[-1]
  *                 if v-1 >= 0:
  *                     gp = gappaths[v-1][st][::-1]             # <<<<<<<<<<<<<<
  *                     vit_track.extend(gp)
  *                     vit_track_time.extend(np.array(np.arange(len(gp))*tsft + starts[v-1][-1])[::-1])#+np.array(range(len(gp))[::-1]))
  */
-        __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_v, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1457, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_v, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1459, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_gappaths, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1457, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_gappaths, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1459, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_st); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1457, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_st); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1459, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_slice__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1457, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_slice__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1459, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF_SET(__pyx_v_gp, __pyx_t_1);
         __pyx_t_1 = 0;
 
-        /* "soapcw/soapcw.pyx":1458
+        /* "soapcw/soapcw.pyx":1460
  *                 if v-1 >= 0:
  *                     gp = gappaths[v-1][st][::-1]
  *                     vit_track.extend(gp)             # <<<<<<<<<<<<<<
  *                     vit_track_time.extend(np.array(np.arange(len(gp))*tsft + starts[v-1][-1])[::-1])#+np.array(range(len(gp))[::-1]))
  *                     #vit_track_time.extend(range(len(gp))[::-1])
  */
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_vit_track, __pyx_n_s_extend); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1458, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_vit_track, __pyx_n_s_extend); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1460, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_t_11 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
           __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_6);
           if (likely(__pyx_t_11)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
             __Pyx_INCREF(__pyx_t_11);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_6, function);
           }
         }
         __pyx_t_1 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_11, __pyx_v_gp) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_gp);
         __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1458, __pyx_L1_error)
+        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1460, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-        /* "soapcw/soapcw.pyx":1459
+        /* "soapcw/soapcw.pyx":1461
  *                     gp = gappaths[v-1][st][::-1]
  *                     vit_track.extend(gp)
  *                     vit_track_time.extend(np.array(np.arange(len(gp))*tsft + starts[v-1][-1])[::-1])#+np.array(range(len(gp))[::-1]))             # <<<<<<<<<<<<<<
  *                     #vit_track_time.extend(range(len(gp))[::-1])
  *                     gpb = True
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_arange); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_arange); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_13 = PyObject_Length(__pyx_v_gp); if (unlikely(__pyx_t_13 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1459, __pyx_L1_error)
-        __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_13); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        __pyx_t_13 = PyObject_Length(__pyx_v_gp); if (unlikely(__pyx_t_13 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1461, __pyx_L1_error)
+        __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_13); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __pyx_t_7 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
           __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_8);
           if (likely(__pyx_t_7)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
             __Pyx_INCREF(__pyx_t_7);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_8, function);
           }
         }
         __pyx_t_6 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_7, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_9);
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = PyNumber_Multiply(__pyx_t_6, __pyx_v_tsft); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        __pyx_t_8 = PyNumber_Multiply(__pyx_t_6, __pyx_v_tsft); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_v, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_v, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_starts, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_starts, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_9, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_9, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_9 = PyNumber_Add(__pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        __pyx_t_9 = PyNumber_Add(__pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_t_6 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
           __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_11);
           if (likely(__pyx_t_6)) {
@@ -28887,117 +29094,117 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_11, function);
           }
         }
         __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_6, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_9);
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_slice__9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1459, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_slice__9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_12 = __Pyx_PyList_Extend(__pyx_v_vit_track_time, __pyx_t_11); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 1459, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyList_Extend(__pyx_v_vit_track_time, __pyx_t_11); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 1461, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-        /* "soapcw/soapcw.pyx":1461
+        /* "soapcw/soapcw.pyx":1463
  *                     vit_track_time.extend(np.array(np.arange(len(gp))*tsft + starts[v-1][-1])[::-1])#+np.array(range(len(gp))[::-1]))
  *                     #vit_track_time.extend(range(len(gp))[::-1])
  *                     gpb = True             # <<<<<<<<<<<<<<
  *                 else:
  *                     gpb = False
  */
         __pyx_v_gpb = 1;
 
-        /* "soapcw/soapcw.pyx":1456
+        /* "soapcw/soapcw.pyx":1458
  *                     vit_track_time.extend(starts[v][::-1])
  *                 st = vit_track[-1]
  *                 if v-1 >= 0:             # <<<<<<<<<<<<<<
  *                     gp = gappaths[v-1][st][::-1]
  *                     vit_track.extend(gp)
  */
         goto __pyx_L7;
       }
 
-      /* "soapcw/soapcw.pyx":1463
+      /* "soapcw/soapcw.pyx":1465
  *                     gpb = True
  *                 else:
  *                     gpb = False             # <<<<<<<<<<<<<<
  *         else:
  *             vit_track = vit[0].vit_track
  */
       /*else*/ {
         __pyx_v_gpb = 0;
       }
       __pyx_L7:;
 
-      /* "soapcw/soapcw.pyx":1446
+      /* "soapcw/soapcw.pyx":1448
  *         gp = None
  *         if len(starts) > 1:
  *             for v in range(len(starts))[::-1]:             # <<<<<<<<<<<<<<
  *                 if gpb:
  *                     p1 = self.find_path(vit[v].prev,int(vit_track[-1]))[::-1]
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "soapcw/soapcw.pyx":1445
+    /* "soapcw/soapcw.pyx":1447
  *         gpb = False
  *         gp = None
  *         if len(starts) > 1:             # <<<<<<<<<<<<<<
  *             for v in range(len(starts))[::-1]:
  *                 if gpb:
  */
     goto __pyx_L3;
   }
 
-  /* "soapcw/soapcw.pyx":1465
+  /* "soapcw/soapcw.pyx":1467
  *                     gpb = False
  *         else:
  *             vit_track = vit[0].vit_track             # <<<<<<<<<<<<<<
  *         return vit_track[::-1], vit_track_time[::-1]
  * 
  */
   /*else*/ {
-    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_vit, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1465, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_vit, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1467, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1465, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_vit_track); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1467, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF_SET(__pyx_v_vit_track, __pyx_t_11);
     __pyx_t_11 = 0;
   }
   __pyx_L3:;
 
-  /* "soapcw/soapcw.pyx":1466
+  /* "soapcw/soapcw.pyx":1468
  *         else:
  *             vit_track = vit[0].vit_track
  *         return vit_track[::-1], vit_track_time[::-1]             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_vit_track, __pyx_slice__9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1466, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_vit_track, __pyx_slice__9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1468, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_vit_track_time, __pyx_slice__9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1466, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_vit_track_time, __pyx_slice__9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1468, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1466, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1468, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_11);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_11);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __pyx_t_11 = 0;
   __pyx_t_4 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "soapcw/soapcw.pyx":1440
+  /* "soapcw/soapcw.pyx":1442
  *         return vit,starts, gappaths
  * 
  *     def get_track(self,vit,starts,gappaths,tsft=1):             # <<<<<<<<<<<<<<
  *         vit_track = []
  *         vit_track_time = []
  */
 
@@ -29020,15 +29227,15 @@
   __Pyx_XDECREF(__pyx_v_p1);
   __Pyx_XDECREF(__pyx_v_st);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":122
+/* "View.MemoryView":123
  *         cdef bint dtype_is_object
  * 
  *     def __cinit__(array self, tuple shape, Py_ssize_t itemsize, format not None,             # <<<<<<<<<<<<<<
  *                   mode="c", bint allocate_buffer=True):
  * 
  */
 
@@ -29036,14 +29243,17 @@
 static int __pyx_array___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static int __pyx_array___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_shape = 0;
   Py_ssize_t __pyx_v_itemsize;
   PyObject *__pyx_v_format = 0;
   PyObject *__pyx_v_mode = 0;
   int __pyx_v_allocate_buffer;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_shape,&__pyx_n_s_itemsize,&__pyx_n_s_format,&__pyx_n_s_mode,&__pyx_n_s_allocate_buffer,0};
     PyObject* values[5] = {0,0,0,0,0};
     values[3] = ((PyObject *)__pyx_n_s_c);
@@ -29069,21 +29279,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_shape)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_itemsize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 3, 5, 1); __PYX_ERR(1, 122, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 3, 5, 1); __PYX_ERR(1, 123, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_format)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 3, 5, 2); __PYX_ERR(1, 122, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 3, 5, 2); __PYX_ERR(1, 123, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mode);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -29091,15 +29301,15 @@
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allocate_buffer);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(1, 122, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(1, 123, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
@@ -29107,46 +29317,46 @@
         values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_shape = ((PyObject*)values[0]);
-    __pyx_v_itemsize = __Pyx_PyIndex_AsSsize_t(values[1]); if (unlikely((__pyx_v_itemsize == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 122, __pyx_L3_error)
+    __pyx_v_itemsize = __Pyx_PyIndex_AsSsize_t(values[1]); if (unlikely((__pyx_v_itemsize == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 123, __pyx_L3_error)
     __pyx_v_format = values[2];
     __pyx_v_mode = values[3];
     if (values[4]) {
-      __pyx_v_allocate_buffer = __Pyx_PyObject_IsTrue(values[4]); if (unlikely((__pyx_v_allocate_buffer == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 123, __pyx_L3_error)
+      __pyx_v_allocate_buffer = __Pyx_PyObject_IsTrue(values[4]); if (unlikely((__pyx_v_allocate_buffer == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 124, __pyx_L3_error)
     } else {
 
-      /* "View.MemoryView":123
+      /* "View.MemoryView":124
  * 
  *     def __cinit__(array self, tuple shape, Py_ssize_t itemsize, format not None,
  *                   mode="c", bint allocate_buffer=True):             # <<<<<<<<<<<<<<
  * 
  *         cdef int idx
  */
       __pyx_v_allocate_buffer = ((int)1);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 122, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 123, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("View.MemoryView.array.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_shape), (&PyTuple_Type), 1, "shape", 1))) __PYX_ERR(1, 122, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_shape), (&PyTuple_Type), 1, "shape", 1))) __PYX_ERR(1, 123, __pyx_L1_error)
   if (unlikely(((PyObject *)__pyx_v_format) == Py_None)) {
-    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "format"); __PYX_ERR(1, 122, __pyx_L1_error)
+    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "format"); __PYX_ERR(1, 123, __pyx_L1_error)
   }
   __pyx_r = __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(((struct __pyx_array_obj *)__pyx_v_self), __pyx_v_shape, __pyx_v_itemsize, __pyx_v_format, __pyx_v_mode, __pyx_v_allocate_buffer);
 
-  /* "View.MemoryView":122
+  /* "View.MemoryView":123
  *         cdef bint dtype_is_object
  * 
  *     def __cinit__(array self, tuple shape, Py_ssize_t itemsize, format not None,             # <<<<<<<<<<<<<<
  *                   mode="c", bint allocate_buffer=True):
  * 
  */
 
@@ -29174,582 +29384,585 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   char *__pyx_t_7;
   int __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   PyObject *__pyx_t_10 = NULL;
   Py_ssize_t __pyx_t_11;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
   __Pyx_INCREF(__pyx_v_format);
 
-  /* "View.MemoryView":129
+  /* "View.MemoryView":130
  *         cdef PyObject **p
  * 
  *         self.ndim = <int> len(shape)             # <<<<<<<<<<<<<<
  *         self.itemsize = itemsize
  * 
  */
   if (unlikely(__pyx_v_shape == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(1, 129, __pyx_L1_error)
+    __PYX_ERR(1, 130, __pyx_L1_error)
   }
-  __pyx_t_1 = PyTuple_GET_SIZE(__pyx_v_shape); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(1, 129, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_GET_SIZE(__pyx_v_shape); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(1, 130, __pyx_L1_error)
   __pyx_v_self->ndim = ((int)__pyx_t_1);
 
-  /* "View.MemoryView":130
+  /* "View.MemoryView":131
  * 
  *         self.ndim = <int> len(shape)
  *         self.itemsize = itemsize             # <<<<<<<<<<<<<<
  * 
  *         if not self.ndim:
  */
   __pyx_v_self->itemsize = __pyx_v_itemsize;
 
-  /* "View.MemoryView":132
+  /* "View.MemoryView":133
  *         self.itemsize = itemsize
  * 
  *         if not self.ndim:             # <<<<<<<<<<<<<<
  *             raise ValueError("Empty shape tuple for cython.array")
  * 
  */
   __pyx_t_2 = ((!(__pyx_v_self->ndim != 0)) != 0);
   if (unlikely(__pyx_t_2)) {
 
-    /* "View.MemoryView":133
+    /* "View.MemoryView":134
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 133, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 133, __pyx_L1_error)
+    __PYX_ERR(1, 134, __pyx_L1_error)
 
-    /* "View.MemoryView":132
+    /* "View.MemoryView":133
  *         self.itemsize = itemsize
  * 
  *         if not self.ndim:             # <<<<<<<<<<<<<<
  *             raise ValueError("Empty shape tuple for cython.array")
  * 
  */
   }
 
-  /* "View.MemoryView":135
+  /* "View.MemoryView":136
  *             raise ValueError("Empty shape tuple for cython.array")
  * 
  *         if itemsize <= 0:             # <<<<<<<<<<<<<<
  *             raise ValueError("itemsize <= 0 for cython.array")
  * 
  */
   __pyx_t_2 = ((__pyx_v_itemsize <= 0) != 0);
   if (unlikely(__pyx_t_2)) {
 
-    /* "View.MemoryView":136
+    /* "View.MemoryView":137
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__12, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 136, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__12, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 137, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 136, __pyx_L1_error)
+    __PYX_ERR(1, 137, __pyx_L1_error)
 
-    /* "View.MemoryView":135
+    /* "View.MemoryView":136
  *             raise ValueError("Empty shape tuple for cython.array")
  * 
  *         if itemsize <= 0:             # <<<<<<<<<<<<<<
  *             raise ValueError("itemsize <= 0 for cython.array")
  * 
  */
   }
 
-  /* "View.MemoryView":138
+  /* "View.MemoryView":139
  *             raise ValueError("itemsize <= 0 for cython.array")
  * 
  *         if not isinstance(format, bytes):             # <<<<<<<<<<<<<<
  *             format = format.encode('ASCII')
  *         self._format = format  # keep a reference to the byte string
  */
   __pyx_t_2 = PyBytes_Check(__pyx_v_format); 
   __pyx_t_4 = ((!(__pyx_t_2 != 0)) != 0);
   if (__pyx_t_4) {
 
-    /* "View.MemoryView":139
+    /* "View.MemoryView":140
  * 
  *         if not isinstance(format, bytes):
  *             format = format.encode('ASCII')             # <<<<<<<<<<<<<<
  *         self._format = format  # keep a reference to the byte string
  *         self.format = self._format
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_format, __pyx_n_s_encode); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 139, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_format, __pyx_n_s_encode); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 140, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_n_s_ASCII) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_n_s_ASCII);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 139, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 140, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF_SET(__pyx_v_format, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "View.MemoryView":138
+    /* "View.MemoryView":139
  *             raise ValueError("itemsize <= 0 for cython.array")
  * 
  *         if not isinstance(format, bytes):             # <<<<<<<<<<<<<<
  *             format = format.encode('ASCII')
  *         self._format = format  # keep a reference to the byte string
  */
   }
 
-  /* "View.MemoryView":140
+  /* "View.MemoryView":141
  *         if not isinstance(format, bytes):
  *             format = format.encode('ASCII')
  *         self._format = format  # keep a reference to the byte string             # <<<<<<<<<<<<<<
  *         self.format = self._format
  * 
  */
-  if (!(likely(PyBytes_CheckExact(__pyx_v_format))||((__pyx_v_format) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_v_format)->tp_name), 0))) __PYX_ERR(1, 140, __pyx_L1_error)
+  if (!(likely(PyBytes_CheckExact(__pyx_v_format))||((__pyx_v_format) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_v_format)->tp_name), 0))) __PYX_ERR(1, 141, __pyx_L1_error)
   __pyx_t_3 = __pyx_v_format;
   __Pyx_INCREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->_format);
   __Pyx_DECREF(__pyx_v_self->_format);
   __pyx_v_self->_format = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "View.MemoryView":141
+  /* "View.MemoryView":142
  *             format = format.encode('ASCII')
  *         self._format = format  # keep a reference to the byte string
  *         self.format = self._format             # <<<<<<<<<<<<<<
  * 
  * 
  */
   if (unlikely(__pyx_v_self->_format == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-    __PYX_ERR(1, 141, __pyx_L1_error)
+    __PYX_ERR(1, 142, __pyx_L1_error)
   }
-  __pyx_t_7 = __Pyx_PyBytes_AsWritableString(__pyx_v_self->_format); if (unlikely((!__pyx_t_7) && PyErr_Occurred())) __PYX_ERR(1, 141, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyBytes_AsWritableString(__pyx_v_self->_format); if (unlikely((!__pyx_t_7) && PyErr_Occurred())) __PYX_ERR(1, 142, __pyx_L1_error)
   __pyx_v_self->format = __pyx_t_7;
 
-  /* "View.MemoryView":144
+  /* "View.MemoryView":145
  * 
  * 
  *         self._shape = <Py_ssize_t *> PyObject_Malloc(sizeof(Py_ssize_t)*self.ndim*2)             # <<<<<<<<<<<<<<
  *         self._strides = self._shape + self.ndim
  * 
  */
   __pyx_v_self->_shape = ((Py_ssize_t *)PyObject_Malloc((((sizeof(Py_ssize_t)) * __pyx_v_self->ndim) * 2)));
 
-  /* "View.MemoryView":145
+  /* "View.MemoryView":146
  * 
  *         self._shape = <Py_ssize_t *> PyObject_Malloc(sizeof(Py_ssize_t)*self.ndim*2)
  *         self._strides = self._shape + self.ndim             # <<<<<<<<<<<<<<
  * 
  *         if not self._shape:
  */
   __pyx_v_self->_strides = (__pyx_v_self->_shape + __pyx_v_self->ndim);
 
-  /* "View.MemoryView":147
+  /* "View.MemoryView":148
  *         self._strides = self._shape + self.ndim
  * 
  *         if not self._shape:             # <<<<<<<<<<<<<<
  *             raise MemoryError("unable to allocate shape and strides.")
  * 
  */
   __pyx_t_4 = ((!(__pyx_v_self->_shape != 0)) != 0);
   if (unlikely(__pyx_t_4)) {
 
-    /* "View.MemoryView":148
+    /* "View.MemoryView":149
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 148, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 149, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 148, __pyx_L1_error)
+    __PYX_ERR(1, 149, __pyx_L1_error)
 
-    /* "View.MemoryView":147
+    /* "View.MemoryView":148
  *         self._strides = self._shape + self.ndim
  * 
  *         if not self._shape:             # <<<<<<<<<<<<<<
  *             raise MemoryError("unable to allocate shape and strides.")
  * 
  */
   }
 
-  /* "View.MemoryView":151
+  /* "View.MemoryView":152
  * 
  * 
  *         for idx, dim in enumerate(shape):             # <<<<<<<<<<<<<<
  *             if dim <= 0:
  *                 raise ValueError("Invalid shape in axis %d: %d." % (idx, dim))
  */
   __pyx_t_8 = 0;
   __pyx_t_3 = __pyx_v_shape; __Pyx_INCREF(__pyx_t_3); __pyx_t_1 = 0;
   for (;;) {
     if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_5); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(1, 151, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_5); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(1, 152, __pyx_L1_error)
     #else
-    __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 151, __pyx_L1_error)
+    __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 152, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     #endif
-    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 151, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 152, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_v_dim = __pyx_t_9;
     __pyx_v_idx = __pyx_t_8;
     __pyx_t_8 = (__pyx_t_8 + 1);
 
-    /* "View.MemoryView":152
+    /* "View.MemoryView":153
  * 
  *         for idx, dim in enumerate(shape):
  *             if dim <= 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError("Invalid shape in axis %d: %d." % (idx, dim))
  *             self._shape[idx] = dim
  */
     __pyx_t_4 = ((__pyx_v_dim <= 0) != 0);
     if (unlikely(__pyx_t_4)) {
 
-      /* "View.MemoryView":153
+      /* "View.MemoryView":154
  *         for idx, dim in enumerate(shape):
  *             if dim <= 0:
  *                 raise ValueError("Invalid shape in axis %d: %d." % (idx, dim))             # <<<<<<<<<<<<<<
  *             self._shape[idx] = dim
  * 
  */
-      __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_idx); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 153, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_idx); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 154, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_dim); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 153, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_dim); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 154, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 153, __pyx_L1_error)
+      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 154, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_5);
       __Pyx_GIVEREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_t_6);
       __pyx_t_5 = 0;
       __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyString_Format(__pyx_kp_s_Invalid_shape_in_axis_d_d, __pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 153, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyString_Format(__pyx_kp_s_Invalid_shape_in_axis_d_d, __pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 154, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_6); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 153, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_6); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 154, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_Raise(__pyx_t_10, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __PYX_ERR(1, 153, __pyx_L1_error)
+      __PYX_ERR(1, 154, __pyx_L1_error)
 
-      /* "View.MemoryView":152
+      /* "View.MemoryView":153
  * 
  *         for idx, dim in enumerate(shape):
  *             if dim <= 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError("Invalid shape in axis %d: %d." % (idx, dim))
  *             self._shape[idx] = dim
  */
     }
 
-    /* "View.MemoryView":154
+    /* "View.MemoryView":155
  *             if dim <= 0:
  *                 raise ValueError("Invalid shape in axis %d: %d." % (idx, dim))
  *             self._shape[idx] = dim             # <<<<<<<<<<<<<<
  * 
  *         cdef char order
  */
     (__pyx_v_self->_shape[__pyx_v_idx]) = __pyx_v_dim;
 
-    /* "View.MemoryView":151
+    /* "View.MemoryView":152
  * 
  * 
  *         for idx, dim in enumerate(shape):             # <<<<<<<<<<<<<<
  *             if dim <= 0:
  *                 raise ValueError("Invalid shape in axis %d: %d." % (idx, dim))
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "View.MemoryView":157
+  /* "View.MemoryView":158
  * 
  *         cdef char order
  *         if mode == 'fortran':             # <<<<<<<<<<<<<<
  *             order = b'F'
  *             self.mode = u'fortran'
  */
-  __pyx_t_4 = (__Pyx_PyString_Equals(__pyx_v_mode, __pyx_n_s_fortran, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(1, 157, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyString_Equals(__pyx_v_mode, __pyx_n_s_fortran, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(1, 158, __pyx_L1_error)
   if (__pyx_t_4) {
 
-    /* "View.MemoryView":158
+    /* "View.MemoryView":159
  *         cdef char order
  *         if mode == 'fortran':
  *             order = b'F'             # <<<<<<<<<<<<<<
  *             self.mode = u'fortran'
  *         elif mode == 'c':
  */
     __pyx_v_order = 'F';
 
-    /* "View.MemoryView":159
+    /* "View.MemoryView":160
  *         if mode == 'fortran':
  *             order = b'F'
  *             self.mode = u'fortran'             # <<<<<<<<<<<<<<
  *         elif mode == 'c':
  *             order = b'C'
  */
     __Pyx_INCREF(__pyx_n_u_fortran);
     __Pyx_GIVEREF(__pyx_n_u_fortran);
     __Pyx_GOTREF(__pyx_v_self->mode);
     __Pyx_DECREF(__pyx_v_self->mode);
     __pyx_v_self->mode = __pyx_n_u_fortran;
 
-    /* "View.MemoryView":157
+    /* "View.MemoryView":158
  * 
  *         cdef char order
  *         if mode == 'fortran':             # <<<<<<<<<<<<<<
  *             order = b'F'
  *             self.mode = u'fortran'
  */
     goto __pyx_L10;
   }
 
-  /* "View.MemoryView":160
+  /* "View.MemoryView":161
  *             order = b'F'
  *             self.mode = u'fortran'
  *         elif mode == 'c':             # <<<<<<<<<<<<<<
  *             order = b'C'
  *             self.mode = u'c'
  */
-  __pyx_t_4 = (__Pyx_PyString_Equals(__pyx_v_mode, __pyx_n_s_c, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(1, 160, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyString_Equals(__pyx_v_mode, __pyx_n_s_c, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(1, 161, __pyx_L1_error)
   if (likely(__pyx_t_4)) {
 
-    /* "View.MemoryView":161
+    /* "View.MemoryView":162
  *             self.mode = u'fortran'
  *         elif mode == 'c':
  *             order = b'C'             # <<<<<<<<<<<<<<
  *             self.mode = u'c'
  *         else:
  */
     __pyx_v_order = 'C';
 
-    /* "View.MemoryView":162
+    /* "View.MemoryView":163
  *         elif mode == 'c':
  *             order = b'C'
  *             self.mode = u'c'             # <<<<<<<<<<<<<<
  *         else:
  *             raise ValueError("Invalid mode, expected 'c' or 'fortran', got %s" % mode)
  */
     __Pyx_INCREF(__pyx_n_u_c);
     __Pyx_GIVEREF(__pyx_n_u_c);
     __Pyx_GOTREF(__pyx_v_self->mode);
     __Pyx_DECREF(__pyx_v_self->mode);
     __pyx_v_self->mode = __pyx_n_u_c;
 
-    /* "View.MemoryView":160
+    /* "View.MemoryView":161
  *             order = b'F'
  *             self.mode = u'fortran'
  *         elif mode == 'c':             # <<<<<<<<<<<<<<
  *             order = b'C'
  *             self.mode = u'c'
  */
     goto __pyx_L10;
   }
 
-  /* "View.MemoryView":164
+  /* "View.MemoryView":165
  *             self.mode = u'c'
  *         else:
  *             raise ValueError("Invalid mode, expected 'c' or 'fortran', got %s" % mode)             # <<<<<<<<<<<<<<
  * 
  *         self.len = fill_contig_strides_array(self._shape, self._strides,
  */
   /*else*/ {
-    __pyx_t_3 = __Pyx_PyString_FormatSafe(__pyx_kp_s_Invalid_mode_expected_c_or_fortr, __pyx_v_mode); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 164, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyString_FormatSafe(__pyx_kp_s_Invalid_mode_expected_c_or_fortr, __pyx_v_mode); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 165, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 164, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 165, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_Raise(__pyx_t_10, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __PYX_ERR(1, 164, __pyx_L1_error)
+    __PYX_ERR(1, 165, __pyx_L1_error)
   }
   __pyx_L10:;
 
-  /* "View.MemoryView":166
+  /* "View.MemoryView":167
  *             raise ValueError("Invalid mode, expected 'c' or 'fortran', got %s" % mode)
  * 
  *         self.len = fill_contig_strides_array(self._shape, self._strides,             # <<<<<<<<<<<<<<
  *                                              itemsize, self.ndim, order)
  * 
  */
   __pyx_v_self->len = __pyx_fill_contig_strides_array(__pyx_v_self->_shape, __pyx_v_self->_strides, __pyx_v_itemsize, __pyx_v_self->ndim, __pyx_v_order);
 
-  /* "View.MemoryView":169
+  /* "View.MemoryView":170
  *                                              itemsize, self.ndim, order)
  * 
  *         self.free_data = allocate_buffer             # <<<<<<<<<<<<<<
  *         self.dtype_is_object = format == b'O'
  *         if allocate_buffer:
  */
   __pyx_v_self->free_data = __pyx_v_allocate_buffer;
 
-  /* "View.MemoryView":170
+  /* "View.MemoryView":171
  * 
  *         self.free_data = allocate_buffer
  *         self.dtype_is_object = format == b'O'             # <<<<<<<<<<<<<<
  *         if allocate_buffer:
  * 
  */
-  __pyx_t_10 = PyObject_RichCompare(__pyx_v_format, __pyx_n_b_O, Py_EQ); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 170, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 170, __pyx_L1_error)
+  __pyx_t_10 = PyObject_RichCompare(__pyx_v_format, __pyx_n_b_O, Py_EQ); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 171, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 171, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   __pyx_v_self->dtype_is_object = __pyx_t_4;
 
-  /* "View.MemoryView":171
+  /* "View.MemoryView":172
  *         self.free_data = allocate_buffer
  *         self.dtype_is_object = format == b'O'
  *         if allocate_buffer:             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_4 = (__pyx_v_allocate_buffer != 0);
   if (__pyx_t_4) {
 
-    /* "View.MemoryView":174
+    /* "View.MemoryView":175
  * 
  * 
  *             self.data = <char *>malloc(self.len)             # <<<<<<<<<<<<<<
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")
  */
     __pyx_v_self->data = ((char *)malloc(__pyx_v_self->len));
 
-    /* "View.MemoryView":175
+    /* "View.MemoryView":176
  * 
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:             # <<<<<<<<<<<<<<
  *                 raise MemoryError("unable to allocate array data.")
  * 
  */
     __pyx_t_4 = ((!(__pyx_v_self->data != 0)) != 0);
     if (unlikely(__pyx_t_4)) {
 
-      /* "View.MemoryView":176
+      /* "View.MemoryView":177
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__14, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 176, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__14, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 177, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_Raise(__pyx_t_10, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __PYX_ERR(1, 176, __pyx_L1_error)
+      __PYX_ERR(1, 177, __pyx_L1_error)
 
-      /* "View.MemoryView":175
+      /* "View.MemoryView":176
  * 
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:             # <<<<<<<<<<<<<<
  *                 raise MemoryError("unable to allocate array data.")
  * 
  */
     }
 
-    /* "View.MemoryView":178
+    /* "View.MemoryView":179
  *                 raise MemoryError("unable to allocate array data.")
  * 
  *             if self.dtype_is_object:             # <<<<<<<<<<<<<<
  *                 p = <PyObject **> self.data
  *                 for i in range(self.len / itemsize):
  */
     __pyx_t_4 = (__pyx_v_self->dtype_is_object != 0);
     if (__pyx_t_4) {
 
-      /* "View.MemoryView":179
+      /* "View.MemoryView":180
  * 
  *             if self.dtype_is_object:
  *                 p = <PyObject **> self.data             # <<<<<<<<<<<<<<
  *                 for i in range(self.len / itemsize):
  *                     p[i] = Py_None
  */
       __pyx_v_p = ((PyObject **)__pyx_v_self->data);
 
-      /* "View.MemoryView":180
+      /* "View.MemoryView":181
  *             if self.dtype_is_object:
  *                 p = <PyObject **> self.data
  *                 for i in range(self.len / itemsize):             # <<<<<<<<<<<<<<
  *                     p[i] = Py_None
  *                     Py_INCREF(Py_None)
  */
       if (unlikely(__pyx_v_itemsize == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-        __PYX_ERR(1, 180, __pyx_L1_error)
+        __PYX_ERR(1, 181, __pyx_L1_error)
       }
       else if (sizeof(Py_ssize_t) == sizeof(long) && (!(((Py_ssize_t)-1) > 0)) && unlikely(__pyx_v_itemsize == (Py_ssize_t)-1)  && unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_v_self->len))) {
         PyErr_SetString(PyExc_OverflowError, "value too large to perform division");
-        __PYX_ERR(1, 180, __pyx_L1_error)
+        __PYX_ERR(1, 181, __pyx_L1_error)
       }
       __pyx_t_1 = __Pyx_div_Py_ssize_t(__pyx_v_self->len, __pyx_v_itemsize);
       __pyx_t_9 = __pyx_t_1;
       for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_9; __pyx_t_11+=1) {
         __pyx_v_i = __pyx_t_11;
 
-        /* "View.MemoryView":181
+        /* "View.MemoryView":182
  *                 p = <PyObject **> self.data
  *                 for i in range(self.len / itemsize):
  *                     p[i] = Py_None             # <<<<<<<<<<<<<<
  *                     Py_INCREF(Py_None)
  * 
  */
         (__pyx_v_p[__pyx_v_i]) = Py_None;
 
-        /* "View.MemoryView":182
+        /* "View.MemoryView":183
  *                 for i in range(self.len / itemsize):
  *                     p[i] = Py_None
  *                     Py_INCREF(Py_None)             # <<<<<<<<<<<<<<
  * 
  *     @cname('getbuffer')
  */
         Py_INCREF(Py_None);
       }
 
-      /* "View.MemoryView":178
+      /* "View.MemoryView":179
  *                 raise MemoryError("unable to allocate array data.")
  * 
  *             if self.dtype_is_object:             # <<<<<<<<<<<<<<
  *                 p = <PyObject **> self.data
  *                 for i in range(self.len / itemsize):
  */
     }
 
-    /* "View.MemoryView":171
+    /* "View.MemoryView":172
  *         self.free_data = allocate_buffer
  *         self.dtype_is_object = format == b'O'
  *         if allocate_buffer:             # <<<<<<<<<<<<<<
  * 
  * 
  */
   }
 
-  /* "View.MemoryView":122
+  /* "View.MemoryView":123
  *         cdef bint dtype_is_object
  * 
  *     def __cinit__(array self, tuple shape, Py_ssize_t itemsize, format not None,             # <<<<<<<<<<<<<<
  *                   mode="c", bint allocate_buffer=True):
  * 
  */
 
@@ -29765,15 +29978,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_format);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":185
+/* "View.MemoryView":186
  * 
  *     @cname('getbuffer')
  *     def __getbuffer__(self, Py_buffer *info, int flags):             # <<<<<<<<<<<<<<
  *         cdef int bufmode = -1
  *         if self.mode == u"c":
  */
 
@@ -29797,257 +30010,260 @@
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   char *__pyx_t_4;
   Py_ssize_t __pyx_t_5;
   int __pyx_t_6;
   Py_ssize_t *__pyx_t_7;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   if (__pyx_v_info == NULL) {
     PyErr_SetString(PyExc_BufferError, "PyObject_GetBuffer: view==NULL argument is obsolete");
     return -1;
   }
   __Pyx_RefNannySetupContext("__getbuffer__", 0);
   __pyx_v_info->obj = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(__pyx_v_info->obj);
 
-  /* "View.MemoryView":186
+  /* "View.MemoryView":187
  *     @cname('getbuffer')
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         cdef int bufmode = -1             # <<<<<<<<<<<<<<
  *         if self.mode == u"c":
  *             bufmode = PyBUF_C_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  */
   __pyx_v_bufmode = -1;
 
-  /* "View.MemoryView":187
+  /* "View.MemoryView":188
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         cdef int bufmode = -1
  *         if self.mode == u"c":             # <<<<<<<<<<<<<<
  *             bufmode = PyBUF_C_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         elif self.mode == u"fortran":
  */
-  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mode, __pyx_n_u_c, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 187, __pyx_L1_error)
+  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mode, __pyx_n_u_c, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 188, __pyx_L1_error)
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":188
+    /* "View.MemoryView":189
  *         cdef int bufmode = -1
  *         if self.mode == u"c":
  *             bufmode = PyBUF_C_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS             # <<<<<<<<<<<<<<
  *         elif self.mode == u"fortran":
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  */
     __pyx_v_bufmode = (PyBUF_C_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS);
 
-    /* "View.MemoryView":187
+    /* "View.MemoryView":188
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         cdef int bufmode = -1
  *         if self.mode == u"c":             # <<<<<<<<<<<<<<
  *             bufmode = PyBUF_C_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         elif self.mode == u"fortran":
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":189
+  /* "View.MemoryView":190
  *         if self.mode == u"c":
  *             bufmode = PyBUF_C_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         elif self.mode == u"fortran":             # <<<<<<<<<<<<<<
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mode, __pyx_n_u_fortran, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(1, 189, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mode, __pyx_n_u_fortran, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(1, 190, __pyx_L1_error)
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":190
+    /* "View.MemoryView":191
  *             bufmode = PyBUF_C_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         elif self.mode == u"fortran":
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS             # <<<<<<<<<<<<<<
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")
  */
     __pyx_v_bufmode = (PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS);
 
-    /* "View.MemoryView":189
+    /* "View.MemoryView":190
  *         if self.mode == u"c":
  *             bufmode = PyBUF_C_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         elif self.mode == u"fortran":             # <<<<<<<<<<<<<<
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  */
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":191
+  /* "View.MemoryView":192
  *         elif self.mode == u"fortran":
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):             # <<<<<<<<<<<<<<
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")
  *         info.buf = self.data
  */
   __pyx_t_1 = ((!((__pyx_v_flags & __pyx_v_bufmode) != 0)) != 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "View.MemoryView":192
+    /* "View.MemoryView":193
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 192, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 193, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 192, __pyx_L1_error)
+    __PYX_ERR(1, 193, __pyx_L1_error)
 
-    /* "View.MemoryView":191
+    /* "View.MemoryView":192
  *         elif self.mode == u"fortran":
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):             # <<<<<<<<<<<<<<
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")
  *         info.buf = self.data
  */
   }
 
-  /* "View.MemoryView":193
+  /* "View.MemoryView":194
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")
  *         info.buf = self.data             # <<<<<<<<<<<<<<
  *         info.len = self.len
  *         info.ndim = self.ndim
  */
   __pyx_t_4 = __pyx_v_self->data;
   __pyx_v_info->buf = __pyx_t_4;
 
-  /* "View.MemoryView":194
+  /* "View.MemoryView":195
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")
  *         info.buf = self.data
  *         info.len = self.len             # <<<<<<<<<<<<<<
  *         info.ndim = self.ndim
  *         info.shape = self._shape
  */
   __pyx_t_5 = __pyx_v_self->len;
   __pyx_v_info->len = __pyx_t_5;
 
-  /* "View.MemoryView":195
+  /* "View.MemoryView":196
  *         info.buf = self.data
  *         info.len = self.len
  *         info.ndim = self.ndim             # <<<<<<<<<<<<<<
  *         info.shape = self._shape
  *         info.strides = self._strides
  */
   __pyx_t_6 = __pyx_v_self->ndim;
   __pyx_v_info->ndim = __pyx_t_6;
 
-  /* "View.MemoryView":196
+  /* "View.MemoryView":197
  *         info.len = self.len
  *         info.ndim = self.ndim
  *         info.shape = self._shape             # <<<<<<<<<<<<<<
  *         info.strides = self._strides
  *         info.suboffsets = NULL
  */
   __pyx_t_7 = __pyx_v_self->_shape;
   __pyx_v_info->shape = __pyx_t_7;
 
-  /* "View.MemoryView":197
+  /* "View.MemoryView":198
  *         info.ndim = self.ndim
  *         info.shape = self._shape
  *         info.strides = self._strides             # <<<<<<<<<<<<<<
  *         info.suboffsets = NULL
  *         info.itemsize = self.itemsize
  */
   __pyx_t_7 = __pyx_v_self->_strides;
   __pyx_v_info->strides = __pyx_t_7;
 
-  /* "View.MemoryView":198
+  /* "View.MemoryView":199
  *         info.shape = self._shape
  *         info.strides = self._strides
  *         info.suboffsets = NULL             # <<<<<<<<<<<<<<
  *         info.itemsize = self.itemsize
  *         info.readonly = 0
  */
   __pyx_v_info->suboffsets = NULL;
 
-  /* "View.MemoryView":199
+  /* "View.MemoryView":200
  *         info.strides = self._strides
  *         info.suboffsets = NULL
  *         info.itemsize = self.itemsize             # <<<<<<<<<<<<<<
  *         info.readonly = 0
  * 
  */
   __pyx_t_5 = __pyx_v_self->itemsize;
   __pyx_v_info->itemsize = __pyx_t_5;
 
-  /* "View.MemoryView":200
+  /* "View.MemoryView":201
  *         info.suboffsets = NULL
  *         info.itemsize = self.itemsize
  *         info.readonly = 0             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_FORMAT:
  */
   __pyx_v_info->readonly = 0;
 
-  /* "View.MemoryView":202
+  /* "View.MemoryView":203
  *         info.readonly = 0
  * 
  *         if flags & PyBUF_FORMAT:             # <<<<<<<<<<<<<<
  *             info.format = self.format
  *         else:
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_FORMAT) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":203
+    /* "View.MemoryView":204
  * 
  *         if flags & PyBUF_FORMAT:
  *             info.format = self.format             # <<<<<<<<<<<<<<
  *         else:
  *             info.format = NULL
  */
     __pyx_t_4 = __pyx_v_self->format;
     __pyx_v_info->format = __pyx_t_4;
 
-    /* "View.MemoryView":202
+    /* "View.MemoryView":203
  *         info.readonly = 0
  * 
  *         if flags & PyBUF_FORMAT:             # <<<<<<<<<<<<<<
  *             info.format = self.format
  *         else:
  */
     goto __pyx_L5;
   }
 
-  /* "View.MemoryView":205
+  /* "View.MemoryView":206
  *             info.format = self.format
  *         else:
  *             info.format = NULL             # <<<<<<<<<<<<<<
  * 
  *         info.obj = self
  */
   /*else*/ {
     __pyx_v_info->format = NULL;
   }
   __pyx_L5:;
 
-  /* "View.MemoryView":207
+  /* "View.MemoryView":208
  *             info.format = NULL
  * 
  *         info.obj = self             # <<<<<<<<<<<<<<
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_array_getbuffer, "getbuffer(obj, view, flags)")
  */
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
   __Pyx_GOTREF(__pyx_v_info->obj);
   __Pyx_DECREF(__pyx_v_info->obj);
   __pyx_v_info->obj = ((PyObject *)__pyx_v_self);
 
-  /* "View.MemoryView":185
+  /* "View.MemoryView":186
  * 
  *     @cname('getbuffer')
  *     def __getbuffer__(self, Py_buffer *info, int flags):             # <<<<<<<<<<<<<<
  *         cdef int bufmode = -1
  *         if self.mode == u"c":
  */
 
@@ -30069,15 +30285,15 @@
     __Pyx_DECREF(__pyx_v_info->obj); __pyx_v_info->obj = 0;
   }
   __pyx_L2:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":211
+/* "View.MemoryView":212
  *     __pyx_getbuffer = capsule(<void *> &__pyx_array_getbuffer, "getbuffer(obj, view, flags)")
  * 
  *     def __dealloc__(array self):             # <<<<<<<<<<<<<<
  *         if self.callback_free_data != NULL:
  *             self.callback_free_data(self.data)
  */
 
@@ -30093,122 +30309,122 @@
 }
 
 static void __pyx_array___pyx_pf_15View_dot_MemoryView_5array_4__dealloc__(struct __pyx_array_obj *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("__dealloc__", 0);
 
-  /* "View.MemoryView":212
+  /* "View.MemoryView":213
  * 
  *     def __dealloc__(array self):
  *         if self.callback_free_data != NULL:             # <<<<<<<<<<<<<<
  *             self.callback_free_data(self.data)
  *         elif self.free_data:
  */
   __pyx_t_1 = ((__pyx_v_self->callback_free_data != NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":213
+    /* "View.MemoryView":214
  *     def __dealloc__(array self):
  *         if self.callback_free_data != NULL:
  *             self.callback_free_data(self.data)             # <<<<<<<<<<<<<<
  *         elif self.free_data:
  *             if self.dtype_is_object:
  */
     __pyx_v_self->callback_free_data(__pyx_v_self->data);
 
-    /* "View.MemoryView":212
+    /* "View.MemoryView":213
  * 
  *     def __dealloc__(array self):
  *         if self.callback_free_data != NULL:             # <<<<<<<<<<<<<<
  *             self.callback_free_data(self.data)
  *         elif self.free_data:
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":214
+  /* "View.MemoryView":215
  *         if self.callback_free_data != NULL:
  *             self.callback_free_data(self.data)
  *         elif self.free_data:             # <<<<<<<<<<<<<<
  *             if self.dtype_is_object:
  *                 refcount_objects_in_slice(self.data, self._shape,
  */
   __pyx_t_1 = (__pyx_v_self->free_data != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":215
+    /* "View.MemoryView":216
  *             self.callback_free_data(self.data)
  *         elif self.free_data:
  *             if self.dtype_is_object:             # <<<<<<<<<<<<<<
  *                 refcount_objects_in_slice(self.data, self._shape,
  *                                           self._strides, self.ndim, False)
  */
     __pyx_t_1 = (__pyx_v_self->dtype_is_object != 0);
     if (__pyx_t_1) {
 
-      /* "View.MemoryView":216
+      /* "View.MemoryView":217
  *         elif self.free_data:
  *             if self.dtype_is_object:
  *                 refcount_objects_in_slice(self.data, self._shape,             # <<<<<<<<<<<<<<
  *                                           self._strides, self.ndim, False)
  *             free(self.data)
  */
       __pyx_memoryview_refcount_objects_in_slice(__pyx_v_self->data, __pyx_v_self->_shape, __pyx_v_self->_strides, __pyx_v_self->ndim, 0);
 
-      /* "View.MemoryView":215
+      /* "View.MemoryView":216
  *             self.callback_free_data(self.data)
  *         elif self.free_data:
  *             if self.dtype_is_object:             # <<<<<<<<<<<<<<
  *                 refcount_objects_in_slice(self.data, self._shape,
  *                                           self._strides, self.ndim, False)
  */
     }
 
-    /* "View.MemoryView":218
+    /* "View.MemoryView":219
  *                 refcount_objects_in_slice(self.data, self._shape,
  *                                           self._strides, self.ndim, False)
  *             free(self.data)             # <<<<<<<<<<<<<<
  *         PyObject_Free(self._shape)
  * 
  */
     free(__pyx_v_self->data);
 
-    /* "View.MemoryView":214
+    /* "View.MemoryView":215
  *         if self.callback_free_data != NULL:
  *             self.callback_free_data(self.data)
  *         elif self.free_data:             # <<<<<<<<<<<<<<
  *             if self.dtype_is_object:
  *                 refcount_objects_in_slice(self.data, self._shape,
  */
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":219
+  /* "View.MemoryView":220
  *                                           self._strides, self.ndim, False)
  *             free(self.data)
  *         PyObject_Free(self._shape)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   PyObject_Free(__pyx_v_self->_shape);
 
-  /* "View.MemoryView":211
+  /* "View.MemoryView":212
  *     __pyx_getbuffer = capsule(<void *> &__pyx_array_getbuffer, "getbuffer(obj, view, flags)")
  * 
  *     def __dealloc__(array self):             # <<<<<<<<<<<<<<
  *         if self.callback_free_data != NULL:
  *             self.callback_free_data(self.data)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "View.MemoryView":222
+/* "View.MemoryView":223
  * 
  *     @property
  *     def memview(self):             # <<<<<<<<<<<<<<
  *         return self.get_memview()
  * 
  */
 
@@ -30225,31 +30441,34 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_15View_dot_MemoryView_5array_7memview___get__(struct __pyx_array_obj *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "View.MemoryView":223
+  /* "View.MemoryView":224
  *     @property
  *     def memview(self):
  *         return self.get_memview()             # <<<<<<<<<<<<<<
  * 
  *     @cname('get_memview')
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = ((struct __pyx_vtabstruct_array *)__pyx_v_self->__pyx_vtab)->get_memview(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 223, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_array *)__pyx_v_self->__pyx_vtab)->get_memview(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":222
+  /* "View.MemoryView":223
  * 
  *     @property
  *     def memview(self):             # <<<<<<<<<<<<<<
  *         return self.get_memview()
  * 
  */
 
@@ -30260,71 +30479,74 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":226
+/* "View.MemoryView":227
  * 
  *     @cname('get_memview')
  *     cdef get_memview(self):             # <<<<<<<<<<<<<<
  *         flags =  PyBUF_ANY_CONTIGUOUS|PyBUF_FORMAT|PyBUF_WRITABLE
  *         return  memoryview(self, flags, self.dtype_is_object)
  */
 
 static PyObject *__pyx_array_get_memview(struct __pyx_array_obj *__pyx_v_self) {
   int __pyx_v_flags;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_memview", 0);
 
-  /* "View.MemoryView":227
+  /* "View.MemoryView":228
  *     @cname('get_memview')
  *     cdef get_memview(self):
  *         flags =  PyBUF_ANY_CONTIGUOUS|PyBUF_FORMAT|PyBUF_WRITABLE             # <<<<<<<<<<<<<<
  *         return  memoryview(self, flags, self.dtype_is_object)
  * 
  */
   __pyx_v_flags = ((PyBUF_ANY_CONTIGUOUS | PyBUF_FORMAT) | PyBUF_WRITABLE);
 
-  /* "View.MemoryView":228
+  /* "View.MemoryView":229
  *     cdef get_memview(self):
  *         flags =  PyBUF_ANY_CONTIGUOUS|PyBUF_FORMAT|PyBUF_WRITABLE
  *         return  memoryview(self, flags, self.dtype_is_object)             # <<<<<<<<<<<<<<
  * 
  *     def __len__(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_flags); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 228, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_flags); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 229, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_v_self->dtype_is_object); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 228, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_v_self->dtype_is_object); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 229, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 228, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 229, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
   PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_self));
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_2);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryview_type), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 228, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryview_type), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 229, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":226
+  /* "View.MemoryView":227
  * 
  *     @cname('get_memview')
  *     cdef get_memview(self):             # <<<<<<<<<<<<<<
  *         flags =  PyBUF_ANY_CONTIGUOUS|PyBUF_FORMAT|PyBUF_WRITABLE
  *         return  memoryview(self, flags, self.dtype_is_object)
  */
 
@@ -30337,15 +30559,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":230
+/* "View.MemoryView":231
  *         return  memoryview(self, flags, self.dtype_is_object)
  * 
  *     def __len__(self):             # <<<<<<<<<<<<<<
  *         return self._shape[0]
  * 
  */
 
@@ -30363,39 +30585,39 @@
 }
 
 static Py_ssize_t __pyx_array___pyx_pf_15View_dot_MemoryView_5array_6__len__(struct __pyx_array_obj *__pyx_v_self) {
   Py_ssize_t __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__len__", 0);
 
-  /* "View.MemoryView":231
+  /* "View.MemoryView":232
  * 
  *     def __len__(self):
  *         return self._shape[0]             # <<<<<<<<<<<<<<
  * 
  *     def __getattr__(self, attr):
  */
   __pyx_r = (__pyx_v_self->_shape[0]);
   goto __pyx_L0;
 
-  /* "View.MemoryView":230
+  /* "View.MemoryView":231
  *         return  memoryview(self, flags, self.dtype_is_object)
  * 
  *     def __len__(self):             # <<<<<<<<<<<<<<
  *         return self._shape[0]
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":233
+/* "View.MemoryView":234
  *         return self._shape[0]
  * 
  *     def __getattr__(self, attr):             # <<<<<<<<<<<<<<
  *         return getattr(self.memview, attr)
  * 
  */
 
@@ -30413,34 +30635,37 @@
 }
 
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_8__getattr__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_attr) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__getattr__", 0);
 
-  /* "View.MemoryView":234
+  /* "View.MemoryView":235
  * 
  *     def __getattr__(self, attr):
  *         return getattr(self.memview, attr)             # <<<<<<<<<<<<<<
  * 
  *     def __getitem__(self, item):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_memview); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 234, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_memview); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_GetAttr(__pyx_t_1, __pyx_v_attr); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 234, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetAttr(__pyx_t_1, __pyx_v_attr); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":233
+  /* "View.MemoryView":234
  *         return self._shape[0]
  * 
  *     def __getattr__(self, attr):             # <<<<<<<<<<<<<<
  *         return getattr(self.memview, attr)
  * 
  */
 
@@ -30452,15 +30677,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":236
+/* "View.MemoryView":237
  *         return getattr(self.memview, attr)
  * 
  *     def __getitem__(self, item):             # <<<<<<<<<<<<<<
  *         return self.memview[item]
  * 
  */
 
@@ -30478,34 +30703,37 @@
 }
 
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_10__getitem__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_item) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__getitem__", 0);
 
-  /* "View.MemoryView":237
+  /* "View.MemoryView":238
  * 
  *     def __getitem__(self, item):
  *         return self.memview[item]             # <<<<<<<<<<<<<<
  * 
  *     def __setitem__(self, item, value):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_memview); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 237, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_memview); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 238, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_item); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 237, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_item); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 238, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":236
+  /* "View.MemoryView":237
  *         return getattr(self.memview, attr)
  * 
  *     def __getitem__(self, item):             # <<<<<<<<<<<<<<
  *         return self.memview[item]
  * 
  */
 
@@ -30517,15 +30745,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":239
+/* "View.MemoryView":240
  *         return self.memview[item]
  * 
  *     def __setitem__(self, item, value):             # <<<<<<<<<<<<<<
  *         self.memview[item] = value
  * 
  */
 
@@ -30542,29 +30770,32 @@
   return __pyx_r;
 }
 
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array_12__setitem__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_item, PyObject *__pyx_v_value) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__setitem__", 0);
 
-  /* "View.MemoryView":240
+  /* "View.MemoryView":241
  * 
  *     def __setitem__(self, item, value):
  *         self.memview[item] = value             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_memview); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 240, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_memview); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 241, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_item, __pyx_v_value) < 0)) __PYX_ERR(1, 240, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_item, __pyx_v_value) < 0)) __PYX_ERR(1, 241, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "View.MemoryView":239
+  /* "View.MemoryView":240
  *         return self.memview[item]
  * 
  *     def __setitem__(self, item, value):             # <<<<<<<<<<<<<<
  *         self.memview[item] = value
  * 
  */
 
@@ -30599,14 +30830,17 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf___pyx_array___reduce_cython__(CYTHON_UNUSED struct __pyx_array_obj *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reduce_cython__", 0);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
@@ -30653,14 +30887,17 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf___pyx_array_2__setstate_cython__(CYTHON_UNUSED struct __pyx_array_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
@@ -30683,15 +30920,15 @@
   __Pyx_AddTraceback("View.MemoryView.array.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":244
+/* "View.MemoryView":245
  * 
  * @cname("__pyx_array_new")
  * cdef array array_cwrapper(tuple shape, Py_ssize_t itemsize, char *format,             # <<<<<<<<<<<<<<
  *                           char *mode, char *buf):
  *     cdef array result
  */
 
@@ -30700,147 +30937,150 @@
   struct __pyx_array_obj *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("array_cwrapper", 0);
 
-  /* "View.MemoryView":248
+  /* "View.MemoryView":249
  *     cdef array result
  * 
  *     if buf == NULL:             # <<<<<<<<<<<<<<
  *         result = array(shape, itemsize, format, mode.decode('ASCII'))
  *     else:
  */
   __pyx_t_1 = ((__pyx_v_buf == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":249
+    /* "View.MemoryView":250
  * 
  *     if buf == NULL:
  *         result = array(shape, itemsize, format, mode.decode('ASCII'))             # <<<<<<<<<<<<<<
  *     else:
  *         result = array(shape, itemsize, format, mode.decode('ASCII'),
  */
-    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 249, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyBytes_FromString(__pyx_v_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 249, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyBytes_FromString(__pyx_v_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_decode_c_string(__pyx_v_mode, 0, strlen(__pyx_v_mode), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 249, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_decode_c_string(__pyx_v_mode, 0, strlen(__pyx_v_mode), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(4); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 249, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(4); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_INCREF(__pyx_v_shape);
     __Pyx_GIVEREF(__pyx_v_shape);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_shape);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 3, __pyx_t_4);
     __pyx_t_2 = 0;
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_array_type), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 249, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_array_type), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_v_result = ((struct __pyx_array_obj *)__pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "View.MemoryView":248
+    /* "View.MemoryView":249
  *     cdef array result
  * 
  *     if buf == NULL:             # <<<<<<<<<<<<<<
  *         result = array(shape, itemsize, format, mode.decode('ASCII'))
  *     else:
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":251
+  /* "View.MemoryView":252
  *         result = array(shape, itemsize, format, mode.decode('ASCII'))
  *     else:
  *         result = array(shape, itemsize, format, mode.decode('ASCII'),             # <<<<<<<<<<<<<<
  *                        allocate_buffer=False)
  *         result.data = buf
  */
   /*else*/ {
-    __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_itemsize); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 251, __pyx_L1_error)
+    __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_itemsize); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyBytes_FromString(__pyx_v_format); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 251, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyBytes_FromString(__pyx_v_format); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = __Pyx_decode_c_string(__pyx_v_mode, 0, strlen(__pyx_v_mode), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 251, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_decode_c_string(__pyx_v_mode, 0, strlen(__pyx_v_mode), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 251, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_v_shape);
     __Pyx_GIVEREF(__pyx_v_shape);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_shape);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_t_3);
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
     __pyx_t_3 = 0;
 
-    /* "View.MemoryView":252
+    /* "View.MemoryView":253
  *     else:
  *         result = array(shape, itemsize, format, mode.decode('ASCII'),
  *                        allocate_buffer=False)             # <<<<<<<<<<<<<<
  *         result.data = buf
  * 
  */
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 252, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 253, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_allocate_buffer, Py_False) < 0) __PYX_ERR(1, 252, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_allocate_buffer, Py_False) < 0) __PYX_ERR(1, 253, __pyx_L1_error)
 
-    /* "View.MemoryView":251
+    /* "View.MemoryView":252
  *         result = array(shape, itemsize, format, mode.decode('ASCII'))
  *     else:
  *         result = array(shape, itemsize, format, mode.decode('ASCII'),             # <<<<<<<<<<<<<<
  *                        allocate_buffer=False)
  *         result.data = buf
  */
-    __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_array_type), __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 251, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_array_type), __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_result = ((struct __pyx_array_obj *)__pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "View.MemoryView":253
+    /* "View.MemoryView":254
  *         result = array(shape, itemsize, format, mode.decode('ASCII'),
  *                        allocate_buffer=False)
  *         result.data = buf             # <<<<<<<<<<<<<<
  * 
  *     return result
  */
     __pyx_v_result->data = __pyx_v_buf;
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":255
+  /* "View.MemoryView":256
  *         result.data = buf
  * 
  *     return result             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(((PyObject *)__pyx_r));
   __Pyx_INCREF(((PyObject *)__pyx_v_result));
   __pyx_r = __pyx_v_result;
   goto __pyx_L0;
 
-  /* "View.MemoryView":244
+  /* "View.MemoryView":245
  * 
  * @cname("__pyx_array_new")
  * cdef array array_cwrapper(tuple shape, Py_ssize_t itemsize, char *format,             # <<<<<<<<<<<<<<
  *                           char *mode, char *buf):
  *     cdef array result
  */
 
@@ -30855,26 +31095,29 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_result);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":281
+/* "View.MemoryView":282
  * cdef class Enum(object):
  *     cdef object name
  *     def __init__(self, name):             # <<<<<<<<<<<<<<
  *         self.name = name
  *     def __repr__(self):
  */
 
 /* Python wrapper */
 static int __pyx_MemviewEnum___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static int __pyx_MemviewEnum___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_name = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_name,0};
     PyObject* values[1] = {0};
     if (unlikely(__pyx_kwds)) {
@@ -30889,26 +31132,26 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(1, 281, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(1, 282, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_name = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 281, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 282, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("View.MemoryView.Enum.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_MemviewEnum___pyx_pf_15View_dot_MemoryView_4Enum___init__(((struct __pyx_MemviewEnum_obj *)__pyx_v_self), __pyx_v_name);
 
@@ -30918,42 +31161,42 @@
 }
 
 static int __pyx_MemviewEnum___pyx_pf_15View_dot_MemoryView_4Enum___init__(struct __pyx_MemviewEnum_obj *__pyx_v_self, PyObject *__pyx_v_name) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "View.MemoryView":282
+  /* "View.MemoryView":283
  *     cdef object name
  *     def __init__(self, name):
  *         self.name = name             # <<<<<<<<<<<<<<
  *     def __repr__(self):
  *         return self.name
  */
   __Pyx_INCREF(__pyx_v_name);
   __Pyx_GIVEREF(__pyx_v_name);
   __Pyx_GOTREF(__pyx_v_self->name);
   __Pyx_DECREF(__pyx_v_self->name);
   __pyx_v_self->name = __pyx_v_name;
 
-  /* "View.MemoryView":281
+  /* "View.MemoryView":282
  * cdef class Enum(object):
  *     cdef object name
  *     def __init__(self, name):             # <<<<<<<<<<<<<<
  *         self.name = name
  *     def __repr__(self):
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":283
+/* "View.MemoryView":284
  *     def __init__(self, name):
  *         self.name = name
  *     def __repr__(self):             # <<<<<<<<<<<<<<
  *         return self.name
  * 
  */
 
@@ -30971,27 +31214,27 @@
 }
 
 static PyObject *__pyx_MemviewEnum___pyx_pf_15View_dot_MemoryView_4Enum_2__repr__(struct __pyx_MemviewEnum_obj *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__repr__", 0);
 
-  /* "View.MemoryView":284
+  /* "View.MemoryView":285
  *         self.name = name
  *     def __repr__(self):
  *         return self.name             # <<<<<<<<<<<<<<
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_self->name);
   __pyx_r = __pyx_v_self->name;
   goto __pyx_L0;
 
-  /* "View.MemoryView":283
+  /* "View.MemoryView":284
  *     def __init__(self, name):
  *         self.name = name
  *     def __repr__(self):             # <<<<<<<<<<<<<<
  *         return self.name
  * 
  */
 
@@ -31028,14 +31271,17 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_t_2;
   int __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reduce_cython__", 0);
 
   /* "(tree fragment)":5
  *     cdef object _dict
  *     cdef bint use_setstate
  *     state = (self.name,)             # <<<<<<<<<<<<<<
  *     _dict = getattr(self, '__dict__', None)
@@ -31253,22 +31499,25 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf___pyx_MemviewEnum_2__setstate_cython__(struct __pyx_MemviewEnum_obj *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":17
  *         return __pyx_unpickle_Enum, (type(self), 0xb068931, state)
  * def __setstate_cython__(self, __pyx_state):
  *     __pyx_unpickle_Enum__set_state(self, __pyx_state)             # <<<<<<<<<<<<<<
  */
-  if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(1, 17, __pyx_L1_error)
+  if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(1, 17, __pyx_L1_error)
   __pyx_t_1 = __pyx_unpickle_Enum__set_state(__pyx_v_self, ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 17, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "(tree fragment)":16
  *     else:
  *         return __pyx_unpickle_Enum, (type(self), 0xb068931, state)
@@ -31285,111 +31534,114 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":298
+/* "View.MemoryView":299
  * 
  * @cname('__pyx_align_pointer')
  * cdef void *align_pointer(void *memory, size_t alignment) nogil:             # <<<<<<<<<<<<<<
  *     "Align pointer memory on a given boundary"
  *     cdef Py_intptr_t aligned_p = <Py_intptr_t> memory
  */
 
 static void *__pyx_align_pointer(void *__pyx_v_memory, size_t __pyx_v_alignment) {
   Py_intptr_t __pyx_v_aligned_p;
   size_t __pyx_v_offset;
   void *__pyx_r;
   int __pyx_t_1;
 
-  /* "View.MemoryView":300
+  /* "View.MemoryView":301
  * cdef void *align_pointer(void *memory, size_t alignment) nogil:
  *     "Align pointer memory on a given boundary"
  *     cdef Py_intptr_t aligned_p = <Py_intptr_t> memory             # <<<<<<<<<<<<<<
  *     cdef size_t offset
  * 
  */
   __pyx_v_aligned_p = ((Py_intptr_t)__pyx_v_memory);
 
-  /* "View.MemoryView":304
+  /* "View.MemoryView":305
  * 
  *     with cython.cdivision(True):
  *         offset = aligned_p % alignment             # <<<<<<<<<<<<<<
  * 
  *     if offset > 0:
  */
   __pyx_v_offset = (__pyx_v_aligned_p % __pyx_v_alignment);
 
-  /* "View.MemoryView":306
+  /* "View.MemoryView":307
  *         offset = aligned_p % alignment
  * 
  *     if offset > 0:             # <<<<<<<<<<<<<<
  *         aligned_p += alignment - offset
  * 
  */
   __pyx_t_1 = ((__pyx_v_offset > 0) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":307
+    /* "View.MemoryView":308
  * 
  *     if offset > 0:
  *         aligned_p += alignment - offset             # <<<<<<<<<<<<<<
  * 
  *     return <void *> aligned_p
  */
     __pyx_v_aligned_p = (__pyx_v_aligned_p + (__pyx_v_alignment - __pyx_v_offset));
 
-    /* "View.MemoryView":306
+    /* "View.MemoryView":307
  *         offset = aligned_p % alignment
  * 
  *     if offset > 0:             # <<<<<<<<<<<<<<
  *         aligned_p += alignment - offset
  * 
  */
   }
 
-  /* "View.MemoryView":309
+  /* "View.MemoryView":310
  *         aligned_p += alignment - offset
  * 
  *     return <void *> aligned_p             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((void *)__pyx_v_aligned_p);
   goto __pyx_L0;
 
-  /* "View.MemoryView":298
+  /* "View.MemoryView":299
  * 
  * @cname('__pyx_align_pointer')
  * cdef void *align_pointer(void *memory, size_t alignment) nogil:             # <<<<<<<<<<<<<<
  *     "Align pointer memory on a given boundary"
  *     cdef Py_intptr_t aligned_p = <Py_intptr_t> memory
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "View.MemoryView":345
+/* "View.MemoryView":346
  *     cdef __Pyx_TypeInfo *typeinfo
  * 
  *     def __cinit__(memoryview self, object obj, int flags, bint dtype_is_object=False):             # <<<<<<<<<<<<<<
  *         self.obj = obj
  *         self.flags = flags
  */
 
 /* Python wrapper */
 static int __pyx_memoryview___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static int __pyx_memoryview___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_obj = 0;
   int __pyx_v_flags;
   int __pyx_v_dtype_is_object;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_obj,&__pyx_n_s_flags,&__pyx_n_s_dtype_is_object,0};
     PyObject* values[3] = {0,0,0};
     if (unlikely(__pyx_kwds)) {
@@ -31410,47 +31662,47 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obj)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_flags)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 3, 1); __PYX_ERR(1, 345, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 3, 1); __PYX_ERR(1, 346, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dtype_is_object);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(1, 345, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(1, 346, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_obj = values[0];
-    __pyx_v_flags = __Pyx_PyInt_As_int(values[1]); if (unlikely((__pyx_v_flags == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 345, __pyx_L3_error)
+    __pyx_v_flags = __Pyx_PyInt_As_int(values[1]); if (unlikely((__pyx_v_flags == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 346, __pyx_L3_error)
     if (values[2]) {
-      __pyx_v_dtype_is_object = __Pyx_PyObject_IsTrue(values[2]); if (unlikely((__pyx_v_dtype_is_object == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 345, __pyx_L3_error)
+      __pyx_v_dtype_is_object = __Pyx_PyObject_IsTrue(values[2]); if (unlikely((__pyx_v_dtype_is_object == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 346, __pyx_L3_error)
     } else {
       __pyx_v_dtype_is_object = ((int)0);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 345, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 346, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("View.MemoryView.memoryview.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview___cinit__(((struct __pyx_memoryview_obj *)__pyx_v_self), __pyx_v_obj, __pyx_v_flags, __pyx_v_dtype_is_object);
 
@@ -31462,39 +31714,42 @@
 static int __pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview___cinit__(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_obj, int __pyx_v_flags, int __pyx_v_dtype_is_object) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "View.MemoryView":346
+  /* "View.MemoryView":347
  * 
  *     def __cinit__(memoryview self, object obj, int flags, bint dtype_is_object=False):
  *         self.obj = obj             # <<<<<<<<<<<<<<
  *         self.flags = flags
  *         if type(self) is memoryview or obj is not None:
  */
   __Pyx_INCREF(__pyx_v_obj);
   __Pyx_GIVEREF(__pyx_v_obj);
   __Pyx_GOTREF(__pyx_v_self->obj);
   __Pyx_DECREF(__pyx_v_self->obj);
   __pyx_v_self->obj = __pyx_v_obj;
 
-  /* "View.MemoryView":347
+  /* "View.MemoryView":348
  *     def __cinit__(memoryview self, object obj, int flags, bint dtype_is_object=False):
  *         self.obj = obj
  *         self.flags = flags             # <<<<<<<<<<<<<<
  *         if type(self) is memoryview or obj is not None:
  *             __Pyx_GetBuffer(obj, &self.view, flags)
  */
   __pyx_v_self->flags = __pyx_v_flags;
 
-  /* "View.MemoryView":348
+  /* "View.MemoryView":349
  *         self.obj = obj
  *         self.flags = flags
  *         if type(self) is memoryview or obj is not None:             # <<<<<<<<<<<<<<
  *             __Pyx_GetBuffer(obj, &self.view, flags)
  *             if <PyObject *> self.view.obj == NULL:
  */
   __pyx_t_2 = (((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))) == ((PyObject *)__pyx_memoryview_type));
@@ -31506,231 +31761,250 @@
   }
   __pyx_t_3 = (__pyx_v_obj != Py_None);
   __pyx_t_2 = (__pyx_t_3 != 0);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":349
+    /* "View.MemoryView":350
  *         self.flags = flags
  *         if type(self) is memoryview or obj is not None:
  *             __Pyx_GetBuffer(obj, &self.view, flags)             # <<<<<<<<<<<<<<
  *             if <PyObject *> self.view.obj == NULL:
  *                 (<__pyx_buffer *> &self.view).obj = Py_None
  */
-    __pyx_t_4 = __Pyx_GetBuffer(__pyx_v_obj, (&__pyx_v_self->view), __pyx_v_flags); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 349, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_GetBuffer(__pyx_v_obj, (&__pyx_v_self->view), __pyx_v_flags); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 350, __pyx_L1_error)
 
-    /* "View.MemoryView":350
+    /* "View.MemoryView":351
  *         if type(self) is memoryview or obj is not None:
  *             __Pyx_GetBuffer(obj, &self.view, flags)
  *             if <PyObject *> self.view.obj == NULL:             # <<<<<<<<<<<<<<
  *                 (<__pyx_buffer *> &self.view).obj = Py_None
  *                 Py_INCREF(Py_None)
  */
     __pyx_t_1 = ((((PyObject *)__pyx_v_self->view.obj) == NULL) != 0);
     if (__pyx_t_1) {
 
-      /* "View.MemoryView":351
+      /* "View.MemoryView":352
  *             __Pyx_GetBuffer(obj, &self.view, flags)
  *             if <PyObject *> self.view.obj == NULL:
  *                 (<__pyx_buffer *> &self.view).obj = Py_None             # <<<<<<<<<<<<<<
  *                 Py_INCREF(Py_None)
  * 
  */
       ((Py_buffer *)(&__pyx_v_self->view))->obj = Py_None;
 
-      /* "View.MemoryView":352
+      /* "View.MemoryView":353
  *             if <PyObject *> self.view.obj == NULL:
  *                 (<__pyx_buffer *> &self.view).obj = Py_None
  *                 Py_INCREF(Py_None)             # <<<<<<<<<<<<<<
  * 
- *         global __pyx_memoryview_thread_locks_used
+ *         if not __PYX_CYTHON_ATOMICS_ENABLED():
  */
       Py_INCREF(Py_None);
 
-      /* "View.MemoryView":350
+      /* "View.MemoryView":351
  *         if type(self) is memoryview or obj is not None:
  *             __Pyx_GetBuffer(obj, &self.view, flags)
  *             if <PyObject *> self.view.obj == NULL:             # <<<<<<<<<<<<<<
  *                 (<__pyx_buffer *> &self.view).obj = Py_None
  *                 Py_INCREF(Py_None)
  */
     }
 
-    /* "View.MemoryView":348
+    /* "View.MemoryView":349
  *         self.obj = obj
  *         self.flags = flags
  *         if type(self) is memoryview or obj is not None:             # <<<<<<<<<<<<<<
  *             __Pyx_GetBuffer(obj, &self.view, flags)
  *             if <PyObject *> self.view.obj == NULL:
  */
   }
 
   /* "View.MemoryView":355
+ *                 Py_INCREF(Py_None)
  * 
- *         global __pyx_memoryview_thread_locks_used
- *         if __pyx_memoryview_thread_locks_used < THREAD_LOCKS_PREALLOCATED:             # <<<<<<<<<<<<<<
- *             self.lock = __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]
- *             __pyx_memoryview_thread_locks_used += 1
+ *         if not __PYX_CYTHON_ATOMICS_ENABLED():             # <<<<<<<<<<<<<<
+ *             global __pyx_memoryview_thread_locks_used
+ *             if __pyx_memoryview_thread_locks_used < THREAD_LOCKS_PREALLOCATED:
  */
-  __pyx_t_1 = ((__pyx_memoryview_thread_locks_used < 8) != 0);
+  __pyx_t_1 = ((!(__PYX_CYTHON_ATOMICS_ENABLED() != 0)) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":356
- *         global __pyx_memoryview_thread_locks_used
- *         if __pyx_memoryview_thread_locks_used < THREAD_LOCKS_PREALLOCATED:
- *             self.lock = __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]             # <<<<<<<<<<<<<<
- *             __pyx_memoryview_thread_locks_used += 1
- *         if self.lock is NULL:
- */
-    __pyx_v_self->lock = (__pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]);
-
     /* "View.MemoryView":357
- *         if __pyx_memoryview_thread_locks_used < THREAD_LOCKS_PREALLOCATED:
- *             self.lock = __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]
- *             __pyx_memoryview_thread_locks_used += 1             # <<<<<<<<<<<<<<
- *         if self.lock is NULL:
- *             self.lock = PyThread_allocate_lock()
+ *         if not __PYX_CYTHON_ATOMICS_ENABLED():
+ *             global __pyx_memoryview_thread_locks_used
+ *             if __pyx_memoryview_thread_locks_used < THREAD_LOCKS_PREALLOCATED:             # <<<<<<<<<<<<<<
+ *                 self.lock = __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]
+ *                 __pyx_memoryview_thread_locks_used += 1
  */
-    __pyx_memoryview_thread_locks_used = (__pyx_memoryview_thread_locks_used + 1);
+    __pyx_t_1 = ((__pyx_memoryview_thread_locks_used < 8) != 0);
+    if (__pyx_t_1) {
 
-    /* "View.MemoryView":355
- * 
- *         global __pyx_memoryview_thread_locks_used
- *         if __pyx_memoryview_thread_locks_used < THREAD_LOCKS_PREALLOCATED:             # <<<<<<<<<<<<<<
- *             self.lock = __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]
- *             __pyx_memoryview_thread_locks_used += 1
+      /* "View.MemoryView":358
+ *             global __pyx_memoryview_thread_locks_used
+ *             if __pyx_memoryview_thread_locks_used < THREAD_LOCKS_PREALLOCATED:
+ *                 self.lock = __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]             # <<<<<<<<<<<<<<
+ *                 __pyx_memoryview_thread_locks_used += 1
+ *             if self.lock is NULL:
  */
-  }
+      __pyx_v_self->lock = (__pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]);
 
-  /* "View.MemoryView":358
- *             self.lock = __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]
- *             __pyx_memoryview_thread_locks_used += 1
- *         if self.lock is NULL:             # <<<<<<<<<<<<<<
- *             self.lock = PyThread_allocate_lock()
+      /* "View.MemoryView":359
+ *             if __pyx_memoryview_thread_locks_used < THREAD_LOCKS_PREALLOCATED:
+ *                 self.lock = __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]
+ *                 __pyx_memoryview_thread_locks_used += 1             # <<<<<<<<<<<<<<
  *             if self.lock is NULL:
+ *                 self.lock = PyThread_allocate_lock()
  */
-  __pyx_t_1 = ((__pyx_v_self->lock == NULL) != 0);
-  if (__pyx_t_1) {
+      __pyx_memoryview_thread_locks_used = (__pyx_memoryview_thread_locks_used + 1);
 
-    /* "View.MemoryView":359
- *             __pyx_memoryview_thread_locks_used += 1
- *         if self.lock is NULL:
- *             self.lock = PyThread_allocate_lock()             # <<<<<<<<<<<<<<
- *             if self.lock is NULL:
- *                 raise MemoryError
+      /* "View.MemoryView":357
+ *         if not __PYX_CYTHON_ATOMICS_ENABLED():
+ *             global __pyx_memoryview_thread_locks_used
+ *             if __pyx_memoryview_thread_locks_used < THREAD_LOCKS_PREALLOCATED:             # <<<<<<<<<<<<<<
+ *                 self.lock = __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]
+ *                 __pyx_memoryview_thread_locks_used += 1
  */
-    __pyx_v_self->lock = PyThread_allocate_lock();
+    }
 
     /* "View.MemoryView":360
- *         if self.lock is NULL:
- *             self.lock = PyThread_allocate_lock()
+ *                 self.lock = __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]
+ *                 __pyx_memoryview_thread_locks_used += 1
  *             if self.lock is NULL:             # <<<<<<<<<<<<<<
- *                 raise MemoryError
- * 
+ *                 self.lock = PyThread_allocate_lock()
+ *                 if self.lock is NULL:
  */
     __pyx_t_1 = ((__pyx_v_self->lock == NULL) != 0);
-    if (unlikely(__pyx_t_1)) {
+    if (__pyx_t_1) {
 
       /* "View.MemoryView":361
- *             self.lock = PyThread_allocate_lock()
+ *                 __pyx_memoryview_thread_locks_used += 1
  *             if self.lock is NULL:
- *                 raise MemoryError             # <<<<<<<<<<<<<<
+ *                 self.lock = PyThread_allocate_lock()             # <<<<<<<<<<<<<<
+ *                 if self.lock is NULL:
+ *                     raise MemoryError
+ */
+      __pyx_v_self->lock = PyThread_allocate_lock();
+
+      /* "View.MemoryView":362
+ *             if self.lock is NULL:
+ *                 self.lock = PyThread_allocate_lock()
+ *                 if self.lock is NULL:             # <<<<<<<<<<<<<<
+ *                     raise MemoryError
+ * 
+ */
+      __pyx_t_1 = ((__pyx_v_self->lock == NULL) != 0);
+      if (unlikely(__pyx_t_1)) {
+
+        /* "View.MemoryView":363
+ *                 self.lock = PyThread_allocate_lock()
+ *                 if self.lock is NULL:
+ *                     raise MemoryError             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_FORMAT:
  */
-      PyErr_NoMemory(); __PYX_ERR(1, 361, __pyx_L1_error)
+        PyErr_NoMemory(); __PYX_ERR(1, 363, __pyx_L1_error)
+
+        /* "View.MemoryView":362
+ *             if self.lock is NULL:
+ *                 self.lock = PyThread_allocate_lock()
+ *                 if self.lock is NULL:             # <<<<<<<<<<<<<<
+ *                     raise MemoryError
+ * 
+ */
+      }
 
       /* "View.MemoryView":360
- *         if self.lock is NULL:
- *             self.lock = PyThread_allocate_lock()
+ *                 self.lock = __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]
+ *                 __pyx_memoryview_thread_locks_used += 1
  *             if self.lock is NULL:             # <<<<<<<<<<<<<<
- *                 raise MemoryError
- * 
+ *                 self.lock = PyThread_allocate_lock()
+ *                 if self.lock is NULL:
  */
     }
 
-    /* "View.MemoryView":358
- *             self.lock = __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]
- *             __pyx_memoryview_thread_locks_used += 1
- *         if self.lock is NULL:             # <<<<<<<<<<<<<<
- *             self.lock = PyThread_allocate_lock()
- *             if self.lock is NULL:
+    /* "View.MemoryView":355
+ *                 Py_INCREF(Py_None)
+ * 
+ *         if not __PYX_CYTHON_ATOMICS_ENABLED():             # <<<<<<<<<<<<<<
+ *             global __pyx_memoryview_thread_locks_used
+ *             if __pyx_memoryview_thread_locks_used < THREAD_LOCKS_PREALLOCATED:
  */
   }
 
-  /* "View.MemoryView":363
- *                 raise MemoryError
+  /* "View.MemoryView":365
+ *                     raise MemoryError
  * 
  *         if flags & PyBUF_FORMAT:             # <<<<<<<<<<<<<<
  *             self.dtype_is_object = (self.view.format[0] == b'O' and self.view.format[1] == b'\0')
  *         else:
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_FORMAT) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":364
+    /* "View.MemoryView":366
  * 
  *         if flags & PyBUF_FORMAT:
  *             self.dtype_is_object = (self.view.format[0] == b'O' and self.view.format[1] == b'\0')             # <<<<<<<<<<<<<<
  *         else:
  *             self.dtype_is_object = dtype_is_object
  */
     __pyx_t_2 = (((__pyx_v_self->view.format[0]) == 'O') != 0);
     if (__pyx_t_2) {
     } else {
       __pyx_t_1 = __pyx_t_2;
-      goto __pyx_L11_bool_binop_done;
+      goto __pyx_L12_bool_binop_done;
     }
     __pyx_t_2 = (((__pyx_v_self->view.format[1]) == '\x00') != 0);
     __pyx_t_1 = __pyx_t_2;
-    __pyx_L11_bool_binop_done:;
+    __pyx_L12_bool_binop_done:;
     __pyx_v_self->dtype_is_object = __pyx_t_1;
 
-    /* "View.MemoryView":363
- *                 raise MemoryError
+    /* "View.MemoryView":365
+ *                     raise MemoryError
  * 
  *         if flags & PyBUF_FORMAT:             # <<<<<<<<<<<<<<
  *             self.dtype_is_object = (self.view.format[0] == b'O' and self.view.format[1] == b'\0')
  *         else:
  */
-    goto __pyx_L10;
+    goto __pyx_L11;
   }
 
-  /* "View.MemoryView":366
+  /* "View.MemoryView":368
  *             self.dtype_is_object = (self.view.format[0] == b'O' and self.view.format[1] == b'\0')
  *         else:
  *             self.dtype_is_object = dtype_is_object             # <<<<<<<<<<<<<<
  * 
  *         self.acquisition_count_aligned_p = <__pyx_atomic_int *> align_pointer(
  */
   /*else*/ {
     __pyx_v_self->dtype_is_object = __pyx_v_dtype_is_object;
   }
-  __pyx_L10:;
+  __pyx_L11:;
 
-  /* "View.MemoryView":368
+  /* "View.MemoryView":370
  *             self.dtype_is_object = dtype_is_object
  * 
  *         self.acquisition_count_aligned_p = <__pyx_atomic_int *> align_pointer(             # <<<<<<<<<<<<<<
  *                   <void *> &self.acquisition_count[0], sizeof(__pyx_atomic_int))
  *         self.typeinfo = NULL
  */
   __pyx_v_self->acquisition_count_aligned_p = ((__pyx_atomic_int *)__pyx_align_pointer(((void *)(&(__pyx_v_self->acquisition_count[0]))), (sizeof(__pyx_atomic_int))));
 
-  /* "View.MemoryView":370
+  /* "View.MemoryView":372
  *         self.acquisition_count_aligned_p = <__pyx_atomic_int *> align_pointer(
  *                   <void *> &self.acquisition_count[0], sizeof(__pyx_atomic_int))
  *         self.typeinfo = NULL             # <<<<<<<<<<<<<<
  * 
  *     def __dealloc__(memoryview self):
  */
   __pyx_v_self->typeinfo = NULL;
 
-  /* "View.MemoryView":345
+  /* "View.MemoryView":346
  *     cdef __Pyx_TypeInfo *typeinfo
  * 
  *     def __cinit__(memoryview self, object obj, int flags, bint dtype_is_object=False):             # <<<<<<<<<<<<<<
  *         self.obj = obj
  *         self.flags = flags
  */
 
@@ -31741,15 +32015,15 @@
   __Pyx_AddTraceback("View.MemoryView.memoryview.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":372
+/* "View.MemoryView":374
  *         self.typeinfo = NULL
  * 
  *     def __dealloc__(memoryview self):             # <<<<<<<<<<<<<<
  *         if self.obj is not None:
  *             __Pyx_ReleaseBuffer(&self.view)
  */
 
@@ -31772,215 +32046,215 @@
   int __pyx_t_3;
   int __pyx_t_4;
   int __pyx_t_5;
   PyThread_type_lock __pyx_t_6;
   PyThread_type_lock __pyx_t_7;
   __Pyx_RefNannySetupContext("__dealloc__", 0);
 
-  /* "View.MemoryView":373
+  /* "View.MemoryView":375
  * 
  *     def __dealloc__(memoryview self):
  *         if self.obj is not None:             # <<<<<<<<<<<<<<
  *             __Pyx_ReleaseBuffer(&self.view)
  *         elif (<__pyx_buffer *> &self.view).obj == Py_None:
  */
   __pyx_t_1 = (__pyx_v_self->obj != Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":374
+    /* "View.MemoryView":376
  *     def __dealloc__(memoryview self):
  *         if self.obj is not None:
  *             __Pyx_ReleaseBuffer(&self.view)             # <<<<<<<<<<<<<<
  *         elif (<__pyx_buffer *> &self.view).obj == Py_None:
  * 
  */
     __Pyx_ReleaseBuffer((&__pyx_v_self->view));
 
-    /* "View.MemoryView":373
+    /* "View.MemoryView":375
  * 
  *     def __dealloc__(memoryview self):
  *         if self.obj is not None:             # <<<<<<<<<<<<<<
  *             __Pyx_ReleaseBuffer(&self.view)
  *         elif (<__pyx_buffer *> &self.view).obj == Py_None:
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":375
+  /* "View.MemoryView":377
  *         if self.obj is not None:
  *             __Pyx_ReleaseBuffer(&self.view)
  *         elif (<__pyx_buffer *> &self.view).obj == Py_None:             # <<<<<<<<<<<<<<
  * 
  *             (<__pyx_buffer *> &self.view).obj = NULL
  */
   __pyx_t_2 = ((((Py_buffer *)(&__pyx_v_self->view))->obj == Py_None) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":377
+    /* "View.MemoryView":379
  *         elif (<__pyx_buffer *> &self.view).obj == Py_None:
  * 
  *             (<__pyx_buffer *> &self.view).obj = NULL             # <<<<<<<<<<<<<<
  *             Py_DECREF(Py_None)
  * 
  */
     ((Py_buffer *)(&__pyx_v_self->view))->obj = NULL;
 
-    /* "View.MemoryView":378
+    /* "View.MemoryView":380
  * 
  *             (<__pyx_buffer *> &self.view).obj = NULL
  *             Py_DECREF(Py_None)             # <<<<<<<<<<<<<<
  * 
  *         cdef int i
  */
     Py_DECREF(Py_None);
 
-    /* "View.MemoryView":375
+    /* "View.MemoryView":377
  *         if self.obj is not None:
  *             __Pyx_ReleaseBuffer(&self.view)
  *         elif (<__pyx_buffer *> &self.view).obj == Py_None:             # <<<<<<<<<<<<<<
  * 
  *             (<__pyx_buffer *> &self.view).obj = NULL
  */
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":382
+  /* "View.MemoryView":384
  *         cdef int i
  *         global __pyx_memoryview_thread_locks_used
  *         if self.lock != NULL:             # <<<<<<<<<<<<<<
  *             for i in range(__pyx_memoryview_thread_locks_used):
  *                 if __pyx_memoryview_thread_locks[i] is self.lock:
  */
   __pyx_t_2 = ((__pyx_v_self->lock != NULL) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":383
+    /* "View.MemoryView":385
  *         global __pyx_memoryview_thread_locks_used
  *         if self.lock != NULL:
  *             for i in range(__pyx_memoryview_thread_locks_used):             # <<<<<<<<<<<<<<
  *                 if __pyx_memoryview_thread_locks[i] is self.lock:
  *                     __pyx_memoryview_thread_locks_used -= 1
  */
     __pyx_t_3 = __pyx_memoryview_thread_locks_used;
     __pyx_t_4 = __pyx_t_3;
     for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
       __pyx_v_i = __pyx_t_5;
 
-      /* "View.MemoryView":384
+      /* "View.MemoryView":386
  *         if self.lock != NULL:
  *             for i in range(__pyx_memoryview_thread_locks_used):
  *                 if __pyx_memoryview_thread_locks[i] is self.lock:             # <<<<<<<<<<<<<<
  *                     __pyx_memoryview_thread_locks_used -= 1
  *                     if i != __pyx_memoryview_thread_locks_used:
  */
       __pyx_t_2 = (((__pyx_memoryview_thread_locks[__pyx_v_i]) == __pyx_v_self->lock) != 0);
       if (__pyx_t_2) {
 
-        /* "View.MemoryView":385
+        /* "View.MemoryView":387
  *             for i in range(__pyx_memoryview_thread_locks_used):
  *                 if __pyx_memoryview_thread_locks[i] is self.lock:
  *                     __pyx_memoryview_thread_locks_used -= 1             # <<<<<<<<<<<<<<
  *                     if i != __pyx_memoryview_thread_locks_used:
  *                         __pyx_memoryview_thread_locks[i], __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used] = (
  */
         __pyx_memoryview_thread_locks_used = (__pyx_memoryview_thread_locks_used - 1);
 
-        /* "View.MemoryView":386
+        /* "View.MemoryView":388
  *                 if __pyx_memoryview_thread_locks[i] is self.lock:
  *                     __pyx_memoryview_thread_locks_used -= 1
  *                     if i != __pyx_memoryview_thread_locks_used:             # <<<<<<<<<<<<<<
  *                         __pyx_memoryview_thread_locks[i], __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used] = (
  *                             __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used], __pyx_memoryview_thread_locks[i])
  */
         __pyx_t_2 = ((__pyx_v_i != __pyx_memoryview_thread_locks_used) != 0);
         if (__pyx_t_2) {
 
-          /* "View.MemoryView":388
+          /* "View.MemoryView":390
  *                     if i != __pyx_memoryview_thread_locks_used:
  *                         __pyx_memoryview_thread_locks[i], __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used] = (
  *                             __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used], __pyx_memoryview_thread_locks[i])             # <<<<<<<<<<<<<<
  *                     break
  *             else:
  */
           __pyx_t_6 = (__pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]);
           __pyx_t_7 = (__pyx_memoryview_thread_locks[__pyx_v_i]);
 
-          /* "View.MemoryView":387
+          /* "View.MemoryView":389
  *                     __pyx_memoryview_thread_locks_used -= 1
  *                     if i != __pyx_memoryview_thread_locks_used:
  *                         __pyx_memoryview_thread_locks[i], __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used] = (             # <<<<<<<<<<<<<<
  *                             __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used], __pyx_memoryview_thread_locks[i])
  *                     break
  */
           (__pyx_memoryview_thread_locks[__pyx_v_i]) = __pyx_t_6;
           (__pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used]) = __pyx_t_7;
 
-          /* "View.MemoryView":386
+          /* "View.MemoryView":388
  *                 if __pyx_memoryview_thread_locks[i] is self.lock:
  *                     __pyx_memoryview_thread_locks_used -= 1
  *                     if i != __pyx_memoryview_thread_locks_used:             # <<<<<<<<<<<<<<
  *                         __pyx_memoryview_thread_locks[i], __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used] = (
  *                             __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used], __pyx_memoryview_thread_locks[i])
  */
         }
 
-        /* "View.MemoryView":389
+        /* "View.MemoryView":391
  *                         __pyx_memoryview_thread_locks[i], __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used] = (
  *                             __pyx_memoryview_thread_locks[__pyx_memoryview_thread_locks_used], __pyx_memoryview_thread_locks[i])
  *                     break             # <<<<<<<<<<<<<<
  *             else:
  *                 PyThread_free_lock(self.lock)
  */
         goto __pyx_L6_break;
 
-        /* "View.MemoryView":384
+        /* "View.MemoryView":386
  *         if self.lock != NULL:
  *             for i in range(__pyx_memoryview_thread_locks_used):
  *                 if __pyx_memoryview_thread_locks[i] is self.lock:             # <<<<<<<<<<<<<<
  *                     __pyx_memoryview_thread_locks_used -= 1
  *                     if i != __pyx_memoryview_thread_locks_used:
  */
       }
     }
     /*else*/ {
 
-      /* "View.MemoryView":391
+      /* "View.MemoryView":393
  *                     break
  *             else:
  *                 PyThread_free_lock(self.lock)             # <<<<<<<<<<<<<<
  * 
  *     cdef char *get_item_pointer(memoryview self, object index) except NULL:
  */
       PyThread_free_lock(__pyx_v_self->lock);
     }
     __pyx_L6_break:;
 
-    /* "View.MemoryView":382
+    /* "View.MemoryView":384
  *         cdef int i
  *         global __pyx_memoryview_thread_locks_used
  *         if self.lock != NULL:             # <<<<<<<<<<<<<<
  *             for i in range(__pyx_memoryview_thread_locks_used):
  *                 if __pyx_memoryview_thread_locks[i] is self.lock:
  */
   }
 
-  /* "View.MemoryView":372
+  /* "View.MemoryView":374
  *         self.typeinfo = NULL
  * 
  *     def __dealloc__(memoryview self):             # <<<<<<<<<<<<<<
  *         if self.obj is not None:
  *             __Pyx_ReleaseBuffer(&self.view)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "View.MemoryView":393
+/* "View.MemoryView":395
  *                 PyThread_free_lock(self.lock)
  * 
  *     cdef char *get_item_pointer(memoryview self, object index) except NULL:             # <<<<<<<<<<<<<<
  *         cdef Py_ssize_t dim
  *         cdef char *itemp = <char *> self.view.buf
  */
 
@@ -31993,109 +32267,112 @@
   Py_ssize_t __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   Py_ssize_t __pyx_t_3;
   PyObject *(*__pyx_t_4)(PyObject *);
   PyObject *__pyx_t_5 = NULL;
   Py_ssize_t __pyx_t_6;
   char *__pyx_t_7;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_item_pointer", 0);
 
-  /* "View.MemoryView":395
+  /* "View.MemoryView":397
  *     cdef char *get_item_pointer(memoryview self, object index) except NULL:
  *         cdef Py_ssize_t dim
  *         cdef char *itemp = <char *> self.view.buf             # <<<<<<<<<<<<<<
  * 
  *         for dim, idx in enumerate(index):
  */
   __pyx_v_itemp = ((char *)__pyx_v_self->view.buf);
 
-  /* "View.MemoryView":397
+  /* "View.MemoryView":399
  *         cdef char *itemp = <char *> self.view.buf
  * 
  *         for dim, idx in enumerate(index):             # <<<<<<<<<<<<<<
  *             itemp = pybuffer_index(&self.view, itemp, idx, dim)
  * 
  */
   __pyx_t_1 = 0;
   if (likely(PyList_CheckExact(__pyx_v_index)) || PyTuple_CheckExact(__pyx_v_index)) {
     __pyx_t_2 = __pyx_v_index; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_index); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 397, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_index); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 399, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 397, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 399, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(1, 397, __pyx_L1_error)
+        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(1, 399, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 397, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 399, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(1, 397, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(1, 399, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 397, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 399, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       }
     } else {
       __pyx_t_5 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_5)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(1, 397, __pyx_L1_error)
+          else __PYX_ERR(1, 399, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_5);
     }
     __Pyx_XDECREF_SET(__pyx_v_idx, __pyx_t_5);
     __pyx_t_5 = 0;
     __pyx_v_dim = __pyx_t_1;
     __pyx_t_1 = (__pyx_t_1 + 1);
 
-    /* "View.MemoryView":398
+    /* "View.MemoryView":400
  * 
  *         for dim, idx in enumerate(index):
  *             itemp = pybuffer_index(&self.view, itemp, idx, dim)             # <<<<<<<<<<<<<<
  * 
  *         return itemp
  */
-    __pyx_t_6 = __Pyx_PyIndex_AsSsize_t(__pyx_v_idx); if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 398, __pyx_L1_error)
-    __pyx_t_7 = __pyx_pybuffer_index((&__pyx_v_self->view), __pyx_v_itemp, __pyx_t_6, __pyx_v_dim); if (unlikely(__pyx_t_7 == ((char *)NULL))) __PYX_ERR(1, 398, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyIndex_AsSsize_t(__pyx_v_idx); if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 400, __pyx_L1_error)
+    __pyx_t_7 = __pyx_pybuffer_index((&__pyx_v_self->view), __pyx_v_itemp, __pyx_t_6, __pyx_v_dim); if (unlikely(__pyx_t_7 == ((char *)NULL))) __PYX_ERR(1, 400, __pyx_L1_error)
     __pyx_v_itemp = __pyx_t_7;
 
-    /* "View.MemoryView":397
+    /* "View.MemoryView":399
  *         cdef char *itemp = <char *> self.view.buf
  * 
  *         for dim, idx in enumerate(index):             # <<<<<<<<<<<<<<
  *             itemp = pybuffer_index(&self.view, itemp, idx, dim)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "View.MemoryView":400
+  /* "View.MemoryView":402
  *             itemp = pybuffer_index(&self.view, itemp, idx, dim)
  * 
  *         return itemp             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = __pyx_v_itemp;
   goto __pyx_L0;
 
-  /* "View.MemoryView":393
+  /* "View.MemoryView":395
  *                 PyThread_free_lock(self.lock)
  * 
  *     cdef char *get_item_pointer(memoryview self, object index) except NULL:             # <<<<<<<<<<<<<<
  *         cdef Py_ssize_t dim
  *         cdef char *itemp = <char *> self.view.buf
  */
 
@@ -32107,15 +32384,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_idx);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":403
+/* "View.MemoryView":405
  * 
  * 
  *     def __getitem__(memoryview self, object index):             # <<<<<<<<<<<<<<
  *         if index is Ellipsis:
  *             return self
  */
 
@@ -32140,145 +32417,148 @@
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   char *__pyx_t_6;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__getitem__", 0);
 
-  /* "View.MemoryView":404
+  /* "View.MemoryView":406
  * 
  *     def __getitem__(memoryview self, object index):
  *         if index is Ellipsis:             # <<<<<<<<<<<<<<
  *             return self
  * 
  */
   __pyx_t_1 = (__pyx_v_index == __pyx_builtin_Ellipsis);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":405
+    /* "View.MemoryView":407
  *     def __getitem__(memoryview self, object index):
  *         if index is Ellipsis:
  *             return self             # <<<<<<<<<<<<<<
  * 
  *         have_slices, indices = _unellipsify(index, self.view.ndim)
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_self));
     __pyx_r = ((PyObject *)__pyx_v_self);
     goto __pyx_L0;
 
-    /* "View.MemoryView":404
+    /* "View.MemoryView":406
  * 
  *     def __getitem__(memoryview self, object index):
  *         if index is Ellipsis:             # <<<<<<<<<<<<<<
  *             return self
  * 
  */
   }
 
-  /* "View.MemoryView":407
+  /* "View.MemoryView":409
  *             return self
  * 
  *         have_slices, indices = _unellipsify(index, self.view.ndim)             # <<<<<<<<<<<<<<
  * 
  *         cdef char *itemp
  */
-  __pyx_t_3 = _unellipsify(__pyx_v_index, __pyx_v_self->view.ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 407, __pyx_L1_error)
+  __pyx_t_3 = _unellipsify(__pyx_v_index, __pyx_v_self->view.ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 409, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   if (likely(__pyx_t_3 != Py_None)) {
     PyObject* sequence = __pyx_t_3;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 2)) {
       if (size > 2) __Pyx_RaiseTooManyValuesError(2);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(1, 407, __pyx_L1_error)
+      __PYX_ERR(1, 409, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     __pyx_t_4 = PyTuple_GET_ITEM(sequence, 0); 
     __pyx_t_5 = PyTuple_GET_ITEM(sequence, 1); 
     __Pyx_INCREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_t_5);
     #else
-    __pyx_t_4 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 407, __pyx_L1_error)
+    __pyx_t_4 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 409, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 407, __pyx_L1_error)
+    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 409, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     #endif
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } else {
-    __Pyx_RaiseNoneNotIterableError(); __PYX_ERR(1, 407, __pyx_L1_error)
+    __Pyx_RaiseNoneNotIterableError(); __PYX_ERR(1, 409, __pyx_L1_error)
   }
   __pyx_v_have_slices = __pyx_t_4;
   __pyx_t_4 = 0;
   __pyx_v_indices = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "View.MemoryView":410
+  /* "View.MemoryView":412
  * 
  *         cdef char *itemp
  *         if have_slices:             # <<<<<<<<<<<<<<
  *             return memview_slice(self, indices)
  *         else:
  */
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_have_slices); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(1, 410, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_have_slices); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(1, 412, __pyx_L1_error)
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":411
+    /* "View.MemoryView":413
  *         cdef char *itemp
  *         if have_slices:
  *             return memview_slice(self, indices)             # <<<<<<<<<<<<<<
  *         else:
  *             itemp = self.get_item_pointer(indices)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = ((PyObject *)__pyx_memview_slice(__pyx_v_self, __pyx_v_indices)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 411, __pyx_L1_error)
+    __pyx_t_3 = ((PyObject *)__pyx_memview_slice(__pyx_v_self, __pyx_v_indices)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "View.MemoryView":410
+    /* "View.MemoryView":412
  * 
  *         cdef char *itemp
  *         if have_slices:             # <<<<<<<<<<<<<<
  *             return memview_slice(self, indices)
  *         else:
  */
   }
 
-  /* "View.MemoryView":413
+  /* "View.MemoryView":415
  *             return memview_slice(self, indices)
  *         else:
  *             itemp = self.get_item_pointer(indices)             # <<<<<<<<<<<<<<
  *             return self.convert_item_to_object(itemp)
  * 
  */
   /*else*/ {
-    __pyx_t_6 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->get_item_pointer(__pyx_v_self, __pyx_v_indices); if (unlikely(__pyx_t_6 == ((char *)NULL))) __PYX_ERR(1, 413, __pyx_L1_error)
+    __pyx_t_6 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->get_item_pointer(__pyx_v_self, __pyx_v_indices); if (unlikely(__pyx_t_6 == ((char *)NULL))) __PYX_ERR(1, 415, __pyx_L1_error)
     __pyx_v_itemp = __pyx_t_6;
 
-    /* "View.MemoryView":414
+    /* "View.MemoryView":416
  *         else:
  *             itemp = self.get_item_pointer(indices)
  *             return self.convert_item_to_object(itemp)             # <<<<<<<<<<<<<<
  * 
  *     def __setitem__(memoryview self, object index, object value):
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->convert_item_to_object(__pyx_v_self, __pyx_v_itemp); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 414, __pyx_L1_error)
+    __pyx_t_3 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->convert_item_to_object(__pyx_v_self, __pyx_v_itemp); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
   }
 
-  /* "View.MemoryView":403
+  /* "View.MemoryView":405
  * 
  * 
  *     def __getitem__(memoryview self, object index):             # <<<<<<<<<<<<<<
  *         if index is Ellipsis:
  *             return self
  */
 
@@ -32293,15 +32573,15 @@
   __Pyx_XDECREF(__pyx_v_have_slices);
   __Pyx_XDECREF(__pyx_v_indices);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":416
+/* "View.MemoryView":418
  *             return self.convert_item_to_object(itemp)
  * 
  *     def __setitem__(memoryview self, object index, object value):             # <<<<<<<<<<<<<<
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")
  */
 
@@ -32323,185 +32603,188 @@
   PyObject *__pyx_v_obj = NULL;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__setitem__", 0);
   __Pyx_INCREF(__pyx_v_index);
 
-  /* "View.MemoryView":417
+  /* "View.MemoryView":419
  * 
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:             # <<<<<<<<<<<<<<
  *             raise TypeError("Cannot assign to read-only memoryview")
  * 
  */
   __pyx_t_1 = (__pyx_v_self->view.readonly != 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "View.MemoryView":418
+    /* "View.MemoryView":420
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 418, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 420, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(1, 418, __pyx_L1_error)
+    __PYX_ERR(1, 420, __pyx_L1_error)
 
-    /* "View.MemoryView":417
+    /* "View.MemoryView":419
  * 
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:             # <<<<<<<<<<<<<<
  *             raise TypeError("Cannot assign to read-only memoryview")
  * 
  */
   }
 
-  /* "View.MemoryView":420
+  /* "View.MemoryView":422
  *             raise TypeError("Cannot assign to read-only memoryview")
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)             # <<<<<<<<<<<<<<
  * 
  *         if have_slices:
  */
-  __pyx_t_2 = _unellipsify(__pyx_v_index, __pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 420, __pyx_L1_error)
+  __pyx_t_2 = _unellipsify(__pyx_v_index, __pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (likely(__pyx_t_2 != Py_None)) {
     PyObject* sequence = __pyx_t_2;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 2)) {
       if (size > 2) __Pyx_RaiseTooManyValuesError(2);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(1, 420, __pyx_L1_error)
+      __PYX_ERR(1, 422, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
     __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
     __Pyx_INCREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_t_4);
     #else
-    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 420, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 422, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 420, __pyx_L1_error)
+    __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 422, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     #endif
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else {
-    __Pyx_RaiseNoneNotIterableError(); __PYX_ERR(1, 420, __pyx_L1_error)
+    __Pyx_RaiseNoneNotIterableError(); __PYX_ERR(1, 422, __pyx_L1_error)
   }
   __pyx_v_have_slices = __pyx_t_3;
   __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_index, __pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "View.MemoryView":422
+  /* "View.MemoryView":424
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  * 
  *         if have_slices:             # <<<<<<<<<<<<<<
  *             obj = self.is_slice(value)
  *             if obj:
  */
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_have_slices); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 422, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_have_slices); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 424, __pyx_L1_error)
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":423
+    /* "View.MemoryView":425
  * 
  *         if have_slices:
  *             obj = self.is_slice(value)             # <<<<<<<<<<<<<<
  *             if obj:
  *                 self.setitem_slice_assignment(self[index], obj)
  */
-    __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->is_slice(__pyx_v_self, __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 423, __pyx_L1_error)
+    __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->is_slice(__pyx_v_self, __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 425, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_obj = __pyx_t_2;
     __pyx_t_2 = 0;
 
-    /* "View.MemoryView":424
+    /* "View.MemoryView":426
  *         if have_slices:
  *             obj = self.is_slice(value)
  *             if obj:             # <<<<<<<<<<<<<<
  *                 self.setitem_slice_assignment(self[index], obj)
  *             else:
  */
-    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_obj); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 424, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_obj); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 426, __pyx_L1_error)
     if (__pyx_t_1) {
 
-      /* "View.MemoryView":425
+      /* "View.MemoryView":427
  *             obj = self.is_slice(value)
  *             if obj:
  *                 self.setitem_slice_assignment(self[index], obj)             # <<<<<<<<<<<<<<
  *             else:
  *                 self.setitem_slice_assign_scalar(self[index], value)
  */
-      __pyx_t_2 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_self), __pyx_v_index); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 425, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_self), __pyx_v_index); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 427, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->setitem_slice_assignment(__pyx_v_self, __pyx_t_2, __pyx_v_obj); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 425, __pyx_L1_error)
+      __pyx_t_4 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->setitem_slice_assignment(__pyx_v_self, __pyx_t_2, __pyx_v_obj); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 427, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "View.MemoryView":424
+      /* "View.MemoryView":426
  *         if have_slices:
  *             obj = self.is_slice(value)
  *             if obj:             # <<<<<<<<<<<<<<
  *                 self.setitem_slice_assignment(self[index], obj)
  *             else:
  */
       goto __pyx_L5;
     }
 
-    /* "View.MemoryView":427
+    /* "View.MemoryView":429
  *                 self.setitem_slice_assignment(self[index], obj)
  *             else:
  *                 self.setitem_slice_assign_scalar(self[index], value)             # <<<<<<<<<<<<<<
  *         else:
  *             self.setitem_indexed(index, value)
  */
     /*else*/ {
-      __pyx_t_4 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_self), __pyx_v_index); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 427, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_self), __pyx_v_index); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 429, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_memoryview_type))))) __PYX_ERR(1, 427, __pyx_L1_error)
-      __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->setitem_slice_assign_scalar(__pyx_v_self, ((struct __pyx_memoryview_obj *)__pyx_t_4), __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 427, __pyx_L1_error)
+      if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_memoryview_type))))) __PYX_ERR(1, 429, __pyx_L1_error)
+      __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->setitem_slice_assign_scalar(__pyx_v_self, ((struct __pyx_memoryview_obj *)__pyx_t_4), __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 429, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __pyx_L5:;
 
-    /* "View.MemoryView":422
+    /* "View.MemoryView":424
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  * 
  *         if have_slices:             # <<<<<<<<<<<<<<
  *             obj = self.is_slice(value)
  *             if obj:
  */
     goto __pyx_L4;
   }
 
-  /* "View.MemoryView":429
+  /* "View.MemoryView":431
  *                 self.setitem_slice_assign_scalar(self[index], value)
  *         else:
  *             self.setitem_indexed(index, value)             # <<<<<<<<<<<<<<
  * 
  *     cdef is_slice(self, obj):
  */
   /*else*/ {
-    __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->setitem_indexed(__pyx_v_self, __pyx_v_index, __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 429, __pyx_L1_error)
+    __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->setitem_indexed(__pyx_v_self, __pyx_v_index, __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 431, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __pyx_L4:;
 
-  /* "View.MemoryView":416
+  /* "View.MemoryView":418
  *             return self.convert_item_to_object(itemp)
  * 
  *     def __setitem__(memoryview self, object index, object value):             # <<<<<<<<<<<<<<
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")
  */
 
@@ -32518,15 +32801,15 @@
   __Pyx_XDECREF(__pyx_v_have_slices);
   __Pyx_XDECREF(__pyx_v_obj);
   __Pyx_XDECREF(__pyx_v_index);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":431
+/* "View.MemoryView":433
  *             self.setitem_indexed(index, value)
  * 
  *     cdef is_slice(self, obj):             # <<<<<<<<<<<<<<
  *         if not isinstance(obj, memoryview):
  *             try:
  */
 
@@ -32538,29 +32821,32 @@
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_t_9;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_slice", 0);
   __Pyx_INCREF(__pyx_v_obj);
 
-  /* "View.MemoryView":432
+  /* "View.MemoryView":434
  * 
  *     cdef is_slice(self, obj):
  *         if not isinstance(obj, memoryview):             # <<<<<<<<<<<<<<
  *             try:
  *                 obj = memoryview(obj, self.flags & ~PyBUF_WRITABLE | PyBUF_ANY_CONTIGUOUS,
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_obj, __pyx_memoryview_type); 
   __pyx_t_2 = ((!(__pyx_t_1 != 0)) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":433
+    /* "View.MemoryView":435
  *     cdef is_slice(self, obj):
  *         if not isinstance(obj, memoryview):
  *             try:             # <<<<<<<<<<<<<<
  *                 obj = memoryview(obj, self.flags & ~PyBUF_WRITABLE | PyBUF_ANY_CONTIGUOUS,
  *                                  self.dtype_is_object)
  */
     {
@@ -32568,59 +32854,59 @@
       __Pyx_PyThreadState_assign
       __Pyx_ExceptionSave(&__pyx_t_3, &__pyx_t_4, &__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_3);
       __Pyx_XGOTREF(__pyx_t_4);
       __Pyx_XGOTREF(__pyx_t_5);
       /*try:*/ {
 
-        /* "View.MemoryView":434
+        /* "View.MemoryView":436
  *         if not isinstance(obj, memoryview):
  *             try:
  *                 obj = memoryview(obj, self.flags & ~PyBUF_WRITABLE | PyBUF_ANY_CONTIGUOUS,             # <<<<<<<<<<<<<<
  *                                  self.dtype_is_object)
  *             except TypeError:
  */
-        __pyx_t_6 = __Pyx_PyInt_From_int(((__pyx_v_self->flags & (~PyBUF_WRITABLE)) | PyBUF_ANY_CONTIGUOUS)); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 434, __pyx_L4_error)
+        __pyx_t_6 = __Pyx_PyInt_From_int(((__pyx_v_self->flags & (~PyBUF_WRITABLE)) | PyBUF_ANY_CONTIGUOUS)); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 436, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_6);
 
-        /* "View.MemoryView":435
+        /* "View.MemoryView":437
  *             try:
  *                 obj = memoryview(obj, self.flags & ~PyBUF_WRITABLE | PyBUF_ANY_CONTIGUOUS,
  *                                  self.dtype_is_object)             # <<<<<<<<<<<<<<
  *             except TypeError:
  *                 return None
  */
-        __pyx_t_7 = __Pyx_PyBool_FromLong(__pyx_v_self->dtype_is_object); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 435, __pyx_L4_error)
+        __pyx_t_7 = __Pyx_PyBool_FromLong(__pyx_v_self->dtype_is_object); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 437, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_7);
 
-        /* "View.MemoryView":434
+        /* "View.MemoryView":436
  *         if not isinstance(obj, memoryview):
  *             try:
  *                 obj = memoryview(obj, self.flags & ~PyBUF_WRITABLE | PyBUF_ANY_CONTIGUOUS,             # <<<<<<<<<<<<<<
  *                                  self.dtype_is_object)
  *             except TypeError:
  */
-        __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 434, __pyx_L4_error)
+        __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 436, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_INCREF(__pyx_v_obj);
         __Pyx_GIVEREF(__pyx_v_obj);
         PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_obj);
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_6);
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_8, 2, __pyx_t_7);
         __pyx_t_6 = 0;
         __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryview_type), __pyx_t_8, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 434, __pyx_L4_error)
+        __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryview_type), __pyx_t_8, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 436, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __Pyx_DECREF_SET(__pyx_v_obj, __pyx_t_7);
         __pyx_t_7 = 0;
 
-        /* "View.MemoryView":433
+        /* "View.MemoryView":435
  *     cdef is_slice(self, obj):
  *         if not isinstance(obj, memoryview):
  *             try:             # <<<<<<<<<<<<<<
  *                 obj = memoryview(obj, self.flags & ~PyBUF_WRITABLE | PyBUF_ANY_CONTIGUOUS,
  *                                  self.dtype_is_object)
  */
       }
@@ -32629,30 +32915,30 @@
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       goto __pyx_L9_try_end;
       __pyx_L4_error:;
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-      /* "View.MemoryView":436
+      /* "View.MemoryView":438
  *                 obj = memoryview(obj, self.flags & ~PyBUF_WRITABLE | PyBUF_ANY_CONTIGUOUS,
  *                                  self.dtype_is_object)
  *             except TypeError:             # <<<<<<<<<<<<<<
  *                 return None
  * 
  */
       __pyx_t_9 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_TypeError);
       if (__pyx_t_9) {
         __Pyx_AddTraceback("View.MemoryView.memoryview.is_slice", __pyx_clineno, __pyx_lineno, __pyx_filename);
-        if (__Pyx_GetException(&__pyx_t_7, &__pyx_t_8, &__pyx_t_6) < 0) __PYX_ERR(1, 436, __pyx_L6_except_error)
+        if (__Pyx_GetException(&__pyx_t_7, &__pyx_t_8, &__pyx_t_6) < 0) __PYX_ERR(1, 438, __pyx_L6_except_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_GOTREF(__pyx_t_6);
 
-        /* "View.MemoryView":437
+        /* "View.MemoryView":439
  *                                  self.dtype_is_object)
  *             except TypeError:
  *                 return None             # <<<<<<<<<<<<<<
  * 
  *         return obj
  */
         __Pyx_XDECREF(__pyx_r);
@@ -32661,15 +32947,15 @@
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         goto __pyx_L7_except_return;
       }
       goto __pyx_L6_except_error;
       __pyx_L6_except_error:;
 
-      /* "View.MemoryView":433
+      /* "View.MemoryView":435
  *     cdef is_slice(self, obj):
  *         if not isinstance(obj, memoryview):
  *             try:             # <<<<<<<<<<<<<<
  *                 obj = memoryview(obj, self.flags & ~PyBUF_WRITABLE | PyBUF_ANY_CONTIGUOUS,
  *                                  self.dtype_is_object)
  */
       __Pyx_XGIVEREF(__pyx_t_3);
@@ -32682,36 +32968,36 @@
       __Pyx_XGIVEREF(__pyx_t_4);
       __Pyx_XGIVEREF(__pyx_t_5);
       __Pyx_ExceptionReset(__pyx_t_3, __pyx_t_4, __pyx_t_5);
       goto __pyx_L0;
       __pyx_L9_try_end:;
     }
 
-    /* "View.MemoryView":432
+    /* "View.MemoryView":434
  * 
  *     cdef is_slice(self, obj):
  *         if not isinstance(obj, memoryview):             # <<<<<<<<<<<<<<
  *             try:
  *                 obj = memoryview(obj, self.flags & ~PyBUF_WRITABLE | PyBUF_ANY_CONTIGUOUS,
  */
   }
 
-  /* "View.MemoryView":439
+  /* "View.MemoryView":441
  *                 return None
  * 
  *         return obj             # <<<<<<<<<<<<<<
  * 
  *     cdef setitem_slice_assignment(self, dst, src):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_obj);
   __pyx_r = __pyx_v_obj;
   goto __pyx_L0;
 
-  /* "View.MemoryView":431
+  /* "View.MemoryView":433
  *             self.setitem_indexed(index, value)
  * 
  *     cdef is_slice(self, obj):             # <<<<<<<<<<<<<<
  *         if not isinstance(obj, memoryview):
  *             try:
  */
 
@@ -32725,15 +33011,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_obj);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":441
+/* "View.MemoryView":443
  *         return obj
  * 
  *     cdef setitem_slice_assignment(self, dst, src):             # <<<<<<<<<<<<<<
  *         cdef __Pyx_memviewslice dst_slice
  *         cdef __Pyx_memviewslice src_slice
  */
 
@@ -32744,62 +33030,65 @@
   __Pyx_RefNannyDeclarations
   __Pyx_memviewslice *__pyx_t_1;
   __Pyx_memviewslice *__pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_t_6;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("setitem_slice_assignment", 0);
 
-  /* "View.MemoryView":445
+  /* "View.MemoryView":447
  *         cdef __Pyx_memviewslice src_slice
  * 
  *         memoryview_copy_contents(get_slice_from_memview(src, &src_slice)[0],             # <<<<<<<<<<<<<<
  *                                  get_slice_from_memview(dst, &dst_slice)[0],
  *                                  src.ndim, dst.ndim, self.dtype_is_object)
  */
-  if (!(likely(((__pyx_v_src) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_src, __pyx_memoryview_type))))) __PYX_ERR(1, 445, __pyx_L1_error)
-  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(((struct __pyx_memoryview_obj *)__pyx_v_src), (&__pyx_v_src_slice)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 445, __pyx_L1_error)
+  if (!(likely(((__pyx_v_src) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_src, __pyx_memoryview_type))))) __PYX_ERR(1, 447, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(((struct __pyx_memoryview_obj *)__pyx_v_src), (&__pyx_v_src_slice)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 447, __pyx_L1_error)
 
-  /* "View.MemoryView":446
+  /* "View.MemoryView":448
  * 
  *         memoryview_copy_contents(get_slice_from_memview(src, &src_slice)[0],
  *                                  get_slice_from_memview(dst, &dst_slice)[0],             # <<<<<<<<<<<<<<
  *                                  src.ndim, dst.ndim, self.dtype_is_object)
  * 
  */
-  if (!(likely(((__pyx_v_dst) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dst, __pyx_memoryview_type))))) __PYX_ERR(1, 446, __pyx_L1_error)
-  __pyx_t_2 = __pyx_memoryview_get_slice_from_memoryview(((struct __pyx_memoryview_obj *)__pyx_v_dst), (&__pyx_v_dst_slice)); if (unlikely(__pyx_t_2 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 446, __pyx_L1_error)
+  if (!(likely(((__pyx_v_dst) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dst, __pyx_memoryview_type))))) __PYX_ERR(1, 448, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_get_slice_from_memoryview(((struct __pyx_memoryview_obj *)__pyx_v_dst), (&__pyx_v_dst_slice)); if (unlikely(__pyx_t_2 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 448, __pyx_L1_error)
 
-  /* "View.MemoryView":447
+  /* "View.MemoryView":449
  *         memoryview_copy_contents(get_slice_from_memview(src, &src_slice)[0],
  *                                  get_slice_from_memview(dst, &dst_slice)[0],
  *                                  src.ndim, dst.ndim, self.dtype_is_object)             # <<<<<<<<<<<<<<
  * 
  *     cdef setitem_slice_assign_scalar(self, memoryview dst, value):
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_src, __pyx_n_s_ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 447, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_src, __pyx_n_s_ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 449, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 447, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 449, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_dst, __pyx_n_s_ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 447, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_dst, __pyx_n_s_ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 449, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 447, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 449, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "View.MemoryView":445
+  /* "View.MemoryView":447
  *         cdef __Pyx_memviewslice src_slice
  * 
  *         memoryview_copy_contents(get_slice_from_memview(src, &src_slice)[0],             # <<<<<<<<<<<<<<
  *                                  get_slice_from_memview(dst, &dst_slice)[0],
  *                                  src.ndim, dst.ndim, self.dtype_is_object)
  */
-  __pyx_t_6 = __pyx_memoryview_copy_contents((__pyx_t_1[0]), (__pyx_t_2[0]), __pyx_t_4, __pyx_t_5, __pyx_v_self->dtype_is_object); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(1, 445, __pyx_L1_error)
+  __pyx_t_6 = __pyx_memoryview_copy_contents((__pyx_t_1[0]), (__pyx_t_2[0]), __pyx_t_4, __pyx_t_5, __pyx_v_self->dtype_is_object); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(1, 447, __pyx_L1_error)
 
-  /* "View.MemoryView":441
+  /* "View.MemoryView":443
  *         return obj
  * 
  *     cdef setitem_slice_assignment(self, dst, src):             # <<<<<<<<<<<<<<
  *         cdef __Pyx_memviewslice dst_slice
  *         cdef __Pyx_memviewslice src_slice
  */
 
@@ -32812,15 +33101,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":449
+/* "View.MemoryView":451
  *                                  src.ndim, dst.ndim, self.dtype_is_object)
  * 
  *     cdef setitem_slice_assign_scalar(self, memoryview dst, value):             # <<<<<<<<<<<<<<
  *         cdef int array[128]
  *         cdef void *tmp = NULL
  */
 
@@ -32840,206 +33129,209 @@
   char const *__pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
   PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("setitem_slice_assign_scalar", 0);
 
-  /* "View.MemoryView":451
+  /* "View.MemoryView":453
  *     cdef setitem_slice_assign_scalar(self, memoryview dst, value):
  *         cdef int array[128]
  *         cdef void *tmp = NULL             # <<<<<<<<<<<<<<
  *         cdef void *item
  * 
  */
   __pyx_v_tmp = NULL;
 
-  /* "View.MemoryView":456
+  /* "View.MemoryView":458
  *         cdef __Pyx_memviewslice *dst_slice
  *         cdef __Pyx_memviewslice tmp_slice
  *         dst_slice = get_slice_from_memview(dst, &tmp_slice)             # <<<<<<<<<<<<<<
  * 
  *         if <size_t>self.view.itemsize > sizeof(array):
  */
-  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(__pyx_v_dst, (&__pyx_v_tmp_slice)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 456, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(__pyx_v_dst, (&__pyx_v_tmp_slice)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 458, __pyx_L1_error)
   __pyx_v_dst_slice = __pyx_t_1;
 
-  /* "View.MemoryView":458
+  /* "View.MemoryView":460
  *         dst_slice = get_slice_from_memview(dst, &tmp_slice)
  * 
  *         if <size_t>self.view.itemsize > sizeof(array):             # <<<<<<<<<<<<<<
  *             tmp = PyMem_Malloc(self.view.itemsize)
  *             if tmp == NULL:
  */
   __pyx_t_2 = ((((size_t)__pyx_v_self->view.itemsize) > (sizeof(__pyx_v_array))) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":459
+    /* "View.MemoryView":461
  * 
  *         if <size_t>self.view.itemsize > sizeof(array):
  *             tmp = PyMem_Malloc(self.view.itemsize)             # <<<<<<<<<<<<<<
  *             if tmp == NULL:
  *                 raise MemoryError
  */
     __pyx_v_tmp = PyMem_Malloc(__pyx_v_self->view.itemsize);
 
-    /* "View.MemoryView":460
+    /* "View.MemoryView":462
  *         if <size_t>self.view.itemsize > sizeof(array):
  *             tmp = PyMem_Malloc(self.view.itemsize)
  *             if tmp == NULL:             # <<<<<<<<<<<<<<
  *                 raise MemoryError
  *             item = tmp
  */
     __pyx_t_2 = ((__pyx_v_tmp == NULL) != 0);
     if (unlikely(__pyx_t_2)) {
 
-      /* "View.MemoryView":461
+      /* "View.MemoryView":463
  *             tmp = PyMem_Malloc(self.view.itemsize)
  *             if tmp == NULL:
  *                 raise MemoryError             # <<<<<<<<<<<<<<
  *             item = tmp
  *         else:
  */
-      PyErr_NoMemory(); __PYX_ERR(1, 461, __pyx_L1_error)
+      PyErr_NoMemory(); __PYX_ERR(1, 463, __pyx_L1_error)
 
-      /* "View.MemoryView":460
+      /* "View.MemoryView":462
  *         if <size_t>self.view.itemsize > sizeof(array):
  *             tmp = PyMem_Malloc(self.view.itemsize)
  *             if tmp == NULL:             # <<<<<<<<<<<<<<
  *                 raise MemoryError
  *             item = tmp
  */
     }
 
-    /* "View.MemoryView":462
+    /* "View.MemoryView":464
  *             if tmp == NULL:
  *                 raise MemoryError
  *             item = tmp             # <<<<<<<<<<<<<<
  *         else:
  *             item = <void *> array
  */
     __pyx_v_item = __pyx_v_tmp;
 
-    /* "View.MemoryView":458
+    /* "View.MemoryView":460
  *         dst_slice = get_slice_from_memview(dst, &tmp_slice)
  * 
  *         if <size_t>self.view.itemsize > sizeof(array):             # <<<<<<<<<<<<<<
  *             tmp = PyMem_Malloc(self.view.itemsize)
  *             if tmp == NULL:
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":464
+  /* "View.MemoryView":466
  *             item = tmp
  *         else:
  *             item = <void *> array             # <<<<<<<<<<<<<<
  * 
  *         try:
  */
   /*else*/ {
     __pyx_v_item = ((void *)__pyx_v_array);
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":466
+  /* "View.MemoryView":468
  *             item = <void *> array
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             if self.dtype_is_object:
  *                 (<PyObject **> item)[0] = <PyObject *> value
  */
   /*try:*/ {
 
-    /* "View.MemoryView":467
+    /* "View.MemoryView":469
  * 
  *         try:
  *             if self.dtype_is_object:             # <<<<<<<<<<<<<<
  *                 (<PyObject **> item)[0] = <PyObject *> value
  *             else:
  */
     __pyx_t_2 = (__pyx_v_self->dtype_is_object != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":468
+      /* "View.MemoryView":470
  *         try:
  *             if self.dtype_is_object:
  *                 (<PyObject **> item)[0] = <PyObject *> value             # <<<<<<<<<<<<<<
  *             else:
  *                 self.assign_item_from_object(<char *> item, value)
  */
       (((PyObject **)__pyx_v_item)[0]) = ((PyObject *)__pyx_v_value);
 
-      /* "View.MemoryView":467
+      /* "View.MemoryView":469
  * 
  *         try:
  *             if self.dtype_is_object:             # <<<<<<<<<<<<<<
  *                 (<PyObject **> item)[0] = <PyObject *> value
  *             else:
  */
       goto __pyx_L8;
     }
 
-    /* "View.MemoryView":470
+    /* "View.MemoryView":472
  *                 (<PyObject **> item)[0] = <PyObject *> value
  *             else:
  *                 self.assign_item_from_object(<char *> item, value)             # <<<<<<<<<<<<<<
  * 
  * 
  */
     /*else*/ {
-      __pyx_t_3 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->assign_item_from_object(__pyx_v_self, ((char *)__pyx_v_item), __pyx_v_value); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 470, __pyx_L6_error)
+      __pyx_t_3 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->assign_item_from_object(__pyx_v_self, ((char *)__pyx_v_item), __pyx_v_value); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 472, __pyx_L6_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __pyx_L8:;
 
-    /* "View.MemoryView":474
+    /* "View.MemoryView":476
  * 
  * 
  *             if self.view.suboffsets != NULL:             # <<<<<<<<<<<<<<
  *                 assert_direct_dimensions(self.view.suboffsets, self.view.ndim)
  *             slice_assign_scalar(dst_slice, dst.view.ndim, self.view.itemsize,
  */
     __pyx_t_2 = ((__pyx_v_self->view.suboffsets != NULL) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":475
+      /* "View.MemoryView":477
  * 
  *             if self.view.suboffsets != NULL:
  *                 assert_direct_dimensions(self.view.suboffsets, self.view.ndim)             # <<<<<<<<<<<<<<
  *             slice_assign_scalar(dst_slice, dst.view.ndim, self.view.itemsize,
  *                                 item, self.dtype_is_object)
  */
-      __pyx_t_3 = assert_direct_dimensions(__pyx_v_self->view.suboffsets, __pyx_v_self->view.ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 475, __pyx_L6_error)
+      __pyx_t_3 = assert_direct_dimensions(__pyx_v_self->view.suboffsets, __pyx_v_self->view.ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 477, __pyx_L6_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "View.MemoryView":474
+      /* "View.MemoryView":476
  * 
  * 
  *             if self.view.suboffsets != NULL:             # <<<<<<<<<<<<<<
  *                 assert_direct_dimensions(self.view.suboffsets, self.view.ndim)
  *             slice_assign_scalar(dst_slice, dst.view.ndim, self.view.itemsize,
  */
     }
 
-    /* "View.MemoryView":476
+    /* "View.MemoryView":478
  *             if self.view.suboffsets != NULL:
  *                 assert_direct_dimensions(self.view.suboffsets, self.view.ndim)
  *             slice_assign_scalar(dst_slice, dst.view.ndim, self.view.itemsize,             # <<<<<<<<<<<<<<
  *                                 item, self.dtype_is_object)
  *         finally:
  */
     __pyx_memoryview_slice_assign_scalar(__pyx_v_dst_slice, __pyx_v_dst->view.ndim, __pyx_v_self->view.itemsize, __pyx_v_item, __pyx_v_self->dtype_is_object);
   }
 
-  /* "View.MemoryView":479
+  /* "View.MemoryView":481
  *                                 item, self.dtype_is_object)
  *         finally:
  *             PyMem_Free(tmp)             # <<<<<<<<<<<<<<
  * 
  *     cdef setitem_indexed(self, index, value):
  */
   /*finally:*/ {
@@ -33078,15 +33370,15 @@
       __pyx_t_7 = 0; __pyx_t_8 = 0; __pyx_t_9 = 0; __pyx_t_10 = 0; __pyx_t_11 = 0; __pyx_t_12 = 0;
       __pyx_lineno = __pyx_t_4; __pyx_clineno = __pyx_t_5; __pyx_filename = __pyx_t_6;
       goto __pyx_L1_error;
     }
     __pyx_L7:;
   }
 
-  /* "View.MemoryView":449
+  /* "View.MemoryView":451
  *                                  src.ndim, dst.ndim, self.dtype_is_object)
  * 
  *     cdef setitem_slice_assign_scalar(self, memoryview dst, value):             # <<<<<<<<<<<<<<
  *         cdef int array[128]
  *         cdef void *tmp = NULL
  */
 
@@ -33099,52 +33391,55 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":481
+/* "View.MemoryView":483
  *             PyMem_Free(tmp)
  * 
  *     cdef setitem_indexed(self, index, value):             # <<<<<<<<<<<<<<
  *         cdef char *itemp = self.get_item_pointer(index)
  *         self.assign_item_from_object(itemp, value)
  */
 
 static PyObject *__pyx_memoryview_setitem_indexed(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_index, PyObject *__pyx_v_value) {
   char *__pyx_v_itemp;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   char *__pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("setitem_indexed", 0);
 
-  /* "View.MemoryView":482
+  /* "View.MemoryView":484
  * 
  *     cdef setitem_indexed(self, index, value):
  *         cdef char *itemp = self.get_item_pointer(index)             # <<<<<<<<<<<<<<
  *         self.assign_item_from_object(itemp, value)
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->get_item_pointer(__pyx_v_self, __pyx_v_index); if (unlikely(__pyx_t_1 == ((char *)NULL))) __PYX_ERR(1, 482, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->get_item_pointer(__pyx_v_self, __pyx_v_index); if (unlikely(__pyx_t_1 == ((char *)NULL))) __PYX_ERR(1, 484, __pyx_L1_error)
   __pyx_v_itemp = __pyx_t_1;
 
-  /* "View.MemoryView":483
+  /* "View.MemoryView":485
  *     cdef setitem_indexed(self, index, value):
  *         cdef char *itemp = self.get_item_pointer(index)
  *         self.assign_item_from_object(itemp, value)             # <<<<<<<<<<<<<<
  * 
  *     cdef convert_item_to_object(self, char *itemp):
  */
-  __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->assign_item_from_object(__pyx_v_self, __pyx_v_itemp, __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 483, __pyx_L1_error)
+  __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->assign_item_from_object(__pyx_v_self, __pyx_v_itemp, __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "View.MemoryView":481
+  /* "View.MemoryView":483
  *             PyMem_Free(tmp)
  * 
  *     cdef setitem_indexed(self, index, value):             # <<<<<<<<<<<<<<
  *         cdef char *itemp = self.get_item_pointer(index)
  *         self.assign_item_from_object(itemp, value)
  */
 
@@ -33157,15 +33452,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":485
+/* "View.MemoryView":487
  *         self.assign_item_from_object(itemp, value)
  * 
  *     cdef convert_item_to_object(self, char *itemp):             # <<<<<<<<<<<<<<
  *         """Only used if instantiated manually by the user, or if Cython doesn't
  *         know how to convert the type"""
  */
 
@@ -33182,41 +33477,44 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   PyObject *__pyx_t_9 = NULL;
   size_t __pyx_t_10;
   int __pyx_t_11;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("convert_item_to_object", 0);
 
-  /* "View.MemoryView":488
+  /* "View.MemoryView":490
  *         """Only used if instantiated manually by the user, or if Cython doesn't
  *         know how to convert the type"""
  *         import struct             # <<<<<<<<<<<<<<
  *         cdef bytes bytesitem
  * 
  */
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_struct, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 488, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_struct, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 490, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_struct = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "View.MemoryView":491
+  /* "View.MemoryView":493
  *         cdef bytes bytesitem
  * 
  *         bytesitem = itemp[:self.view.itemsize]             # <<<<<<<<<<<<<<
  *         try:
  *             result = struct.unpack(self.view.format, bytesitem)
  */
-  __pyx_t_1 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_itemp + 0, __pyx_v_self->view.itemsize - 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 491, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_itemp + 0, __pyx_v_self->view.itemsize - 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 493, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_bytesitem = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "View.MemoryView":492
+  /* "View.MemoryView":494
  * 
  *         bytesitem = itemp[:self.view.itemsize]
  *         try:             # <<<<<<<<<<<<<<
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  */
   {
@@ -33224,24 +33522,24 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_2, &__pyx_t_3, &__pyx_t_4);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_4);
     /*try:*/ {
 
-      /* "View.MemoryView":493
+      /* "View.MemoryView":495
  *         bytesitem = itemp[:self.view.itemsize]
  *         try:
  *             result = struct.unpack(self.view.format, bytesitem)             # <<<<<<<<<<<<<<
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")
  */
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_unpack); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 493, __pyx_L3_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_unpack); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 495, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = __Pyx_PyBytes_FromString(__pyx_v_self->view.format); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 493, __pyx_L3_error)
+      __pyx_t_6 = __Pyx_PyBytes_FromString(__pyx_v_self->view.format); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 495, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_6);
       __pyx_t_7 = NULL;
       __pyx_t_8 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_7)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -33250,94 +33548,94 @@
           __Pyx_DECREF_SET(__pyx_t_5, function);
           __pyx_t_8 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_t_6, __pyx_v_bytesitem};
-        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 493, __pyx_L3_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 495, __pyx_L3_error)
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_t_6, __pyx_v_bytesitem};
-        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 493, __pyx_L3_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 495, __pyx_L3_error)
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       } else
       #endif
       {
-        __pyx_t_9 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 493, __pyx_L3_error)
+        __pyx_t_9 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 495, __pyx_L3_error)
         __Pyx_GOTREF(__pyx_t_9);
         if (__pyx_t_7) {
           __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_t_6);
         __Pyx_INCREF(__pyx_v_bytesitem);
         __Pyx_GIVEREF(__pyx_v_bytesitem);
         PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_8, __pyx_v_bytesitem);
         __pyx_t_6 = 0;
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 493, __pyx_L3_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 495, __pyx_L3_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       }
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_v_result = __pyx_t_1;
       __pyx_t_1 = 0;
 
-      /* "View.MemoryView":492
+      /* "View.MemoryView":494
  * 
  *         bytesitem = itemp[:self.view.itemsize]
  *         try:             # <<<<<<<<<<<<<<
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  */
     }
 
-    /* "View.MemoryView":497
+    /* "View.MemoryView":499
  *             raise ValueError("Unable to convert item to object")
  *         else:
  *             if len(self.view.format) == 1:             # <<<<<<<<<<<<<<
  *                 return result[0]
  *             return result
  */
     /*else:*/ {
       __pyx_t_10 = strlen(__pyx_v_self->view.format); 
       __pyx_t_11 = ((__pyx_t_10 == 1) != 0);
       if (__pyx_t_11) {
 
-        /* "View.MemoryView":498
+        /* "View.MemoryView":500
  *         else:
  *             if len(self.view.format) == 1:
  *                 return result[0]             # <<<<<<<<<<<<<<
  *             return result
  * 
  */
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_result, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 498, __pyx_L5_except_error)
+        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_result, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 500, __pyx_L5_except_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_r = __pyx_t_1;
         __pyx_t_1 = 0;
         goto __pyx_L6_except_return;
 
-        /* "View.MemoryView":497
+        /* "View.MemoryView":499
  *             raise ValueError("Unable to convert item to object")
  *         else:
  *             if len(self.view.format) == 1:             # <<<<<<<<<<<<<<
  *                 return result[0]
  *             return result
  */
       }
 
-      /* "View.MemoryView":499
+      /* "View.MemoryView":501
  *             if len(self.view.format) == 1:
  *                 return result[0]
  *             return result             # <<<<<<<<<<<<<<
  * 
  *     cdef assign_item_from_object(self, char *itemp, object value):
  */
       __Pyx_XDECREF(__pyx_r);
@@ -33348,52 +33646,52 @@
     __pyx_L3_error:;
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "View.MemoryView":494
+    /* "View.MemoryView":496
  *         try:
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:             # <<<<<<<<<<<<<<
  *             raise ValueError("Unable to convert item to object")
  *         else:
  */
     __Pyx_ErrFetch(&__pyx_t_1, &__pyx_t_5, &__pyx_t_9);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_error); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 494, __pyx_L5_except_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_error); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 496, __pyx_L5_except_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_8 = __Pyx_PyErr_GivenExceptionMatches(__pyx_t_1, __pyx_t_6);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_ErrRestore(__pyx_t_1, __pyx_t_5, __pyx_t_9);
     __pyx_t_1 = 0; __pyx_t_5 = 0; __pyx_t_9 = 0;
     if (__pyx_t_8) {
       __Pyx_AddTraceback("View.MemoryView.memoryview.convert_item_to_object", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_9, &__pyx_t_5, &__pyx_t_1) < 0) __PYX_ERR(1, 494, __pyx_L5_except_error)
+      if (__Pyx_GetException(&__pyx_t_9, &__pyx_t_5, &__pyx_t_1) < 0) __PYX_ERR(1, 496, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_1);
 
-      /* "View.MemoryView":495
+      /* "View.MemoryView":497
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 495, __pyx_L5_except_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 497, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(1, 495, __pyx_L5_except_error)
+      __PYX_ERR(1, 497, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "View.MemoryView":492
+    /* "View.MemoryView":494
  * 
  *         bytesitem = itemp[:self.view.itemsize]
  *         try:             # <<<<<<<<<<<<<<
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  */
     __Pyx_XGIVEREF(__pyx_t_2);
@@ -33405,15 +33703,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_XGIVEREF(__pyx_t_4);
     __Pyx_ExceptionReset(__pyx_t_2, __pyx_t_3, __pyx_t_4);
     goto __pyx_L0;
   }
 
-  /* "View.MemoryView":485
+  /* "View.MemoryView":487
  *         self.assign_item_from_object(itemp, value)
  * 
  *     cdef convert_item_to_object(self, char *itemp):             # <<<<<<<<<<<<<<
  *         """Only used if instantiated manually by the user, or if Cython doesn't
  *         know how to convert the type"""
  */
 
@@ -33431,15 +33729,15 @@
   __Pyx_XDECREF(__pyx_v_bytesitem);
   __Pyx_XDECREF(__pyx_v_result);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":501
+/* "View.MemoryView":503
  *             return result
  * 
  *     cdef assign_item_from_object(self, char *itemp, object value):             # <<<<<<<<<<<<<<
  *         """Only used if instantiated manually by the user, or if Cython doesn't
  *         know how to convert the type"""
  */
 
@@ -33460,90 +33758,93 @@
   PyObject *__pyx_t_8 = NULL;
   Py_ssize_t __pyx_t_9;
   PyObject *__pyx_t_10 = NULL;
   char *__pyx_t_11;
   char *__pyx_t_12;
   char *__pyx_t_13;
   char *__pyx_t_14;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("assign_item_from_object", 0);
 
-  /* "View.MemoryView":504
+  /* "View.MemoryView":506
  *         """Only used if instantiated manually by the user, or if Cython doesn't
  *         know how to convert the type"""
  *         import struct             # <<<<<<<<<<<<<<
  *         cdef char c
  *         cdef bytes bytesvalue
  */
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_struct, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 504, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_struct, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 506, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_struct = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "View.MemoryView":509
+  /* "View.MemoryView":511
  *         cdef Py_ssize_t i
  * 
  *         if isinstance(value, tuple):             # <<<<<<<<<<<<<<
  *             bytesvalue = struct.pack(self.view.format, *value)
  *         else:
  */
   __pyx_t_2 = PyTuple_Check(__pyx_v_value); 
   __pyx_t_3 = (__pyx_t_2 != 0);
   if (__pyx_t_3) {
 
-    /* "View.MemoryView":510
+    /* "View.MemoryView":512
  * 
  *         if isinstance(value, tuple):
  *             bytesvalue = struct.pack(self.view.format, *value)             # <<<<<<<<<<<<<<
  *         else:
  *             bytesvalue = struct.pack(self.view.format, value)
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_pack); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 510, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_pack); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 512, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyBytes_FromString(__pyx_v_self->view.format); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 510, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyBytes_FromString(__pyx_v_self->view.format); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 512, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 510, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 512, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PySequence_Tuple(__pyx_v_value); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 510, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PySequence_Tuple(__pyx_v_value); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 512, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 510, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 512, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 510, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 512, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (!(likely(PyBytes_CheckExact(__pyx_t_4))||((__pyx_t_4) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_4)->tp_name), 0))) __PYX_ERR(1, 510, __pyx_L1_error)
+    if (!(likely(PyBytes_CheckExact(__pyx_t_4))||((__pyx_t_4) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_4)->tp_name), 0))) __PYX_ERR(1, 512, __pyx_L1_error)
     __pyx_v_bytesvalue = ((PyObject*)__pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "View.MemoryView":509
+    /* "View.MemoryView":511
  *         cdef Py_ssize_t i
  * 
  *         if isinstance(value, tuple):             # <<<<<<<<<<<<<<
  *             bytesvalue = struct.pack(self.view.format, *value)
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":512
+  /* "View.MemoryView":514
  *             bytesvalue = struct.pack(self.view.format, *value)
  *         else:
  *             bytesvalue = struct.pack(self.view.format, value)             # <<<<<<<<<<<<<<
  * 
  *         for i, c in enumerate(bytesvalue):
  */
   /*else*/ {
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_pack); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 512, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_pack); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 514, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyBytes_FromString(__pyx_v_self->view.format); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 512, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyBytes_FromString(__pyx_v_self->view.format); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 514, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_5 = NULL;
     __pyx_t_7 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -33552,102 +33853,102 @@
         __Pyx_DECREF_SET(__pyx_t_6, function);
         __pyx_t_7 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_6)) {
       PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_1, __pyx_v_value};
-      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 512, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 514, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
       PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_1, __pyx_v_value};
-      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 512, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 514, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else
     #endif
     {
-      __pyx_t_8 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 512, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       if (__pyx_t_5) {
         __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_5); __pyx_t_5 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_t_1);
       __Pyx_INCREF(__pyx_v_value);
       __Pyx_GIVEREF(__pyx_v_value);
       PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_v_value);
       __pyx_t_1 = 0;
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_8, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 512, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_8, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (!(likely(PyBytes_CheckExact(__pyx_t_4))||((__pyx_t_4) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_4)->tp_name), 0))) __PYX_ERR(1, 512, __pyx_L1_error)
+    if (!(likely(PyBytes_CheckExact(__pyx_t_4))||((__pyx_t_4) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_4)->tp_name), 0))) __PYX_ERR(1, 514, __pyx_L1_error)
     __pyx_v_bytesvalue = ((PyObject*)__pyx_t_4);
     __pyx_t_4 = 0;
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":514
+  /* "View.MemoryView":516
  *             bytesvalue = struct.pack(self.view.format, value)
  * 
  *         for i, c in enumerate(bytesvalue):             # <<<<<<<<<<<<<<
  *             itemp[i] = c
  * 
  */
   __pyx_t_9 = 0;
   if (unlikely(__pyx_v_bytesvalue == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' is not iterable");
-    __PYX_ERR(1, 514, __pyx_L1_error)
+    __PYX_ERR(1, 516, __pyx_L1_error)
   }
   __Pyx_INCREF(__pyx_v_bytesvalue);
   __pyx_t_10 = __pyx_v_bytesvalue;
   __pyx_t_12 = PyBytes_AS_STRING(__pyx_t_10);
   __pyx_t_13 = (__pyx_t_12 + PyBytes_GET_SIZE(__pyx_t_10));
   for (__pyx_t_14 = __pyx_t_12; __pyx_t_14 < __pyx_t_13; __pyx_t_14++) {
     __pyx_t_11 = __pyx_t_14;
     __pyx_v_c = (__pyx_t_11[0]);
 
-    /* "View.MemoryView":515
+    /* "View.MemoryView":517
  * 
  *         for i, c in enumerate(bytesvalue):
  *             itemp[i] = c             # <<<<<<<<<<<<<<
  * 
  *     @cname('getbuffer')
  */
     __pyx_v_i = __pyx_t_9;
 
-    /* "View.MemoryView":514
+    /* "View.MemoryView":516
  *             bytesvalue = struct.pack(self.view.format, value)
  * 
  *         for i, c in enumerate(bytesvalue):             # <<<<<<<<<<<<<<
  *             itemp[i] = c
  * 
  */
     __pyx_t_9 = (__pyx_t_9 + 1);
 
-    /* "View.MemoryView":515
+    /* "View.MemoryView":517
  * 
  *         for i, c in enumerate(bytesvalue):
  *             itemp[i] = c             # <<<<<<<<<<<<<<
  * 
  *     @cname('getbuffer')
  */
     (__pyx_v_itemp[__pyx_v_i]) = __pyx_v_c;
   }
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "View.MemoryView":501
+  /* "View.MemoryView":503
  *             return result
  * 
  *     cdef assign_item_from_object(self, char *itemp, object value):             # <<<<<<<<<<<<<<
  *         """Only used if instantiated manually by the user, or if Cython doesn't
  *         know how to convert the type"""
  */
 
@@ -33667,15 +33968,15 @@
   __Pyx_XDECREF(__pyx_v_struct);
   __Pyx_XDECREF(__pyx_v_bytesvalue);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":518
+/* "View.MemoryView":520
  * 
  *     @cname('getbuffer')
  *     def __getbuffer__(self, Py_buffer *info, int flags):             # <<<<<<<<<<<<<<
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")
  */
 
@@ -33699,23 +34000,26 @@
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   Py_ssize_t *__pyx_t_4;
   char *__pyx_t_5;
   void *__pyx_t_6;
   int __pyx_t_7;
   Py_ssize_t __pyx_t_8;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   if (__pyx_v_info == NULL) {
     PyErr_SetString(PyExc_BufferError, "PyObject_GetBuffer: view==NULL argument is obsolete");
     return -1;
   }
   __Pyx_RefNannySetupContext("__getbuffer__", 0);
   __pyx_v_info->obj = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(__pyx_v_info->obj);
 
-  /* "View.MemoryView":519
+  /* "View.MemoryView":521
  *     @cname('getbuffer')
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:             # <<<<<<<<<<<<<<
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")
  * 
  */
   __pyx_t_2 = ((__pyx_v_flags & PyBUF_WRITABLE) != 0);
@@ -33725,268 +34029,268 @@
     goto __pyx_L4_bool_binop_done;
   }
   __pyx_t_2 = (__pyx_v_self->view.readonly != 0);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "View.MemoryView":520
+    /* "View.MemoryView":522
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 520, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 522, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 520, __pyx_L1_error)
+    __PYX_ERR(1, 522, __pyx_L1_error)
 
-    /* "View.MemoryView":519
+    /* "View.MemoryView":521
  *     @cname('getbuffer')
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:             # <<<<<<<<<<<<<<
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")
  * 
  */
   }
 
-  /* "View.MemoryView":522
+  /* "View.MemoryView":524
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")
  * 
  *         if flags & PyBUF_ND:             # <<<<<<<<<<<<<<
  *             info.shape = self.view.shape
  *         else:
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_ND) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":523
+    /* "View.MemoryView":525
  * 
  *         if flags & PyBUF_ND:
  *             info.shape = self.view.shape             # <<<<<<<<<<<<<<
  *         else:
  *             info.shape = NULL
  */
     __pyx_t_4 = __pyx_v_self->view.shape;
     __pyx_v_info->shape = __pyx_t_4;
 
-    /* "View.MemoryView":522
+    /* "View.MemoryView":524
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")
  * 
  *         if flags & PyBUF_ND:             # <<<<<<<<<<<<<<
  *             info.shape = self.view.shape
  *         else:
  */
     goto __pyx_L6;
   }
 
-  /* "View.MemoryView":525
+  /* "View.MemoryView":527
  *             info.shape = self.view.shape
  *         else:
  *             info.shape = NULL             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_STRIDES:
  */
   /*else*/ {
     __pyx_v_info->shape = NULL;
   }
   __pyx_L6:;
 
-  /* "View.MemoryView":527
+  /* "View.MemoryView":529
  *             info.shape = NULL
  * 
  *         if flags & PyBUF_STRIDES:             # <<<<<<<<<<<<<<
  *             info.strides = self.view.strides
  *         else:
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_STRIDES) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":528
+    /* "View.MemoryView":530
  * 
  *         if flags & PyBUF_STRIDES:
  *             info.strides = self.view.strides             # <<<<<<<<<<<<<<
  *         else:
  *             info.strides = NULL
  */
     __pyx_t_4 = __pyx_v_self->view.strides;
     __pyx_v_info->strides = __pyx_t_4;
 
-    /* "View.MemoryView":527
+    /* "View.MemoryView":529
  *             info.shape = NULL
  * 
  *         if flags & PyBUF_STRIDES:             # <<<<<<<<<<<<<<
  *             info.strides = self.view.strides
  *         else:
  */
     goto __pyx_L7;
   }
 
-  /* "View.MemoryView":530
+  /* "View.MemoryView":532
  *             info.strides = self.view.strides
  *         else:
  *             info.strides = NULL             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_INDIRECT:
  */
   /*else*/ {
     __pyx_v_info->strides = NULL;
   }
   __pyx_L7:;
 
-  /* "View.MemoryView":532
+  /* "View.MemoryView":534
  *             info.strides = NULL
  * 
  *         if flags & PyBUF_INDIRECT:             # <<<<<<<<<<<<<<
  *             info.suboffsets = self.view.suboffsets
  *         else:
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_INDIRECT) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":533
+    /* "View.MemoryView":535
  * 
  *         if flags & PyBUF_INDIRECT:
  *             info.suboffsets = self.view.suboffsets             # <<<<<<<<<<<<<<
  *         else:
  *             info.suboffsets = NULL
  */
     __pyx_t_4 = __pyx_v_self->view.suboffsets;
     __pyx_v_info->suboffsets = __pyx_t_4;
 
-    /* "View.MemoryView":532
+    /* "View.MemoryView":534
  *             info.strides = NULL
  * 
  *         if flags & PyBUF_INDIRECT:             # <<<<<<<<<<<<<<
  *             info.suboffsets = self.view.suboffsets
  *         else:
  */
     goto __pyx_L8;
   }
 
-  /* "View.MemoryView":535
+  /* "View.MemoryView":537
  *             info.suboffsets = self.view.suboffsets
  *         else:
  *             info.suboffsets = NULL             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_FORMAT:
  */
   /*else*/ {
     __pyx_v_info->suboffsets = NULL;
   }
   __pyx_L8:;
 
-  /* "View.MemoryView":537
+  /* "View.MemoryView":539
  *             info.suboffsets = NULL
  * 
  *         if flags & PyBUF_FORMAT:             # <<<<<<<<<<<<<<
  *             info.format = self.view.format
  *         else:
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_FORMAT) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":538
+    /* "View.MemoryView":540
  * 
  *         if flags & PyBUF_FORMAT:
  *             info.format = self.view.format             # <<<<<<<<<<<<<<
  *         else:
  *             info.format = NULL
  */
     __pyx_t_5 = __pyx_v_self->view.format;
     __pyx_v_info->format = __pyx_t_5;
 
-    /* "View.MemoryView":537
+    /* "View.MemoryView":539
  *             info.suboffsets = NULL
  * 
  *         if flags & PyBUF_FORMAT:             # <<<<<<<<<<<<<<
  *             info.format = self.view.format
  *         else:
  */
     goto __pyx_L9;
   }
 
-  /* "View.MemoryView":540
+  /* "View.MemoryView":542
  *             info.format = self.view.format
  *         else:
  *             info.format = NULL             # <<<<<<<<<<<<<<
  * 
  *         info.buf = self.view.buf
  */
   /*else*/ {
     __pyx_v_info->format = NULL;
   }
   __pyx_L9:;
 
-  /* "View.MemoryView":542
+  /* "View.MemoryView":544
  *             info.format = NULL
  * 
  *         info.buf = self.view.buf             # <<<<<<<<<<<<<<
  *         info.ndim = self.view.ndim
  *         info.itemsize = self.view.itemsize
  */
   __pyx_t_6 = __pyx_v_self->view.buf;
   __pyx_v_info->buf = __pyx_t_6;
 
-  /* "View.MemoryView":543
+  /* "View.MemoryView":545
  * 
  *         info.buf = self.view.buf
  *         info.ndim = self.view.ndim             # <<<<<<<<<<<<<<
  *         info.itemsize = self.view.itemsize
  *         info.len = self.view.len
  */
   __pyx_t_7 = __pyx_v_self->view.ndim;
   __pyx_v_info->ndim = __pyx_t_7;
 
-  /* "View.MemoryView":544
+  /* "View.MemoryView":546
  *         info.buf = self.view.buf
  *         info.ndim = self.view.ndim
  *         info.itemsize = self.view.itemsize             # <<<<<<<<<<<<<<
  *         info.len = self.view.len
  *         info.readonly = self.view.readonly
  */
   __pyx_t_8 = __pyx_v_self->view.itemsize;
   __pyx_v_info->itemsize = __pyx_t_8;
 
-  /* "View.MemoryView":545
+  /* "View.MemoryView":547
  *         info.ndim = self.view.ndim
  *         info.itemsize = self.view.itemsize
  *         info.len = self.view.len             # <<<<<<<<<<<<<<
  *         info.readonly = self.view.readonly
  *         info.obj = self
  */
   __pyx_t_8 = __pyx_v_self->view.len;
   __pyx_v_info->len = __pyx_t_8;
 
-  /* "View.MemoryView":546
+  /* "View.MemoryView":548
  *         info.itemsize = self.view.itemsize
  *         info.len = self.view.len
  *         info.readonly = self.view.readonly             # <<<<<<<<<<<<<<
  *         info.obj = self
  * 
  */
   __pyx_t_1 = __pyx_v_self->view.readonly;
   __pyx_v_info->readonly = __pyx_t_1;
 
-  /* "View.MemoryView":547
+  /* "View.MemoryView":549
  *         info.len = self.view.len
  *         info.readonly = self.view.readonly
  *         info.obj = self             # <<<<<<<<<<<<<<
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_memoryview_getbuffer, "getbuffer(obj, view, flags)")
  */
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
   __Pyx_GOTREF(__pyx_v_info->obj);
   __Pyx_DECREF(__pyx_v_info->obj);
   __pyx_v_info->obj = ((PyObject *)__pyx_v_self);
 
-  /* "View.MemoryView":518
+  /* "View.MemoryView":520
  * 
  *     @cname('getbuffer')
  *     def __getbuffer__(self, Py_buffer *info, int flags):             # <<<<<<<<<<<<<<
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")
  */
 
@@ -34008,15 +34312,15 @@
     __Pyx_DECREF(__pyx_v_info->obj); __pyx_v_info->obj = 0;
   }
   __pyx_L2:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":553
+/* "View.MemoryView":555
  * 
  *     @property
  *     def T(self):             # <<<<<<<<<<<<<<
  *         cdef _memoryviewslice result = memoryview_copy(self)
  *         transpose_memslice(&result.from_slice)
  */
 
@@ -34035,51 +34339,54 @@
 
 static PyObject *__pyx_pf_15View_dot_MemoryView_10memoryview_1T___get__(struct __pyx_memoryview_obj *__pyx_v_self) {
   struct __pyx_memoryviewslice_obj *__pyx_v_result = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_t_2;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "View.MemoryView":554
+  /* "View.MemoryView":556
  *     @property
  *     def T(self):
  *         cdef _memoryviewslice result = memoryview_copy(self)             # <<<<<<<<<<<<<<
  *         transpose_memslice(&result.from_slice)
  *         return result
  */
-  __pyx_t_1 = __pyx_memoryview_copy_object(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 554, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_copy_object(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 556, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_memoryviewslice_type))))) __PYX_ERR(1, 554, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_memoryviewslice_type))))) __PYX_ERR(1, 556, __pyx_L1_error)
   __pyx_v_result = ((struct __pyx_memoryviewslice_obj *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "View.MemoryView":555
+  /* "View.MemoryView":557
  *     def T(self):
  *         cdef _memoryviewslice result = memoryview_copy(self)
  *         transpose_memslice(&result.from_slice)             # <<<<<<<<<<<<<<
  *         return result
  * 
  */
-  __pyx_t_2 = __pyx_memslice_transpose((&__pyx_v_result->from_slice)); if (unlikely(__pyx_t_2 == ((int)0))) __PYX_ERR(1, 555, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memslice_transpose((&__pyx_v_result->from_slice)); if (unlikely(__pyx_t_2 == ((int)0))) __PYX_ERR(1, 557, __pyx_L1_error)
 
-  /* "View.MemoryView":556
+  /* "View.MemoryView":558
  *         cdef _memoryviewslice result = memoryview_copy(self)
  *         transpose_memslice(&result.from_slice)
  *         return result             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_result));
   __pyx_r = ((PyObject *)__pyx_v_result);
   goto __pyx_L0;
 
-  /* "View.MemoryView":553
+  /* "View.MemoryView":555
  * 
  *     @property
  *     def T(self):             # <<<<<<<<<<<<<<
  *         cdef _memoryviewslice result = memoryview_copy(self)
  *         transpose_memslice(&result.from_slice)
  */
 
@@ -34091,15 +34398,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_result);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":559
+/* "View.MemoryView":561
  * 
  *     @property
  *     def base(self):             # <<<<<<<<<<<<<<
  *         return self.obj
  * 
  */
 
@@ -34117,42 +34424,42 @@
 }
 
 static PyObject *__pyx_pf_15View_dot_MemoryView_10memoryview_4base___get__(struct __pyx_memoryview_obj *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "View.MemoryView":560
+  /* "View.MemoryView":562
  *     @property
  *     def base(self):
  *         return self.obj             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_self->obj);
   __pyx_r = __pyx_v_self->obj;
   goto __pyx_L0;
 
-  /* "View.MemoryView":559
+  /* "View.MemoryView":561
  * 
  *     @property
  *     def base(self):             # <<<<<<<<<<<<<<
  *         return self.obj
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":563
+/* "View.MemoryView":565
  * 
  *     @property
  *     def shape(self):             # <<<<<<<<<<<<<<
  *         return tuple([length for length in self.view.shape[:self.view.ndim]])
  * 
  */
 
@@ -34174,43 +34481,46 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t *__pyx_t_2;
   Py_ssize_t *__pyx_t_3;
   Py_ssize_t *__pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "View.MemoryView":564
+  /* "View.MemoryView":566
  *     @property
  *     def shape(self):
  *         return tuple([length for length in self.view.shape[:self.view.ndim]])             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 564, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3 = (__pyx_v_self->view.shape + __pyx_v_self->view.ndim);
   for (__pyx_t_4 = __pyx_v_self->view.shape; __pyx_t_4 < __pyx_t_3; __pyx_t_4++) {
     __pyx_t_2 = __pyx_t_4;
     __pyx_v_length = (__pyx_t_2[0]);
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_length); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 564, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_length); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 566, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(1, 564, __pyx_L1_error)
+    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(1, 566, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
-  __pyx_t_5 = PyList_AsTuple(((PyObject*)__pyx_t_1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 564, __pyx_L1_error)
+  __pyx_t_5 = PyList_AsTuple(((PyObject*)__pyx_t_1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_5;
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":563
+  /* "View.MemoryView":565
  * 
  *     @property
  *     def shape(self):             # <<<<<<<<<<<<<<
  *         return tuple([length for length in self.view.shape[:self.view.ndim]])
  * 
  */
 
@@ -34222,15 +34532,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":567
+/* "View.MemoryView":569
  * 
  *     @property
  *     def strides(self):             # <<<<<<<<<<<<<<
  *         if self.view.strides == NULL:
  * 
  */
 
@@ -34253,75 +34563,78 @@
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   Py_ssize_t *__pyx_t_3;
   Py_ssize_t *__pyx_t_4;
   Py_ssize_t *__pyx_t_5;
   PyObject *__pyx_t_6 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "View.MemoryView":568
+  /* "View.MemoryView":570
  *     @property
  *     def strides(self):
  *         if self.view.strides == NULL:             # <<<<<<<<<<<<<<
  * 
  *             raise ValueError("Buffer view does not expose strides")
  */
   __pyx_t_1 = ((__pyx_v_self->view.strides == NULL) != 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "View.MemoryView":570
+    /* "View.MemoryView":572
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 570, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 572, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(1, 570, __pyx_L1_error)
+    __PYX_ERR(1, 572, __pyx_L1_error)
 
-    /* "View.MemoryView":568
+    /* "View.MemoryView":570
  *     @property
  *     def strides(self):
  *         if self.view.strides == NULL:             # <<<<<<<<<<<<<<
  * 
  *             raise ValueError("Buffer view does not expose strides")
  */
   }
 
-  /* "View.MemoryView":572
+  /* "View.MemoryView":574
  *             raise ValueError("Buffer view does not expose strides")
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 572, __pyx_L1_error)
+  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = (__pyx_v_self->view.strides + __pyx_v_self->view.ndim);
   for (__pyx_t_5 = __pyx_v_self->view.strides; __pyx_t_5 < __pyx_t_4; __pyx_t_5++) {
     __pyx_t_3 = __pyx_t_5;
     __pyx_v_stride = (__pyx_t_3[0]);
-    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_stride); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 572, __pyx_L1_error)
+    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_stride); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 574, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_6))) __PYX_ERR(1, 572, __pyx_L1_error)
+    if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_6))) __PYX_ERR(1, 574, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
-  __pyx_t_6 = PyList_AsTuple(((PyObject*)__pyx_t_2)); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 572, __pyx_L1_error)
+  __pyx_t_6 = PyList_AsTuple(((PyObject*)__pyx_t_2)); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_6;
   __pyx_t_6 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":567
+  /* "View.MemoryView":569
  * 
  *     @property
  *     def strides(self):             # <<<<<<<<<<<<<<
  *         if self.view.strides == NULL:
  * 
  */
 
@@ -34333,15 +34646,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":575
+/* "View.MemoryView":577
  * 
  *     @property
  *     def suboffsets(self):             # <<<<<<<<<<<<<<
  *         if self.view.suboffsets == NULL:
  *             return (-1,) * self.view.ndim
  */
 
@@ -34364,79 +34677,82 @@
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   Py_ssize_t *__pyx_t_4;
   Py_ssize_t *__pyx_t_5;
   Py_ssize_t *__pyx_t_6;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "View.MemoryView":576
+  /* "View.MemoryView":578
  *     @property
  *     def suboffsets(self):
  *         if self.view.suboffsets == NULL:             # <<<<<<<<<<<<<<
  *             return (-1,) * self.view.ndim
  * 
  */
   __pyx_t_1 = ((__pyx_v_self->view.suboffsets == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":577
+    /* "View.MemoryView":579
  *     def suboffsets(self):
  *         if self.view.suboffsets == NULL:
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 577, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__22, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 577, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__22, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "View.MemoryView":576
+    /* "View.MemoryView":578
  *     @property
  *     def suboffsets(self):
  *         if self.view.suboffsets == NULL:             # <<<<<<<<<<<<<<
  *             return (-1,) * self.view.ndim
  * 
  */
   }
 
-  /* "View.MemoryView":579
+  /* "View.MemoryView":581
  *             return (-1,) * self.view.ndim
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 579, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 581, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = (__pyx_v_self->view.suboffsets + __pyx_v_self->view.ndim);
   for (__pyx_t_6 = __pyx_v_self->view.suboffsets; __pyx_t_6 < __pyx_t_5; __pyx_t_6++) {
     __pyx_t_4 = __pyx_t_6;
     __pyx_v_suboffset = (__pyx_t_4[0]);
-    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_suboffset); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 579, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_suboffset); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 581, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_2))) __PYX_ERR(1, 579, __pyx_L1_error)
+    if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_2))) __PYX_ERR(1, 581, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  __pyx_t_2 = PyList_AsTuple(((PyObject*)__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 579, __pyx_L1_error)
+  __pyx_t_2 = PyList_AsTuple(((PyObject*)__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 581, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":575
+  /* "View.MemoryView":577
  * 
  *     @property
  *     def suboffsets(self):             # <<<<<<<<<<<<<<
  *         if self.view.suboffsets == NULL:
  *             return (-1,) * self.view.ndim
  */
 
@@ -34448,15 +34764,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":582
+/* "View.MemoryView":584
  * 
  *     @property
  *     def ndim(self):             # <<<<<<<<<<<<<<
  *         return self.view.ndim
  * 
  */
 
@@ -34473,31 +34789,34 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_15View_dot_MemoryView_10memoryview_4ndim___get__(struct __pyx_memoryview_obj *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "View.MemoryView":583
+  /* "View.MemoryView":585
  *     @property
  *     def ndim(self):
  *         return self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 583, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 585, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":582
+  /* "View.MemoryView":584
  * 
  *     @property
  *     def ndim(self):             # <<<<<<<<<<<<<<
  *         return self.view.ndim
  * 
  */
 
@@ -34508,15 +34827,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":586
+/* "View.MemoryView":588
  * 
  *     @property
  *     def itemsize(self):             # <<<<<<<<<<<<<<
  *         return self.view.itemsize
  * 
  */
 
@@ -34533,31 +34852,34 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_15View_dot_MemoryView_10memoryview_8itemsize___get__(struct __pyx_memoryview_obj *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "View.MemoryView":587
+  /* "View.MemoryView":589
  *     @property
  *     def itemsize(self):
  *         return self.view.itemsize             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->view.itemsize); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 587, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->view.itemsize); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 589, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":586
+  /* "View.MemoryView":588
  * 
  *     @property
  *     def itemsize(self):             # <<<<<<<<<<<<<<
  *         return self.view.itemsize
  * 
  */
 
@@ -34568,15 +34890,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":590
+/* "View.MemoryView":592
  * 
  *     @property
  *     def nbytes(self):             # <<<<<<<<<<<<<<
  *         return self.size * self.view.itemsize
  * 
  */
 
@@ -34595,37 +34917,40 @@
 
 static PyObject *__pyx_pf_15View_dot_MemoryView_10memoryview_6nbytes___get__(struct __pyx_memoryview_obj *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "View.MemoryView":591
+  /* "View.MemoryView":593
  *     @property
  *     def nbytes(self):
  *         return self.size * self.view.itemsize             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 591, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 593, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->view.itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 591, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->view.itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 593, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 591, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 593, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":590
+  /* "View.MemoryView":592
  * 
  *     @property
  *     def nbytes(self):             # <<<<<<<<<<<<<<
  *         return self.size * self.view.itemsize
  * 
  */
 
@@ -34638,15 +34963,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":594
+/* "View.MemoryView":596
  * 
  *     @property
  *     def size(self):             # <<<<<<<<<<<<<<
  *         if self._size is None:
  *             result = 1
  */
 
@@ -34670,100 +34995,103 @@
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   Py_ssize_t *__pyx_t_3;
   Py_ssize_t *__pyx_t_4;
   Py_ssize_t *__pyx_t_5;
   PyObject *__pyx_t_6 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "View.MemoryView":595
+  /* "View.MemoryView":597
  *     @property
  *     def size(self):
  *         if self._size is None:             # <<<<<<<<<<<<<<
  *             result = 1
  * 
  */
   __pyx_t_1 = (__pyx_v_self->_size == Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":596
+    /* "View.MemoryView":598
  *     def size(self):
  *         if self._size is None:
  *             result = 1             # <<<<<<<<<<<<<<
  * 
  *             for length in self.view.shape[:self.view.ndim]:
  */
     __Pyx_INCREF(__pyx_int_1);
     __pyx_v_result = __pyx_int_1;
 
-    /* "View.MemoryView":598
+    /* "View.MemoryView":600
  *             result = 1
  * 
  *             for length in self.view.shape[:self.view.ndim]:             # <<<<<<<<<<<<<<
  *                 result *= length
  * 
  */
     __pyx_t_4 = (__pyx_v_self->view.shape + __pyx_v_self->view.ndim);
     for (__pyx_t_5 = __pyx_v_self->view.shape; __pyx_t_5 < __pyx_t_4; __pyx_t_5++) {
       __pyx_t_3 = __pyx_t_5;
-      __pyx_t_6 = PyInt_FromSsize_t((__pyx_t_3[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 598, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t((__pyx_t_3[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 600, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_XDECREF_SET(__pyx_v_length, __pyx_t_6);
       __pyx_t_6 = 0;
 
-      /* "View.MemoryView":599
+      /* "View.MemoryView":601
  * 
  *             for length in self.view.shape[:self.view.ndim]:
  *                 result *= length             # <<<<<<<<<<<<<<
  * 
  *             self._size = result
  */
-      __pyx_t_6 = PyNumber_InPlaceMultiply(__pyx_v_result, __pyx_v_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 599, __pyx_L1_error)
+      __pyx_t_6 = PyNumber_InPlaceMultiply(__pyx_v_result, __pyx_v_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF_SET(__pyx_v_result, __pyx_t_6);
       __pyx_t_6 = 0;
     }
 
-    /* "View.MemoryView":601
+    /* "View.MemoryView":603
  *                 result *= length
  * 
  *             self._size = result             # <<<<<<<<<<<<<<
  * 
  *         return self._size
  */
     __Pyx_INCREF(__pyx_v_result);
     __Pyx_GIVEREF(__pyx_v_result);
     __Pyx_GOTREF(__pyx_v_self->_size);
     __Pyx_DECREF(__pyx_v_self->_size);
     __pyx_v_self->_size = __pyx_v_result;
 
-    /* "View.MemoryView":595
+    /* "View.MemoryView":597
  *     @property
  *     def size(self):
  *         if self._size is None:             # <<<<<<<<<<<<<<
  *             result = 1
  * 
  */
   }
 
-  /* "View.MemoryView":603
+  /* "View.MemoryView":605
  *             self._size = result
  * 
  *         return self._size             # <<<<<<<<<<<<<<
  * 
  *     def __len__(self):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_self->_size);
   __pyx_r = __pyx_v_self->_size;
   goto __pyx_L0;
 
-  /* "View.MemoryView":594
+  /* "View.MemoryView":596
  * 
  *     @property
  *     def size(self):             # <<<<<<<<<<<<<<
  *         if self._size is None:
  *             result = 1
  */
 
@@ -34776,15 +35104,15 @@
   __Pyx_XDECREF(__pyx_v_result);
   __Pyx_XDECREF(__pyx_v_length);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":605
+/* "View.MemoryView":607
  *         return self._size
  * 
  *     def __len__(self):             # <<<<<<<<<<<<<<
  *         if self.view.ndim >= 1:
  *             return self.view.shape[0]
  */
 
@@ -34803,68 +35131,68 @@
 
 static Py_ssize_t __pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview_10__len__(struct __pyx_memoryview_obj *__pyx_v_self) {
   Py_ssize_t __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("__len__", 0);
 
-  /* "View.MemoryView":606
+  /* "View.MemoryView":608
  * 
  *     def __len__(self):
  *         if self.view.ndim >= 1:             # <<<<<<<<<<<<<<
  *             return self.view.shape[0]
  * 
  */
   __pyx_t_1 = ((__pyx_v_self->view.ndim >= 1) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":607
+    /* "View.MemoryView":609
  *     def __len__(self):
  *         if self.view.ndim >= 1:
  *             return self.view.shape[0]             # <<<<<<<<<<<<<<
  * 
  *         return 0
  */
     __pyx_r = (__pyx_v_self->view.shape[0]);
     goto __pyx_L0;
 
-    /* "View.MemoryView":606
+    /* "View.MemoryView":608
  * 
  *     def __len__(self):
  *         if self.view.ndim >= 1:             # <<<<<<<<<<<<<<
  *             return self.view.shape[0]
  * 
  */
   }
 
-  /* "View.MemoryView":609
+  /* "View.MemoryView":611
  *             return self.view.shape[0]
  * 
  *         return 0             # <<<<<<<<<<<<<<
  * 
  *     def __repr__(self):
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":605
+  /* "View.MemoryView":607
  *         return self._size
  * 
  *     def __len__(self):             # <<<<<<<<<<<<<<
  *         if self.view.ndim >= 1:
  *             return self.view.shape[0]
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":611
+/* "View.MemoryView":613
  *         return 0
  * 
  *     def __repr__(self):             # <<<<<<<<<<<<<<
  *         return "<MemoryView of %r at 0x%x>" % (self.base.__class__.__name__,
  *                                                id(self))
  */
 
@@ -34883,66 +35211,69 @@
 
 static PyObject *__pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview_12__repr__(struct __pyx_memoryview_obj *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__repr__", 0);
 
-  /* "View.MemoryView":612
+  /* "View.MemoryView":614
  * 
  *     def __repr__(self):
  *         return "<MemoryView of %r at 0x%x>" % (self.base.__class__.__name__,             # <<<<<<<<<<<<<<
  *                                                id(self))
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_base); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 612, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_base); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_class); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 612, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_class); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_name_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 612, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_name_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "View.MemoryView":613
+  /* "View.MemoryView":615
  *     def __repr__(self):
  *         return "<MemoryView of %r at 0x%x>" % (self.base.__class__.__name__,
  *                                                id(self))             # <<<<<<<<<<<<<<
  * 
  *     def __str__(self):
  */
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_id, ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 613, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_id, ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 615, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "View.MemoryView":612
+  /* "View.MemoryView":614
  * 
  *     def __repr__(self):
  *         return "<MemoryView of %r at 0x%x>" % (self.base.__class__.__name__,             # <<<<<<<<<<<<<<
  *                                                id(self))
  * 
  */
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 612, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_MemoryView_of_r_at_0x_x, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 612, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_MemoryView_of_r_at_0x_x, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":611
+  /* "View.MemoryView":613
  *         return 0
  * 
  *     def __repr__(self):             # <<<<<<<<<<<<<<
  *         return "<MemoryView of %r at 0x%x>" % (self.base.__class__.__name__,
  *                                                id(self))
  */
 
@@ -34955,15 +35286,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":615
+/* "View.MemoryView":617
  *                                                id(self))
  * 
  *     def __str__(self):             # <<<<<<<<<<<<<<
  *         return "<MemoryView of %r object>" % (self.base.__class__.__name__,)
  * 
  */
 
@@ -34981,45 +35312,48 @@
 }
 
 static PyObject *__pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview_14__str__(struct __pyx_memoryview_obj *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__str__", 0);
 
-  /* "View.MemoryView":616
+  /* "View.MemoryView":618
  * 
  *     def __str__(self):
  *         return "<MemoryView of %r object>" % (self.base.__class__.__name__,)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_base); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 616, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_base); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 618, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_class); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 616, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_class); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 618, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_name_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 616, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_name_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 618, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 616, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 618, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_MemoryView_of_r_object, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 616, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_MemoryView_of_r_object, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 618, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":615
+  /* "View.MemoryView":617
  *                                                id(self))
  * 
  *     def __str__(self):             # <<<<<<<<<<<<<<
  *         return "<MemoryView of %r object>" % (self.base.__class__.__name__,)
  * 
  */
 
@@ -35031,15 +35365,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":619
+/* "View.MemoryView":621
  * 
  * 
  *     def is_c_contig(self):             # <<<<<<<<<<<<<<
  *         cdef __Pyx_memviewslice *mslice
  *         cdef __Pyx_memviewslice tmp
  */
 
@@ -35059,41 +35393,44 @@
 static PyObject *__pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview_16is_c_contig(struct __pyx_memoryview_obj *__pyx_v_self) {
   __Pyx_memviewslice *__pyx_v_mslice;
   __Pyx_memviewslice __pyx_v_tmp;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_memviewslice *__pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_c_contig", 0);
 
-  /* "View.MemoryView":622
+  /* "View.MemoryView":624
  *         cdef __Pyx_memviewslice *mslice
  *         cdef __Pyx_memviewslice tmp
  *         mslice = get_slice_from_memview(self, &tmp)             # <<<<<<<<<<<<<<
  *         return slice_is_contig(mslice[0], 'C', self.view.ndim)
  * 
  */
-  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(__pyx_v_self, (&__pyx_v_tmp)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 622, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(__pyx_v_self, (&__pyx_v_tmp)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 624, __pyx_L1_error)
   __pyx_v_mslice = __pyx_t_1;
 
-  /* "View.MemoryView":623
+  /* "View.MemoryView":625
  *         cdef __Pyx_memviewslice tmp
  *         mslice = get_slice_from_memview(self, &tmp)
  *         return slice_is_contig(mslice[0], 'C', self.view.ndim)             # <<<<<<<<<<<<<<
  * 
  *     def is_f_contig(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_memviewslice_is_contig((__pyx_v_mslice[0]), 'C', __pyx_v_self->view.ndim)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 623, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_memviewslice_is_contig((__pyx_v_mslice[0]), 'C', __pyx_v_self->view.ndim)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 625, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":619
+  /* "View.MemoryView":621
  * 
  * 
  *     def is_c_contig(self):             # <<<<<<<<<<<<<<
  *         cdef __Pyx_memviewslice *mslice
  *         cdef __Pyx_memviewslice tmp
  */
 
@@ -35104,15 +35441,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":625
+/* "View.MemoryView":627
  *         return slice_is_contig(mslice[0], 'C', self.view.ndim)
  * 
  *     def is_f_contig(self):             # <<<<<<<<<<<<<<
  *         cdef __Pyx_memviewslice *mslice
  *         cdef __Pyx_memviewslice tmp
  */
 
@@ -35132,41 +35469,44 @@
 static PyObject *__pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview_18is_f_contig(struct __pyx_memoryview_obj *__pyx_v_self) {
   __Pyx_memviewslice *__pyx_v_mslice;
   __Pyx_memviewslice __pyx_v_tmp;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_memviewslice *__pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_f_contig", 0);
 
-  /* "View.MemoryView":628
+  /* "View.MemoryView":630
  *         cdef __Pyx_memviewslice *mslice
  *         cdef __Pyx_memviewslice tmp
  *         mslice = get_slice_from_memview(self, &tmp)             # <<<<<<<<<<<<<<
  *         return slice_is_contig(mslice[0], 'F', self.view.ndim)
  * 
  */
-  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(__pyx_v_self, (&__pyx_v_tmp)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 628, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(__pyx_v_self, (&__pyx_v_tmp)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 630, __pyx_L1_error)
   __pyx_v_mslice = __pyx_t_1;
 
-  /* "View.MemoryView":629
+  /* "View.MemoryView":631
  *         cdef __Pyx_memviewslice tmp
  *         mslice = get_slice_from_memview(self, &tmp)
  *         return slice_is_contig(mslice[0], 'F', self.view.ndim)             # <<<<<<<<<<<<<<
  * 
  *     def copy(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_memviewslice_is_contig((__pyx_v_mslice[0]), 'F', __pyx_v_self->view.ndim)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 629, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_memviewslice_is_contig((__pyx_v_mslice[0]), 'F', __pyx_v_self->view.ndim)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 631, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":625
+  /* "View.MemoryView":627
  *         return slice_is_contig(mslice[0], 'C', self.view.ndim)
  * 
  *     def is_f_contig(self):             # <<<<<<<<<<<<<<
  *         cdef __Pyx_memviewslice *mslice
  *         cdef __Pyx_memviewslice tmp
  */
 
@@ -35177,15 +35517,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":631
+/* "View.MemoryView":633
  *         return slice_is_contig(mslice[0], 'F', self.view.ndim)
  * 
  *     def copy(self):             # <<<<<<<<<<<<<<
  *         cdef __Pyx_memviewslice mslice
  *         cdef int flags = self.flags & ~PyBUF_F_CONTIGUOUS
  */
 
@@ -35205,59 +35545,62 @@
 static PyObject *__pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview_20copy(struct __pyx_memoryview_obj *__pyx_v_self) {
   __Pyx_memviewslice __pyx_v_mslice;
   int __pyx_v_flags;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_memviewslice __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("copy", 0);
 
-  /* "View.MemoryView":633
+  /* "View.MemoryView":635
  *     def copy(self):
  *         cdef __Pyx_memviewslice mslice
  *         cdef int flags = self.flags & ~PyBUF_F_CONTIGUOUS             # <<<<<<<<<<<<<<
  * 
  *         slice_copy(self, &mslice)
  */
   __pyx_v_flags = (__pyx_v_self->flags & (~PyBUF_F_CONTIGUOUS));
 
-  /* "View.MemoryView":635
+  /* "View.MemoryView":637
  *         cdef int flags = self.flags & ~PyBUF_F_CONTIGUOUS
  * 
  *         slice_copy(self, &mslice)             # <<<<<<<<<<<<<<
  *         mslice = slice_copy_contig(&mslice, "c", self.view.ndim,
  *                                    self.view.itemsize,
  */
   __pyx_memoryview_slice_copy(__pyx_v_self, (&__pyx_v_mslice));
 
-  /* "View.MemoryView":636
+  /* "View.MemoryView":638
  * 
  *         slice_copy(self, &mslice)
  *         mslice = slice_copy_contig(&mslice, "c", self.view.ndim,             # <<<<<<<<<<<<<<
  *                                    self.view.itemsize,
  *                                    flags|PyBUF_C_CONTIGUOUS,
  */
-  __pyx_t_1 = __pyx_memoryview_copy_new_contig((&__pyx_v_mslice), ((char *)"c"), __pyx_v_self->view.ndim, __pyx_v_self->view.itemsize, (__pyx_v_flags | PyBUF_C_CONTIGUOUS), __pyx_v_self->dtype_is_object); if (unlikely(PyErr_Occurred())) __PYX_ERR(1, 636, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_copy_new_contig((&__pyx_v_mslice), ((char *)"c"), __pyx_v_self->view.ndim, __pyx_v_self->view.itemsize, (__pyx_v_flags | PyBUF_C_CONTIGUOUS), __pyx_v_self->dtype_is_object); if (unlikely(PyErr_Occurred())) __PYX_ERR(1, 638, __pyx_L1_error)
   __pyx_v_mslice = __pyx_t_1;
 
-  /* "View.MemoryView":641
+  /* "View.MemoryView":643
  *                                    self.dtype_is_object)
  * 
  *         return memoryview_copy_from_slice(self, &mslice)             # <<<<<<<<<<<<<<
  * 
  *     def copy_fortran(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __pyx_memoryview_copy_object_from_slice(__pyx_v_self, (&__pyx_v_mslice)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 641, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_copy_object_from_slice(__pyx_v_self, (&__pyx_v_mslice)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 643, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":631
+  /* "View.MemoryView":633
  *         return slice_is_contig(mslice[0], 'F', self.view.ndim)
  * 
  *     def copy(self):             # <<<<<<<<<<<<<<
  *         cdef __Pyx_memviewslice mslice
  *         cdef int flags = self.flags & ~PyBUF_F_CONTIGUOUS
  */
 
@@ -35268,15 +35611,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":643
+/* "View.MemoryView":645
  *         return memoryview_copy_from_slice(self, &mslice)
  * 
  *     def copy_fortran(self):             # <<<<<<<<<<<<<<
  *         cdef __Pyx_memviewslice src, dst
  *         cdef int flags = self.flags & ~PyBUF_C_CONTIGUOUS
  */
 
@@ -35297,59 +35640,62 @@
   __Pyx_memviewslice __pyx_v_src;
   __Pyx_memviewslice __pyx_v_dst;
   int __pyx_v_flags;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_memviewslice __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("copy_fortran", 0);
 
-  /* "View.MemoryView":645
+  /* "View.MemoryView":647
  *     def copy_fortran(self):
  *         cdef __Pyx_memviewslice src, dst
  *         cdef int flags = self.flags & ~PyBUF_C_CONTIGUOUS             # <<<<<<<<<<<<<<
  * 
  *         slice_copy(self, &src)
  */
   __pyx_v_flags = (__pyx_v_self->flags & (~PyBUF_C_CONTIGUOUS));
 
-  /* "View.MemoryView":647
+  /* "View.MemoryView":649
  *         cdef int flags = self.flags & ~PyBUF_C_CONTIGUOUS
  * 
  *         slice_copy(self, &src)             # <<<<<<<<<<<<<<
  *         dst = slice_copy_contig(&src, "fortran", self.view.ndim,
  *                                 self.view.itemsize,
  */
   __pyx_memoryview_slice_copy(__pyx_v_self, (&__pyx_v_src));
 
-  /* "View.MemoryView":648
+  /* "View.MemoryView":650
  * 
  *         slice_copy(self, &src)
  *         dst = slice_copy_contig(&src, "fortran", self.view.ndim,             # <<<<<<<<<<<<<<
  *                                 self.view.itemsize,
  *                                 flags|PyBUF_F_CONTIGUOUS,
  */
-  __pyx_t_1 = __pyx_memoryview_copy_new_contig((&__pyx_v_src), ((char *)"fortran"), __pyx_v_self->view.ndim, __pyx_v_self->view.itemsize, (__pyx_v_flags | PyBUF_F_CONTIGUOUS), __pyx_v_self->dtype_is_object); if (unlikely(PyErr_Occurred())) __PYX_ERR(1, 648, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_copy_new_contig((&__pyx_v_src), ((char *)"fortran"), __pyx_v_self->view.ndim, __pyx_v_self->view.itemsize, (__pyx_v_flags | PyBUF_F_CONTIGUOUS), __pyx_v_self->dtype_is_object); if (unlikely(PyErr_Occurred())) __PYX_ERR(1, 650, __pyx_L1_error)
   __pyx_v_dst = __pyx_t_1;
 
-  /* "View.MemoryView":653
+  /* "View.MemoryView":655
  *                                 self.dtype_is_object)
  * 
  *         return memoryview_copy_from_slice(self, &dst)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __pyx_memoryview_copy_object_from_slice(__pyx_v_self, (&__pyx_v_dst)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 653, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_copy_object_from_slice(__pyx_v_self, (&__pyx_v_dst)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 655, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":643
+  /* "View.MemoryView":645
  *         return memoryview_copy_from_slice(self, &mslice)
  * 
  *     def copy_fortran(self):             # <<<<<<<<<<<<<<
  *         cdef __Pyx_memviewslice src, dst
  *         cdef int flags = self.flags & ~PyBUF_C_CONTIGUOUS
  */
 
@@ -35383,14 +35729,17 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf___pyx_memoryview___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reduce_cython__", 0);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
@@ -35437,14 +35786,17 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf___pyx_memoryview_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
@@ -35467,81 +35819,84 @@
   __Pyx_AddTraceback("View.MemoryView.memoryview.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":657
+/* "View.MemoryView":659
  * 
  * @cname('__pyx_memoryview_new')
  * cdef memoryview_cwrapper(object o, int flags, bint dtype_is_object, __Pyx_TypeInfo *typeinfo):             # <<<<<<<<<<<<<<
  *     cdef memoryview result = memoryview(o, flags, dtype_is_object)
  *     result.typeinfo = typeinfo
  */
 
 static PyObject *__pyx_memoryview_new(PyObject *__pyx_v_o, int __pyx_v_flags, int __pyx_v_dtype_is_object, __Pyx_TypeInfo *__pyx_v_typeinfo) {
   struct __pyx_memoryview_obj *__pyx_v_result = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("memoryview_cwrapper", 0);
 
-  /* "View.MemoryView":658
+  /* "View.MemoryView":660
  * @cname('__pyx_memoryview_new')
  * cdef memoryview_cwrapper(object o, int flags, bint dtype_is_object, __Pyx_TypeInfo *typeinfo):
  *     cdef memoryview result = memoryview(o, flags, dtype_is_object)             # <<<<<<<<<<<<<<
  *     result.typeinfo = typeinfo
  *     return result
  */
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_flags); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 658, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_flags); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 660, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_v_dtype_is_object); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 658, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_v_dtype_is_object); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 660, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 658, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 660, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_o);
   __Pyx_GIVEREF(__pyx_v_o);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_o);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_2);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryview_type), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 658, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryview_type), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 660, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_result = ((struct __pyx_memoryview_obj *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "View.MemoryView":659
+  /* "View.MemoryView":661
  * cdef memoryview_cwrapper(object o, int flags, bint dtype_is_object, __Pyx_TypeInfo *typeinfo):
  *     cdef memoryview result = memoryview(o, flags, dtype_is_object)
  *     result.typeinfo = typeinfo             # <<<<<<<<<<<<<<
  *     return result
  * 
  */
   __pyx_v_result->typeinfo = __pyx_v_typeinfo;
 
-  /* "View.MemoryView":660
+  /* "View.MemoryView":662
  *     cdef memoryview result = memoryview(o, flags, dtype_is_object)
  *     result.typeinfo = typeinfo
  *     return result             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_check')
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_result));
   __pyx_r = ((PyObject *)__pyx_v_result);
   goto __pyx_L0;
 
-  /* "View.MemoryView":657
+  /* "View.MemoryView":659
  * 
  * @cname('__pyx_memoryview_new')
  * cdef memoryview_cwrapper(object o, int flags, bint dtype_is_object, __Pyx_TypeInfo *typeinfo):             # <<<<<<<<<<<<<<
  *     cdef memoryview result = memoryview(o, flags, dtype_is_object)
  *     result.typeinfo = typeinfo
  */
 
@@ -35555,54 +35910,54 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_result);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":663
+/* "View.MemoryView":665
  * 
  * @cname('__pyx_memoryview_check')
  * cdef inline bint memoryview_check(object o):             # <<<<<<<<<<<<<<
  *     return isinstance(o, memoryview)
  * 
  */
 
 static CYTHON_INLINE int __pyx_memoryview_check(PyObject *__pyx_v_o) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("memoryview_check", 0);
 
-  /* "View.MemoryView":664
+  /* "View.MemoryView":666
  * @cname('__pyx_memoryview_check')
  * cdef inline bint memoryview_check(object o):
  *     return isinstance(o, memoryview)             # <<<<<<<<<<<<<<
  * 
  * cdef tuple _unellipsify(object index, int ndim):
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_o, __pyx_memoryview_type); 
   __pyx_r = __pyx_t_1;
   goto __pyx_L0;
 
-  /* "View.MemoryView":663
+  /* "View.MemoryView":665
  * 
  * @cname('__pyx_memoryview_check')
  * cdef inline bint memoryview_check(object o):             # <<<<<<<<<<<<<<
  *     return isinstance(o, memoryview)
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":666
+/* "View.MemoryView":668
  *     return isinstance(o, memoryview)
  * 
  * cdef tuple _unellipsify(object index, int ndim):             # <<<<<<<<<<<<<<
  *     """
  *     Replace all ellipses with full slices and fill incomplete indices with
  */
 
@@ -35623,245 +35978,248 @@
   Py_ssize_t __pyx_t_5;
   PyObject *(*__pyx_t_6)(PyObject *);
   PyObject *__pyx_t_7 = NULL;
   Py_ssize_t __pyx_t_8;
   int __pyx_t_9;
   int __pyx_t_10;
   PyObject *__pyx_t_11 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_unellipsify", 0);
 
-  /* "View.MemoryView":671
+  /* "View.MemoryView":673
  *     full slices.
  *     """
  *     if not isinstance(index, tuple):             # <<<<<<<<<<<<<<
  *         tup = (index,)
  *     else:
  */
   __pyx_t_1 = PyTuple_Check(__pyx_v_index); 
   __pyx_t_2 = ((!(__pyx_t_1 != 0)) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":672
+    /* "View.MemoryView":674
  *     """
  *     if not isinstance(index, tuple):
  *         tup = (index,)             # <<<<<<<<<<<<<<
  *     else:
  *         tup = index
  */
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 672, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_index);
     __Pyx_GIVEREF(__pyx_v_index);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_index);
     __pyx_v_tup = __pyx_t_3;
     __pyx_t_3 = 0;
 
-    /* "View.MemoryView":671
+    /* "View.MemoryView":673
  *     full slices.
  *     """
  *     if not isinstance(index, tuple):             # <<<<<<<<<<<<<<
  *         tup = (index,)
  *     else:
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":674
+  /* "View.MemoryView":676
  *         tup = (index,)
  *     else:
  *         tup = index             # <<<<<<<<<<<<<<
  * 
  *     result = []
  */
   /*else*/ {
     __Pyx_INCREF(__pyx_v_index);
     __pyx_v_tup = __pyx_v_index;
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":676
+  /* "View.MemoryView":678
  *         tup = index
  * 
  *     result = []             # <<<<<<<<<<<<<<
  *     have_slices = False
  *     seen_ellipsis = False
  */
-  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 676, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v_result = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "View.MemoryView":677
+  /* "View.MemoryView":679
  * 
  *     result = []
  *     have_slices = False             # <<<<<<<<<<<<<<
  *     seen_ellipsis = False
  *     for idx, item in enumerate(tup):
  */
   __pyx_v_have_slices = 0;
 
-  /* "View.MemoryView":678
+  /* "View.MemoryView":680
  *     result = []
  *     have_slices = False
  *     seen_ellipsis = False             # <<<<<<<<<<<<<<
  *     for idx, item in enumerate(tup):
  *         if item is Ellipsis:
  */
   __pyx_v_seen_ellipsis = 0;
 
-  /* "View.MemoryView":679
+  /* "View.MemoryView":681
  *     have_slices = False
  *     seen_ellipsis = False
  *     for idx, item in enumerate(tup):             # <<<<<<<<<<<<<<
  *         if item is Ellipsis:
  *             if not seen_ellipsis:
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_t_3 = __pyx_int_0;
   if (likely(PyList_CheckExact(__pyx_v_tup)) || PyTuple_CheckExact(__pyx_v_tup)) {
     __pyx_t_4 = __pyx_v_tup; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
     __pyx_t_6 = NULL;
   } else {
-    __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_tup); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 679, __pyx_L1_error)
+    __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_tup); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 681, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 679, __pyx_L1_error)
+    __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 681, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_6)) {
       if (likely(PyList_CheckExact(__pyx_t_4))) {
         if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(1, 679, __pyx_L1_error)
+        __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(1, 681, __pyx_L1_error)
         #else
-        __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 679, __pyx_L1_error)
+        __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 681, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         #endif
       } else {
         if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(1, 679, __pyx_L1_error)
+        __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(1, 681, __pyx_L1_error)
         #else
-        __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 679, __pyx_L1_error)
+        __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 681, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         #endif
       }
     } else {
       __pyx_t_7 = __pyx_t_6(__pyx_t_4);
       if (unlikely(!__pyx_t_7)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(1, 679, __pyx_L1_error)
+          else __PYX_ERR(1, 681, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_7);
     }
     __Pyx_XDECREF_SET(__pyx_v_item, __pyx_t_7);
     __pyx_t_7 = 0;
     __Pyx_INCREF(__pyx_t_3);
     __Pyx_XDECREF_SET(__pyx_v_idx, __pyx_t_3);
-    __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 679, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 681, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3);
     __pyx_t_3 = __pyx_t_7;
     __pyx_t_7 = 0;
 
-    /* "View.MemoryView":680
+    /* "View.MemoryView":682
  *     seen_ellipsis = False
  *     for idx, item in enumerate(tup):
  *         if item is Ellipsis:             # <<<<<<<<<<<<<<
  *             if not seen_ellipsis:
  *                 result.extend([slice(None)] * (ndim - len(tup) + 1))
  */
     __pyx_t_2 = (__pyx_v_item == __pyx_builtin_Ellipsis);
     __pyx_t_1 = (__pyx_t_2 != 0);
     if (__pyx_t_1) {
 
-      /* "View.MemoryView":681
+      /* "View.MemoryView":683
  *     for idx, item in enumerate(tup):
  *         if item is Ellipsis:
  *             if not seen_ellipsis:             # <<<<<<<<<<<<<<
  *                 result.extend([slice(None)] * (ndim - len(tup) + 1))
  *                 seen_ellipsis = True
  */
       __pyx_t_1 = ((!(__pyx_v_seen_ellipsis != 0)) != 0);
       if (__pyx_t_1) {
 
-        /* "View.MemoryView":682
+        /* "View.MemoryView":684
  *         if item is Ellipsis:
  *             if not seen_ellipsis:
  *                 result.extend([slice(None)] * (ndim - len(tup) + 1))             # <<<<<<<<<<<<<<
  *                 seen_ellipsis = True
  *             else:
  */
-        __pyx_t_8 = PyObject_Length(__pyx_v_tup); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(1, 682, __pyx_L1_error)
-        __pyx_t_7 = PyList_New(1 * ((((__pyx_v_ndim - __pyx_t_8) + 1)<0) ? 0:((__pyx_v_ndim - __pyx_t_8) + 1))); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 682, __pyx_L1_error)
+        __pyx_t_8 = PyObject_Length(__pyx_v_tup); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(1, 684, __pyx_L1_error)
+        __pyx_t_7 = PyList_New(1 * ((((__pyx_v_ndim - __pyx_t_8) + 1)<0) ? 0:((__pyx_v_ndim - __pyx_t_8) + 1))); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 684, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         { Py_ssize_t __pyx_temp;
           for (__pyx_temp=0; __pyx_temp < ((__pyx_v_ndim - __pyx_t_8) + 1); __pyx_temp++) {
             __Pyx_INCREF(__pyx_slice__25);
             __Pyx_GIVEREF(__pyx_slice__25);
             PyList_SET_ITEM(__pyx_t_7, __pyx_temp, __pyx_slice__25);
           }
         }
-        __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_7); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 682, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_7); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 684, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-        /* "View.MemoryView":683
+        /* "View.MemoryView":685
  *             if not seen_ellipsis:
  *                 result.extend([slice(None)] * (ndim - len(tup) + 1))
  *                 seen_ellipsis = True             # <<<<<<<<<<<<<<
  *             else:
  *                 result.append(slice(None))
  */
         __pyx_v_seen_ellipsis = 1;
 
-        /* "View.MemoryView":681
+        /* "View.MemoryView":683
  *     for idx, item in enumerate(tup):
  *         if item is Ellipsis:
  *             if not seen_ellipsis:             # <<<<<<<<<<<<<<
  *                 result.extend([slice(None)] * (ndim - len(tup) + 1))
  *                 seen_ellipsis = True
  */
         goto __pyx_L7;
       }
 
-      /* "View.MemoryView":685
+      /* "View.MemoryView":687
  *                 seen_ellipsis = True
  *             else:
  *                 result.append(slice(None))             # <<<<<<<<<<<<<<
  *             have_slices = True
  *         else:
  */
       /*else*/ {
-        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_slice__25); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 685, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_slice__25); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 687, __pyx_L1_error)
       }
       __pyx_L7:;
 
-      /* "View.MemoryView":686
+      /* "View.MemoryView":688
  *             else:
  *                 result.append(slice(None))
  *             have_slices = True             # <<<<<<<<<<<<<<
  *         else:
  *             if not isinstance(item, slice) and not PyIndex_Check(item):
  */
       __pyx_v_have_slices = 1;
 
-      /* "View.MemoryView":680
+      /* "View.MemoryView":682
  *     seen_ellipsis = False
  *     for idx, item in enumerate(tup):
  *         if item is Ellipsis:             # <<<<<<<<<<<<<<
  *             if not seen_ellipsis:
  *                 result.extend([slice(None)] * (ndim - len(tup) + 1))
  */
       goto __pyx_L6;
     }
 
-    /* "View.MemoryView":688
+    /* "View.MemoryView":690
  *             have_slices = True
  *         else:
  *             if not isinstance(item, slice) and not PyIndex_Check(item):             # <<<<<<<<<<<<<<
  *                 raise TypeError("Cannot index with type '%s'" % type(item))
  * 
  */
     /*else*/ {
@@ -35873,40 +36231,40 @@
         goto __pyx_L9_bool_binop_done;
       }
       __pyx_t_10 = ((!(PyIndex_Check(__pyx_v_item) != 0)) != 0);
       __pyx_t_1 = __pyx_t_10;
       __pyx_L9_bool_binop_done:;
       if (unlikely(__pyx_t_1)) {
 
-        /* "View.MemoryView":689
+        /* "View.MemoryView":691
  *         else:
  *             if not isinstance(item, slice) and not PyIndex_Check(item):
  *                 raise TypeError("Cannot index with type '%s'" % type(item))             # <<<<<<<<<<<<<<
  * 
  *             have_slices = have_slices or isinstance(item, slice)
  */
-        __pyx_t_7 = __Pyx_PyString_FormatSafe(__pyx_kp_s_Cannot_index_with_type_s, ((PyObject *)Py_TYPE(__pyx_v_item))); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 689, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyString_FormatSafe(__pyx_kp_s_Cannot_index_with_type_s, ((PyObject *)Py_TYPE(__pyx_v_item))); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 691, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 689, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 691, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_Raise(__pyx_t_11, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __PYX_ERR(1, 689, __pyx_L1_error)
+        __PYX_ERR(1, 691, __pyx_L1_error)
 
-        /* "View.MemoryView":688
+        /* "View.MemoryView":690
  *             have_slices = True
  *         else:
  *             if not isinstance(item, slice) and not PyIndex_Check(item):             # <<<<<<<<<<<<<<
  *                 raise TypeError("Cannot index with type '%s'" % type(item))
  * 
  */
       }
 
-      /* "View.MemoryView":691
+      /* "View.MemoryView":693
  *                 raise TypeError("Cannot index with type '%s'" % type(item))
  * 
  *             have_slices = have_slices or isinstance(item, slice)             # <<<<<<<<<<<<<<
  *             result.append(item)
  * 
  */
       __pyx_t_10 = (__pyx_v_have_slices != 0);
@@ -35917,120 +36275,120 @@
       }
       __pyx_t_10 = PySlice_Check(__pyx_v_item); 
       __pyx_t_2 = (__pyx_t_10 != 0);
       __pyx_t_1 = __pyx_t_2;
       __pyx_L11_bool_binop_done:;
       __pyx_v_have_slices = __pyx_t_1;
 
-      /* "View.MemoryView":692
+      /* "View.MemoryView":694
  * 
  *             have_slices = have_slices or isinstance(item, slice)
  *             result.append(item)             # <<<<<<<<<<<<<<
  * 
  *     nslices = ndim - len(result)
  */
-      __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_v_item); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 692, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_v_item); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 694, __pyx_L1_error)
     }
     __pyx_L6:;
 
-    /* "View.MemoryView":679
+    /* "View.MemoryView":681
  *     have_slices = False
  *     seen_ellipsis = False
  *     for idx, item in enumerate(tup):             # <<<<<<<<<<<<<<
  *         if item is Ellipsis:
  *             if not seen_ellipsis:
  */
   }
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "View.MemoryView":694
+  /* "View.MemoryView":696
  *             result.append(item)
  * 
  *     nslices = ndim - len(result)             # <<<<<<<<<<<<<<
  *     if nslices:
  *         result.extend([slice(None)] * nslices)
  */
-  __pyx_t_5 = PyList_GET_SIZE(__pyx_v_result); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(1, 694, __pyx_L1_error)
+  __pyx_t_5 = PyList_GET_SIZE(__pyx_v_result); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(1, 696, __pyx_L1_error)
   __pyx_v_nslices = (__pyx_v_ndim - __pyx_t_5);
 
-  /* "View.MemoryView":695
+  /* "View.MemoryView":697
  * 
  *     nslices = ndim - len(result)
  *     if nslices:             # <<<<<<<<<<<<<<
  *         result.extend([slice(None)] * nslices)
  * 
  */
   __pyx_t_1 = (__pyx_v_nslices != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":696
+    /* "View.MemoryView":698
  *     nslices = ndim - len(result)
  *     if nslices:
  *         result.extend([slice(None)] * nslices)             # <<<<<<<<<<<<<<
  * 
  *     return have_slices or nslices, tuple(result)
  */
-    __pyx_t_3 = PyList_New(1 * ((__pyx_v_nslices<0) ? 0:__pyx_v_nslices)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 696, __pyx_L1_error)
+    __pyx_t_3 = PyList_New(1 * ((__pyx_v_nslices<0) ? 0:__pyx_v_nslices)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     { Py_ssize_t __pyx_temp;
       for (__pyx_temp=0; __pyx_temp < __pyx_v_nslices; __pyx_temp++) {
         __Pyx_INCREF(__pyx_slice__25);
         __Pyx_GIVEREF(__pyx_slice__25);
         PyList_SET_ITEM(__pyx_t_3, __pyx_temp, __pyx_slice__25);
       }
     }
-    __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 696, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 698, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "View.MemoryView":695
+    /* "View.MemoryView":697
  * 
  *     nslices = ndim - len(result)
  *     if nslices:             # <<<<<<<<<<<<<<
  *         result.extend([slice(None)] * nslices)
  * 
  */
   }
 
-  /* "View.MemoryView":698
+  /* "View.MemoryView":700
  *         result.extend([slice(None)] * nslices)
  * 
  *     return have_slices or nslices, tuple(result)             # <<<<<<<<<<<<<<
  * 
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):
  */
   __Pyx_XDECREF(__pyx_r);
   if (!__pyx_v_have_slices) {
   } else {
-    __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_have_slices); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 698, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_have_slices); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 700, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = __pyx_t_4;
     __pyx_t_4 = 0;
     goto __pyx_L14_bool_binop_done;
   }
-  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_nslices); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 698, __pyx_L1_error)
+  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_nslices); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = __pyx_t_4;
   __pyx_t_4 = 0;
   __pyx_L14_bool_binop_done:;
-  __pyx_t_4 = PyList_AsTuple(__pyx_v_result); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 698, __pyx_L1_error)
+  __pyx_t_4 = PyList_AsTuple(__pyx_v_result); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 698, __pyx_L1_error)
+  __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_t_4);
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
   __pyx_r = ((PyObject*)__pyx_t_11);
   __pyx_t_11 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":666
+  /* "View.MemoryView":668
  *     return isinstance(o, memoryview)
  * 
  * cdef tuple _unellipsify(object index, int ndim):             # <<<<<<<<<<<<<<
  *     """
  *     Replace all ellipses with full slices and fill incomplete indices with
  */
 
@@ -36048,15 +36406,15 @@
   __Pyx_XDECREF(__pyx_v_idx);
   __Pyx_XDECREF(__pyx_v_item);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":700
+/* "View.MemoryView":702
  *     return have_slices or nslices, tuple(result)
  * 
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):             # <<<<<<<<<<<<<<
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  */
 
@@ -36065,62 +36423,65 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   Py_ssize_t *__pyx_t_1;
   Py_ssize_t *__pyx_t_2;
   Py_ssize_t *__pyx_t_3;
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("assert_direct_dimensions", 0);
 
-  /* "View.MemoryView":701
+  /* "View.MemoryView":703
  * 
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):
  *     for suboffset in suboffsets[:ndim]:             # <<<<<<<<<<<<<<
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")
  */
   __pyx_t_2 = (__pyx_v_suboffsets + __pyx_v_ndim);
   for (__pyx_t_3 = __pyx_v_suboffsets; __pyx_t_3 < __pyx_t_2; __pyx_t_3++) {
     __pyx_t_1 = __pyx_t_3;
     __pyx_v_suboffset = (__pyx_t_1[0]);
 
-    /* "View.MemoryView":702
+    /* "View.MemoryView":704
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:             # <<<<<<<<<<<<<<
  *             raise ValueError("Indirect dimensions not supported")
  * 
  */
     __pyx_t_4 = ((__pyx_v_suboffset >= 0) != 0);
     if (unlikely(__pyx_t_4)) {
 
-      /* "View.MemoryView":703
+      /* "View.MemoryView":705
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 703, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 705, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_Raise(__pyx_t_5, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __PYX_ERR(1, 703, __pyx_L1_error)
+      __PYX_ERR(1, 705, __pyx_L1_error)
 
-      /* "View.MemoryView":702
+      /* "View.MemoryView":704
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:             # <<<<<<<<<<<<<<
  *             raise ValueError("Indirect dimensions not supported")
  * 
  */
     }
   }
 
-  /* "View.MemoryView":700
+  /* "View.MemoryView":702
  *     return have_slices or nslices, tuple(result)
  * 
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):             # <<<<<<<<<<<<<<
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  */
 
@@ -36133,15 +36494,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":710
+/* "View.MemoryView":712
  * 
  * @cname('__pyx_memview_slice')
  * cdef memoryview memview_slice(memoryview memview, object indices):             # <<<<<<<<<<<<<<
  *     cdef int new_ndim = 0, suboffset_dim = -1, dim
  *     cdef bint negative_step
  */
 
@@ -36172,531 +36533,534 @@
   int __pyx_t_6;
   Py_ssize_t __pyx_t_7;
   PyObject *(*__pyx_t_8)(PyObject *);
   PyObject *__pyx_t_9 = NULL;
   Py_ssize_t __pyx_t_10;
   int __pyx_t_11;
   Py_ssize_t __pyx_t_12;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("memview_slice", 0);
 
-  /* "View.MemoryView":711
+  /* "View.MemoryView":713
  * @cname('__pyx_memview_slice')
  * cdef memoryview memview_slice(memoryview memview, object indices):
  *     cdef int new_ndim = 0, suboffset_dim = -1, dim             # <<<<<<<<<<<<<<
  *     cdef bint negative_step
  *     cdef __Pyx_memviewslice src, dst
  */
   __pyx_v_new_ndim = 0;
   __pyx_v_suboffset_dim = -1;
 
-  /* "View.MemoryView":718
+  /* "View.MemoryView":720
  * 
  * 
  *     memset(&dst, 0, sizeof(dst))             # <<<<<<<<<<<<<<
  * 
  *     cdef _memoryviewslice memviewsliceobj
  */
   (void)(memset((&__pyx_v_dst), 0, (sizeof(__pyx_v_dst))));
 
-  /* "View.MemoryView":722
+  /* "View.MemoryView":724
  *     cdef _memoryviewslice memviewsliceobj
  * 
  *     assert memview.view.ndim > 0             # <<<<<<<<<<<<<<
  * 
  *     if isinstance(memview, _memoryviewslice):
  */
   #ifndef CYTHON_WITHOUT_ASSERTIONS
   if (unlikely(!Py_OptimizeFlag)) {
     if (unlikely(!((__pyx_v_memview->view.ndim > 0) != 0))) {
       PyErr_SetNone(PyExc_AssertionError);
-      __PYX_ERR(1, 722, __pyx_L1_error)
+      __PYX_ERR(1, 724, __pyx_L1_error)
     }
   }
   #endif
 
-  /* "View.MemoryView":724
+  /* "View.MemoryView":726
  *     assert memview.view.ndim > 0
  * 
  *     if isinstance(memview, _memoryviewslice):             # <<<<<<<<<<<<<<
  *         memviewsliceobj = memview
  *         p_src = &memviewsliceobj.from_slice
  */
   __pyx_t_1 = __Pyx_TypeCheck(((PyObject *)__pyx_v_memview), __pyx_memoryviewslice_type); 
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":725
+    /* "View.MemoryView":727
  * 
  *     if isinstance(memview, _memoryviewslice):
  *         memviewsliceobj = memview             # <<<<<<<<<<<<<<
  *         p_src = &memviewsliceobj.from_slice
  *     else:
  */
-    if (!(likely(((((PyObject *)__pyx_v_memview)) == Py_None) || likely(__Pyx_TypeTest(((PyObject *)__pyx_v_memview), __pyx_memoryviewslice_type))))) __PYX_ERR(1, 725, __pyx_L1_error)
+    if (!(likely(((((PyObject *)__pyx_v_memview)) == Py_None) || likely(__Pyx_TypeTest(((PyObject *)__pyx_v_memview), __pyx_memoryviewslice_type))))) __PYX_ERR(1, 727, __pyx_L1_error)
     __pyx_t_3 = ((PyObject *)__pyx_v_memview);
     __Pyx_INCREF(__pyx_t_3);
     __pyx_v_memviewsliceobj = ((struct __pyx_memoryviewslice_obj *)__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "View.MemoryView":726
+    /* "View.MemoryView":728
  *     if isinstance(memview, _memoryviewslice):
  *         memviewsliceobj = memview
  *         p_src = &memviewsliceobj.from_slice             # <<<<<<<<<<<<<<
  *     else:
  *         slice_copy(memview, &src)
  */
     __pyx_v_p_src = (&__pyx_v_memviewsliceobj->from_slice);
 
-    /* "View.MemoryView":724
+    /* "View.MemoryView":726
  *     assert memview.view.ndim > 0
  * 
  *     if isinstance(memview, _memoryviewslice):             # <<<<<<<<<<<<<<
  *         memviewsliceobj = memview
  *         p_src = &memviewsliceobj.from_slice
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":728
+  /* "View.MemoryView":730
  *         p_src = &memviewsliceobj.from_slice
  *     else:
  *         slice_copy(memview, &src)             # <<<<<<<<<<<<<<
  *         p_src = &src
  * 
  */
   /*else*/ {
     __pyx_memoryview_slice_copy(__pyx_v_memview, (&__pyx_v_src));
 
-    /* "View.MemoryView":729
+    /* "View.MemoryView":731
  *     else:
  *         slice_copy(memview, &src)
  *         p_src = &src             # <<<<<<<<<<<<<<
  * 
  * 
  */
     __pyx_v_p_src = (&__pyx_v_src);
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":735
+  /* "View.MemoryView":737
  * 
  * 
  *     dst.memview = p_src.memview             # <<<<<<<<<<<<<<
  *     dst.data = p_src.data
  * 
  */
   __pyx_t_4 = __pyx_v_p_src->memview;
   __pyx_v_dst.memview = __pyx_t_4;
 
-  /* "View.MemoryView":736
+  /* "View.MemoryView":738
  * 
  *     dst.memview = p_src.memview
  *     dst.data = p_src.data             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_5 = __pyx_v_p_src->data;
   __pyx_v_dst.data = __pyx_t_5;
 
-  /* "View.MemoryView":741
+  /* "View.MemoryView":743
  * 
  * 
  *     cdef __Pyx_memviewslice *p_dst = &dst             # <<<<<<<<<<<<<<
  *     cdef int *p_suboffset_dim = &suboffset_dim
  *     cdef Py_ssize_t start, stop, step
  */
   __pyx_v_p_dst = (&__pyx_v_dst);
 
-  /* "View.MemoryView":742
+  /* "View.MemoryView":744
  * 
  *     cdef __Pyx_memviewslice *p_dst = &dst
  *     cdef int *p_suboffset_dim = &suboffset_dim             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t start, stop, step
  *     cdef bint have_start, have_stop, have_step
  */
   __pyx_v_p_suboffset_dim = (&__pyx_v_suboffset_dim);
 
-  /* "View.MemoryView":746
+  /* "View.MemoryView":748
  *     cdef bint have_start, have_stop, have_step
  * 
  *     for dim, index in enumerate(indices):             # <<<<<<<<<<<<<<
  *         if PyIndex_Check(index):
  *             slice_memviewslice(
  */
   __pyx_t_6 = 0;
   if (likely(PyList_CheckExact(__pyx_v_indices)) || PyTuple_CheckExact(__pyx_v_indices)) {
     __pyx_t_3 = __pyx_v_indices; __Pyx_INCREF(__pyx_t_3); __pyx_t_7 = 0;
     __pyx_t_8 = NULL;
   } else {
-    __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_indices); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 746, __pyx_L1_error)
+    __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_indices); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_8 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 746, __pyx_L1_error)
+    __pyx_t_8 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 748, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_8)) {
       if (likely(PyList_CheckExact(__pyx_t_3))) {
         if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_9 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(1, 746, __pyx_L1_error)
+        __pyx_t_9 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(1, 748, __pyx_L1_error)
         #else
-        __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 746, __pyx_L1_error)
+        __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 748, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         #endif
       } else {
         if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(1, 746, __pyx_L1_error)
+        __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(1, 748, __pyx_L1_error)
         #else
-        __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 746, __pyx_L1_error)
+        __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 748, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         #endif
       }
     } else {
       __pyx_t_9 = __pyx_t_8(__pyx_t_3);
       if (unlikely(!__pyx_t_9)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(1, 746, __pyx_L1_error)
+          else __PYX_ERR(1, 748, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_9);
     }
     __Pyx_XDECREF_SET(__pyx_v_index, __pyx_t_9);
     __pyx_t_9 = 0;
     __pyx_v_dim = __pyx_t_6;
     __pyx_t_6 = (__pyx_t_6 + 1);
 
-    /* "View.MemoryView":747
+    /* "View.MemoryView":749
  * 
  *     for dim, index in enumerate(indices):
  *         if PyIndex_Check(index):             # <<<<<<<<<<<<<<
  *             slice_memviewslice(
  *                 p_dst, p_src.shape[dim], p_src.strides[dim], p_src.suboffsets[dim],
  */
     __pyx_t_2 = (PyIndex_Check(__pyx_v_index) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":751
+      /* "View.MemoryView":753
  *                 p_dst, p_src.shape[dim], p_src.strides[dim], p_src.suboffsets[dim],
  *                 dim, new_ndim, p_suboffset_dim,
  *                 index, 0, 0, # start, stop, step             # <<<<<<<<<<<<<<
  *                 0, 0, 0, # have_{start,stop,step}
  *                 False)
  */
-      __pyx_t_10 = __Pyx_PyIndex_AsSsize_t(__pyx_v_index); if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 751, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyIndex_AsSsize_t(__pyx_v_index); if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 753, __pyx_L1_error)
 
-      /* "View.MemoryView":748
+      /* "View.MemoryView":750
  *     for dim, index in enumerate(indices):
  *         if PyIndex_Check(index):
  *             slice_memviewslice(             # <<<<<<<<<<<<<<
  *                 p_dst, p_src.shape[dim], p_src.strides[dim], p_src.suboffsets[dim],
  *                 dim, new_ndim, p_suboffset_dim,
  */
-      __pyx_t_11 = __pyx_memoryview_slice_memviewslice(__pyx_v_p_dst, (__pyx_v_p_src->shape[__pyx_v_dim]), (__pyx_v_p_src->strides[__pyx_v_dim]), (__pyx_v_p_src->suboffsets[__pyx_v_dim]), __pyx_v_dim, __pyx_v_new_ndim, __pyx_v_p_suboffset_dim, __pyx_t_10, 0, 0, 0, 0, 0, 0); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(1, 748, __pyx_L1_error)
+      __pyx_t_11 = __pyx_memoryview_slice_memviewslice(__pyx_v_p_dst, (__pyx_v_p_src->shape[__pyx_v_dim]), (__pyx_v_p_src->strides[__pyx_v_dim]), (__pyx_v_p_src->suboffsets[__pyx_v_dim]), __pyx_v_dim, __pyx_v_new_ndim, __pyx_v_p_suboffset_dim, __pyx_t_10, 0, 0, 0, 0, 0, 0); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(1, 750, __pyx_L1_error)
 
-      /* "View.MemoryView":747
+      /* "View.MemoryView":749
  * 
  *     for dim, index in enumerate(indices):
  *         if PyIndex_Check(index):             # <<<<<<<<<<<<<<
  *             slice_memviewslice(
  *                 p_dst, p_src.shape[dim], p_src.strides[dim], p_src.suboffsets[dim],
  */
       goto __pyx_L6;
     }
 
-    /* "View.MemoryView":754
+    /* "View.MemoryView":756
  *                 0, 0, 0, # have_{start,stop,step}
  *                 False)
  *         elif index is None:             # <<<<<<<<<<<<<<
  *             p_dst.shape[new_ndim] = 1
  *             p_dst.strides[new_ndim] = 0
  */
     __pyx_t_2 = (__pyx_v_index == Py_None);
     __pyx_t_1 = (__pyx_t_2 != 0);
     if (__pyx_t_1) {
 
-      /* "View.MemoryView":755
+      /* "View.MemoryView":757
  *                 False)
  *         elif index is None:
  *             p_dst.shape[new_ndim] = 1             # <<<<<<<<<<<<<<
  *             p_dst.strides[new_ndim] = 0
  *             p_dst.suboffsets[new_ndim] = -1
  */
       (__pyx_v_p_dst->shape[__pyx_v_new_ndim]) = 1;
 
-      /* "View.MemoryView":756
+      /* "View.MemoryView":758
  *         elif index is None:
  *             p_dst.shape[new_ndim] = 1
  *             p_dst.strides[new_ndim] = 0             # <<<<<<<<<<<<<<
  *             p_dst.suboffsets[new_ndim] = -1
  *             new_ndim += 1
  */
       (__pyx_v_p_dst->strides[__pyx_v_new_ndim]) = 0;
 
-      /* "View.MemoryView":757
+      /* "View.MemoryView":759
  *             p_dst.shape[new_ndim] = 1
  *             p_dst.strides[new_ndim] = 0
  *             p_dst.suboffsets[new_ndim] = -1             # <<<<<<<<<<<<<<
  *             new_ndim += 1
  *         else:
  */
       (__pyx_v_p_dst->suboffsets[__pyx_v_new_ndim]) = -1L;
 
-      /* "View.MemoryView":758
+      /* "View.MemoryView":760
  *             p_dst.strides[new_ndim] = 0
  *             p_dst.suboffsets[new_ndim] = -1
  *             new_ndim += 1             # <<<<<<<<<<<<<<
  *         else:
  *             start = index.start or 0
  */
       __pyx_v_new_ndim = (__pyx_v_new_ndim + 1);
 
-      /* "View.MemoryView":754
+      /* "View.MemoryView":756
  *                 0, 0, 0, # have_{start,stop,step}
  *                 False)
  *         elif index is None:             # <<<<<<<<<<<<<<
  *             p_dst.shape[new_ndim] = 1
  *             p_dst.strides[new_ndim] = 0
  */
       goto __pyx_L6;
     }
 
-    /* "View.MemoryView":760
+    /* "View.MemoryView":762
  *             new_ndim += 1
  *         else:
  *             start = index.start or 0             # <<<<<<<<<<<<<<
  *             stop = index.stop or 0
  *             step = index.step or 0
  */
     /*else*/ {
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_start); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 760, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_start); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 762, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 760, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 762, __pyx_L1_error)
       if (!__pyx_t_1) {
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       } else {
-        __pyx_t_12 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 760, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 762, __pyx_L1_error)
         __pyx_t_10 = __pyx_t_12;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         goto __pyx_L7_bool_binop_done;
       }
       __pyx_t_10 = 0;
       __pyx_L7_bool_binop_done:;
       __pyx_v_start = __pyx_t_10;
 
-      /* "View.MemoryView":761
+      /* "View.MemoryView":763
  *         else:
  *             start = index.start or 0
  *             stop = index.stop or 0             # <<<<<<<<<<<<<<
  *             step = index.step or 0
  * 
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_stop); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 761, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_stop); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 763, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 761, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 763, __pyx_L1_error)
       if (!__pyx_t_1) {
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       } else {
-        __pyx_t_12 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 761, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 763, __pyx_L1_error)
         __pyx_t_10 = __pyx_t_12;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         goto __pyx_L9_bool_binop_done;
       }
       __pyx_t_10 = 0;
       __pyx_L9_bool_binop_done:;
       __pyx_v_stop = __pyx_t_10;
 
-      /* "View.MemoryView":762
+      /* "View.MemoryView":764
  *             start = index.start or 0
  *             stop = index.stop or 0
  *             step = index.step or 0             # <<<<<<<<<<<<<<
  * 
  *             have_start = index.start is not None
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_step); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 762, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_step); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 764, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 762, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 764, __pyx_L1_error)
       if (!__pyx_t_1) {
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       } else {
-        __pyx_t_12 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 762, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 764, __pyx_L1_error)
         __pyx_t_10 = __pyx_t_12;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         goto __pyx_L11_bool_binop_done;
       }
       __pyx_t_10 = 0;
       __pyx_L11_bool_binop_done:;
       __pyx_v_step = __pyx_t_10;
 
-      /* "View.MemoryView":764
+      /* "View.MemoryView":766
  *             step = index.step or 0
  * 
  *             have_start = index.start is not None             # <<<<<<<<<<<<<<
  *             have_stop = index.stop is not None
  *             have_step = index.step is not None
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_start); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 764, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_start); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 766, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __pyx_t_1 = (__pyx_t_9 != Py_None);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __pyx_v_have_start = __pyx_t_1;
 
-      /* "View.MemoryView":765
+      /* "View.MemoryView":767
  * 
  *             have_start = index.start is not None
  *             have_stop = index.stop is not None             # <<<<<<<<<<<<<<
  *             have_step = index.step is not None
  * 
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_stop); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 765, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_stop); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 767, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __pyx_t_1 = (__pyx_t_9 != Py_None);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __pyx_v_have_stop = __pyx_t_1;
 
-      /* "View.MemoryView":766
+      /* "View.MemoryView":768
  *             have_start = index.start is not None
  *             have_stop = index.stop is not None
  *             have_step = index.step is not None             # <<<<<<<<<<<<<<
  * 
  *             slice_memviewslice(
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_step); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 766, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_step); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 768, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __pyx_t_1 = (__pyx_t_9 != Py_None);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __pyx_v_have_step = __pyx_t_1;
 
-      /* "View.MemoryView":768
+      /* "View.MemoryView":770
  *             have_step = index.step is not None
  * 
  *             slice_memviewslice(             # <<<<<<<<<<<<<<
  *                 p_dst, p_src.shape[dim], p_src.strides[dim], p_src.suboffsets[dim],
  *                 dim, new_ndim, p_suboffset_dim,
  */
-      __pyx_t_11 = __pyx_memoryview_slice_memviewslice(__pyx_v_p_dst, (__pyx_v_p_src->shape[__pyx_v_dim]), (__pyx_v_p_src->strides[__pyx_v_dim]), (__pyx_v_p_src->suboffsets[__pyx_v_dim]), __pyx_v_dim, __pyx_v_new_ndim, __pyx_v_p_suboffset_dim, __pyx_v_start, __pyx_v_stop, __pyx_v_step, __pyx_v_have_start, __pyx_v_have_stop, __pyx_v_have_step, 1); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(1, 768, __pyx_L1_error)
+      __pyx_t_11 = __pyx_memoryview_slice_memviewslice(__pyx_v_p_dst, (__pyx_v_p_src->shape[__pyx_v_dim]), (__pyx_v_p_src->strides[__pyx_v_dim]), (__pyx_v_p_src->suboffsets[__pyx_v_dim]), __pyx_v_dim, __pyx_v_new_ndim, __pyx_v_p_suboffset_dim, __pyx_v_start, __pyx_v_stop, __pyx_v_step, __pyx_v_have_start, __pyx_v_have_stop, __pyx_v_have_step, 1); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(1, 770, __pyx_L1_error)
 
-      /* "View.MemoryView":774
+      /* "View.MemoryView":776
  *                 have_start, have_stop, have_step,
  *                 True)
  *             new_ndim += 1             # <<<<<<<<<<<<<<
  * 
  *     if isinstance(memview, _memoryviewslice):
  */
       __pyx_v_new_ndim = (__pyx_v_new_ndim + 1);
     }
     __pyx_L6:;
 
-    /* "View.MemoryView":746
+    /* "View.MemoryView":748
  *     cdef bint have_start, have_stop, have_step
  * 
  *     for dim, index in enumerate(indices):             # <<<<<<<<<<<<<<
  *         if PyIndex_Check(index):
  *             slice_memviewslice(
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "View.MemoryView":776
+  /* "View.MemoryView":778
  *             new_ndim += 1
  * 
  *     if isinstance(memview, _memoryviewslice):             # <<<<<<<<<<<<<<
  *         return memoryview_fromslice(dst, new_ndim,
  *                                     memviewsliceobj.to_object_func,
  */
   __pyx_t_1 = __Pyx_TypeCheck(((PyObject *)__pyx_v_memview), __pyx_memoryviewslice_type); 
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":777
+    /* "View.MemoryView":779
  * 
  *     if isinstance(memview, _memoryviewslice):
  *         return memoryview_fromslice(dst, new_ndim,             # <<<<<<<<<<<<<<
  *                                     memviewsliceobj.to_object_func,
  *                                     memviewsliceobj.to_dtype_func,
  */
     __Pyx_XDECREF(((PyObject *)__pyx_r));
 
-    /* "View.MemoryView":778
+    /* "View.MemoryView":780
  *     if isinstance(memview, _memoryviewslice):
  *         return memoryview_fromslice(dst, new_ndim,
  *                                     memviewsliceobj.to_object_func,             # <<<<<<<<<<<<<<
  *                                     memviewsliceobj.to_dtype_func,
  *                                     memview.dtype_is_object)
  */
-    if (unlikely(!__pyx_v_memviewsliceobj)) { __Pyx_RaiseUnboundLocalError("memviewsliceobj"); __PYX_ERR(1, 778, __pyx_L1_error) }
+    if (unlikely(!__pyx_v_memviewsliceobj)) { __Pyx_RaiseUnboundLocalError("memviewsliceobj"); __PYX_ERR(1, 780, __pyx_L1_error) }
 
-    /* "View.MemoryView":779
+    /* "View.MemoryView":781
  *         return memoryview_fromslice(dst, new_ndim,
  *                                     memviewsliceobj.to_object_func,
  *                                     memviewsliceobj.to_dtype_func,             # <<<<<<<<<<<<<<
  *                                     memview.dtype_is_object)
  *     else:
  */
-    if (unlikely(!__pyx_v_memviewsliceobj)) { __Pyx_RaiseUnboundLocalError("memviewsliceobj"); __PYX_ERR(1, 779, __pyx_L1_error) }
+    if (unlikely(!__pyx_v_memviewsliceobj)) { __Pyx_RaiseUnboundLocalError("memviewsliceobj"); __PYX_ERR(1, 781, __pyx_L1_error) }
 
-    /* "View.MemoryView":777
+    /* "View.MemoryView":779
  * 
  *     if isinstance(memview, _memoryviewslice):
  *         return memoryview_fromslice(dst, new_ndim,             # <<<<<<<<<<<<<<
  *                                     memviewsliceobj.to_object_func,
  *                                     memviewsliceobj.to_dtype_func,
  */
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_dst, __pyx_v_new_ndim, __pyx_v_memviewsliceobj->to_object_func, __pyx_v_memviewsliceobj->to_dtype_func, __pyx_v_memview->dtype_is_object); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 777, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_dst, __pyx_v_new_ndim, __pyx_v_memviewsliceobj->to_object_func, __pyx_v_memviewsliceobj->to_dtype_func, __pyx_v_memview->dtype_is_object); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_memoryview_type))))) __PYX_ERR(1, 777, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_memoryview_type))))) __PYX_ERR(1, 779, __pyx_L1_error)
     __pyx_r = ((struct __pyx_memoryview_obj *)__pyx_t_3);
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "View.MemoryView":776
+    /* "View.MemoryView":778
  *             new_ndim += 1
  * 
  *     if isinstance(memview, _memoryviewslice):             # <<<<<<<<<<<<<<
  *         return memoryview_fromslice(dst, new_ndim,
  *                                     memviewsliceobj.to_object_func,
  */
   }
 
-  /* "View.MemoryView":782
+  /* "View.MemoryView":784
  *                                     memview.dtype_is_object)
  *     else:
  *         return memoryview_fromslice(dst, new_ndim, NULL, NULL,             # <<<<<<<<<<<<<<
  *                                     memview.dtype_is_object)
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(((PyObject *)__pyx_r));
 
-    /* "View.MemoryView":783
+    /* "View.MemoryView":785
  *     else:
  *         return memoryview_fromslice(dst, new_ndim, NULL, NULL,
  *                                     memview.dtype_is_object)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_dst, __pyx_v_new_ndim, NULL, NULL, __pyx_v_memview->dtype_is_object); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 782, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_dst, __pyx_v_new_ndim, NULL, NULL, __pyx_v_memview->dtype_is_object); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 784, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
 
-    /* "View.MemoryView":782
+    /* "View.MemoryView":784
  *                                     memview.dtype_is_object)
  *     else:
  *         return memoryview_fromslice(dst, new_ndim, NULL, NULL,             # <<<<<<<<<<<<<<
  *                                     memview.dtype_is_object)
  * 
  */
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_memoryview_type))))) __PYX_ERR(1, 782, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_memoryview_type))))) __PYX_ERR(1, 784, __pyx_L1_error)
     __pyx_r = ((struct __pyx_memoryview_obj *)__pyx_t_3);
     __pyx_t_3 = 0;
     goto __pyx_L0;
   }
 
-  /* "View.MemoryView":710
+  /* "View.MemoryView":712
  * 
  * @cname('__pyx_memview_slice')
  * cdef memoryview memview_slice(memoryview memview, object indices):             # <<<<<<<<<<<<<<
  *     cdef int new_ndim = 0, suboffset_dim = -1, dim
  *     cdef bint negative_step
  */
 
@@ -36710,111 +37074,114 @@
   __Pyx_XDECREF((PyObject *)__pyx_v_memviewsliceobj);
   __Pyx_XDECREF(__pyx_v_index);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":807
+/* "View.MemoryView":809
  * 
  * @cname('__pyx_memoryview_slice_memviewslice')
  * cdef int slice_memviewslice(             # <<<<<<<<<<<<<<
  *         __Pyx_memviewslice *dst,
  *         Py_ssize_t shape, Py_ssize_t stride, Py_ssize_t suboffset,
  */
 
 static int __pyx_memoryview_slice_memviewslice(__Pyx_memviewslice *__pyx_v_dst, Py_ssize_t __pyx_v_shape, Py_ssize_t __pyx_v_stride, Py_ssize_t __pyx_v_suboffset, int __pyx_v_dim, int __pyx_v_new_ndim, int *__pyx_v_suboffset_dim, Py_ssize_t __pyx_v_start, Py_ssize_t __pyx_v_stop, Py_ssize_t __pyx_v_step, int __pyx_v_have_start, int __pyx_v_have_stop, int __pyx_v_have_step, int __pyx_v_is_slice) {
   Py_ssize_t __pyx_v_new_shape;
   int __pyx_v_negative_step;
   int __pyx_r;
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
 
-  /* "View.MemoryView":827
+  /* "View.MemoryView":829
  *     cdef bint negative_step
  * 
  *     if not is_slice:             # <<<<<<<<<<<<<<
  * 
  *         if start < 0:
  */
   __pyx_t_1 = ((!(__pyx_v_is_slice != 0)) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":829
+    /* "View.MemoryView":831
  *     if not is_slice:
  * 
  *         if start < 0:             # <<<<<<<<<<<<<<
  *             start += shape
  *         if not 0 <= start < shape:
  */
     __pyx_t_1 = ((__pyx_v_start < 0) != 0);
     if (__pyx_t_1) {
 
-      /* "View.MemoryView":830
+      /* "View.MemoryView":832
  * 
  *         if start < 0:
  *             start += shape             # <<<<<<<<<<<<<<
  *         if not 0 <= start < shape:
  *             _err_dim(IndexError, "Index out of bounds (axis %d)", dim)
  */
       __pyx_v_start = (__pyx_v_start + __pyx_v_shape);
 
-      /* "View.MemoryView":829
+      /* "View.MemoryView":831
  *     if not is_slice:
  * 
  *         if start < 0:             # <<<<<<<<<<<<<<
  *             start += shape
  *         if not 0 <= start < shape:
  */
     }
 
-    /* "View.MemoryView":831
+    /* "View.MemoryView":833
  *         if start < 0:
  *             start += shape
  *         if not 0 <= start < shape:             # <<<<<<<<<<<<<<
  *             _err_dim(IndexError, "Index out of bounds (axis %d)", dim)
  *     else:
  */
     __pyx_t_1 = (0 <= __pyx_v_start);
     if (__pyx_t_1) {
       __pyx_t_1 = (__pyx_v_start < __pyx_v_shape);
     }
     __pyx_t_2 = ((!(__pyx_t_1 != 0)) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":832
+      /* "View.MemoryView":834
  *             start += shape
  *         if not 0 <= start < shape:
  *             _err_dim(IndexError, "Index out of bounds (axis %d)", dim)             # <<<<<<<<<<<<<<
  *     else:
  * 
  */
-      __pyx_t_3 = __pyx_memoryview_err_dim(__pyx_builtin_IndexError, ((char *)"Index out of bounds (axis %d)"), __pyx_v_dim); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(1, 832, __pyx_L1_error)
+      __pyx_t_3 = __pyx_memoryview_err_dim(__pyx_builtin_IndexError, ((char *)"Index out of bounds (axis %d)"), __pyx_v_dim); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(1, 834, __pyx_L1_error)
 
-      /* "View.MemoryView":831
+      /* "View.MemoryView":833
  *         if start < 0:
  *             start += shape
  *         if not 0 <= start < shape:             # <<<<<<<<<<<<<<
  *             _err_dim(IndexError, "Index out of bounds (axis %d)", dim)
  *     else:
  */
     }
 
-    /* "View.MemoryView":827
+    /* "View.MemoryView":829
  *     cdef bint negative_step
  * 
  *     if not is_slice:             # <<<<<<<<<<<<<<
  * 
  *         if start < 0:
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":835
+  /* "View.MemoryView":837
  *     else:
  * 
  *         negative_step = have_step != 0 and step < 0             # <<<<<<<<<<<<<<
  * 
  *         if have_step and step == 0:
  */
   /*else*/ {
@@ -36825,15 +37192,15 @@
       goto __pyx_L6_bool_binop_done;
     }
     __pyx_t_1 = ((__pyx_v_step < 0) != 0);
     __pyx_t_2 = __pyx_t_1;
     __pyx_L6_bool_binop_done:;
     __pyx_v_negative_step = __pyx_t_2;
 
-    /* "View.MemoryView":837
+    /* "View.MemoryView":839
  *         negative_step = have_step != 0 and step < 0
  * 
  *         if have_step and step == 0:             # <<<<<<<<<<<<<<
  *             _err_dim(ValueError, "Step may not be zero (axis %d)", dim)
  * 
  */
     __pyx_t_1 = (__pyx_v_have_step != 0);
@@ -36843,639 +37210,639 @@
       goto __pyx_L9_bool_binop_done;
     }
     __pyx_t_1 = ((__pyx_v_step == 0) != 0);
     __pyx_t_2 = __pyx_t_1;
     __pyx_L9_bool_binop_done:;
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":838
+      /* "View.MemoryView":840
  * 
  *         if have_step and step == 0:
  *             _err_dim(ValueError, "Step may not be zero (axis %d)", dim)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __pyx_t_3 = __pyx_memoryview_err_dim(__pyx_builtin_ValueError, ((char *)"Step may not be zero (axis %d)"), __pyx_v_dim); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(1, 838, __pyx_L1_error)
+      __pyx_t_3 = __pyx_memoryview_err_dim(__pyx_builtin_ValueError, ((char *)"Step may not be zero (axis %d)"), __pyx_v_dim); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(1, 840, __pyx_L1_error)
 
-      /* "View.MemoryView":837
+      /* "View.MemoryView":839
  *         negative_step = have_step != 0 and step < 0
  * 
  *         if have_step and step == 0:             # <<<<<<<<<<<<<<
  *             _err_dim(ValueError, "Step may not be zero (axis %d)", dim)
  * 
  */
     }
 
-    /* "View.MemoryView":841
+    /* "View.MemoryView":843
  * 
  * 
  *         if have_start:             # <<<<<<<<<<<<<<
  *             if start < 0:
  *                 start += shape
  */
     __pyx_t_2 = (__pyx_v_have_start != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":842
+      /* "View.MemoryView":844
  * 
  *         if have_start:
  *             if start < 0:             # <<<<<<<<<<<<<<
  *                 start += shape
  *                 if start < 0:
  */
       __pyx_t_2 = ((__pyx_v_start < 0) != 0);
       if (__pyx_t_2) {
 
-        /* "View.MemoryView":843
+        /* "View.MemoryView":845
  *         if have_start:
  *             if start < 0:
  *                 start += shape             # <<<<<<<<<<<<<<
  *                 if start < 0:
  *                     start = 0
  */
         __pyx_v_start = (__pyx_v_start + __pyx_v_shape);
 
-        /* "View.MemoryView":844
+        /* "View.MemoryView":846
  *             if start < 0:
  *                 start += shape
  *                 if start < 0:             # <<<<<<<<<<<<<<
  *                     start = 0
  *             elif start >= shape:
  */
         __pyx_t_2 = ((__pyx_v_start < 0) != 0);
         if (__pyx_t_2) {
 
-          /* "View.MemoryView":845
+          /* "View.MemoryView":847
  *                 start += shape
  *                 if start < 0:
  *                     start = 0             # <<<<<<<<<<<<<<
  *             elif start >= shape:
  *                 if negative_step:
  */
           __pyx_v_start = 0;
 
-          /* "View.MemoryView":844
+          /* "View.MemoryView":846
  *             if start < 0:
  *                 start += shape
  *                 if start < 0:             # <<<<<<<<<<<<<<
  *                     start = 0
  *             elif start >= shape:
  */
         }
 
-        /* "View.MemoryView":842
+        /* "View.MemoryView":844
  * 
  *         if have_start:
  *             if start < 0:             # <<<<<<<<<<<<<<
  *                 start += shape
  *                 if start < 0:
  */
         goto __pyx_L12;
       }
 
-      /* "View.MemoryView":846
+      /* "View.MemoryView":848
  *                 if start < 0:
  *                     start = 0
  *             elif start >= shape:             # <<<<<<<<<<<<<<
  *                 if negative_step:
  *                     start = shape - 1
  */
       __pyx_t_2 = ((__pyx_v_start >= __pyx_v_shape) != 0);
       if (__pyx_t_2) {
 
-        /* "View.MemoryView":847
+        /* "View.MemoryView":849
  *                     start = 0
  *             elif start >= shape:
  *                 if negative_step:             # <<<<<<<<<<<<<<
  *                     start = shape - 1
  *                 else:
  */
         __pyx_t_2 = (__pyx_v_negative_step != 0);
         if (__pyx_t_2) {
 
-          /* "View.MemoryView":848
+          /* "View.MemoryView":850
  *             elif start >= shape:
  *                 if negative_step:
  *                     start = shape - 1             # <<<<<<<<<<<<<<
  *                 else:
  *                     start = shape
  */
           __pyx_v_start = (__pyx_v_shape - 1);
 
-          /* "View.MemoryView":847
+          /* "View.MemoryView":849
  *                     start = 0
  *             elif start >= shape:
  *                 if negative_step:             # <<<<<<<<<<<<<<
  *                     start = shape - 1
  *                 else:
  */
           goto __pyx_L14;
         }
 
-        /* "View.MemoryView":850
+        /* "View.MemoryView":852
  *                     start = shape - 1
  *                 else:
  *                     start = shape             # <<<<<<<<<<<<<<
  *         else:
  *             if negative_step:
  */
         /*else*/ {
           __pyx_v_start = __pyx_v_shape;
         }
         __pyx_L14:;
 
-        /* "View.MemoryView":846
+        /* "View.MemoryView":848
  *                 if start < 0:
  *                     start = 0
  *             elif start >= shape:             # <<<<<<<<<<<<<<
  *                 if negative_step:
  *                     start = shape - 1
  */
       }
       __pyx_L12:;
 
-      /* "View.MemoryView":841
+      /* "View.MemoryView":843
  * 
  * 
  *         if have_start:             # <<<<<<<<<<<<<<
  *             if start < 0:
  *                 start += shape
  */
       goto __pyx_L11;
     }
 
-    /* "View.MemoryView":852
+    /* "View.MemoryView":854
  *                     start = shape
  *         else:
  *             if negative_step:             # <<<<<<<<<<<<<<
  *                 start = shape - 1
  *             else:
  */
     /*else*/ {
       __pyx_t_2 = (__pyx_v_negative_step != 0);
       if (__pyx_t_2) {
 
-        /* "View.MemoryView":853
+        /* "View.MemoryView":855
  *         else:
  *             if negative_step:
  *                 start = shape - 1             # <<<<<<<<<<<<<<
  *             else:
  *                 start = 0
  */
         __pyx_v_start = (__pyx_v_shape - 1);
 
-        /* "View.MemoryView":852
+        /* "View.MemoryView":854
  *                     start = shape
  *         else:
  *             if negative_step:             # <<<<<<<<<<<<<<
  *                 start = shape - 1
  *             else:
  */
         goto __pyx_L15;
       }
 
-      /* "View.MemoryView":855
+      /* "View.MemoryView":857
  *                 start = shape - 1
  *             else:
  *                 start = 0             # <<<<<<<<<<<<<<
  * 
  *         if have_stop:
  */
       /*else*/ {
         __pyx_v_start = 0;
       }
       __pyx_L15:;
     }
     __pyx_L11:;
 
-    /* "View.MemoryView":857
+    /* "View.MemoryView":859
  *                 start = 0
  * 
  *         if have_stop:             # <<<<<<<<<<<<<<
  *             if stop < 0:
  *                 stop += shape
  */
     __pyx_t_2 = (__pyx_v_have_stop != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":858
+      /* "View.MemoryView":860
  * 
  *         if have_stop:
  *             if stop < 0:             # <<<<<<<<<<<<<<
  *                 stop += shape
  *                 if stop < 0:
  */
       __pyx_t_2 = ((__pyx_v_stop < 0) != 0);
       if (__pyx_t_2) {
 
-        /* "View.MemoryView":859
+        /* "View.MemoryView":861
  *         if have_stop:
  *             if stop < 0:
  *                 stop += shape             # <<<<<<<<<<<<<<
  *                 if stop < 0:
  *                     stop = 0
  */
         __pyx_v_stop = (__pyx_v_stop + __pyx_v_shape);
 
-        /* "View.MemoryView":860
+        /* "View.MemoryView":862
  *             if stop < 0:
  *                 stop += shape
  *                 if stop < 0:             # <<<<<<<<<<<<<<
  *                     stop = 0
  *             elif stop > shape:
  */
         __pyx_t_2 = ((__pyx_v_stop < 0) != 0);
         if (__pyx_t_2) {
 
-          /* "View.MemoryView":861
+          /* "View.MemoryView":863
  *                 stop += shape
  *                 if stop < 0:
  *                     stop = 0             # <<<<<<<<<<<<<<
  *             elif stop > shape:
  *                 stop = shape
  */
           __pyx_v_stop = 0;
 
-          /* "View.MemoryView":860
+          /* "View.MemoryView":862
  *             if stop < 0:
  *                 stop += shape
  *                 if stop < 0:             # <<<<<<<<<<<<<<
  *                     stop = 0
  *             elif stop > shape:
  */
         }
 
-        /* "View.MemoryView":858
+        /* "View.MemoryView":860
  * 
  *         if have_stop:
  *             if stop < 0:             # <<<<<<<<<<<<<<
  *                 stop += shape
  *                 if stop < 0:
  */
         goto __pyx_L17;
       }
 
-      /* "View.MemoryView":862
+      /* "View.MemoryView":864
  *                 if stop < 0:
  *                     stop = 0
  *             elif stop > shape:             # <<<<<<<<<<<<<<
  *                 stop = shape
  *         else:
  */
       __pyx_t_2 = ((__pyx_v_stop > __pyx_v_shape) != 0);
       if (__pyx_t_2) {
 
-        /* "View.MemoryView":863
+        /* "View.MemoryView":865
  *                     stop = 0
  *             elif stop > shape:
  *                 stop = shape             # <<<<<<<<<<<<<<
  *         else:
  *             if negative_step:
  */
         __pyx_v_stop = __pyx_v_shape;
 
-        /* "View.MemoryView":862
+        /* "View.MemoryView":864
  *                 if stop < 0:
  *                     stop = 0
  *             elif stop > shape:             # <<<<<<<<<<<<<<
  *                 stop = shape
  *         else:
  */
       }
       __pyx_L17:;
 
-      /* "View.MemoryView":857
+      /* "View.MemoryView":859
  *                 start = 0
  * 
  *         if have_stop:             # <<<<<<<<<<<<<<
  *             if stop < 0:
  *                 stop += shape
  */
       goto __pyx_L16;
     }
 
-    /* "View.MemoryView":865
+    /* "View.MemoryView":867
  *                 stop = shape
  *         else:
  *             if negative_step:             # <<<<<<<<<<<<<<
  *                 stop = -1
  *             else:
  */
     /*else*/ {
       __pyx_t_2 = (__pyx_v_negative_step != 0);
       if (__pyx_t_2) {
 
-        /* "View.MemoryView":866
+        /* "View.MemoryView":868
  *         else:
  *             if negative_step:
  *                 stop = -1             # <<<<<<<<<<<<<<
  *             else:
  *                 stop = shape
  */
         __pyx_v_stop = -1L;
 
-        /* "View.MemoryView":865
+        /* "View.MemoryView":867
  *                 stop = shape
  *         else:
  *             if negative_step:             # <<<<<<<<<<<<<<
  *                 stop = -1
  *             else:
  */
         goto __pyx_L19;
       }
 
-      /* "View.MemoryView":868
+      /* "View.MemoryView":870
  *                 stop = -1
  *             else:
  *                 stop = shape             # <<<<<<<<<<<<<<
  * 
  *         if not have_step:
  */
       /*else*/ {
         __pyx_v_stop = __pyx_v_shape;
       }
       __pyx_L19:;
     }
     __pyx_L16:;
 
-    /* "View.MemoryView":870
+    /* "View.MemoryView":872
  *                 stop = shape
  * 
  *         if not have_step:             # <<<<<<<<<<<<<<
  *             step = 1
  * 
  */
     __pyx_t_2 = ((!(__pyx_v_have_step != 0)) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":871
+      /* "View.MemoryView":873
  * 
  *         if not have_step:
  *             step = 1             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_v_step = 1;
 
-      /* "View.MemoryView":870
+      /* "View.MemoryView":872
  *                 stop = shape
  * 
  *         if not have_step:             # <<<<<<<<<<<<<<
  *             step = 1
  * 
  */
     }
 
-    /* "View.MemoryView":875
+    /* "View.MemoryView":877
  * 
  *         with cython.cdivision(True):
  *             new_shape = (stop - start) // step             # <<<<<<<<<<<<<<
  * 
  *             if (stop - start) - step * new_shape:
  */
     __pyx_v_new_shape = ((__pyx_v_stop - __pyx_v_start) / __pyx_v_step);
 
-    /* "View.MemoryView":877
+    /* "View.MemoryView":879
  *             new_shape = (stop - start) // step
  * 
  *             if (stop - start) - step * new_shape:             # <<<<<<<<<<<<<<
  *                 new_shape += 1
  * 
  */
     __pyx_t_2 = (((__pyx_v_stop - __pyx_v_start) - (__pyx_v_step * __pyx_v_new_shape)) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":878
+      /* "View.MemoryView":880
  * 
  *             if (stop - start) - step * new_shape:
  *                 new_shape += 1             # <<<<<<<<<<<<<<
  * 
  *         if new_shape < 0:
  */
       __pyx_v_new_shape = (__pyx_v_new_shape + 1);
 
-      /* "View.MemoryView":877
+      /* "View.MemoryView":879
  *             new_shape = (stop - start) // step
  * 
  *             if (stop - start) - step * new_shape:             # <<<<<<<<<<<<<<
  *                 new_shape += 1
  * 
  */
     }
 
-    /* "View.MemoryView":880
+    /* "View.MemoryView":882
  *                 new_shape += 1
  * 
  *         if new_shape < 0:             # <<<<<<<<<<<<<<
  *             new_shape = 0
  * 
  */
     __pyx_t_2 = ((__pyx_v_new_shape < 0) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":881
+      /* "View.MemoryView":883
  * 
  *         if new_shape < 0:
  *             new_shape = 0             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_v_new_shape = 0;
 
-      /* "View.MemoryView":880
+      /* "View.MemoryView":882
  *                 new_shape += 1
  * 
  *         if new_shape < 0:             # <<<<<<<<<<<<<<
  *             new_shape = 0
  * 
  */
     }
 
-    /* "View.MemoryView":884
+    /* "View.MemoryView":886
  * 
  * 
  *         dst.strides[new_ndim] = stride * step             # <<<<<<<<<<<<<<
  *         dst.shape[new_ndim] = new_shape
  *         dst.suboffsets[new_ndim] = suboffset
  */
     (__pyx_v_dst->strides[__pyx_v_new_ndim]) = (__pyx_v_stride * __pyx_v_step);
 
-    /* "View.MemoryView":885
+    /* "View.MemoryView":887
  * 
  *         dst.strides[new_ndim] = stride * step
  *         dst.shape[new_ndim] = new_shape             # <<<<<<<<<<<<<<
  *         dst.suboffsets[new_ndim] = suboffset
  * 
  */
     (__pyx_v_dst->shape[__pyx_v_new_ndim]) = __pyx_v_new_shape;
 
-    /* "View.MemoryView":886
+    /* "View.MemoryView":888
  *         dst.strides[new_ndim] = stride * step
  *         dst.shape[new_ndim] = new_shape
  *         dst.suboffsets[new_ndim] = suboffset             # <<<<<<<<<<<<<<
  * 
  * 
  */
     (__pyx_v_dst->suboffsets[__pyx_v_new_ndim]) = __pyx_v_suboffset;
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":889
+  /* "View.MemoryView":891
  * 
  * 
  *     if suboffset_dim[0] < 0:             # <<<<<<<<<<<<<<
  *         dst.data += start * stride
  *     else:
  */
   __pyx_t_2 = (((__pyx_v_suboffset_dim[0]) < 0) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":890
+    /* "View.MemoryView":892
  * 
  *     if suboffset_dim[0] < 0:
  *         dst.data += start * stride             # <<<<<<<<<<<<<<
  *     else:
  *         dst.suboffsets[suboffset_dim[0]] += start * stride
  */
     __pyx_v_dst->data = (__pyx_v_dst->data + (__pyx_v_start * __pyx_v_stride));
 
-    /* "View.MemoryView":889
+    /* "View.MemoryView":891
  * 
  * 
  *     if suboffset_dim[0] < 0:             # <<<<<<<<<<<<<<
  *         dst.data += start * stride
  *     else:
  */
     goto __pyx_L23;
   }
 
-  /* "View.MemoryView":892
+  /* "View.MemoryView":894
  *         dst.data += start * stride
  *     else:
  *         dst.suboffsets[suboffset_dim[0]] += start * stride             # <<<<<<<<<<<<<<
  * 
  *     if suboffset >= 0:
  */
   /*else*/ {
     __pyx_t_3 = (__pyx_v_suboffset_dim[0]);
     (__pyx_v_dst->suboffsets[__pyx_t_3]) = ((__pyx_v_dst->suboffsets[__pyx_t_3]) + (__pyx_v_start * __pyx_v_stride));
   }
   __pyx_L23:;
 
-  /* "View.MemoryView":894
+  /* "View.MemoryView":896
  *         dst.suboffsets[suboffset_dim[0]] += start * stride
  * 
  *     if suboffset >= 0:             # <<<<<<<<<<<<<<
  *         if not is_slice:
  *             if new_ndim == 0:
  */
   __pyx_t_2 = ((__pyx_v_suboffset >= 0) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":895
+    /* "View.MemoryView":897
  * 
  *     if suboffset >= 0:
  *         if not is_slice:             # <<<<<<<<<<<<<<
  *             if new_ndim == 0:
  *                 dst.data = (<char **> dst.data)[0] + suboffset
  */
     __pyx_t_2 = ((!(__pyx_v_is_slice != 0)) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":896
+      /* "View.MemoryView":898
  *     if suboffset >= 0:
  *         if not is_slice:
  *             if new_ndim == 0:             # <<<<<<<<<<<<<<
  *                 dst.data = (<char **> dst.data)[0] + suboffset
  *             else:
  */
       __pyx_t_2 = ((__pyx_v_new_ndim == 0) != 0);
       if (__pyx_t_2) {
 
-        /* "View.MemoryView":897
+        /* "View.MemoryView":899
  *         if not is_slice:
  *             if new_ndim == 0:
  *                 dst.data = (<char **> dst.data)[0] + suboffset             # <<<<<<<<<<<<<<
  *             else:
  *                 _err_dim(IndexError, "All dimensions preceding dimension %d "
  */
         __pyx_v_dst->data = ((((char **)__pyx_v_dst->data)[0]) + __pyx_v_suboffset);
 
-        /* "View.MemoryView":896
+        /* "View.MemoryView":898
  *     if suboffset >= 0:
  *         if not is_slice:
  *             if new_ndim == 0:             # <<<<<<<<<<<<<<
  *                 dst.data = (<char **> dst.data)[0] + suboffset
  *             else:
  */
         goto __pyx_L26;
       }
 
-      /* "View.MemoryView":899
+      /* "View.MemoryView":901
  *                 dst.data = (<char **> dst.data)[0] + suboffset
  *             else:
  *                 _err_dim(IndexError, "All dimensions preceding dimension %d "             # <<<<<<<<<<<<<<
  *                                      "must be indexed and not sliced", dim)
  *         else:
  */
       /*else*/ {
 
-        /* "View.MemoryView":900
+        /* "View.MemoryView":902
  *             else:
  *                 _err_dim(IndexError, "All dimensions preceding dimension %d "
  *                                      "must be indexed and not sliced", dim)             # <<<<<<<<<<<<<<
  *         else:
  *             suboffset_dim[0] = new_ndim
  */
-        __pyx_t_3 = __pyx_memoryview_err_dim(__pyx_builtin_IndexError, ((char *)"All dimensions preceding dimension %d must be indexed and not sliced"), __pyx_v_dim); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(1, 899, __pyx_L1_error)
+        __pyx_t_3 = __pyx_memoryview_err_dim(__pyx_builtin_IndexError, ((char *)"All dimensions preceding dimension %d must be indexed and not sliced"), __pyx_v_dim); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(1, 901, __pyx_L1_error)
       }
       __pyx_L26:;
 
-      /* "View.MemoryView":895
+      /* "View.MemoryView":897
  * 
  *     if suboffset >= 0:
  *         if not is_slice:             # <<<<<<<<<<<<<<
  *             if new_ndim == 0:
  *                 dst.data = (<char **> dst.data)[0] + suboffset
  */
       goto __pyx_L25;
     }
 
-    /* "View.MemoryView":902
+    /* "View.MemoryView":904
  *                                      "must be indexed and not sliced", dim)
  *         else:
  *             suboffset_dim[0] = new_ndim             # <<<<<<<<<<<<<<
  * 
  *     return 0
  */
     /*else*/ {
       (__pyx_v_suboffset_dim[0]) = __pyx_v_new_ndim;
     }
     __pyx_L25:;
 
-    /* "View.MemoryView":894
+    /* "View.MemoryView":896
  *         dst.suboffsets[suboffset_dim[0]] += start * stride
  * 
  *     if suboffset >= 0:             # <<<<<<<<<<<<<<
  *         if not is_slice:
  *             if new_ndim == 0:
  */
   }
 
-  /* "View.MemoryView":904
+  /* "View.MemoryView":906
  *             suboffset_dim[0] = new_ndim
  * 
  *     return 0             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":807
+  /* "View.MemoryView":809
  * 
  * @cname('__pyx_memoryview_slice_memviewslice')
  * cdef int slice_memviewslice(             # <<<<<<<<<<<<<<
  *         __Pyx_memviewslice *dst,
  *         Py_ssize_t shape, Py_ssize_t stride, Py_ssize_t suboffset,
  */
 
@@ -37491,15 +37858,15 @@
     #endif
   }
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "View.MemoryView":910
+/* "View.MemoryView":912
  * 
  * @cname('__pyx_pybuffer_index')
  * cdef char *pybuffer_index(Py_buffer *view, char *bufp, Py_ssize_t index,             # <<<<<<<<<<<<<<
  *                           Py_ssize_t dim) except NULL:
  *     cdef Py_ssize_t shape, stride, suboffset = -1
  */
 
@@ -37511,282 +37878,285 @@
   char *__pyx_v_resultp;
   char *__pyx_r;
   __Pyx_RefNannyDeclarations
   Py_ssize_t __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("pybuffer_index", 0);
 
-  /* "View.MemoryView":912
+  /* "View.MemoryView":914
  * cdef char *pybuffer_index(Py_buffer *view, char *bufp, Py_ssize_t index,
  *                           Py_ssize_t dim) except NULL:
  *     cdef Py_ssize_t shape, stride, suboffset = -1             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t itemsize = view.itemsize
  *     cdef char *resultp
  */
   __pyx_v_suboffset = -1L;
 
-  /* "View.MemoryView":913
+  /* "View.MemoryView":915
  *                           Py_ssize_t dim) except NULL:
  *     cdef Py_ssize_t shape, stride, suboffset = -1
  *     cdef Py_ssize_t itemsize = view.itemsize             # <<<<<<<<<<<<<<
  *     cdef char *resultp
  * 
  */
   __pyx_t_1 = __pyx_v_view->itemsize;
   __pyx_v_itemsize = __pyx_t_1;
 
-  /* "View.MemoryView":916
+  /* "View.MemoryView":918
  *     cdef char *resultp
  * 
  *     if view.ndim == 0:             # <<<<<<<<<<<<<<
  *         shape = view.len / itemsize
  *         stride = itemsize
  */
   __pyx_t_2 = ((__pyx_v_view->ndim == 0) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":917
+    /* "View.MemoryView":919
  * 
  *     if view.ndim == 0:
  *         shape = view.len / itemsize             # <<<<<<<<<<<<<<
  *         stride = itemsize
  *     else:
  */
     if (unlikely(__pyx_v_itemsize == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-      __PYX_ERR(1, 917, __pyx_L1_error)
+      __PYX_ERR(1, 919, __pyx_L1_error)
     }
     else if (sizeof(Py_ssize_t) == sizeof(long) && (!(((Py_ssize_t)-1) > 0)) && unlikely(__pyx_v_itemsize == (Py_ssize_t)-1)  && unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_v_view->len))) {
       PyErr_SetString(PyExc_OverflowError, "value too large to perform division");
-      __PYX_ERR(1, 917, __pyx_L1_error)
+      __PYX_ERR(1, 919, __pyx_L1_error)
     }
     __pyx_v_shape = __Pyx_div_Py_ssize_t(__pyx_v_view->len, __pyx_v_itemsize);
 
-    /* "View.MemoryView":918
+    /* "View.MemoryView":920
  *     if view.ndim == 0:
  *         shape = view.len / itemsize
  *         stride = itemsize             # <<<<<<<<<<<<<<
  *     else:
  *         shape = view.shape[dim]
  */
     __pyx_v_stride = __pyx_v_itemsize;
 
-    /* "View.MemoryView":916
+    /* "View.MemoryView":918
  *     cdef char *resultp
  * 
  *     if view.ndim == 0:             # <<<<<<<<<<<<<<
  *         shape = view.len / itemsize
  *         stride = itemsize
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":920
+  /* "View.MemoryView":922
  *         stride = itemsize
  *     else:
  *         shape = view.shape[dim]             # <<<<<<<<<<<<<<
  *         stride = view.strides[dim]
  *         if view.suboffsets != NULL:
  */
   /*else*/ {
     __pyx_v_shape = (__pyx_v_view->shape[__pyx_v_dim]);
 
-    /* "View.MemoryView":921
+    /* "View.MemoryView":923
  *     else:
  *         shape = view.shape[dim]
  *         stride = view.strides[dim]             # <<<<<<<<<<<<<<
  *         if view.suboffsets != NULL:
  *             suboffset = view.suboffsets[dim]
  */
     __pyx_v_stride = (__pyx_v_view->strides[__pyx_v_dim]);
 
-    /* "View.MemoryView":922
+    /* "View.MemoryView":924
  *         shape = view.shape[dim]
  *         stride = view.strides[dim]
  *         if view.suboffsets != NULL:             # <<<<<<<<<<<<<<
  *             suboffset = view.suboffsets[dim]
  * 
  */
     __pyx_t_2 = ((__pyx_v_view->suboffsets != NULL) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":923
+      /* "View.MemoryView":925
  *         stride = view.strides[dim]
  *         if view.suboffsets != NULL:
  *             suboffset = view.suboffsets[dim]             # <<<<<<<<<<<<<<
  * 
  *     if index < 0:
  */
       __pyx_v_suboffset = (__pyx_v_view->suboffsets[__pyx_v_dim]);
 
-      /* "View.MemoryView":922
+      /* "View.MemoryView":924
  *         shape = view.shape[dim]
  *         stride = view.strides[dim]
  *         if view.suboffsets != NULL:             # <<<<<<<<<<<<<<
  *             suboffset = view.suboffsets[dim]
  * 
  */
     }
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":925
+  /* "View.MemoryView":927
  *             suboffset = view.suboffsets[dim]
  * 
  *     if index < 0:             # <<<<<<<<<<<<<<
  *         index += view.shape[dim]
  *         if index < 0:
  */
   __pyx_t_2 = ((__pyx_v_index < 0) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":926
+    /* "View.MemoryView":928
  * 
  *     if index < 0:
  *         index += view.shape[dim]             # <<<<<<<<<<<<<<
  *         if index < 0:
  *             raise IndexError("Out of bounds on buffer access (axis %d)" % dim)
  */
     __pyx_v_index = (__pyx_v_index + (__pyx_v_view->shape[__pyx_v_dim]));
 
-    /* "View.MemoryView":927
+    /* "View.MemoryView":929
  *     if index < 0:
  *         index += view.shape[dim]
  *         if index < 0:             # <<<<<<<<<<<<<<
  *             raise IndexError("Out of bounds on buffer access (axis %d)" % dim)
  * 
  */
     __pyx_t_2 = ((__pyx_v_index < 0) != 0);
     if (unlikely(__pyx_t_2)) {
 
-      /* "View.MemoryView":928
+      /* "View.MemoryView":930
  *         index += view.shape[dim]
  *         if index < 0:
  *             raise IndexError("Out of bounds on buffer access (axis %d)" % dim)             # <<<<<<<<<<<<<<
  * 
  *     if index >= shape:
  */
-      __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_dim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 928, __pyx_L1_error)
+      __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_dim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 930, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Out_of_bounds_on_buffer_access_a, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 928, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Out_of_bounds_on_buffer_access_a, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 930, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_IndexError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 928, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_IndexError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 930, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_Raise(__pyx_t_3, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __PYX_ERR(1, 928, __pyx_L1_error)
+      __PYX_ERR(1, 930, __pyx_L1_error)
 
-      /* "View.MemoryView":927
+      /* "View.MemoryView":929
  *     if index < 0:
  *         index += view.shape[dim]
  *         if index < 0:             # <<<<<<<<<<<<<<
  *             raise IndexError("Out of bounds on buffer access (axis %d)" % dim)
  * 
  */
     }
 
-    /* "View.MemoryView":925
+    /* "View.MemoryView":927
  *             suboffset = view.suboffsets[dim]
  * 
  *     if index < 0:             # <<<<<<<<<<<<<<
  *         index += view.shape[dim]
  *         if index < 0:
  */
   }
 
-  /* "View.MemoryView":930
+  /* "View.MemoryView":932
  *             raise IndexError("Out of bounds on buffer access (axis %d)" % dim)
  * 
  *     if index >= shape:             # <<<<<<<<<<<<<<
  *         raise IndexError("Out of bounds on buffer access (axis %d)" % dim)
  * 
  */
   __pyx_t_2 = ((__pyx_v_index >= __pyx_v_shape) != 0);
   if (unlikely(__pyx_t_2)) {
 
-    /* "View.MemoryView":931
+    /* "View.MemoryView":933
  * 
  *     if index >= shape:
  *         raise IndexError("Out of bounds on buffer access (axis %d)" % dim)             # <<<<<<<<<<<<<<
  * 
  *     resultp = bufp + index * stride
  */
-    __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_dim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 931, __pyx_L1_error)
+    __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_dim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 933, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Out_of_bounds_on_buffer_access_a, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 931, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Out_of_bounds_on_buffer_access_a, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 933, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_IndexError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 931, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_IndexError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 933, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 931, __pyx_L1_error)
+    __PYX_ERR(1, 933, __pyx_L1_error)
 
-    /* "View.MemoryView":930
+    /* "View.MemoryView":932
  *             raise IndexError("Out of bounds on buffer access (axis %d)" % dim)
  * 
  *     if index >= shape:             # <<<<<<<<<<<<<<
  *         raise IndexError("Out of bounds on buffer access (axis %d)" % dim)
  * 
  */
   }
 
-  /* "View.MemoryView":933
+  /* "View.MemoryView":935
  *         raise IndexError("Out of bounds on buffer access (axis %d)" % dim)
  * 
  *     resultp = bufp + index * stride             # <<<<<<<<<<<<<<
  *     if suboffset >= 0:
  *         resultp = (<char **> resultp)[0] + suboffset
  */
   __pyx_v_resultp = (__pyx_v_bufp + (__pyx_v_index * __pyx_v_stride));
 
-  /* "View.MemoryView":934
+  /* "View.MemoryView":936
  * 
  *     resultp = bufp + index * stride
  *     if suboffset >= 0:             # <<<<<<<<<<<<<<
  *         resultp = (<char **> resultp)[0] + suboffset
  * 
  */
   __pyx_t_2 = ((__pyx_v_suboffset >= 0) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":935
+    /* "View.MemoryView":937
  *     resultp = bufp + index * stride
  *     if suboffset >= 0:
  *         resultp = (<char **> resultp)[0] + suboffset             # <<<<<<<<<<<<<<
  * 
  *     return resultp
  */
     __pyx_v_resultp = ((((char **)__pyx_v_resultp)[0]) + __pyx_v_suboffset);
 
-    /* "View.MemoryView":934
+    /* "View.MemoryView":936
  * 
  *     resultp = bufp + index * stride
  *     if suboffset >= 0:             # <<<<<<<<<<<<<<
  *         resultp = (<char **> resultp)[0] + suboffset
  * 
  */
   }
 
-  /* "View.MemoryView":937
+  /* "View.MemoryView":939
  *         resultp = (<char **> resultp)[0] + suboffset
  * 
  *     return resultp             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = __pyx_v_resultp;
   goto __pyx_L0;
 
-  /* "View.MemoryView":910
+  /* "View.MemoryView":912
  * 
  * @cname('__pyx_pybuffer_index')
  * cdef char *pybuffer_index(Py_buffer *view, char *bufp, Py_ssize_t index,             # <<<<<<<<<<<<<<
  *                           Py_ssize_t dim) except NULL:
  *     cdef Py_ssize_t shape, stride, suboffset = -1
  */
 
@@ -37797,15 +38167,15 @@
   __Pyx_AddTraceback("View.MemoryView.pybuffer_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":943
+/* "View.MemoryView":945
  * 
  * @cname('__pyx_memslice_transpose')
  * cdef int transpose_memslice(__Pyx_memviewslice *memslice) nogil except 0:             # <<<<<<<<<<<<<<
  *     cdef int ndim = memslice.memview.view.ndim
  * 
  */
 
@@ -37821,91 +38191,94 @@
   long __pyx_t_3;
   long __pyx_t_4;
   Py_ssize_t __pyx_t_5;
   Py_ssize_t __pyx_t_6;
   int __pyx_t_7;
   int __pyx_t_8;
   int __pyx_t_9;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
 
-  /* "View.MemoryView":944
+  /* "View.MemoryView":946
  * @cname('__pyx_memslice_transpose')
  * cdef int transpose_memslice(__Pyx_memviewslice *memslice) nogil except 0:
  *     cdef int ndim = memslice.memview.view.ndim             # <<<<<<<<<<<<<<
  * 
  *     cdef Py_ssize_t *shape = memslice.shape
  */
   __pyx_t_1 = __pyx_v_memslice->memview->view.ndim;
   __pyx_v_ndim = __pyx_t_1;
 
-  /* "View.MemoryView":946
+  /* "View.MemoryView":948
  *     cdef int ndim = memslice.memview.view.ndim
  * 
  *     cdef Py_ssize_t *shape = memslice.shape             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t *strides = memslice.strides
  * 
  */
   __pyx_t_2 = __pyx_v_memslice->shape;
   __pyx_v_shape = __pyx_t_2;
 
-  /* "View.MemoryView":947
+  /* "View.MemoryView":949
  * 
  *     cdef Py_ssize_t *shape = memslice.shape
  *     cdef Py_ssize_t *strides = memslice.strides             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_2 = __pyx_v_memslice->strides;
   __pyx_v_strides = __pyx_t_2;
 
-  /* "View.MemoryView":951
+  /* "View.MemoryView":953
  * 
  *     cdef int i, j
  *     for i in range(ndim / 2):             # <<<<<<<<<<<<<<
  *         j = ndim - 1 - i
  *         strides[i], strides[j] = strides[j], strides[i]
  */
   __pyx_t_3 = __Pyx_div_long(__pyx_v_ndim, 2);
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_1 = 0; __pyx_t_1 < __pyx_t_4; __pyx_t_1+=1) {
     __pyx_v_i = __pyx_t_1;
 
-    /* "View.MemoryView":952
+    /* "View.MemoryView":954
  *     cdef int i, j
  *     for i in range(ndim / 2):
  *         j = ndim - 1 - i             # <<<<<<<<<<<<<<
  *         strides[i], strides[j] = strides[j], strides[i]
  *         shape[i], shape[j] = shape[j], shape[i]
  */
     __pyx_v_j = ((__pyx_v_ndim - 1) - __pyx_v_i);
 
-    /* "View.MemoryView":953
+    /* "View.MemoryView":955
  *     for i in range(ndim / 2):
  *         j = ndim - 1 - i
  *         strides[i], strides[j] = strides[j], strides[i]             # <<<<<<<<<<<<<<
  *         shape[i], shape[j] = shape[j], shape[i]
  * 
  */
     __pyx_t_5 = (__pyx_v_strides[__pyx_v_j]);
     __pyx_t_6 = (__pyx_v_strides[__pyx_v_i]);
     (__pyx_v_strides[__pyx_v_i]) = __pyx_t_5;
     (__pyx_v_strides[__pyx_v_j]) = __pyx_t_6;
 
-    /* "View.MemoryView":954
+    /* "View.MemoryView":956
  *         j = ndim - 1 - i
  *         strides[i], strides[j] = strides[j], strides[i]
  *         shape[i], shape[j] = shape[j], shape[i]             # <<<<<<<<<<<<<<
  * 
  *         if memslice.suboffsets[i] >= 0 or memslice.suboffsets[j] >= 0:
  */
     __pyx_t_6 = (__pyx_v_shape[__pyx_v_j]);
     __pyx_t_5 = (__pyx_v_shape[__pyx_v_i]);
     (__pyx_v_shape[__pyx_v_i]) = __pyx_t_6;
     (__pyx_v_shape[__pyx_v_j]) = __pyx_t_5;
 
-    /* "View.MemoryView":956
+    /* "View.MemoryView":958
  *         shape[i], shape[j] = shape[j], shape[i]
  * 
  *         if memslice.suboffsets[i] >= 0 or memslice.suboffsets[j] >= 0:             # <<<<<<<<<<<<<<
  *             _err(ValueError, "Cannot transpose memoryview with indirect dimensions")
  * 
  */
     __pyx_t_8 = (((__pyx_v_memslice->suboffsets[__pyx_v_i]) >= 0) != 0);
@@ -37915,44 +38288,44 @@
       goto __pyx_L6_bool_binop_done;
     }
     __pyx_t_8 = (((__pyx_v_memslice->suboffsets[__pyx_v_j]) >= 0) != 0);
     __pyx_t_7 = __pyx_t_8;
     __pyx_L6_bool_binop_done:;
     if (__pyx_t_7) {
 
-      /* "View.MemoryView":957
+      /* "View.MemoryView":959
  * 
  *         if memslice.suboffsets[i] >= 0 or memslice.suboffsets[j] >= 0:
  *             _err(ValueError, "Cannot transpose memoryview with indirect dimensions")             # <<<<<<<<<<<<<<
  * 
  *     return 1
  */
-      __pyx_t_9 = __pyx_memoryview_err(__pyx_builtin_ValueError, ((char *)"Cannot transpose memoryview with indirect dimensions")); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 957, __pyx_L1_error)
+      __pyx_t_9 = __pyx_memoryview_err(__pyx_builtin_ValueError, ((char *)"Cannot transpose memoryview with indirect dimensions")); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 959, __pyx_L1_error)
 
-      /* "View.MemoryView":956
+      /* "View.MemoryView":958
  *         shape[i], shape[j] = shape[j], shape[i]
  * 
  *         if memslice.suboffsets[i] >= 0 or memslice.suboffsets[j] >= 0:             # <<<<<<<<<<<<<<
  *             _err(ValueError, "Cannot transpose memoryview with indirect dimensions")
  * 
  */
     }
   }
 
-  /* "View.MemoryView":959
+  /* "View.MemoryView":961
  *             _err(ValueError, "Cannot transpose memoryview with indirect dimensions")
  * 
  *     return 1             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "View.MemoryView":943
+  /* "View.MemoryView":945
  * 
  * @cname('__pyx_memslice_transpose')
  * cdef int transpose_memslice(__Pyx_memviewslice *memslice) nogil except 0:             # <<<<<<<<<<<<<<
  *     cdef int ndim = memslice.memview.view.ndim
  * 
  */
 
@@ -37968,15 +38341,15 @@
     #endif
   }
   __pyx_r = 0;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "View.MemoryView":976
+/* "View.MemoryView":978
  *     cdef int (*to_dtype_func)(char *, object) except 0
  * 
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         __PYX_XDEC_MEMVIEW(&self.from_slice, 1)
  * 
  */
 
@@ -37991,100 +38364,103 @@
   __Pyx_RefNannyFinishContext();
 }
 
 static void __pyx_memoryviewslice___pyx_pf_15View_dot_MemoryView_16_memoryviewslice___dealloc__(struct __pyx_memoryviewslice_obj *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__dealloc__", 0);
 
-  /* "View.MemoryView":977
+  /* "View.MemoryView":979
  * 
  *     def __dealloc__(self):
  *         __PYX_XDEC_MEMVIEW(&self.from_slice, 1)             # <<<<<<<<<<<<<<
  * 
  *     cdef convert_item_to_object(self, char *itemp):
  */
   __PYX_XDEC_MEMVIEW((&__pyx_v_self->from_slice), 1);
 
-  /* "View.MemoryView":976
+  /* "View.MemoryView":978
  *     cdef int (*to_dtype_func)(char *, object) except 0
  * 
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         __PYX_XDEC_MEMVIEW(&self.from_slice, 1)
  * 
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "View.MemoryView":979
+/* "View.MemoryView":981
  *         __PYX_XDEC_MEMVIEW(&self.from_slice, 1)
  * 
  *     cdef convert_item_to_object(self, char *itemp):             # <<<<<<<<<<<<<<
  *         if self.to_object_func != NULL:
  *             return self.to_object_func(itemp)
  */
 
 static PyObject *__pyx_memoryviewslice_convert_item_to_object(struct __pyx_memoryviewslice_obj *__pyx_v_self, char *__pyx_v_itemp) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("convert_item_to_object", 0);
 
-  /* "View.MemoryView":980
+  /* "View.MemoryView":982
  * 
  *     cdef convert_item_to_object(self, char *itemp):
  *         if self.to_object_func != NULL:             # <<<<<<<<<<<<<<
  *             return self.to_object_func(itemp)
  *         else:
  */
   __pyx_t_1 = ((__pyx_v_self->to_object_func != NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":981
+    /* "View.MemoryView":983
  *     cdef convert_item_to_object(self, char *itemp):
  *         if self.to_object_func != NULL:
  *             return self.to_object_func(itemp)             # <<<<<<<<<<<<<<
  *         else:
  *             return memoryview.convert_item_to_object(self, itemp)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_2 = __pyx_v_self->to_object_func(__pyx_v_itemp); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 981, __pyx_L1_error)
+    __pyx_t_2 = __pyx_v_self->to_object_func(__pyx_v_itemp); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 983, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
 
-    /* "View.MemoryView":980
+    /* "View.MemoryView":982
  * 
  *     cdef convert_item_to_object(self, char *itemp):
  *         if self.to_object_func != NULL:             # <<<<<<<<<<<<<<
  *             return self.to_object_func(itemp)
  *         else:
  */
   }
 
-  /* "View.MemoryView":983
+  /* "View.MemoryView":985
  *             return self.to_object_func(itemp)
  *         else:
  *             return memoryview.convert_item_to_object(self, itemp)             # <<<<<<<<<<<<<<
  * 
  *     cdef assign_item_from_object(self, char *itemp, object value):
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_2 = __pyx_memoryview_convert_item_to_object(((struct __pyx_memoryview_obj *)__pyx_v_self), __pyx_v_itemp); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 983, __pyx_L1_error)
+    __pyx_t_2 = __pyx_memoryview_convert_item_to_object(((struct __pyx_memoryview_obj *)__pyx_v_self), __pyx_v_itemp); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 985, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
   }
 
-  /* "View.MemoryView":979
+  /* "View.MemoryView":981
  *         __PYX_XDEC_MEMVIEW(&self.from_slice, 1)
  * 
  *     cdef convert_item_to_object(self, char *itemp):             # <<<<<<<<<<<<<<
  *         if self.to_object_func != NULL:
  *             return self.to_object_func(itemp)
  */
 
@@ -38095,74 +38471,77 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":985
+/* "View.MemoryView":987
  *             return memoryview.convert_item_to_object(self, itemp)
  * 
  *     cdef assign_item_from_object(self, char *itemp, object value):             # <<<<<<<<<<<<<<
  *         if self.to_dtype_func != NULL:
  *             self.to_dtype_func(itemp, value)
  */
 
 static PyObject *__pyx_memoryviewslice_assign_item_from_object(struct __pyx_memoryviewslice_obj *__pyx_v_self, char *__pyx_v_itemp, PyObject *__pyx_v_value) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("assign_item_from_object", 0);
 
-  /* "View.MemoryView":986
+  /* "View.MemoryView":988
  * 
  *     cdef assign_item_from_object(self, char *itemp, object value):
  *         if self.to_dtype_func != NULL:             # <<<<<<<<<<<<<<
  *             self.to_dtype_func(itemp, value)
  *         else:
  */
   __pyx_t_1 = ((__pyx_v_self->to_dtype_func != NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":987
+    /* "View.MemoryView":989
  *     cdef assign_item_from_object(self, char *itemp, object value):
  *         if self.to_dtype_func != NULL:
  *             self.to_dtype_func(itemp, value)             # <<<<<<<<<<<<<<
  *         else:
  *             memoryview.assign_item_from_object(self, itemp, value)
  */
-    __pyx_t_2 = __pyx_v_self->to_dtype_func(__pyx_v_itemp, __pyx_v_value); if (unlikely(__pyx_t_2 == ((int)0))) __PYX_ERR(1, 987, __pyx_L1_error)
+    __pyx_t_2 = __pyx_v_self->to_dtype_func(__pyx_v_itemp, __pyx_v_value); if (unlikely(__pyx_t_2 == ((int)0))) __PYX_ERR(1, 989, __pyx_L1_error)
 
-    /* "View.MemoryView":986
+    /* "View.MemoryView":988
  * 
  *     cdef assign_item_from_object(self, char *itemp, object value):
  *         if self.to_dtype_func != NULL:             # <<<<<<<<<<<<<<
  *             self.to_dtype_func(itemp, value)
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":989
+  /* "View.MemoryView":991
  *             self.to_dtype_func(itemp, value)
  *         else:
  *             memoryview.assign_item_from_object(self, itemp, value)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   /*else*/ {
-    __pyx_t_3 = __pyx_memoryview_assign_item_from_object(((struct __pyx_memoryview_obj *)__pyx_v_self), __pyx_v_itemp, __pyx_v_value); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 989, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_assign_item_from_object(((struct __pyx_memoryview_obj *)__pyx_v_self), __pyx_v_itemp, __pyx_v_value); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 991, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":985
+  /* "View.MemoryView":987
  *             return memoryview.convert_item_to_object(self, itemp)
  * 
  *     cdef assign_item_from_object(self, char *itemp, object value):             # <<<<<<<<<<<<<<
  *         if self.to_dtype_func != NULL:
  *             self.to_dtype_func(itemp, value)
  */
 
@@ -38175,15 +38554,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":992
+/* "View.MemoryView":994
  * 
  *     @property
  *     def base(self):             # <<<<<<<<<<<<<<
  *         return self.from_object
  * 
  */
 
@@ -38201,27 +38580,27 @@
 }
 
 static PyObject *__pyx_pf_15View_dot_MemoryView_16_memoryviewslice_4base___get__(struct __pyx_memoryviewslice_obj *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "View.MemoryView":993
+  /* "View.MemoryView":995
  *     @property
  *     def base(self):
  *         return self.from_object             # <<<<<<<<<<<<<<
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_memoryview_getbuffer, "getbuffer(obj, view, flags)")
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_self->from_object);
   __pyx_r = __pyx_v_self->from_object;
   goto __pyx_L0;
 
-  /* "View.MemoryView":992
+  /* "View.MemoryView":994
  * 
  *     @property
  *     def base(self):             # <<<<<<<<<<<<<<
  *         return self.from_object
  * 
  */
 
@@ -38251,14 +38630,17 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf___pyx_memoryviewslice___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reduce_cython__", 0);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
@@ -38305,14 +38687,17 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf___pyx_memoryviewslice_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
@@ -38335,15 +38720,15 @@
   __Pyx_AddTraceback("View.MemoryView._memoryviewslice.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":999
+/* "View.MemoryView":1001
  * 
  * @cname('__pyx_memoryview_fromslice')
  * cdef memoryview_fromslice(__Pyx_memviewslice memviewslice,             # <<<<<<<<<<<<<<
  *                           int ndim,
  *                           object (*to_object_func)(char *),
  */
 
@@ -38358,353 +38743,356 @@
   PyObject *__pyx_t_3 = NULL;
   __Pyx_TypeInfo *__pyx_t_4;
   Py_buffer __pyx_t_5;
   Py_ssize_t *__pyx_t_6;
   Py_ssize_t *__pyx_t_7;
   Py_ssize_t *__pyx_t_8;
   Py_ssize_t __pyx_t_9;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("memoryview_fromslice", 0);
 
-  /* "View.MemoryView":1007
+  /* "View.MemoryView":1009
  *     cdef _memoryviewslice result
  * 
  *     if <PyObject *> memviewslice.memview == Py_None:             # <<<<<<<<<<<<<<
  *         return None
  * 
  */
   __pyx_t_1 = ((((PyObject *)__pyx_v_memviewslice.memview) == Py_None) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":1008
+    /* "View.MemoryView":1010
  * 
  *     if <PyObject *> memviewslice.memview == Py_None:
  *         return None             # <<<<<<<<<<<<<<
  * 
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "View.MemoryView":1007
+    /* "View.MemoryView":1009
  *     cdef _memoryviewslice result
  * 
  *     if <PyObject *> memviewslice.memview == Py_None:             # <<<<<<<<<<<<<<
  *         return None
  * 
  */
   }
 
-  /* "View.MemoryView":1013
+  /* "View.MemoryView":1015
  * 
  * 
  *     result = _memoryviewslice(None, 0, dtype_is_object)             # <<<<<<<<<<<<<<
  * 
  *     result.from_slice = memviewslice
  */
-  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_v_dtype_is_object); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1013, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_v_dtype_is_object); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1013, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
   PyTuple_SET_ITEM(__pyx_t_3, 0, Py_None);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryviewslice_type), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1013, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryviewslice_type), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_result = ((struct __pyx_memoryviewslice_obj *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "View.MemoryView":1015
+  /* "View.MemoryView":1017
  *     result = _memoryviewslice(None, 0, dtype_is_object)
  * 
  *     result.from_slice = memviewslice             # <<<<<<<<<<<<<<
  *     __PYX_INC_MEMVIEW(&memviewslice, 1)
  * 
  */
   __pyx_v_result->from_slice = __pyx_v_memviewslice;
 
-  /* "View.MemoryView":1016
+  /* "View.MemoryView":1018
  * 
  *     result.from_slice = memviewslice
  *     __PYX_INC_MEMVIEW(&memviewslice, 1)             # <<<<<<<<<<<<<<
  * 
  *     result.from_object = (<memoryview> memviewslice.memview).base
  */
   __PYX_INC_MEMVIEW((&__pyx_v_memviewslice), 1);
 
-  /* "View.MemoryView":1018
+  /* "View.MemoryView":1020
  *     __PYX_INC_MEMVIEW(&memviewslice, 1)
  * 
  *     result.from_object = (<memoryview> memviewslice.memview).base             # <<<<<<<<<<<<<<
  *     result.typeinfo = memviewslice.memview.typeinfo
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_memviewslice.memview), __pyx_n_s_base); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1018, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_memviewslice.memview), __pyx_n_s_base); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1020, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_result->from_object);
   __Pyx_DECREF(__pyx_v_result->from_object);
   __pyx_v_result->from_object = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "View.MemoryView":1019
+  /* "View.MemoryView":1021
  * 
  *     result.from_object = (<memoryview> memviewslice.memview).base
  *     result.typeinfo = memviewslice.memview.typeinfo             # <<<<<<<<<<<<<<
  * 
  *     result.view = memviewslice.memview.view
  */
   __pyx_t_4 = __pyx_v_memviewslice.memview->typeinfo;
   __pyx_v_result->__pyx_base.typeinfo = __pyx_t_4;
 
-  /* "View.MemoryView":1021
+  /* "View.MemoryView":1023
  *     result.typeinfo = memviewslice.memview.typeinfo
  * 
  *     result.view = memviewslice.memview.view             # <<<<<<<<<<<<<<
  *     result.view.buf = <void *> memviewslice.data
  *     result.view.ndim = ndim
  */
   __pyx_t_5 = __pyx_v_memviewslice.memview->view;
   __pyx_v_result->__pyx_base.view = __pyx_t_5;
 
-  /* "View.MemoryView":1022
+  /* "View.MemoryView":1024
  * 
  *     result.view = memviewslice.memview.view
  *     result.view.buf = <void *> memviewslice.data             # <<<<<<<<<<<<<<
  *     result.view.ndim = ndim
  *     (<__pyx_buffer *> &result.view).obj = Py_None
  */
   __pyx_v_result->__pyx_base.view.buf = ((void *)__pyx_v_memviewslice.data);
 
-  /* "View.MemoryView":1023
+  /* "View.MemoryView":1025
  *     result.view = memviewslice.memview.view
  *     result.view.buf = <void *> memviewslice.data
  *     result.view.ndim = ndim             # <<<<<<<<<<<<<<
  *     (<__pyx_buffer *> &result.view).obj = Py_None
  *     Py_INCREF(Py_None)
  */
   __pyx_v_result->__pyx_base.view.ndim = __pyx_v_ndim;
 
-  /* "View.MemoryView":1024
+  /* "View.MemoryView":1026
  *     result.view.buf = <void *> memviewslice.data
  *     result.view.ndim = ndim
  *     (<__pyx_buffer *> &result.view).obj = Py_None             # <<<<<<<<<<<<<<
  *     Py_INCREF(Py_None)
  * 
  */
   ((Py_buffer *)(&__pyx_v_result->__pyx_base.view))->obj = Py_None;
 
-  /* "View.MemoryView":1025
+  /* "View.MemoryView":1027
  *     result.view.ndim = ndim
  *     (<__pyx_buffer *> &result.view).obj = Py_None
  *     Py_INCREF(Py_None)             # <<<<<<<<<<<<<<
  * 
  *     if (<memoryview>memviewslice.memview).flags & PyBUF_WRITABLE:
  */
   Py_INCREF(Py_None);
 
-  /* "View.MemoryView":1027
+  /* "View.MemoryView":1029
  *     Py_INCREF(Py_None)
  * 
  *     if (<memoryview>memviewslice.memview).flags & PyBUF_WRITABLE:             # <<<<<<<<<<<<<<
  *         result.flags = PyBUF_RECORDS
  *     else:
  */
   __pyx_t_1 = ((((struct __pyx_memoryview_obj *)__pyx_v_memviewslice.memview)->flags & PyBUF_WRITABLE) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":1028
+    /* "View.MemoryView":1030
  * 
  *     if (<memoryview>memviewslice.memview).flags & PyBUF_WRITABLE:
  *         result.flags = PyBUF_RECORDS             # <<<<<<<<<<<<<<
  *     else:
  *         result.flags = PyBUF_RECORDS_RO
  */
     __pyx_v_result->__pyx_base.flags = PyBUF_RECORDS;
 
-    /* "View.MemoryView":1027
+    /* "View.MemoryView":1029
  *     Py_INCREF(Py_None)
  * 
  *     if (<memoryview>memviewslice.memview).flags & PyBUF_WRITABLE:             # <<<<<<<<<<<<<<
  *         result.flags = PyBUF_RECORDS
  *     else:
  */
     goto __pyx_L4;
   }
 
-  /* "View.MemoryView":1030
+  /* "View.MemoryView":1032
  *         result.flags = PyBUF_RECORDS
  *     else:
  *         result.flags = PyBUF_RECORDS_RO             # <<<<<<<<<<<<<<
  * 
  *     result.view.shape = <Py_ssize_t *> result.from_slice.shape
  */
   /*else*/ {
     __pyx_v_result->__pyx_base.flags = PyBUF_RECORDS_RO;
   }
   __pyx_L4:;
 
-  /* "View.MemoryView":1032
+  /* "View.MemoryView":1034
  *         result.flags = PyBUF_RECORDS_RO
  * 
  *     result.view.shape = <Py_ssize_t *> result.from_slice.shape             # <<<<<<<<<<<<<<
  *     result.view.strides = <Py_ssize_t *> result.from_slice.strides
  * 
  */
   __pyx_v_result->__pyx_base.view.shape = ((Py_ssize_t *)__pyx_v_result->from_slice.shape);
 
-  /* "View.MemoryView":1033
+  /* "View.MemoryView":1035
  * 
  *     result.view.shape = <Py_ssize_t *> result.from_slice.shape
  *     result.view.strides = <Py_ssize_t *> result.from_slice.strides             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_v_result->__pyx_base.view.strides = ((Py_ssize_t *)__pyx_v_result->from_slice.strides);
 
-  /* "View.MemoryView":1036
+  /* "View.MemoryView":1038
  * 
  * 
  *     result.view.suboffsets = NULL             # <<<<<<<<<<<<<<
  *     for suboffset in result.from_slice.suboffsets[:ndim]:
  *         if suboffset >= 0:
  */
   __pyx_v_result->__pyx_base.view.suboffsets = NULL;
 
-  /* "View.MemoryView":1037
+  /* "View.MemoryView":1039
  * 
  *     result.view.suboffsets = NULL
  *     for suboffset in result.from_slice.suboffsets[:ndim]:             # <<<<<<<<<<<<<<
  *         if suboffset >= 0:
  *             result.view.suboffsets = <Py_ssize_t *> result.from_slice.suboffsets
  */
   __pyx_t_7 = (__pyx_v_result->from_slice.suboffsets + __pyx_v_ndim);
   for (__pyx_t_8 = __pyx_v_result->from_slice.suboffsets; __pyx_t_8 < __pyx_t_7; __pyx_t_8++) {
     __pyx_t_6 = __pyx_t_8;
     __pyx_v_suboffset = (__pyx_t_6[0]);
 
-    /* "View.MemoryView":1038
+    /* "View.MemoryView":1040
  *     result.view.suboffsets = NULL
  *     for suboffset in result.from_slice.suboffsets[:ndim]:
  *         if suboffset >= 0:             # <<<<<<<<<<<<<<
  *             result.view.suboffsets = <Py_ssize_t *> result.from_slice.suboffsets
  *             break
  */
     __pyx_t_1 = ((__pyx_v_suboffset >= 0) != 0);
     if (__pyx_t_1) {
 
-      /* "View.MemoryView":1039
+      /* "View.MemoryView":1041
  *     for suboffset in result.from_slice.suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             result.view.suboffsets = <Py_ssize_t *> result.from_slice.suboffsets             # <<<<<<<<<<<<<<
  *             break
  * 
  */
       __pyx_v_result->__pyx_base.view.suboffsets = ((Py_ssize_t *)__pyx_v_result->from_slice.suboffsets);
 
-      /* "View.MemoryView":1040
+      /* "View.MemoryView":1042
  *         if suboffset >= 0:
  *             result.view.suboffsets = <Py_ssize_t *> result.from_slice.suboffsets
  *             break             # <<<<<<<<<<<<<<
  * 
  *     result.view.len = result.view.itemsize
  */
       goto __pyx_L6_break;
 
-      /* "View.MemoryView":1038
+      /* "View.MemoryView":1040
  *     result.view.suboffsets = NULL
  *     for suboffset in result.from_slice.suboffsets[:ndim]:
  *         if suboffset >= 0:             # <<<<<<<<<<<<<<
  *             result.view.suboffsets = <Py_ssize_t *> result.from_slice.suboffsets
  *             break
  */
     }
   }
   __pyx_L6_break:;
 
-  /* "View.MemoryView":1042
+  /* "View.MemoryView":1044
  *             break
  * 
  *     result.view.len = result.view.itemsize             # <<<<<<<<<<<<<<
  *     for length in result.view.shape[:ndim]:
  *         result.view.len *= length
  */
   __pyx_t_9 = __pyx_v_result->__pyx_base.view.itemsize;
   __pyx_v_result->__pyx_base.view.len = __pyx_t_9;
 
-  /* "View.MemoryView":1043
+  /* "View.MemoryView":1045
  * 
  *     result.view.len = result.view.itemsize
  *     for length in result.view.shape[:ndim]:             # <<<<<<<<<<<<<<
  *         result.view.len *= length
  * 
  */
   __pyx_t_7 = (__pyx_v_result->__pyx_base.view.shape + __pyx_v_ndim);
   for (__pyx_t_8 = __pyx_v_result->__pyx_base.view.shape; __pyx_t_8 < __pyx_t_7; __pyx_t_8++) {
     __pyx_t_6 = __pyx_t_8;
-    __pyx_t_2 = PyInt_FromSsize_t((__pyx_t_6[0])); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1043, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t((__pyx_t_6[0])); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1045, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_XDECREF_SET(__pyx_v_length, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "View.MemoryView":1044
+    /* "View.MemoryView":1046
  *     result.view.len = result.view.itemsize
  *     for length in result.view.shape[:ndim]:
  *         result.view.len *= length             # <<<<<<<<<<<<<<
  * 
  *     result.to_object_func = to_object_func
  */
-    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_result->__pyx_base.view.len); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1044, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_result->__pyx_base.view.len); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1046, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyNumber_InPlaceMultiply(__pyx_t_2, __pyx_v_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1044, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_InPlaceMultiply(__pyx_t_2, __pyx_v_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1046, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 1044, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 1046, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_result->__pyx_base.view.len = __pyx_t_9;
   }
 
-  /* "View.MemoryView":1046
+  /* "View.MemoryView":1048
  *         result.view.len *= length
  * 
  *     result.to_object_func = to_object_func             # <<<<<<<<<<<<<<
  *     result.to_dtype_func = to_dtype_func
  * 
  */
   __pyx_v_result->to_object_func = __pyx_v_to_object_func;
 
-  /* "View.MemoryView":1047
+  /* "View.MemoryView":1049
  * 
  *     result.to_object_func = to_object_func
  *     result.to_dtype_func = to_dtype_func             # <<<<<<<<<<<<<<
  * 
  *     return result
  */
   __pyx_v_result->to_dtype_func = __pyx_v_to_dtype_func;
 
-  /* "View.MemoryView":1049
+  /* "View.MemoryView":1051
  *     result.to_dtype_func = to_dtype_func
  * 
  *     return result             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_get_slice_from_memoryview')
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_result));
   __pyx_r = ((PyObject *)__pyx_v_result);
   goto __pyx_L0;
 
-  /* "View.MemoryView":999
+  /* "View.MemoryView":1001
  * 
  * @cname('__pyx_memoryview_fromslice')
  * cdef memoryview_fromslice(__Pyx_memviewslice memviewslice,             # <<<<<<<<<<<<<<
  *                           int ndim,
  *                           object (*to_object_func)(char *),
  */
 
@@ -38718,96 +39106,99 @@
   __Pyx_XDECREF((PyObject *)__pyx_v_result);
   __Pyx_XDECREF(__pyx_v_length);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":1052
+/* "View.MemoryView":1054
  * 
  * @cname('__pyx_memoryview_get_slice_from_memoryview')
  * cdef __Pyx_memviewslice *get_slice_from_memview(memoryview memview,             # <<<<<<<<<<<<<<
  *                                                    __Pyx_memviewslice *mslice) except NULL:
  *     cdef _memoryviewslice obj
  */
 
 static __Pyx_memviewslice *__pyx_memoryview_get_slice_from_memoryview(struct __pyx_memoryview_obj *__pyx_v_memview, __Pyx_memviewslice *__pyx_v_mslice) {
   struct __pyx_memoryviewslice_obj *__pyx_v_obj = 0;
   __Pyx_memviewslice *__pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_slice_from_memview", 0);
 
-  /* "View.MemoryView":1055
+  /* "View.MemoryView":1057
  *                                                    __Pyx_memviewslice *mslice) except NULL:
  *     cdef _memoryviewslice obj
  *     if isinstance(memview, _memoryviewslice):             # <<<<<<<<<<<<<<
  *         obj = memview
  *         return &obj.from_slice
  */
   __pyx_t_1 = __Pyx_TypeCheck(((PyObject *)__pyx_v_memview), __pyx_memoryviewslice_type); 
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":1056
+    /* "View.MemoryView":1058
  *     cdef _memoryviewslice obj
  *     if isinstance(memview, _memoryviewslice):
  *         obj = memview             # <<<<<<<<<<<<<<
  *         return &obj.from_slice
  *     else:
  */
-    if (!(likely(((((PyObject *)__pyx_v_memview)) == Py_None) || likely(__Pyx_TypeTest(((PyObject *)__pyx_v_memview), __pyx_memoryviewslice_type))))) __PYX_ERR(1, 1056, __pyx_L1_error)
+    if (!(likely(((((PyObject *)__pyx_v_memview)) == Py_None) || likely(__Pyx_TypeTest(((PyObject *)__pyx_v_memview), __pyx_memoryviewslice_type))))) __PYX_ERR(1, 1058, __pyx_L1_error)
     __pyx_t_3 = ((PyObject *)__pyx_v_memview);
     __Pyx_INCREF(__pyx_t_3);
     __pyx_v_obj = ((struct __pyx_memoryviewslice_obj *)__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "View.MemoryView":1057
+    /* "View.MemoryView":1059
  *     if isinstance(memview, _memoryviewslice):
  *         obj = memview
  *         return &obj.from_slice             # <<<<<<<<<<<<<<
  *     else:
  *         slice_copy(memview, mslice)
  */
     __pyx_r = (&__pyx_v_obj->from_slice);
     goto __pyx_L0;
 
-    /* "View.MemoryView":1055
+    /* "View.MemoryView":1057
  *                                                    __Pyx_memviewslice *mslice) except NULL:
  *     cdef _memoryviewslice obj
  *     if isinstance(memview, _memoryviewslice):             # <<<<<<<<<<<<<<
  *         obj = memview
  *         return &obj.from_slice
  */
   }
 
-  /* "View.MemoryView":1059
+  /* "View.MemoryView":1061
  *         return &obj.from_slice
  *     else:
  *         slice_copy(memview, mslice)             # <<<<<<<<<<<<<<
  *         return mslice
  * 
  */
   /*else*/ {
     __pyx_memoryview_slice_copy(__pyx_v_memview, __pyx_v_mslice);
 
-    /* "View.MemoryView":1060
+    /* "View.MemoryView":1062
  *     else:
  *         slice_copy(memview, mslice)
  *         return mslice             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_slice_copy')
  */
     __pyx_r = __pyx_v_mslice;
     goto __pyx_L0;
   }
 
-  /* "View.MemoryView":1052
+  /* "View.MemoryView":1054
  * 
  * @cname('__pyx_memoryview_get_slice_from_memoryview')
  * cdef __Pyx_memviewslice *get_slice_from_memview(memoryview memview,             # <<<<<<<<<<<<<<
  *                                                    __Pyx_memviewslice *mslice) except NULL:
  *     cdef _memoryviewslice obj
  */
 
@@ -38818,15 +39209,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_obj);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":1063
+/* "View.MemoryView":1065
  * 
  * @cname('__pyx_memoryview_slice_copy')
  * cdef void slice_copy(memoryview memview, __Pyx_memviewslice *dst):             # <<<<<<<<<<<<<<
  *     cdef int dim
  *     cdef (Py_ssize_t*) shape, strides, suboffsets
  */
 
@@ -38839,158 +39230,161 @@
   Py_ssize_t *__pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
   Py_ssize_t __pyx_t_5;
   __Pyx_RefNannySetupContext("slice_copy", 0);
 
-  /* "View.MemoryView":1067
+  /* "View.MemoryView":1069
  *     cdef (Py_ssize_t*) shape, strides, suboffsets
  * 
  *     shape = memview.view.shape             # <<<<<<<<<<<<<<
  *     strides = memview.view.strides
  *     suboffsets = memview.view.suboffsets
  */
   __pyx_t_1 = __pyx_v_memview->view.shape;
   __pyx_v_shape = __pyx_t_1;
 
-  /* "View.MemoryView":1068
+  /* "View.MemoryView":1070
  * 
  *     shape = memview.view.shape
  *     strides = memview.view.strides             # <<<<<<<<<<<<<<
  *     suboffsets = memview.view.suboffsets
  * 
  */
   __pyx_t_1 = __pyx_v_memview->view.strides;
   __pyx_v_strides = __pyx_t_1;
 
-  /* "View.MemoryView":1069
+  /* "View.MemoryView":1071
  *     shape = memview.view.shape
  *     strides = memview.view.strides
  *     suboffsets = memview.view.suboffsets             # <<<<<<<<<<<<<<
  * 
  *     dst.memview = <__pyx_memoryview *> memview
  */
   __pyx_t_1 = __pyx_v_memview->view.suboffsets;
   __pyx_v_suboffsets = __pyx_t_1;
 
-  /* "View.MemoryView":1071
+  /* "View.MemoryView":1073
  *     suboffsets = memview.view.suboffsets
  * 
  *     dst.memview = <__pyx_memoryview *> memview             # <<<<<<<<<<<<<<
  *     dst.data = <char *> memview.view.buf
  * 
  */
   __pyx_v_dst->memview = ((struct __pyx_memoryview_obj *)__pyx_v_memview);
 
-  /* "View.MemoryView":1072
+  /* "View.MemoryView":1074
  * 
  *     dst.memview = <__pyx_memoryview *> memview
  *     dst.data = <char *> memview.view.buf             # <<<<<<<<<<<<<<
  * 
  *     for dim in range(memview.view.ndim):
  */
   __pyx_v_dst->data = ((char *)__pyx_v_memview->view.buf);
 
-  /* "View.MemoryView":1074
+  /* "View.MemoryView":1076
  *     dst.data = <char *> memview.view.buf
  * 
  *     for dim in range(memview.view.ndim):             # <<<<<<<<<<<<<<
  *         dst.shape[dim] = shape[dim]
  *         dst.strides[dim] = strides[dim]
  */
   __pyx_t_2 = __pyx_v_memview->view.ndim;
   __pyx_t_3 = __pyx_t_2;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_dim = __pyx_t_4;
 
-    /* "View.MemoryView":1075
+    /* "View.MemoryView":1077
  * 
  *     for dim in range(memview.view.ndim):
  *         dst.shape[dim] = shape[dim]             # <<<<<<<<<<<<<<
  *         dst.strides[dim] = strides[dim]
  *         dst.suboffsets[dim] = suboffsets[dim] if suboffsets else -1
  */
     (__pyx_v_dst->shape[__pyx_v_dim]) = (__pyx_v_shape[__pyx_v_dim]);
 
-    /* "View.MemoryView":1076
+    /* "View.MemoryView":1078
  *     for dim in range(memview.view.ndim):
  *         dst.shape[dim] = shape[dim]
  *         dst.strides[dim] = strides[dim]             # <<<<<<<<<<<<<<
  *         dst.suboffsets[dim] = suboffsets[dim] if suboffsets else -1
  * 
  */
     (__pyx_v_dst->strides[__pyx_v_dim]) = (__pyx_v_strides[__pyx_v_dim]);
 
-    /* "View.MemoryView":1077
+    /* "View.MemoryView":1079
  *         dst.shape[dim] = shape[dim]
  *         dst.strides[dim] = strides[dim]
  *         dst.suboffsets[dim] = suboffsets[dim] if suboffsets else -1             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_copy_object')
  */
     if ((__pyx_v_suboffsets != 0)) {
       __pyx_t_5 = (__pyx_v_suboffsets[__pyx_v_dim]);
     } else {
       __pyx_t_5 = -1L;
     }
     (__pyx_v_dst->suboffsets[__pyx_v_dim]) = __pyx_t_5;
   }
 
-  /* "View.MemoryView":1063
+  /* "View.MemoryView":1065
  * 
  * @cname('__pyx_memoryview_slice_copy')
  * cdef void slice_copy(memoryview memview, __Pyx_memviewslice *dst):             # <<<<<<<<<<<<<<
  *     cdef int dim
  *     cdef (Py_ssize_t*) shape, strides, suboffsets
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "View.MemoryView":1080
+/* "View.MemoryView":1082
  * 
  * @cname('__pyx_memoryview_copy_object')
  * cdef memoryview_copy(memoryview memview):             # <<<<<<<<<<<<<<
  *     "Create a new memoryview object"
  *     cdef __Pyx_memviewslice memviewslice
  */
 
 static PyObject *__pyx_memoryview_copy_object(struct __pyx_memoryview_obj *__pyx_v_memview) {
   __Pyx_memviewslice __pyx_v_memviewslice;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("memoryview_copy", 0);
 
-  /* "View.MemoryView":1083
+  /* "View.MemoryView":1085
  *     "Create a new memoryview object"
  *     cdef __Pyx_memviewslice memviewslice
  *     slice_copy(memview, &memviewslice)             # <<<<<<<<<<<<<<
  *     return memoryview_copy_from_slice(memview, &memviewslice)
  * 
  */
   __pyx_memoryview_slice_copy(__pyx_v_memview, (&__pyx_v_memviewslice));
 
-  /* "View.MemoryView":1084
+  /* "View.MemoryView":1086
  *     cdef __Pyx_memviewslice memviewslice
  *     slice_copy(memview, &memviewslice)
  *     return memoryview_copy_from_slice(memview, &memviewslice)             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_copy_object_from_slice')
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_memoryview_copy_object_from_slice(__pyx_v_memview, (&__pyx_v_memviewslice)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1084, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_copy_object_from_slice(__pyx_v_memview, (&__pyx_v_memviewslice)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":1080
+  /* "View.MemoryView":1082
  * 
  * @cname('__pyx_memoryview_copy_object')
  * cdef memoryview_copy(memoryview memview):             # <<<<<<<<<<<<<<
  *     "Create a new memoryview object"
  *     cdef __Pyx_memviewslice memviewslice
  */
 
@@ -39001,15 +39395,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":1087
+/* "View.MemoryView":1089
  * 
  * @cname('__pyx_memoryview_copy_object_from_slice')
  * cdef memoryview_copy_from_slice(memoryview memview, __Pyx_memviewslice *memviewslice):             # <<<<<<<<<<<<<<
  *     """
  *     Create a new memoryview object from a given memoryview object and slice.
  */
 
@@ -39019,101 +39413,104 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *(*__pyx_t_3)(char *);
   int (*__pyx_t_4)(char *, PyObject *);
   PyObject *__pyx_t_5 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("memoryview_copy_from_slice", 0);
 
-  /* "View.MemoryView":1094
+  /* "View.MemoryView":1096
  *     cdef int (*to_dtype_func)(char *, object) except 0
  * 
  *     if isinstance(memview, _memoryviewslice):             # <<<<<<<<<<<<<<
  *         to_object_func = (<_memoryviewslice> memview).to_object_func
  *         to_dtype_func = (<_memoryviewslice> memview).to_dtype_func
  */
   __pyx_t_1 = __Pyx_TypeCheck(((PyObject *)__pyx_v_memview), __pyx_memoryviewslice_type); 
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":1095
+    /* "View.MemoryView":1097
  * 
  *     if isinstance(memview, _memoryviewslice):
  *         to_object_func = (<_memoryviewslice> memview).to_object_func             # <<<<<<<<<<<<<<
  *         to_dtype_func = (<_memoryviewslice> memview).to_dtype_func
  *     else:
  */
     __pyx_t_3 = ((struct __pyx_memoryviewslice_obj *)__pyx_v_memview)->to_object_func;
     __pyx_v_to_object_func = __pyx_t_3;
 
-    /* "View.MemoryView":1096
+    /* "View.MemoryView":1098
  *     if isinstance(memview, _memoryviewslice):
  *         to_object_func = (<_memoryviewslice> memview).to_object_func
  *         to_dtype_func = (<_memoryviewslice> memview).to_dtype_func             # <<<<<<<<<<<<<<
  *     else:
  *         to_object_func = NULL
  */
     __pyx_t_4 = ((struct __pyx_memoryviewslice_obj *)__pyx_v_memview)->to_dtype_func;
     __pyx_v_to_dtype_func = __pyx_t_4;
 
-    /* "View.MemoryView":1094
+    /* "View.MemoryView":1096
  *     cdef int (*to_dtype_func)(char *, object) except 0
  * 
  *     if isinstance(memview, _memoryviewslice):             # <<<<<<<<<<<<<<
  *         to_object_func = (<_memoryviewslice> memview).to_object_func
  *         to_dtype_func = (<_memoryviewslice> memview).to_dtype_func
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":1098
+  /* "View.MemoryView":1100
  *         to_dtype_func = (<_memoryviewslice> memview).to_dtype_func
  *     else:
  *         to_object_func = NULL             # <<<<<<<<<<<<<<
  *         to_dtype_func = NULL
  * 
  */
   /*else*/ {
     __pyx_v_to_object_func = NULL;
 
-    /* "View.MemoryView":1099
+    /* "View.MemoryView":1101
  *     else:
  *         to_object_func = NULL
  *         to_dtype_func = NULL             # <<<<<<<<<<<<<<
  * 
  *     return memoryview_fromslice(memviewslice[0], memview.view.ndim,
  */
     __pyx_v_to_dtype_func = NULL;
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":1101
+  /* "View.MemoryView":1103
  *         to_dtype_func = NULL
  * 
  *     return memoryview_fromslice(memviewslice[0], memview.view.ndim,             # <<<<<<<<<<<<<<
  *                                 to_object_func, to_dtype_func,
  *                                 memview.dtype_is_object)
  */
   __Pyx_XDECREF(__pyx_r);
 
-  /* "View.MemoryView":1103
+  /* "View.MemoryView":1105
  *     return memoryview_fromslice(memviewslice[0], memview.view.ndim,
  *                                 to_object_func, to_dtype_func,
  *                                 memview.dtype_is_object)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_5 = __pyx_memoryview_fromslice((__pyx_v_memviewslice[0]), __pyx_v_memview->view.ndim, __pyx_v_to_object_func, __pyx_v_to_dtype_func, __pyx_v_memview->dtype_is_object); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 1101, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice((__pyx_v_memviewslice[0]), __pyx_v_memview->view.ndim, __pyx_v_to_object_func, __pyx_v_to_dtype_func, __pyx_v_memview->dtype_is_object); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 1103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_r = __pyx_t_5;
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":1087
+  /* "View.MemoryView":1089
  * 
  * @cname('__pyx_memoryview_copy_object_from_slice')
  * cdef memoryview_copy_from_slice(memoryview memview, __Pyx_memviewslice *memviewslice):             # <<<<<<<<<<<<<<
  *     """
  *     Create a new memoryview object from a given memoryview object and slice.
  */
 
@@ -39124,81 +39521,81 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "View.MemoryView":1109
+/* "View.MemoryView":1111
  * 
  * 
  * cdef Py_ssize_t abs_py_ssize_t(Py_ssize_t arg) nogil:             # <<<<<<<<<<<<<<
  *     if arg < 0:
  *         return -arg
  */
 
 static Py_ssize_t abs_py_ssize_t(Py_ssize_t __pyx_v_arg) {
   Py_ssize_t __pyx_r;
   int __pyx_t_1;
 
-  /* "View.MemoryView":1110
+  /* "View.MemoryView":1112
  * 
  * cdef Py_ssize_t abs_py_ssize_t(Py_ssize_t arg) nogil:
  *     if arg < 0:             # <<<<<<<<<<<<<<
  *         return -arg
  *     else:
  */
   __pyx_t_1 = ((__pyx_v_arg < 0) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":1111
+    /* "View.MemoryView":1113
  * cdef Py_ssize_t abs_py_ssize_t(Py_ssize_t arg) nogil:
  *     if arg < 0:
  *         return -arg             # <<<<<<<<<<<<<<
  *     else:
  *         return arg
  */
     __pyx_r = (-__pyx_v_arg);
     goto __pyx_L0;
 
-    /* "View.MemoryView":1110
+    /* "View.MemoryView":1112
  * 
  * cdef Py_ssize_t abs_py_ssize_t(Py_ssize_t arg) nogil:
  *     if arg < 0:             # <<<<<<<<<<<<<<
  *         return -arg
  *     else:
  */
   }
 
-  /* "View.MemoryView":1113
+  /* "View.MemoryView":1115
  *         return -arg
  *     else:
  *         return arg             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_get_best_slice_order')
  */
   /*else*/ {
     __pyx_r = __pyx_v_arg;
     goto __pyx_L0;
   }
 
-  /* "View.MemoryView":1109
+  /* "View.MemoryView":1111
  * 
  * 
  * cdef Py_ssize_t abs_py_ssize_t(Py_ssize_t arg) nogil:             # <<<<<<<<<<<<<<
  *     if arg < 0:
  *         return -arg
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "View.MemoryView":1116
+/* "View.MemoryView":1118
  * 
  * @cname('__pyx_get_best_slice_order')
  * cdef char get_best_order(__Pyx_memviewslice *mslice, int ndim) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     Figure out the best memory access order for a given slice.
  */
 
@@ -39208,187 +39605,187 @@
   Py_ssize_t __pyx_v_f_stride;
   char __pyx_r;
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
 
-  /* "View.MemoryView":1121
+  /* "View.MemoryView":1123
  *     """
  *     cdef int i
  *     cdef Py_ssize_t c_stride = 0             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t f_stride = 0
  * 
  */
   __pyx_v_c_stride = 0;
 
-  /* "View.MemoryView":1122
+  /* "View.MemoryView":1124
  *     cdef int i
  *     cdef Py_ssize_t c_stride = 0
  *     cdef Py_ssize_t f_stride = 0             # <<<<<<<<<<<<<<
  * 
  *     for i in range(ndim - 1, -1, -1):
  */
   __pyx_v_f_stride = 0;
 
-  /* "View.MemoryView":1124
+  /* "View.MemoryView":1126
  *     cdef Py_ssize_t f_stride = 0
  * 
  *     for i in range(ndim - 1, -1, -1):             # <<<<<<<<<<<<<<
  *         if mslice.shape[i] > 1:
  *             c_stride = mslice.strides[i]
  */
   for (__pyx_t_1 = (__pyx_v_ndim - 1); __pyx_t_1 > -1; __pyx_t_1-=1) {
     __pyx_v_i = __pyx_t_1;
 
-    /* "View.MemoryView":1125
+    /* "View.MemoryView":1127
  * 
  *     for i in range(ndim - 1, -1, -1):
  *         if mslice.shape[i] > 1:             # <<<<<<<<<<<<<<
  *             c_stride = mslice.strides[i]
  *             break
  */
     __pyx_t_2 = (((__pyx_v_mslice->shape[__pyx_v_i]) > 1) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":1126
+      /* "View.MemoryView":1128
  *     for i in range(ndim - 1, -1, -1):
  *         if mslice.shape[i] > 1:
  *             c_stride = mslice.strides[i]             # <<<<<<<<<<<<<<
  *             break
  * 
  */
       __pyx_v_c_stride = (__pyx_v_mslice->strides[__pyx_v_i]);
 
-      /* "View.MemoryView":1127
+      /* "View.MemoryView":1129
  *         if mslice.shape[i] > 1:
  *             c_stride = mslice.strides[i]
  *             break             # <<<<<<<<<<<<<<
  * 
  *     for i in range(ndim):
  */
       goto __pyx_L4_break;
 
-      /* "View.MemoryView":1125
+      /* "View.MemoryView":1127
  * 
  *     for i in range(ndim - 1, -1, -1):
  *         if mslice.shape[i] > 1:             # <<<<<<<<<<<<<<
  *             c_stride = mslice.strides[i]
  *             break
  */
     }
   }
   __pyx_L4_break:;
 
-  /* "View.MemoryView":1129
+  /* "View.MemoryView":1131
  *             break
  * 
  *     for i in range(ndim):             # <<<<<<<<<<<<<<
  *         if mslice.shape[i] > 1:
  *             f_stride = mslice.strides[i]
  */
   __pyx_t_1 = __pyx_v_ndim;
   __pyx_t_3 = __pyx_t_1;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_i = __pyx_t_4;
 
-    /* "View.MemoryView":1130
+    /* "View.MemoryView":1132
  * 
  *     for i in range(ndim):
  *         if mslice.shape[i] > 1:             # <<<<<<<<<<<<<<
  *             f_stride = mslice.strides[i]
  *             break
  */
     __pyx_t_2 = (((__pyx_v_mslice->shape[__pyx_v_i]) > 1) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":1131
+      /* "View.MemoryView":1133
  *     for i in range(ndim):
  *         if mslice.shape[i] > 1:
  *             f_stride = mslice.strides[i]             # <<<<<<<<<<<<<<
  *             break
  * 
  */
       __pyx_v_f_stride = (__pyx_v_mslice->strides[__pyx_v_i]);
 
-      /* "View.MemoryView":1132
+      /* "View.MemoryView":1134
  *         if mslice.shape[i] > 1:
  *             f_stride = mslice.strides[i]
  *             break             # <<<<<<<<<<<<<<
  * 
  *     if abs_py_ssize_t(c_stride) <= abs_py_ssize_t(f_stride):
  */
       goto __pyx_L7_break;
 
-      /* "View.MemoryView":1130
+      /* "View.MemoryView":1132
  * 
  *     for i in range(ndim):
  *         if mslice.shape[i] > 1:             # <<<<<<<<<<<<<<
  *             f_stride = mslice.strides[i]
  *             break
  */
     }
   }
   __pyx_L7_break:;
 
-  /* "View.MemoryView":1134
+  /* "View.MemoryView":1136
  *             break
  * 
  *     if abs_py_ssize_t(c_stride) <= abs_py_ssize_t(f_stride):             # <<<<<<<<<<<<<<
  *         return 'C'
  *     else:
  */
   __pyx_t_2 = ((abs_py_ssize_t(__pyx_v_c_stride) <= abs_py_ssize_t(__pyx_v_f_stride)) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":1135
+    /* "View.MemoryView":1137
  * 
  *     if abs_py_ssize_t(c_stride) <= abs_py_ssize_t(f_stride):
  *         return 'C'             # <<<<<<<<<<<<<<
  *     else:
  *         return 'F'
  */
     __pyx_r = 'C';
     goto __pyx_L0;
 
-    /* "View.MemoryView":1134
+    /* "View.MemoryView":1136
  *             break
  * 
  *     if abs_py_ssize_t(c_stride) <= abs_py_ssize_t(f_stride):             # <<<<<<<<<<<<<<
  *         return 'C'
  *     else:
  */
   }
 
-  /* "View.MemoryView":1137
+  /* "View.MemoryView":1139
  *         return 'C'
  *     else:
  *         return 'F'             # <<<<<<<<<<<<<<
  * 
  * @cython.cdivision(True)
  */
   /*else*/ {
     __pyx_r = 'F';
     goto __pyx_L0;
   }
 
-  /* "View.MemoryView":1116
+  /* "View.MemoryView":1118
  * 
  * @cname('__pyx_get_best_slice_order')
  * cdef char get_best_order(__Pyx_memviewslice *mslice, int ndim) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     Figure out the best memory access order for a given slice.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "View.MemoryView":1140
+/* "View.MemoryView":1142
  * 
  * @cython.cdivision(True)
  * cdef void _copy_strided_to_strided(char *src_data, Py_ssize_t *src_strides,             # <<<<<<<<<<<<<<
  *                                    char *dst_data, Py_ssize_t *dst_strides,
  *                                    Py_ssize_t *src_shape, Py_ssize_t *dst_shape,
  */
 
@@ -39401,61 +39798,61 @@
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   Py_ssize_t __pyx_t_4;
   Py_ssize_t __pyx_t_5;
   Py_ssize_t __pyx_t_6;
 
-  /* "View.MemoryView":1147
+  /* "View.MemoryView":1149
  * 
  *     cdef Py_ssize_t i
  *     cdef Py_ssize_t src_extent = src_shape[0]             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t dst_extent = dst_shape[0]
  *     cdef Py_ssize_t src_stride = src_strides[0]
  */
   __pyx_v_src_extent = (__pyx_v_src_shape[0]);
 
-  /* "View.MemoryView":1148
+  /* "View.MemoryView":1150
  *     cdef Py_ssize_t i
  *     cdef Py_ssize_t src_extent = src_shape[0]
  *     cdef Py_ssize_t dst_extent = dst_shape[0]             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t src_stride = src_strides[0]
  *     cdef Py_ssize_t dst_stride = dst_strides[0]
  */
   __pyx_v_dst_extent = (__pyx_v_dst_shape[0]);
 
-  /* "View.MemoryView":1149
+  /* "View.MemoryView":1151
  *     cdef Py_ssize_t src_extent = src_shape[0]
  *     cdef Py_ssize_t dst_extent = dst_shape[0]
  *     cdef Py_ssize_t src_stride = src_strides[0]             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t dst_stride = dst_strides[0]
  * 
  */
   __pyx_v_src_stride = (__pyx_v_src_strides[0]);
 
-  /* "View.MemoryView":1150
+  /* "View.MemoryView":1152
  *     cdef Py_ssize_t dst_extent = dst_shape[0]
  *     cdef Py_ssize_t src_stride = src_strides[0]
  *     cdef Py_ssize_t dst_stride = dst_strides[0]             # <<<<<<<<<<<<<<
  * 
  *     if ndim == 1:
  */
   __pyx_v_dst_stride = (__pyx_v_dst_strides[0]);
 
-  /* "View.MemoryView":1152
+  /* "View.MemoryView":1154
  *     cdef Py_ssize_t dst_stride = dst_strides[0]
  * 
  *     if ndim == 1:             # <<<<<<<<<<<<<<
  *        if (src_stride > 0 and dst_stride > 0 and
  *            <size_t> src_stride == itemsize == <size_t> dst_stride):
  */
   __pyx_t_1 = ((__pyx_v_ndim == 1) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":1153
+    /* "View.MemoryView":1155
  * 
  *     if ndim == 1:
  *        if (src_stride > 0 and dst_stride > 0 and             # <<<<<<<<<<<<<<
  *            <size_t> src_stride == itemsize == <size_t> dst_stride):
  *            memcpy(dst_data, src_data, itemsize * dst_extent)
  */
     __pyx_t_2 = ((__pyx_v_src_stride > 0) != 0);
@@ -39467,195 +39864,195 @@
     __pyx_t_2 = ((__pyx_v_dst_stride > 0) != 0);
     if (__pyx_t_2) {
     } else {
       __pyx_t_1 = __pyx_t_2;
       goto __pyx_L5_bool_binop_done;
     }
 
-    /* "View.MemoryView":1154
+    /* "View.MemoryView":1156
  *     if ndim == 1:
  *        if (src_stride > 0 and dst_stride > 0 and
  *            <size_t> src_stride == itemsize == <size_t> dst_stride):             # <<<<<<<<<<<<<<
  *            memcpy(dst_data, src_data, itemsize * dst_extent)
  *        else:
  */
     __pyx_t_2 = (((size_t)__pyx_v_src_stride) == __pyx_v_itemsize);
     if (__pyx_t_2) {
       __pyx_t_2 = (__pyx_v_itemsize == ((size_t)__pyx_v_dst_stride));
     }
     __pyx_t_3 = (__pyx_t_2 != 0);
     __pyx_t_1 = __pyx_t_3;
     __pyx_L5_bool_binop_done:;
 
-    /* "View.MemoryView":1153
+    /* "View.MemoryView":1155
  * 
  *     if ndim == 1:
  *        if (src_stride > 0 and dst_stride > 0 and             # <<<<<<<<<<<<<<
  *            <size_t> src_stride == itemsize == <size_t> dst_stride):
  *            memcpy(dst_data, src_data, itemsize * dst_extent)
  */
     if (__pyx_t_1) {
 
-      /* "View.MemoryView":1155
+      /* "View.MemoryView":1157
  *        if (src_stride > 0 and dst_stride > 0 and
  *            <size_t> src_stride == itemsize == <size_t> dst_stride):
  *            memcpy(dst_data, src_data, itemsize * dst_extent)             # <<<<<<<<<<<<<<
  *        else:
  *            for i in range(dst_extent):
  */
       (void)(memcpy(__pyx_v_dst_data, __pyx_v_src_data, (__pyx_v_itemsize * __pyx_v_dst_extent)));
 
-      /* "View.MemoryView":1153
+      /* "View.MemoryView":1155
  * 
  *     if ndim == 1:
  *        if (src_stride > 0 and dst_stride > 0 and             # <<<<<<<<<<<<<<
  *            <size_t> src_stride == itemsize == <size_t> dst_stride):
  *            memcpy(dst_data, src_data, itemsize * dst_extent)
  */
       goto __pyx_L4;
     }
 
-    /* "View.MemoryView":1157
+    /* "View.MemoryView":1159
  *            memcpy(dst_data, src_data, itemsize * dst_extent)
  *        else:
  *            for i in range(dst_extent):             # <<<<<<<<<<<<<<
  *                memcpy(dst_data, src_data, itemsize)
  *                src_data += src_stride
  */
     /*else*/ {
       __pyx_t_4 = __pyx_v_dst_extent;
       __pyx_t_5 = __pyx_t_4;
       for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
         __pyx_v_i = __pyx_t_6;
 
-        /* "View.MemoryView":1158
+        /* "View.MemoryView":1160
  *        else:
  *            for i in range(dst_extent):
  *                memcpy(dst_data, src_data, itemsize)             # <<<<<<<<<<<<<<
  *                src_data += src_stride
  *                dst_data += dst_stride
  */
         (void)(memcpy(__pyx_v_dst_data, __pyx_v_src_data, __pyx_v_itemsize));
 
-        /* "View.MemoryView":1159
+        /* "View.MemoryView":1161
  *            for i in range(dst_extent):
  *                memcpy(dst_data, src_data, itemsize)
  *                src_data += src_stride             # <<<<<<<<<<<<<<
  *                dst_data += dst_stride
  *     else:
  */
         __pyx_v_src_data = (__pyx_v_src_data + __pyx_v_src_stride);
 
-        /* "View.MemoryView":1160
+        /* "View.MemoryView":1162
  *                memcpy(dst_data, src_data, itemsize)
  *                src_data += src_stride
  *                dst_data += dst_stride             # <<<<<<<<<<<<<<
  *     else:
  *         for i in range(dst_extent):
  */
         __pyx_v_dst_data = (__pyx_v_dst_data + __pyx_v_dst_stride);
       }
     }
     __pyx_L4:;
 
-    /* "View.MemoryView":1152
+    /* "View.MemoryView":1154
  *     cdef Py_ssize_t dst_stride = dst_strides[0]
  * 
  *     if ndim == 1:             # <<<<<<<<<<<<<<
  *        if (src_stride > 0 and dst_stride > 0 and
  *            <size_t> src_stride == itemsize == <size_t> dst_stride):
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":1162
+  /* "View.MemoryView":1164
  *                dst_data += dst_stride
  *     else:
  *         for i in range(dst_extent):             # <<<<<<<<<<<<<<
  *             _copy_strided_to_strided(src_data, src_strides + 1,
  *                                      dst_data, dst_strides + 1,
  */
   /*else*/ {
     __pyx_t_4 = __pyx_v_dst_extent;
     __pyx_t_5 = __pyx_t_4;
     for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
       __pyx_v_i = __pyx_t_6;
 
-      /* "View.MemoryView":1163
+      /* "View.MemoryView":1165
  *     else:
  *         for i in range(dst_extent):
  *             _copy_strided_to_strided(src_data, src_strides + 1,             # <<<<<<<<<<<<<<
  *                                      dst_data, dst_strides + 1,
  *                                      src_shape + 1, dst_shape + 1,
  */
       _copy_strided_to_strided(__pyx_v_src_data, (__pyx_v_src_strides + 1), __pyx_v_dst_data, (__pyx_v_dst_strides + 1), (__pyx_v_src_shape + 1), (__pyx_v_dst_shape + 1), (__pyx_v_ndim - 1), __pyx_v_itemsize);
 
-      /* "View.MemoryView":1167
+      /* "View.MemoryView":1169
  *                                      src_shape + 1, dst_shape + 1,
  *                                      ndim - 1, itemsize)
  *             src_data += src_stride             # <<<<<<<<<<<<<<
  *             dst_data += dst_stride
  * 
  */
       __pyx_v_src_data = (__pyx_v_src_data + __pyx_v_src_stride);
 
-      /* "View.MemoryView":1168
+      /* "View.MemoryView":1170
  *                                      ndim - 1, itemsize)
  *             src_data += src_stride
  *             dst_data += dst_stride             # <<<<<<<<<<<<<<
  * 
  * cdef void copy_strided_to_strided(__Pyx_memviewslice *src,
  */
       __pyx_v_dst_data = (__pyx_v_dst_data + __pyx_v_dst_stride);
     }
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":1140
+  /* "View.MemoryView":1142
  * 
  * @cython.cdivision(True)
  * cdef void _copy_strided_to_strided(char *src_data, Py_ssize_t *src_strides,             # <<<<<<<<<<<<<<
  *                                    char *dst_data, Py_ssize_t *dst_strides,
  *                                    Py_ssize_t *src_shape, Py_ssize_t *dst_shape,
  */
 
   /* function exit code */
 }
 
-/* "View.MemoryView":1170
+/* "View.MemoryView":1172
  *             dst_data += dst_stride
  * 
  * cdef void copy_strided_to_strided(__Pyx_memviewslice *src,             # <<<<<<<<<<<<<<
  *                                   __Pyx_memviewslice *dst,
  *                                   int ndim, size_t itemsize) nogil:
  */
 
 static void copy_strided_to_strided(__Pyx_memviewslice *__pyx_v_src, __Pyx_memviewslice *__pyx_v_dst, int __pyx_v_ndim, size_t __pyx_v_itemsize) {
 
-  /* "View.MemoryView":1173
+  /* "View.MemoryView":1175
  *                                   __Pyx_memviewslice *dst,
  *                                   int ndim, size_t itemsize) nogil:
  *     _copy_strided_to_strided(src.data, src.strides, dst.data, dst.strides,             # <<<<<<<<<<<<<<
  *                              src.shape, dst.shape, ndim, itemsize)
  * 
  */
   _copy_strided_to_strided(__pyx_v_src->data, __pyx_v_src->strides, __pyx_v_dst->data, __pyx_v_dst->strides, __pyx_v_src->shape, __pyx_v_dst->shape, __pyx_v_ndim, __pyx_v_itemsize);
 
-  /* "View.MemoryView":1170
+  /* "View.MemoryView":1172
  *             dst_data += dst_stride
  * 
  * cdef void copy_strided_to_strided(__Pyx_memviewslice *src,             # <<<<<<<<<<<<<<
  *                                   __Pyx_memviewslice *dst,
  *                                   int ndim, size_t itemsize) nogil:
  */
 
   /* function exit code */
 }
 
-/* "View.MemoryView":1177
+/* "View.MemoryView":1179
  * 
  * @cname('__pyx_memoryview_slice_get_size')
  * cdef Py_ssize_t slice_get_size(__Pyx_memviewslice *src, int ndim) nogil:             # <<<<<<<<<<<<<<
  *     "Return the size of the memory occupied by the slice in number of bytes"
  *     cdef Py_ssize_t shape, size = src.memview.view.itemsize
  */
 
@@ -39664,70 +40061,70 @@
   Py_ssize_t __pyx_v_size;
   Py_ssize_t __pyx_r;
   Py_ssize_t __pyx_t_1;
   Py_ssize_t *__pyx_t_2;
   Py_ssize_t *__pyx_t_3;
   Py_ssize_t *__pyx_t_4;
 
-  /* "View.MemoryView":1179
+  /* "View.MemoryView":1181
  * cdef Py_ssize_t slice_get_size(__Pyx_memviewslice *src, int ndim) nogil:
  *     "Return the size of the memory occupied by the slice in number of bytes"
  *     cdef Py_ssize_t shape, size = src.memview.view.itemsize             # <<<<<<<<<<<<<<
  * 
  *     for shape in src.shape[:ndim]:
  */
   __pyx_t_1 = __pyx_v_src->memview->view.itemsize;
   __pyx_v_size = __pyx_t_1;
 
-  /* "View.MemoryView":1181
+  /* "View.MemoryView":1183
  *     cdef Py_ssize_t shape, size = src.memview.view.itemsize
  * 
  *     for shape in src.shape[:ndim]:             # <<<<<<<<<<<<<<
  *         size *= shape
  * 
  */
   __pyx_t_3 = (__pyx_v_src->shape + __pyx_v_ndim);
   for (__pyx_t_4 = __pyx_v_src->shape; __pyx_t_4 < __pyx_t_3; __pyx_t_4++) {
     __pyx_t_2 = __pyx_t_4;
     __pyx_v_shape = (__pyx_t_2[0]);
 
-    /* "View.MemoryView":1182
+    /* "View.MemoryView":1184
  * 
  *     for shape in src.shape[:ndim]:
  *         size *= shape             # <<<<<<<<<<<<<<
  * 
  *     return size
  */
     __pyx_v_size = (__pyx_v_size * __pyx_v_shape);
   }
 
-  /* "View.MemoryView":1184
+  /* "View.MemoryView":1186
  *         size *= shape
  * 
  *     return size             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_fill_contig_strides_array')
  */
   __pyx_r = __pyx_v_size;
   goto __pyx_L0;
 
-  /* "View.MemoryView":1177
+  /* "View.MemoryView":1179
  * 
  * @cname('__pyx_memoryview_slice_get_size')
  * cdef Py_ssize_t slice_get_size(__Pyx_memviewslice *src, int ndim) nogil:             # <<<<<<<<<<<<<<
  *     "Return the size of the memory occupied by the slice in number of bytes"
  *     cdef Py_ssize_t shape, size = src.memview.view.itemsize
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "View.MemoryView":1187
+/* "View.MemoryView":1189
  * 
  * @cname('__pyx_fill_contig_strides_array')
  * cdef Py_ssize_t fill_contig_strides_array(             # <<<<<<<<<<<<<<
  *                 Py_ssize_t *shape, Py_ssize_t *strides, Py_ssize_t stride,
  *                 int ndim, char order) nogil:
  */
 
@@ -39735,121 +40132,121 @@
   int __pyx_v_idx;
   Py_ssize_t __pyx_r;
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
 
-  /* "View.MemoryView":1196
+  /* "View.MemoryView":1198
  *     cdef int idx
  * 
  *     if order == 'F':             # <<<<<<<<<<<<<<
  *         for idx in range(ndim):
  *             strides[idx] = stride
  */
   __pyx_t_1 = ((__pyx_v_order == 'F') != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":1197
+    /* "View.MemoryView":1199
  * 
  *     if order == 'F':
  *         for idx in range(ndim):             # <<<<<<<<<<<<<<
  *             strides[idx] = stride
  *             stride *= shape[idx]
  */
     __pyx_t_2 = __pyx_v_ndim;
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_idx = __pyx_t_4;
 
-      /* "View.MemoryView":1198
+      /* "View.MemoryView":1200
  *     if order == 'F':
  *         for idx in range(ndim):
  *             strides[idx] = stride             # <<<<<<<<<<<<<<
  *             stride *= shape[idx]
  *     else:
  */
       (__pyx_v_strides[__pyx_v_idx]) = __pyx_v_stride;
 
-      /* "View.MemoryView":1199
+      /* "View.MemoryView":1201
  *         for idx in range(ndim):
  *             strides[idx] = stride
  *             stride *= shape[idx]             # <<<<<<<<<<<<<<
  *     else:
  *         for idx in range(ndim - 1, -1, -1):
  */
       __pyx_v_stride = (__pyx_v_stride * (__pyx_v_shape[__pyx_v_idx]));
     }
 
-    /* "View.MemoryView":1196
+    /* "View.MemoryView":1198
  *     cdef int idx
  * 
  *     if order == 'F':             # <<<<<<<<<<<<<<
  *         for idx in range(ndim):
  *             strides[idx] = stride
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":1201
+  /* "View.MemoryView":1203
  *             stride *= shape[idx]
  *     else:
  *         for idx in range(ndim - 1, -1, -1):             # <<<<<<<<<<<<<<
  *             strides[idx] = stride
  *             stride *= shape[idx]
  */
   /*else*/ {
     for (__pyx_t_2 = (__pyx_v_ndim - 1); __pyx_t_2 > -1; __pyx_t_2-=1) {
       __pyx_v_idx = __pyx_t_2;
 
-      /* "View.MemoryView":1202
+      /* "View.MemoryView":1204
  *     else:
  *         for idx in range(ndim - 1, -1, -1):
  *             strides[idx] = stride             # <<<<<<<<<<<<<<
  *             stride *= shape[idx]
  * 
  */
       (__pyx_v_strides[__pyx_v_idx]) = __pyx_v_stride;
 
-      /* "View.MemoryView":1203
+      /* "View.MemoryView":1205
  *         for idx in range(ndim - 1, -1, -1):
  *             strides[idx] = stride
  *             stride *= shape[idx]             # <<<<<<<<<<<<<<
  * 
  *     return stride
  */
       __pyx_v_stride = (__pyx_v_stride * (__pyx_v_shape[__pyx_v_idx]));
     }
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":1205
+  /* "View.MemoryView":1207
  *             stride *= shape[idx]
  * 
  *     return stride             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_copy_data_to_temp')
  */
   __pyx_r = __pyx_v_stride;
   goto __pyx_L0;
 
-  /* "View.MemoryView":1187
+  /* "View.MemoryView":1189
  * 
  * @cname('__pyx_fill_contig_strides_array')
  * cdef Py_ssize_t fill_contig_strides_array(             # <<<<<<<<<<<<<<
  *                 Py_ssize_t *shape, Py_ssize_t *strides, Py_ssize_t stride,
  *                 int ndim, char order) nogil:
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "View.MemoryView":1208
+/* "View.MemoryView":1210
  * 
  * @cname('__pyx_memoryview_copy_data_to_temp')
  * cdef void *copy_data_to_temp(__Pyx_memviewslice *src,             # <<<<<<<<<<<<<<
  *                              __Pyx_memviewslice *tmpslice,
  *                              char order,
  */
 
@@ -39861,223 +40258,226 @@
   void *__pyx_r;
   Py_ssize_t __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   struct __pyx_memoryview_obj *__pyx_t_4;
   int __pyx_t_5;
   int __pyx_t_6;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
 
-  /* "View.MemoryView":1219
+  /* "View.MemoryView":1221
  *     cdef void *result
  * 
  *     cdef size_t itemsize = src.memview.view.itemsize             # <<<<<<<<<<<<<<
  *     cdef size_t size = slice_get_size(src, ndim)
  * 
  */
   __pyx_t_1 = __pyx_v_src->memview->view.itemsize;
   __pyx_v_itemsize = __pyx_t_1;
 
-  /* "View.MemoryView":1220
+  /* "View.MemoryView":1222
  * 
  *     cdef size_t itemsize = src.memview.view.itemsize
  *     cdef size_t size = slice_get_size(src, ndim)             # <<<<<<<<<<<<<<
  * 
  *     result = malloc(size)
  */
   __pyx_v_size = __pyx_memoryview_slice_get_size(__pyx_v_src, __pyx_v_ndim);
 
-  /* "View.MemoryView":1222
+  /* "View.MemoryView":1224
  *     cdef size_t size = slice_get_size(src, ndim)
  * 
  *     result = malloc(size)             # <<<<<<<<<<<<<<
  *     if not result:
  *         _err(MemoryError, NULL)
  */
   __pyx_v_result = malloc(__pyx_v_size);
 
-  /* "View.MemoryView":1223
+  /* "View.MemoryView":1225
  * 
  *     result = malloc(size)
  *     if not result:             # <<<<<<<<<<<<<<
  *         _err(MemoryError, NULL)
  * 
  */
   __pyx_t_2 = ((!(__pyx_v_result != 0)) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":1224
+    /* "View.MemoryView":1226
  *     result = malloc(size)
  *     if not result:
  *         _err(MemoryError, NULL)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __pyx_memoryview_err(__pyx_builtin_MemoryError, NULL); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(1, 1224, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_err(__pyx_builtin_MemoryError, NULL); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(1, 1226, __pyx_L1_error)
 
-    /* "View.MemoryView":1223
+    /* "View.MemoryView":1225
  * 
  *     result = malloc(size)
  *     if not result:             # <<<<<<<<<<<<<<
  *         _err(MemoryError, NULL)
  * 
  */
   }
 
-  /* "View.MemoryView":1227
+  /* "View.MemoryView":1229
  * 
  * 
  *     tmpslice.data = <char *> result             # <<<<<<<<<<<<<<
  *     tmpslice.memview = src.memview
  *     for i in range(ndim):
  */
   __pyx_v_tmpslice->data = ((char *)__pyx_v_result);
 
-  /* "View.MemoryView":1228
+  /* "View.MemoryView":1230
  * 
  *     tmpslice.data = <char *> result
  *     tmpslice.memview = src.memview             # <<<<<<<<<<<<<<
  *     for i in range(ndim):
  *         tmpslice.shape[i] = src.shape[i]
  */
   __pyx_t_4 = __pyx_v_src->memview;
   __pyx_v_tmpslice->memview = __pyx_t_4;
 
-  /* "View.MemoryView":1229
+  /* "View.MemoryView":1231
  *     tmpslice.data = <char *> result
  *     tmpslice.memview = src.memview
  *     for i in range(ndim):             # <<<<<<<<<<<<<<
  *         tmpslice.shape[i] = src.shape[i]
  *         tmpslice.suboffsets[i] = -1
  */
   __pyx_t_3 = __pyx_v_ndim;
   __pyx_t_5 = __pyx_t_3;
   for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
     __pyx_v_i = __pyx_t_6;
 
-    /* "View.MemoryView":1230
+    /* "View.MemoryView":1232
  *     tmpslice.memview = src.memview
  *     for i in range(ndim):
  *         tmpslice.shape[i] = src.shape[i]             # <<<<<<<<<<<<<<
  *         tmpslice.suboffsets[i] = -1
  * 
  */
     (__pyx_v_tmpslice->shape[__pyx_v_i]) = (__pyx_v_src->shape[__pyx_v_i]);
 
-    /* "View.MemoryView":1231
+    /* "View.MemoryView":1233
  *     for i in range(ndim):
  *         tmpslice.shape[i] = src.shape[i]
  *         tmpslice.suboffsets[i] = -1             # <<<<<<<<<<<<<<
  * 
  *     fill_contig_strides_array(&tmpslice.shape[0], &tmpslice.strides[0], itemsize,
  */
     (__pyx_v_tmpslice->suboffsets[__pyx_v_i]) = -1L;
   }
 
-  /* "View.MemoryView":1233
+  /* "View.MemoryView":1235
  *         tmpslice.suboffsets[i] = -1
  * 
  *     fill_contig_strides_array(&tmpslice.shape[0], &tmpslice.strides[0], itemsize,             # <<<<<<<<<<<<<<
  *                               ndim, order)
  * 
  */
   (void)(__pyx_fill_contig_strides_array((&(__pyx_v_tmpslice->shape[0])), (&(__pyx_v_tmpslice->strides[0])), __pyx_v_itemsize, __pyx_v_ndim, __pyx_v_order));
 
-  /* "View.MemoryView":1237
+  /* "View.MemoryView":1239
  * 
  * 
  *     for i in range(ndim):             # <<<<<<<<<<<<<<
  *         if tmpslice.shape[i] == 1:
  *             tmpslice.strides[i] = 0
  */
   __pyx_t_3 = __pyx_v_ndim;
   __pyx_t_5 = __pyx_t_3;
   for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
     __pyx_v_i = __pyx_t_6;
 
-    /* "View.MemoryView":1238
+    /* "View.MemoryView":1240
  * 
  *     for i in range(ndim):
  *         if tmpslice.shape[i] == 1:             # <<<<<<<<<<<<<<
  *             tmpslice.strides[i] = 0
  * 
  */
     __pyx_t_2 = (((__pyx_v_tmpslice->shape[__pyx_v_i]) == 1) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":1239
+      /* "View.MemoryView":1241
  *     for i in range(ndim):
  *         if tmpslice.shape[i] == 1:
  *             tmpslice.strides[i] = 0             # <<<<<<<<<<<<<<
  * 
  *     if slice_is_contig(src[0], order, ndim):
  */
       (__pyx_v_tmpslice->strides[__pyx_v_i]) = 0;
 
-      /* "View.MemoryView":1238
+      /* "View.MemoryView":1240
  * 
  *     for i in range(ndim):
  *         if tmpslice.shape[i] == 1:             # <<<<<<<<<<<<<<
  *             tmpslice.strides[i] = 0
  * 
  */
     }
   }
 
-  /* "View.MemoryView":1241
+  /* "View.MemoryView":1243
  *             tmpslice.strides[i] = 0
  * 
  *     if slice_is_contig(src[0], order, ndim):             # <<<<<<<<<<<<<<
  *         memcpy(result, src.data, size)
  *     else:
  */
   __pyx_t_2 = (__pyx_memviewslice_is_contig((__pyx_v_src[0]), __pyx_v_order, __pyx_v_ndim) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":1242
+    /* "View.MemoryView":1244
  * 
  *     if slice_is_contig(src[0], order, ndim):
  *         memcpy(result, src.data, size)             # <<<<<<<<<<<<<<
  *     else:
  *         copy_strided_to_strided(src, tmpslice, ndim, itemsize)
  */
     (void)(memcpy(__pyx_v_result, __pyx_v_src->data, __pyx_v_size));
 
-    /* "View.MemoryView":1241
+    /* "View.MemoryView":1243
  *             tmpslice.strides[i] = 0
  * 
  *     if slice_is_contig(src[0], order, ndim):             # <<<<<<<<<<<<<<
  *         memcpy(result, src.data, size)
  *     else:
  */
     goto __pyx_L9;
   }
 
-  /* "View.MemoryView":1244
+  /* "View.MemoryView":1246
  *         memcpy(result, src.data, size)
  *     else:
  *         copy_strided_to_strided(src, tmpslice, ndim, itemsize)             # <<<<<<<<<<<<<<
  * 
  *     return result
  */
   /*else*/ {
     copy_strided_to_strided(__pyx_v_src, __pyx_v_tmpslice, __pyx_v_ndim, __pyx_v_itemsize);
   }
   __pyx_L9:;
 
-  /* "View.MemoryView":1246
+  /* "View.MemoryView":1248
  *         copy_strided_to_strided(src, tmpslice, ndim, itemsize)
  * 
  *     return result             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = __pyx_v_result;
   goto __pyx_L0;
 
-  /* "View.MemoryView":1208
+  /* "View.MemoryView":1210
  * 
  * @cname('__pyx_memoryview_copy_data_to_temp')
  * cdef void *copy_data_to_temp(__Pyx_memviewslice *src,             # <<<<<<<<<<<<<<
  *                              __Pyx_memviewslice *tmpslice,
  *                              char order,
  */
 
@@ -40093,77 +40493,80 @@
     #endif
   }
   __pyx_r = NULL;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "View.MemoryView":1251
+/* "View.MemoryView":1253
  * 
  * @cname('__pyx_memoryview_err_extents')
  * cdef int _err_extents(int i, Py_ssize_t extent1,             # <<<<<<<<<<<<<<
  *                              Py_ssize_t extent2) except -1 with gil:
  *     raise ValueError("got differing extents in dimension %d (got %d and %d)" %
  */
 
 static int __pyx_memoryview_err_extents(int __pyx_v_i, Py_ssize_t __pyx_v_extent1, Py_ssize_t __pyx_v_extent2) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
   #endif
   __Pyx_RefNannySetupContext("_err_extents", 0);
 
-  /* "View.MemoryView":1254
+  /* "View.MemoryView":1256
  *                              Py_ssize_t extent2) except -1 with gil:
  *     raise ValueError("got differing extents in dimension %d (got %d and %d)" %
  *                                                         (i, extent1, extent2))             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_err_dim')
  */
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1254, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_extent1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1254, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_extent1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_extent2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1254, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_extent2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1254, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_3);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
 
-  /* "View.MemoryView":1253
+  /* "View.MemoryView":1255
  * cdef int _err_extents(int i, Py_ssize_t extent1,
  *                              Py_ssize_t extent2) except -1 with gil:
  *     raise ValueError("got differing extents in dimension %d (got %d and %d)" %             # <<<<<<<<<<<<<<
  *                                                         (i, extent1, extent2))
  * 
  */
-  __pyx_t_3 = __Pyx_PyString_Format(__pyx_kp_s_got_differing_extents_in_dimensi, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1253, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyString_Format(__pyx_kp_s_got_differing_extents_in_dimensi, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1255, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1253, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1255, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_Raise(__pyx_t_4, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __PYX_ERR(1, 1253, __pyx_L1_error)
+  __PYX_ERR(1, 1255, __pyx_L1_error)
 
-  /* "View.MemoryView":1251
+  /* "View.MemoryView":1253
  * 
  * @cname('__pyx_memoryview_err_extents')
  * cdef int _err_extents(int i, Py_ssize_t extent1,             # <<<<<<<<<<<<<<
  *                              Py_ssize_t extent2) except -1 with gil:
  *     raise ValueError("got differing extents in dimension %d (got %d and %d)" %
  */
 
@@ -40178,47 +40581,50 @@
   __Pyx_RefNannyFinishContext();
   #ifdef WITH_THREAD
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   return __pyx_r;
 }
 
-/* "View.MemoryView":1257
+/* "View.MemoryView":1259
  * 
  * @cname('__pyx_memoryview_err_dim')
  * cdef int _err_dim(object error, char *msg, int dim) except -1 with gil:             # <<<<<<<<<<<<<<
  *     raise error(msg.decode('ascii') % dim)
  * 
  */
 
 static int __pyx_memoryview_err_dim(PyObject *__pyx_v_error, char *__pyx_v_msg, int __pyx_v_dim) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
   #endif
   __Pyx_RefNannySetupContext("_err_dim", 0);
   __Pyx_INCREF(__pyx_v_error);
 
-  /* "View.MemoryView":1258
+  /* "View.MemoryView":1260
  * @cname('__pyx_memoryview_err_dim')
  * cdef int _err_dim(object error, char *msg, int dim) except -1 with gil:
  *     raise error(msg.decode('ascii') % dim)             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_err')
  */
-  __pyx_t_2 = __Pyx_decode_c_string(__pyx_v_msg, 0, strlen(__pyx_v_msg), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1258, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_decode_c_string(__pyx_v_msg, 0, strlen(__pyx_v_msg), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1260, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_dim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1258, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_dim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1260, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyUnicode_Format(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1258, __pyx_L1_error)
+  __pyx_t_4 = PyUnicode_Format(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1260, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_INCREF(__pyx_v_error);
   __pyx_t_3 = __pyx_v_error; __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -40228,22 +40634,22 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1258, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1260, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(1, 1258, __pyx_L1_error)
+  __PYX_ERR(1, 1260, __pyx_L1_error)
 
-  /* "View.MemoryView":1257
+  /* "View.MemoryView":1259
  * 
  * @cname('__pyx_memoryview_err_dim')
  * cdef int _err_dim(object error, char *msg, int dim) except -1 with gil:             # <<<<<<<<<<<<<<
  *     raise error(msg.decode('ascii') % dim)
  * 
  */
 
@@ -40259,15 +40665,15 @@
   __Pyx_RefNannyFinishContext();
   #ifdef WITH_THREAD
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   return __pyx_r;
 }
 
-/* "View.MemoryView":1261
+/* "View.MemoryView":1263
  * 
  * @cname('__pyx_memoryview_err')
  * cdef int _err(object error, char *msg) except -1 with gil:             # <<<<<<<<<<<<<<
  *     if msg != NULL:
  *         raise error(msg.decode('ascii'))
  */
 
@@ -40275,38 +40681,41 @@
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
   #endif
   __Pyx_RefNannySetupContext("_err", 0);
   __Pyx_INCREF(__pyx_v_error);
 
-  /* "View.MemoryView":1262
+  /* "View.MemoryView":1264
  * @cname('__pyx_memoryview_err')
  * cdef int _err(object error, char *msg) except -1 with gil:
  *     if msg != NULL:             # <<<<<<<<<<<<<<
  *         raise error(msg.decode('ascii'))
  *     else:
  */
   __pyx_t_1 = ((__pyx_v_msg != NULL) != 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "View.MemoryView":1263
+    /* "View.MemoryView":1265
  * cdef int _err(object error, char *msg) except -1 with gil:
  *     if msg != NULL:
  *         raise error(msg.decode('ascii'))             # <<<<<<<<<<<<<<
  *     else:
  *         raise error
  */
-    __pyx_t_3 = __Pyx_decode_c_string(__pyx_v_msg, 0, strlen(__pyx_v_msg), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1263, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_decode_c_string(__pyx_v_msg, 0, strlen(__pyx_v_msg), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1265, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_error);
     __pyx_t_4 = __pyx_v_error; __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -40314,43 +40723,43 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1263, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1265, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(1, 1263, __pyx_L1_error)
+    __PYX_ERR(1, 1265, __pyx_L1_error)
 
-    /* "View.MemoryView":1262
+    /* "View.MemoryView":1264
  * @cname('__pyx_memoryview_err')
  * cdef int _err(object error, char *msg) except -1 with gil:
  *     if msg != NULL:             # <<<<<<<<<<<<<<
  *         raise error(msg.decode('ascii'))
  *     else:
  */
   }
 
-  /* "View.MemoryView":1265
+  /* "View.MemoryView":1267
  *         raise error(msg.decode('ascii'))
  *     else:
  *         raise error             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_copy_contents')
  */
   /*else*/ {
     __Pyx_Raise(__pyx_v_error, 0, 0, 0);
-    __PYX_ERR(1, 1265, __pyx_L1_error)
+    __PYX_ERR(1, 1267, __pyx_L1_error)
   }
 
-  /* "View.MemoryView":1261
+  /* "View.MemoryView":1263
  * 
  * @cname('__pyx_memoryview_err')
  * cdef int _err(object error, char *msg) except -1 with gil:             # <<<<<<<<<<<<<<
  *     if msg != NULL:
  *         raise error(msg.decode('ascii'))
  */
 
@@ -40366,15 +40775,15 @@
   __Pyx_RefNannyFinishContext();
   #ifdef WITH_THREAD
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   return __pyx_r;
 }
 
-/* "View.MemoryView":1268
+/* "View.MemoryView":1270
  * 
  * @cname('__pyx_memoryview_copy_contents')
  * cdef int memoryview_copy_contents(__Pyx_memviewslice src,             # <<<<<<<<<<<<<<
  *                                   __Pyx_memviewslice dst,
  *                                   int src_ndim, int dst_ndim,
  */
 
@@ -40392,120 +40801,123 @@
   int __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_t_6;
   void *__pyx_t_7;
   int __pyx_t_8;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
 
-  /* "View.MemoryView":1276
+  /* "View.MemoryView":1278
  *     Check for overlapping memory and verify the shapes.
  *     """
  *     cdef void *tmpdata = NULL             # <<<<<<<<<<<<<<
  *     cdef size_t itemsize = src.memview.view.itemsize
  *     cdef int i
  */
   __pyx_v_tmpdata = NULL;
 
-  /* "View.MemoryView":1277
+  /* "View.MemoryView":1279
  *     """
  *     cdef void *tmpdata = NULL
  *     cdef size_t itemsize = src.memview.view.itemsize             # <<<<<<<<<<<<<<
  *     cdef int i
  *     cdef char order = get_best_order(&src, src_ndim)
  */
   __pyx_t_1 = __pyx_v_src.memview->view.itemsize;
   __pyx_v_itemsize = __pyx_t_1;
 
-  /* "View.MemoryView":1279
+  /* "View.MemoryView":1281
  *     cdef size_t itemsize = src.memview.view.itemsize
  *     cdef int i
  *     cdef char order = get_best_order(&src, src_ndim)             # <<<<<<<<<<<<<<
  *     cdef bint broadcasting = False
  *     cdef bint direct_copy = False
  */
   __pyx_v_order = __pyx_get_best_slice_order((&__pyx_v_src), __pyx_v_src_ndim);
 
-  /* "View.MemoryView":1280
+  /* "View.MemoryView":1282
  *     cdef int i
  *     cdef char order = get_best_order(&src, src_ndim)
  *     cdef bint broadcasting = False             # <<<<<<<<<<<<<<
  *     cdef bint direct_copy = False
  *     cdef __Pyx_memviewslice tmp
  */
   __pyx_v_broadcasting = 0;
 
-  /* "View.MemoryView":1281
+  /* "View.MemoryView":1283
  *     cdef char order = get_best_order(&src, src_ndim)
  *     cdef bint broadcasting = False
  *     cdef bint direct_copy = False             # <<<<<<<<<<<<<<
  *     cdef __Pyx_memviewslice tmp
  * 
  */
   __pyx_v_direct_copy = 0;
 
-  /* "View.MemoryView":1284
+  /* "View.MemoryView":1286
  *     cdef __Pyx_memviewslice tmp
  * 
  *     if src_ndim < dst_ndim:             # <<<<<<<<<<<<<<
  *         broadcast_leading(&src, src_ndim, dst_ndim)
  *     elif dst_ndim < src_ndim:
  */
   __pyx_t_2 = ((__pyx_v_src_ndim < __pyx_v_dst_ndim) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":1285
+    /* "View.MemoryView":1287
  * 
  *     if src_ndim < dst_ndim:
  *         broadcast_leading(&src, src_ndim, dst_ndim)             # <<<<<<<<<<<<<<
  *     elif dst_ndim < src_ndim:
  *         broadcast_leading(&dst, dst_ndim, src_ndim)
  */
     __pyx_memoryview_broadcast_leading((&__pyx_v_src), __pyx_v_src_ndim, __pyx_v_dst_ndim);
 
-    /* "View.MemoryView":1284
+    /* "View.MemoryView":1286
  *     cdef __Pyx_memviewslice tmp
  * 
  *     if src_ndim < dst_ndim:             # <<<<<<<<<<<<<<
  *         broadcast_leading(&src, src_ndim, dst_ndim)
  *     elif dst_ndim < src_ndim:
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":1286
+  /* "View.MemoryView":1288
  *     if src_ndim < dst_ndim:
  *         broadcast_leading(&src, src_ndim, dst_ndim)
  *     elif dst_ndim < src_ndim:             # <<<<<<<<<<<<<<
  *         broadcast_leading(&dst, dst_ndim, src_ndim)
  * 
  */
   __pyx_t_2 = ((__pyx_v_dst_ndim < __pyx_v_src_ndim) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":1287
+    /* "View.MemoryView":1289
  *         broadcast_leading(&src, src_ndim, dst_ndim)
  *     elif dst_ndim < src_ndim:
  *         broadcast_leading(&dst, dst_ndim, src_ndim)             # <<<<<<<<<<<<<<
  * 
  *     cdef int ndim = max(src_ndim, dst_ndim)
  */
     __pyx_memoryview_broadcast_leading((&__pyx_v_dst), __pyx_v_dst_ndim, __pyx_v_src_ndim);
 
-    /* "View.MemoryView":1286
+    /* "View.MemoryView":1288
  *     if src_ndim < dst_ndim:
  *         broadcast_leading(&src, src_ndim, dst_ndim)
  *     elif dst_ndim < src_ndim:             # <<<<<<<<<<<<<<
  *         broadcast_leading(&dst, dst_ndim, src_ndim)
  * 
  */
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":1289
+  /* "View.MemoryView":1291
  *         broadcast_leading(&dst, dst_ndim, src_ndim)
  * 
  *     cdef int ndim = max(src_ndim, dst_ndim)             # <<<<<<<<<<<<<<
  * 
  *     for i in range(ndim):
  */
   __pyx_t_3 = __pyx_v_dst_ndim;
@@ -40513,420 +40925,420 @@
   if (((__pyx_t_3 > __pyx_t_4) != 0)) {
     __pyx_t_5 = __pyx_t_3;
   } else {
     __pyx_t_5 = __pyx_t_4;
   }
   __pyx_v_ndim = __pyx_t_5;
 
-  /* "View.MemoryView":1291
+  /* "View.MemoryView":1293
  *     cdef int ndim = max(src_ndim, dst_ndim)
  * 
  *     for i in range(ndim):             # <<<<<<<<<<<<<<
  *         if src.shape[i] != dst.shape[i]:
  *             if src.shape[i] == 1:
  */
   __pyx_t_5 = __pyx_v_ndim;
   __pyx_t_3 = __pyx_t_5;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_i = __pyx_t_4;
 
-    /* "View.MemoryView":1292
+    /* "View.MemoryView":1294
  * 
  *     for i in range(ndim):
  *         if src.shape[i] != dst.shape[i]:             # <<<<<<<<<<<<<<
  *             if src.shape[i] == 1:
  *                 broadcasting = True
  */
     __pyx_t_2 = (((__pyx_v_src.shape[__pyx_v_i]) != (__pyx_v_dst.shape[__pyx_v_i])) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":1293
+      /* "View.MemoryView":1295
  *     for i in range(ndim):
  *         if src.shape[i] != dst.shape[i]:
  *             if src.shape[i] == 1:             # <<<<<<<<<<<<<<
  *                 broadcasting = True
  *                 src.strides[i] = 0
  */
       __pyx_t_2 = (((__pyx_v_src.shape[__pyx_v_i]) == 1) != 0);
       if (__pyx_t_2) {
 
-        /* "View.MemoryView":1294
+        /* "View.MemoryView":1296
  *         if src.shape[i] != dst.shape[i]:
  *             if src.shape[i] == 1:
  *                 broadcasting = True             # <<<<<<<<<<<<<<
  *                 src.strides[i] = 0
  *             else:
  */
         __pyx_v_broadcasting = 1;
 
-        /* "View.MemoryView":1295
+        /* "View.MemoryView":1297
  *             if src.shape[i] == 1:
  *                 broadcasting = True
  *                 src.strides[i] = 0             # <<<<<<<<<<<<<<
  *             else:
  *                 _err_extents(i, dst.shape[i], src.shape[i])
  */
         (__pyx_v_src.strides[__pyx_v_i]) = 0;
 
-        /* "View.MemoryView":1293
+        /* "View.MemoryView":1295
  *     for i in range(ndim):
  *         if src.shape[i] != dst.shape[i]:
  *             if src.shape[i] == 1:             # <<<<<<<<<<<<<<
  *                 broadcasting = True
  *                 src.strides[i] = 0
  */
         goto __pyx_L7;
       }
 
-      /* "View.MemoryView":1297
+      /* "View.MemoryView":1299
  *                 src.strides[i] = 0
  *             else:
  *                 _err_extents(i, dst.shape[i], src.shape[i])             # <<<<<<<<<<<<<<
  * 
  *         if src.suboffsets[i] >= 0:
  */
       /*else*/ {
-        __pyx_t_6 = __pyx_memoryview_err_extents(__pyx_v_i, (__pyx_v_dst.shape[__pyx_v_i]), (__pyx_v_src.shape[__pyx_v_i])); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(1, 1297, __pyx_L1_error)
+        __pyx_t_6 = __pyx_memoryview_err_extents(__pyx_v_i, (__pyx_v_dst.shape[__pyx_v_i]), (__pyx_v_src.shape[__pyx_v_i])); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(1, 1299, __pyx_L1_error)
       }
       __pyx_L7:;
 
-      /* "View.MemoryView":1292
+      /* "View.MemoryView":1294
  * 
  *     for i in range(ndim):
  *         if src.shape[i] != dst.shape[i]:             # <<<<<<<<<<<<<<
  *             if src.shape[i] == 1:
  *                 broadcasting = True
  */
     }
 
-    /* "View.MemoryView":1299
+    /* "View.MemoryView":1301
  *                 _err_extents(i, dst.shape[i], src.shape[i])
  * 
  *         if src.suboffsets[i] >= 0:             # <<<<<<<<<<<<<<
  *             _err_dim(ValueError, "Dimension %d is not direct", i)
  * 
  */
     __pyx_t_2 = (((__pyx_v_src.suboffsets[__pyx_v_i]) >= 0) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":1300
+      /* "View.MemoryView":1302
  * 
  *         if src.suboffsets[i] >= 0:
  *             _err_dim(ValueError, "Dimension %d is not direct", i)             # <<<<<<<<<<<<<<
  * 
  *     if slices_overlap(&src, &dst, ndim, itemsize):
  */
-      __pyx_t_6 = __pyx_memoryview_err_dim(__pyx_builtin_ValueError, ((char *)"Dimension %d is not direct"), __pyx_v_i); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(1, 1300, __pyx_L1_error)
+      __pyx_t_6 = __pyx_memoryview_err_dim(__pyx_builtin_ValueError, ((char *)"Dimension %d is not direct"), __pyx_v_i); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(1, 1302, __pyx_L1_error)
 
-      /* "View.MemoryView":1299
+      /* "View.MemoryView":1301
  *                 _err_extents(i, dst.shape[i], src.shape[i])
  * 
  *         if src.suboffsets[i] >= 0:             # <<<<<<<<<<<<<<
  *             _err_dim(ValueError, "Dimension %d is not direct", i)
  * 
  */
     }
   }
 
-  /* "View.MemoryView":1302
+  /* "View.MemoryView":1304
  *             _err_dim(ValueError, "Dimension %d is not direct", i)
  * 
  *     if slices_overlap(&src, &dst, ndim, itemsize):             # <<<<<<<<<<<<<<
  * 
  *         if not slice_is_contig(src, order, ndim):
  */
   __pyx_t_2 = (__pyx_slices_overlap((&__pyx_v_src), (&__pyx_v_dst), __pyx_v_ndim, __pyx_v_itemsize) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":1304
+    /* "View.MemoryView":1306
  *     if slices_overlap(&src, &dst, ndim, itemsize):
  * 
  *         if not slice_is_contig(src, order, ndim):             # <<<<<<<<<<<<<<
  *             order = get_best_order(&dst, ndim)
  * 
  */
     __pyx_t_2 = ((!(__pyx_memviewslice_is_contig(__pyx_v_src, __pyx_v_order, __pyx_v_ndim) != 0)) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":1305
+      /* "View.MemoryView":1307
  * 
  *         if not slice_is_contig(src, order, ndim):
  *             order = get_best_order(&dst, ndim)             # <<<<<<<<<<<<<<
  * 
  *         tmpdata = copy_data_to_temp(&src, &tmp, order, ndim)
  */
       __pyx_v_order = __pyx_get_best_slice_order((&__pyx_v_dst), __pyx_v_ndim);
 
-      /* "View.MemoryView":1304
+      /* "View.MemoryView":1306
  *     if slices_overlap(&src, &dst, ndim, itemsize):
  * 
  *         if not slice_is_contig(src, order, ndim):             # <<<<<<<<<<<<<<
  *             order = get_best_order(&dst, ndim)
  * 
  */
     }
 
-    /* "View.MemoryView":1307
+    /* "View.MemoryView":1309
  *             order = get_best_order(&dst, ndim)
  * 
  *         tmpdata = copy_data_to_temp(&src, &tmp, order, ndim)             # <<<<<<<<<<<<<<
  *         src = tmp
  * 
  */
-    __pyx_t_7 = __pyx_memoryview_copy_data_to_temp((&__pyx_v_src), (&__pyx_v_tmp), __pyx_v_order, __pyx_v_ndim); if (unlikely(__pyx_t_7 == ((void *)NULL))) __PYX_ERR(1, 1307, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_copy_data_to_temp((&__pyx_v_src), (&__pyx_v_tmp), __pyx_v_order, __pyx_v_ndim); if (unlikely(__pyx_t_7 == ((void *)NULL))) __PYX_ERR(1, 1309, __pyx_L1_error)
     __pyx_v_tmpdata = __pyx_t_7;
 
-    /* "View.MemoryView":1308
+    /* "View.MemoryView":1310
  * 
  *         tmpdata = copy_data_to_temp(&src, &tmp, order, ndim)
  *         src = tmp             # <<<<<<<<<<<<<<
  * 
  *     if not broadcasting:
  */
     __pyx_v_src = __pyx_v_tmp;
 
-    /* "View.MemoryView":1302
+    /* "View.MemoryView":1304
  *             _err_dim(ValueError, "Dimension %d is not direct", i)
  * 
  *     if slices_overlap(&src, &dst, ndim, itemsize):             # <<<<<<<<<<<<<<
  * 
  *         if not slice_is_contig(src, order, ndim):
  */
   }
 
-  /* "View.MemoryView":1310
+  /* "View.MemoryView":1312
  *         src = tmp
  * 
  *     if not broadcasting:             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_2 = ((!(__pyx_v_broadcasting != 0)) != 0);
   if (__pyx_t_2) {
 
-    /* "View.MemoryView":1313
+    /* "View.MemoryView":1315
  * 
  * 
  *         if slice_is_contig(src, 'C', ndim):             # <<<<<<<<<<<<<<
  *             direct_copy = slice_is_contig(dst, 'C', ndim)
  *         elif slice_is_contig(src, 'F', ndim):
  */
     __pyx_t_2 = (__pyx_memviewslice_is_contig(__pyx_v_src, 'C', __pyx_v_ndim) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":1314
+      /* "View.MemoryView":1316
  * 
  *         if slice_is_contig(src, 'C', ndim):
  *             direct_copy = slice_is_contig(dst, 'C', ndim)             # <<<<<<<<<<<<<<
  *         elif slice_is_contig(src, 'F', ndim):
  *             direct_copy = slice_is_contig(dst, 'F', ndim)
  */
       __pyx_v_direct_copy = __pyx_memviewslice_is_contig(__pyx_v_dst, 'C', __pyx_v_ndim);
 
-      /* "View.MemoryView":1313
+      /* "View.MemoryView":1315
  * 
  * 
  *         if slice_is_contig(src, 'C', ndim):             # <<<<<<<<<<<<<<
  *             direct_copy = slice_is_contig(dst, 'C', ndim)
  *         elif slice_is_contig(src, 'F', ndim):
  */
       goto __pyx_L12;
     }
 
-    /* "View.MemoryView":1315
+    /* "View.MemoryView":1317
  *         if slice_is_contig(src, 'C', ndim):
  *             direct_copy = slice_is_contig(dst, 'C', ndim)
  *         elif slice_is_contig(src, 'F', ndim):             # <<<<<<<<<<<<<<
  *             direct_copy = slice_is_contig(dst, 'F', ndim)
  * 
  */
     __pyx_t_2 = (__pyx_memviewslice_is_contig(__pyx_v_src, 'F', __pyx_v_ndim) != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":1316
+      /* "View.MemoryView":1318
  *             direct_copy = slice_is_contig(dst, 'C', ndim)
  *         elif slice_is_contig(src, 'F', ndim):
  *             direct_copy = slice_is_contig(dst, 'F', ndim)             # <<<<<<<<<<<<<<
  * 
  *         if direct_copy:
  */
       __pyx_v_direct_copy = __pyx_memviewslice_is_contig(__pyx_v_dst, 'F', __pyx_v_ndim);
 
-      /* "View.MemoryView":1315
+      /* "View.MemoryView":1317
  *         if slice_is_contig(src, 'C', ndim):
  *             direct_copy = slice_is_contig(dst, 'C', ndim)
  *         elif slice_is_contig(src, 'F', ndim):             # <<<<<<<<<<<<<<
  *             direct_copy = slice_is_contig(dst, 'F', ndim)
  * 
  */
     }
     __pyx_L12:;
 
-    /* "View.MemoryView":1318
+    /* "View.MemoryView":1320
  *             direct_copy = slice_is_contig(dst, 'F', ndim)
  * 
  *         if direct_copy:             # <<<<<<<<<<<<<<
  * 
  *             refcount_copying(&dst, dtype_is_object, ndim, False)
  */
     __pyx_t_2 = (__pyx_v_direct_copy != 0);
     if (__pyx_t_2) {
 
-      /* "View.MemoryView":1320
+      /* "View.MemoryView":1322
  *         if direct_copy:
  * 
  *             refcount_copying(&dst, dtype_is_object, ndim, False)             # <<<<<<<<<<<<<<
  *             memcpy(dst.data, src.data, slice_get_size(&src, ndim))
  *             refcount_copying(&dst, dtype_is_object, ndim, True)
  */
       __pyx_memoryview_refcount_copying((&__pyx_v_dst), __pyx_v_dtype_is_object, __pyx_v_ndim, 0);
 
-      /* "View.MemoryView":1321
+      /* "View.MemoryView":1323
  * 
  *             refcount_copying(&dst, dtype_is_object, ndim, False)
  *             memcpy(dst.data, src.data, slice_get_size(&src, ndim))             # <<<<<<<<<<<<<<
  *             refcount_copying(&dst, dtype_is_object, ndim, True)
  *             free(tmpdata)
  */
       (void)(memcpy(__pyx_v_dst.data, __pyx_v_src.data, __pyx_memoryview_slice_get_size((&__pyx_v_src), __pyx_v_ndim)));
 
-      /* "View.MemoryView":1322
+      /* "View.MemoryView":1324
  *             refcount_copying(&dst, dtype_is_object, ndim, False)
  *             memcpy(dst.data, src.data, slice_get_size(&src, ndim))
  *             refcount_copying(&dst, dtype_is_object, ndim, True)             # <<<<<<<<<<<<<<
  *             free(tmpdata)
  *             return 0
  */
       __pyx_memoryview_refcount_copying((&__pyx_v_dst), __pyx_v_dtype_is_object, __pyx_v_ndim, 1);
 
-      /* "View.MemoryView":1323
+      /* "View.MemoryView":1325
  *             memcpy(dst.data, src.data, slice_get_size(&src, ndim))
  *             refcount_copying(&dst, dtype_is_object, ndim, True)
  *             free(tmpdata)             # <<<<<<<<<<<<<<
  *             return 0
  * 
  */
       free(__pyx_v_tmpdata);
 
-      /* "View.MemoryView":1324
+      /* "View.MemoryView":1326
  *             refcount_copying(&dst, dtype_is_object, ndim, True)
  *             free(tmpdata)
  *             return 0             # <<<<<<<<<<<<<<
  * 
  *     if order == 'F' == get_best_order(&dst, ndim):
  */
       __pyx_r = 0;
       goto __pyx_L0;
 
-      /* "View.MemoryView":1318
+      /* "View.MemoryView":1320
  *             direct_copy = slice_is_contig(dst, 'F', ndim)
  * 
  *         if direct_copy:             # <<<<<<<<<<<<<<
  * 
  *             refcount_copying(&dst, dtype_is_object, ndim, False)
  */
     }
 
-    /* "View.MemoryView":1310
+    /* "View.MemoryView":1312
  *         src = tmp
  * 
  *     if not broadcasting:             # <<<<<<<<<<<<<<
  * 
  * 
  */
   }
 
-  /* "View.MemoryView":1326
+  /* "View.MemoryView":1328
  *             return 0
  * 
  *     if order == 'F' == get_best_order(&dst, ndim):             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_2 = (__pyx_v_order == 'F');
   if (__pyx_t_2) {
     __pyx_t_2 = ('F' == __pyx_get_best_slice_order((&__pyx_v_dst), __pyx_v_ndim));
   }
   __pyx_t_8 = (__pyx_t_2 != 0);
   if (__pyx_t_8) {
 
-    /* "View.MemoryView":1329
+    /* "View.MemoryView":1331
  * 
  * 
  *         transpose_memslice(&src)             # <<<<<<<<<<<<<<
  *         transpose_memslice(&dst)
  * 
  */
-    __pyx_t_5 = __pyx_memslice_transpose((&__pyx_v_src)); if (unlikely(__pyx_t_5 == ((int)0))) __PYX_ERR(1, 1329, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memslice_transpose((&__pyx_v_src)); if (unlikely(__pyx_t_5 == ((int)0))) __PYX_ERR(1, 1331, __pyx_L1_error)
 
-    /* "View.MemoryView":1330
+    /* "View.MemoryView":1332
  * 
  *         transpose_memslice(&src)
  *         transpose_memslice(&dst)             # <<<<<<<<<<<<<<
  * 
  *     refcount_copying(&dst, dtype_is_object, ndim, False)
  */
-    __pyx_t_5 = __pyx_memslice_transpose((&__pyx_v_dst)); if (unlikely(__pyx_t_5 == ((int)0))) __PYX_ERR(1, 1330, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memslice_transpose((&__pyx_v_dst)); if (unlikely(__pyx_t_5 == ((int)0))) __PYX_ERR(1, 1332, __pyx_L1_error)
 
-    /* "View.MemoryView":1326
+    /* "View.MemoryView":1328
  *             return 0
  * 
  *     if order == 'F' == get_best_order(&dst, ndim):             # <<<<<<<<<<<<<<
  * 
  * 
  */
   }
 
-  /* "View.MemoryView":1332
+  /* "View.MemoryView":1334
  *         transpose_memslice(&dst)
  * 
  *     refcount_copying(&dst, dtype_is_object, ndim, False)             # <<<<<<<<<<<<<<
  *     copy_strided_to_strided(&src, &dst, ndim, itemsize)
  *     refcount_copying(&dst, dtype_is_object, ndim, True)
  */
   __pyx_memoryview_refcount_copying((&__pyx_v_dst), __pyx_v_dtype_is_object, __pyx_v_ndim, 0);
 
-  /* "View.MemoryView":1333
+  /* "View.MemoryView":1335
  * 
  *     refcount_copying(&dst, dtype_is_object, ndim, False)
  *     copy_strided_to_strided(&src, &dst, ndim, itemsize)             # <<<<<<<<<<<<<<
  *     refcount_copying(&dst, dtype_is_object, ndim, True)
  * 
  */
   copy_strided_to_strided((&__pyx_v_src), (&__pyx_v_dst), __pyx_v_ndim, __pyx_v_itemsize);
 
-  /* "View.MemoryView":1334
+  /* "View.MemoryView":1336
  *     refcount_copying(&dst, dtype_is_object, ndim, False)
  *     copy_strided_to_strided(&src, &dst, ndim, itemsize)
  *     refcount_copying(&dst, dtype_is_object, ndim, True)             # <<<<<<<<<<<<<<
  * 
  *     free(tmpdata)
  */
   __pyx_memoryview_refcount_copying((&__pyx_v_dst), __pyx_v_dtype_is_object, __pyx_v_ndim, 1);
 
-  /* "View.MemoryView":1336
+  /* "View.MemoryView":1338
  *     refcount_copying(&dst, dtype_is_object, ndim, True)
  * 
  *     free(tmpdata)             # <<<<<<<<<<<<<<
  *     return 0
  * 
  */
   free(__pyx_v_tmpdata);
 
-  /* "View.MemoryView":1337
+  /* "View.MemoryView":1339
  * 
  *     free(tmpdata)
  *     return 0             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_broadcast_leading')
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "View.MemoryView":1268
+  /* "View.MemoryView":1270
  * 
  * @cname('__pyx_memoryview_copy_contents')
  * cdef int memoryview_copy_contents(__Pyx_memviewslice src,             # <<<<<<<<<<<<<<
  *                                   __Pyx_memviewslice dst,
  *                                   int src_ndim, int dst_ndim,
  */
 
@@ -40942,217 +41354,217 @@
     #endif
   }
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "View.MemoryView":1340
+/* "View.MemoryView":1342
  * 
  * @cname('__pyx_memoryview_broadcast_leading')
  * cdef void broadcast_leading(__Pyx_memviewslice *mslice,             # <<<<<<<<<<<<<<
  *                             int ndim,
  *                             int ndim_other) nogil:
  */
 
 static void __pyx_memoryview_broadcast_leading(__Pyx_memviewslice *__pyx_v_mslice, int __pyx_v_ndim, int __pyx_v_ndim_other) {
   int __pyx_v_i;
   int __pyx_v_offset;
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
 
-  /* "View.MemoryView":1344
+  /* "View.MemoryView":1346
  *                             int ndim_other) nogil:
  *     cdef int i
  *     cdef int offset = ndim_other - ndim             # <<<<<<<<<<<<<<
  * 
  *     for i in range(ndim - 1, -1, -1):
  */
   __pyx_v_offset = (__pyx_v_ndim_other - __pyx_v_ndim);
 
-  /* "View.MemoryView":1346
+  /* "View.MemoryView":1348
  *     cdef int offset = ndim_other - ndim
  * 
  *     for i in range(ndim - 1, -1, -1):             # <<<<<<<<<<<<<<
  *         mslice.shape[i + offset] = mslice.shape[i]
  *         mslice.strides[i + offset] = mslice.strides[i]
  */
   for (__pyx_t_1 = (__pyx_v_ndim - 1); __pyx_t_1 > -1; __pyx_t_1-=1) {
     __pyx_v_i = __pyx_t_1;
 
-    /* "View.MemoryView":1347
+    /* "View.MemoryView":1349
  * 
  *     for i in range(ndim - 1, -1, -1):
  *         mslice.shape[i + offset] = mslice.shape[i]             # <<<<<<<<<<<<<<
  *         mslice.strides[i + offset] = mslice.strides[i]
  *         mslice.suboffsets[i + offset] = mslice.suboffsets[i]
  */
     (__pyx_v_mslice->shape[(__pyx_v_i + __pyx_v_offset)]) = (__pyx_v_mslice->shape[__pyx_v_i]);
 
-    /* "View.MemoryView":1348
+    /* "View.MemoryView":1350
  *     for i in range(ndim - 1, -1, -1):
  *         mslice.shape[i + offset] = mslice.shape[i]
  *         mslice.strides[i + offset] = mslice.strides[i]             # <<<<<<<<<<<<<<
  *         mslice.suboffsets[i + offset] = mslice.suboffsets[i]
  * 
  */
     (__pyx_v_mslice->strides[(__pyx_v_i + __pyx_v_offset)]) = (__pyx_v_mslice->strides[__pyx_v_i]);
 
-    /* "View.MemoryView":1349
+    /* "View.MemoryView":1351
  *         mslice.shape[i + offset] = mslice.shape[i]
  *         mslice.strides[i + offset] = mslice.strides[i]
  *         mslice.suboffsets[i + offset] = mslice.suboffsets[i]             # <<<<<<<<<<<<<<
  * 
  *     for i in range(offset):
  */
     (__pyx_v_mslice->suboffsets[(__pyx_v_i + __pyx_v_offset)]) = (__pyx_v_mslice->suboffsets[__pyx_v_i]);
   }
 
-  /* "View.MemoryView":1351
+  /* "View.MemoryView":1353
  *         mslice.suboffsets[i + offset] = mslice.suboffsets[i]
  * 
  *     for i in range(offset):             # <<<<<<<<<<<<<<
  *         mslice.shape[i] = 1
  *         mslice.strides[i] = mslice.strides[0]
  */
   __pyx_t_1 = __pyx_v_offset;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "View.MemoryView":1352
+    /* "View.MemoryView":1354
  * 
  *     for i in range(offset):
  *         mslice.shape[i] = 1             # <<<<<<<<<<<<<<
  *         mslice.strides[i] = mslice.strides[0]
  *         mslice.suboffsets[i] = -1
  */
     (__pyx_v_mslice->shape[__pyx_v_i]) = 1;
 
-    /* "View.MemoryView":1353
+    /* "View.MemoryView":1355
  *     for i in range(offset):
  *         mslice.shape[i] = 1
  *         mslice.strides[i] = mslice.strides[0]             # <<<<<<<<<<<<<<
  *         mslice.suboffsets[i] = -1
  * 
  */
     (__pyx_v_mslice->strides[__pyx_v_i]) = (__pyx_v_mslice->strides[0]);
 
-    /* "View.MemoryView":1354
+    /* "View.MemoryView":1356
  *         mslice.shape[i] = 1
  *         mslice.strides[i] = mslice.strides[0]
  *         mslice.suboffsets[i] = -1             # <<<<<<<<<<<<<<
  * 
  * 
  */
     (__pyx_v_mslice->suboffsets[__pyx_v_i]) = -1L;
   }
 
-  /* "View.MemoryView":1340
+  /* "View.MemoryView":1342
  * 
  * @cname('__pyx_memoryview_broadcast_leading')
  * cdef void broadcast_leading(__Pyx_memviewslice *mslice,             # <<<<<<<<<<<<<<
  *                             int ndim,
  *                             int ndim_other) nogil:
  */
 
   /* function exit code */
 }
 
-/* "View.MemoryView":1362
+/* "View.MemoryView":1364
  * 
  * @cname('__pyx_memoryview_refcount_copying')
  * cdef void refcount_copying(__Pyx_memviewslice *dst, bint dtype_is_object,             # <<<<<<<<<<<<<<
  *                            int ndim, bint inc) nogil:
  * 
  */
 
 static void __pyx_memoryview_refcount_copying(__Pyx_memviewslice *__pyx_v_dst, int __pyx_v_dtype_is_object, int __pyx_v_ndim, int __pyx_v_inc) {
   int __pyx_t_1;
 
-  /* "View.MemoryView":1366
+  /* "View.MemoryView":1368
  * 
  * 
  *     if dtype_is_object:             # <<<<<<<<<<<<<<
  *         refcount_objects_in_slice_with_gil(dst.data, dst.shape,
  *                                            dst.strides, ndim, inc)
  */
   __pyx_t_1 = (__pyx_v_dtype_is_object != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":1367
+    /* "View.MemoryView":1369
  * 
  *     if dtype_is_object:
  *         refcount_objects_in_slice_with_gil(dst.data, dst.shape,             # <<<<<<<<<<<<<<
  *                                            dst.strides, ndim, inc)
  * 
  */
     __pyx_memoryview_refcount_objects_in_slice_with_gil(__pyx_v_dst->data, __pyx_v_dst->shape, __pyx_v_dst->strides, __pyx_v_ndim, __pyx_v_inc);
 
-    /* "View.MemoryView":1366
+    /* "View.MemoryView":1368
  * 
  * 
  *     if dtype_is_object:             # <<<<<<<<<<<<<<
  *         refcount_objects_in_slice_with_gil(dst.data, dst.shape,
  *                                            dst.strides, ndim, inc)
  */
   }
 
-  /* "View.MemoryView":1362
+  /* "View.MemoryView":1364
  * 
  * @cname('__pyx_memoryview_refcount_copying')
  * cdef void refcount_copying(__Pyx_memviewslice *dst, bint dtype_is_object,             # <<<<<<<<<<<<<<
  *                            int ndim, bint inc) nogil:
  * 
  */
 
   /* function exit code */
 }
 
-/* "View.MemoryView":1371
+/* "View.MemoryView":1373
  * 
  * @cname('__pyx_memoryview_refcount_objects_in_slice_with_gil')
  * cdef void refcount_objects_in_slice_with_gil(char *data, Py_ssize_t *shape,             # <<<<<<<<<<<<<<
  *                                              Py_ssize_t *strides, int ndim,
  *                                              bint inc) with gil:
  */
 
 static void __pyx_memoryview_refcount_objects_in_slice_with_gil(char *__pyx_v_data, Py_ssize_t *__pyx_v_shape, Py_ssize_t *__pyx_v_strides, int __pyx_v_ndim, int __pyx_v_inc) {
   __Pyx_RefNannyDeclarations
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
   #endif
   __Pyx_RefNannySetupContext("refcount_objects_in_slice_with_gil", 0);
 
-  /* "View.MemoryView":1374
+  /* "View.MemoryView":1376
  *                                              Py_ssize_t *strides, int ndim,
  *                                              bint inc) with gil:
  *     refcount_objects_in_slice(data, shape, strides, ndim, inc)             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_refcount_objects_in_slice')
  */
   __pyx_memoryview_refcount_objects_in_slice(__pyx_v_data, __pyx_v_shape, __pyx_v_strides, __pyx_v_ndim, __pyx_v_inc);
 
-  /* "View.MemoryView":1371
+  /* "View.MemoryView":1373
  * 
  * @cname('__pyx_memoryview_refcount_objects_in_slice_with_gil')
  * cdef void refcount_objects_in_slice_with_gil(char *data, Py_ssize_t *shape,             # <<<<<<<<<<<<<<
  *                                              Py_ssize_t *strides, int ndim,
  *                                              bint inc) with gil:
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   #ifdef WITH_THREAD
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
 }
 
-/* "View.MemoryView":1377
+/* "View.MemoryView":1379
  * 
  * @cname('__pyx_memoryview_refcount_objects_in_slice')
  * cdef void refcount_objects_in_slice(char *data, Py_ssize_t *shape,             # <<<<<<<<<<<<<<
  *                                     Py_ssize_t *strides, int ndim, bint inc):
  *     cdef Py_ssize_t i
  */
 
@@ -41161,178 +41573,178 @@
   __Pyx_RefNannyDeclarations
   Py_ssize_t __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   Py_ssize_t __pyx_t_3;
   int __pyx_t_4;
   __Pyx_RefNannySetupContext("refcount_objects_in_slice", 0);
 
-  /* "View.MemoryView":1381
+  /* "View.MemoryView":1383
  *     cdef Py_ssize_t i
  * 
  *     for i in range(shape[0]):             # <<<<<<<<<<<<<<
  *         if ndim == 1:
  *             if inc:
  */
   __pyx_t_1 = (__pyx_v_shape[0]);
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "View.MemoryView":1382
+    /* "View.MemoryView":1384
  * 
  *     for i in range(shape[0]):
  *         if ndim == 1:             # <<<<<<<<<<<<<<
  *             if inc:
  *                 Py_INCREF((<PyObject **> data)[0])
  */
     __pyx_t_4 = ((__pyx_v_ndim == 1) != 0);
     if (__pyx_t_4) {
 
-      /* "View.MemoryView":1383
+      /* "View.MemoryView":1385
  *     for i in range(shape[0]):
  *         if ndim == 1:
  *             if inc:             # <<<<<<<<<<<<<<
  *                 Py_INCREF((<PyObject **> data)[0])
  *             else:
  */
       __pyx_t_4 = (__pyx_v_inc != 0);
       if (__pyx_t_4) {
 
-        /* "View.MemoryView":1384
+        /* "View.MemoryView":1386
  *         if ndim == 1:
  *             if inc:
  *                 Py_INCREF((<PyObject **> data)[0])             # <<<<<<<<<<<<<<
  *             else:
  *                 Py_DECREF((<PyObject **> data)[0])
  */
         Py_INCREF((((PyObject **)__pyx_v_data)[0]));
 
-        /* "View.MemoryView":1383
+        /* "View.MemoryView":1385
  *     for i in range(shape[0]):
  *         if ndim == 1:
  *             if inc:             # <<<<<<<<<<<<<<
  *                 Py_INCREF((<PyObject **> data)[0])
  *             else:
  */
         goto __pyx_L6;
       }
 
-      /* "View.MemoryView":1386
+      /* "View.MemoryView":1388
  *                 Py_INCREF((<PyObject **> data)[0])
  *             else:
  *                 Py_DECREF((<PyObject **> data)[0])             # <<<<<<<<<<<<<<
  *         else:
  *             refcount_objects_in_slice(data, shape + 1, strides + 1,
  */
       /*else*/ {
         Py_DECREF((((PyObject **)__pyx_v_data)[0]));
       }
       __pyx_L6:;
 
-      /* "View.MemoryView":1382
+      /* "View.MemoryView":1384
  * 
  *     for i in range(shape[0]):
  *         if ndim == 1:             # <<<<<<<<<<<<<<
  *             if inc:
  *                 Py_INCREF((<PyObject **> data)[0])
  */
       goto __pyx_L5;
     }
 
-    /* "View.MemoryView":1388
+    /* "View.MemoryView":1390
  *                 Py_DECREF((<PyObject **> data)[0])
  *         else:
  *             refcount_objects_in_slice(data, shape + 1, strides + 1,             # <<<<<<<<<<<<<<
  *                                       ndim - 1, inc)
  * 
  */
     /*else*/ {
 
-      /* "View.MemoryView":1389
+      /* "View.MemoryView":1391
  *         else:
  *             refcount_objects_in_slice(data, shape + 1, strides + 1,
  *                                       ndim - 1, inc)             # <<<<<<<<<<<<<<
  * 
  *         data += strides[0]
  */
       __pyx_memoryview_refcount_objects_in_slice(__pyx_v_data, (__pyx_v_shape + 1), (__pyx_v_strides + 1), (__pyx_v_ndim - 1), __pyx_v_inc);
     }
     __pyx_L5:;
 
-    /* "View.MemoryView":1391
+    /* "View.MemoryView":1393
  *                                       ndim - 1, inc)
  * 
  *         data += strides[0]             # <<<<<<<<<<<<<<
  * 
  * 
  */
     __pyx_v_data = (__pyx_v_data + (__pyx_v_strides[0]));
   }
 
-  /* "View.MemoryView":1377
+  /* "View.MemoryView":1379
  * 
  * @cname('__pyx_memoryview_refcount_objects_in_slice')
  * cdef void refcount_objects_in_slice(char *data, Py_ssize_t *shape,             # <<<<<<<<<<<<<<
  *                                     Py_ssize_t *strides, int ndim, bint inc):
  *     cdef Py_ssize_t i
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "View.MemoryView":1397
+/* "View.MemoryView":1399
  * 
  * @cname('__pyx_memoryview_slice_assign_scalar')
  * cdef void slice_assign_scalar(__Pyx_memviewslice *dst, int ndim,             # <<<<<<<<<<<<<<
  *                               size_t itemsize, void *item,
  *                               bint dtype_is_object) nogil:
  */
 
 static void __pyx_memoryview_slice_assign_scalar(__Pyx_memviewslice *__pyx_v_dst, int __pyx_v_ndim, size_t __pyx_v_itemsize, void *__pyx_v_item, int __pyx_v_dtype_is_object) {
 
-  /* "View.MemoryView":1400
+  /* "View.MemoryView":1402
  *                               size_t itemsize, void *item,
  *                               bint dtype_is_object) nogil:
  *     refcount_copying(dst, dtype_is_object, ndim, False)             # <<<<<<<<<<<<<<
  *     _slice_assign_scalar(dst.data, dst.shape, dst.strides, ndim,
  *                          itemsize, item)
  */
   __pyx_memoryview_refcount_copying(__pyx_v_dst, __pyx_v_dtype_is_object, __pyx_v_ndim, 0);
 
-  /* "View.MemoryView":1401
+  /* "View.MemoryView":1403
  *                               bint dtype_is_object) nogil:
  *     refcount_copying(dst, dtype_is_object, ndim, False)
  *     _slice_assign_scalar(dst.data, dst.shape, dst.strides, ndim,             # <<<<<<<<<<<<<<
  *                          itemsize, item)
  *     refcount_copying(dst, dtype_is_object, ndim, True)
  */
   __pyx_memoryview__slice_assign_scalar(__pyx_v_dst->data, __pyx_v_dst->shape, __pyx_v_dst->strides, __pyx_v_ndim, __pyx_v_itemsize, __pyx_v_item);
 
-  /* "View.MemoryView":1403
+  /* "View.MemoryView":1405
  *     _slice_assign_scalar(dst.data, dst.shape, dst.strides, ndim,
  *                          itemsize, item)
  *     refcount_copying(dst, dtype_is_object, ndim, True)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_memoryview_refcount_copying(__pyx_v_dst, __pyx_v_dtype_is_object, __pyx_v_ndim, 1);
 
-  /* "View.MemoryView":1397
+  /* "View.MemoryView":1399
  * 
  * @cname('__pyx_memoryview_slice_assign_scalar')
  * cdef void slice_assign_scalar(__Pyx_memviewslice *dst, int ndim,             # <<<<<<<<<<<<<<
  *                               size_t itemsize, void *item,
  *                               bint dtype_is_object) nogil:
  */
 
   /* function exit code */
 }
 
-/* "View.MemoryView":1407
+/* "View.MemoryView":1409
  * 
  * @cname('__pyx_memoryview__slice_assign_scalar')
  * cdef void _slice_assign_scalar(char *data, Py_ssize_t *shape,             # <<<<<<<<<<<<<<
  *                               Py_ssize_t *strides, int ndim,
  *                               size_t itemsize, void *item) nogil:
  */
 
@@ -41341,118 +41753,118 @@
   Py_ssize_t __pyx_v_stride;
   Py_ssize_t __pyx_v_extent;
   int __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   Py_ssize_t __pyx_t_3;
   Py_ssize_t __pyx_t_4;
 
-  /* "View.MemoryView":1411
+  /* "View.MemoryView":1413
  *                               size_t itemsize, void *item) nogil:
  *     cdef Py_ssize_t i
  *     cdef Py_ssize_t stride = strides[0]             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t extent = shape[0]
  * 
  */
   __pyx_v_stride = (__pyx_v_strides[0]);
 
-  /* "View.MemoryView":1412
+  /* "View.MemoryView":1414
  *     cdef Py_ssize_t i
  *     cdef Py_ssize_t stride = strides[0]
  *     cdef Py_ssize_t extent = shape[0]             # <<<<<<<<<<<<<<
  * 
  *     if ndim == 1:
  */
   __pyx_v_extent = (__pyx_v_shape[0]);
 
-  /* "View.MemoryView":1414
+  /* "View.MemoryView":1416
  *     cdef Py_ssize_t extent = shape[0]
  * 
  *     if ndim == 1:             # <<<<<<<<<<<<<<
  *         for i in range(extent):
  *             memcpy(data, item, itemsize)
  */
   __pyx_t_1 = ((__pyx_v_ndim == 1) != 0);
   if (__pyx_t_1) {
 
-    /* "View.MemoryView":1415
+    /* "View.MemoryView":1417
  * 
  *     if ndim == 1:
  *         for i in range(extent):             # <<<<<<<<<<<<<<
  *             memcpy(data, item, itemsize)
  *             data += stride
  */
     __pyx_t_2 = __pyx_v_extent;
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_i = __pyx_t_4;
 
-      /* "View.MemoryView":1416
+      /* "View.MemoryView":1418
  *     if ndim == 1:
  *         for i in range(extent):
  *             memcpy(data, item, itemsize)             # <<<<<<<<<<<<<<
  *             data += stride
  *     else:
  */
       (void)(memcpy(__pyx_v_data, __pyx_v_item, __pyx_v_itemsize));
 
-      /* "View.MemoryView":1417
+      /* "View.MemoryView":1419
  *         for i in range(extent):
  *             memcpy(data, item, itemsize)
  *             data += stride             # <<<<<<<<<<<<<<
  *     else:
  *         for i in range(extent):
  */
       __pyx_v_data = (__pyx_v_data + __pyx_v_stride);
     }
 
-    /* "View.MemoryView":1414
+    /* "View.MemoryView":1416
  *     cdef Py_ssize_t extent = shape[0]
  * 
  *     if ndim == 1:             # <<<<<<<<<<<<<<
  *         for i in range(extent):
  *             memcpy(data, item, itemsize)
  */
     goto __pyx_L3;
   }
 
-  /* "View.MemoryView":1419
+  /* "View.MemoryView":1421
  *             data += stride
  *     else:
  *         for i in range(extent):             # <<<<<<<<<<<<<<
  *             _slice_assign_scalar(data, shape + 1, strides + 1,
  *                                 ndim - 1, itemsize, item)
  */
   /*else*/ {
     __pyx_t_2 = __pyx_v_extent;
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_i = __pyx_t_4;
 
-      /* "View.MemoryView":1420
+      /* "View.MemoryView":1422
  *     else:
  *         for i in range(extent):
  *             _slice_assign_scalar(data, shape + 1, strides + 1,             # <<<<<<<<<<<<<<
  *                                 ndim - 1, itemsize, item)
  *             data += stride
  */
       __pyx_memoryview__slice_assign_scalar(__pyx_v_data, (__pyx_v_shape + 1), (__pyx_v_strides + 1), (__pyx_v_ndim - 1), __pyx_v_itemsize, __pyx_v_item);
 
-      /* "View.MemoryView":1422
+      /* "View.MemoryView":1424
  *             _slice_assign_scalar(data, shape + 1, strides + 1,
  *                                 ndim - 1, itemsize, item)
  *             data += stride             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_v_data = (__pyx_v_data + __pyx_v_stride);
     }
   }
   __pyx_L3:;
 
-  /* "View.MemoryView":1407
+  /* "View.MemoryView":1409
  * 
  * @cname('__pyx_memoryview__slice_assign_scalar')
  * cdef void _slice_assign_scalar(char *data, Py_ssize_t *shape,             # <<<<<<<<<<<<<<
  *                               Py_ssize_t *strides, int ndim,
  *                               size_t itemsize, void *item) nogil:
  */
 
@@ -41468,14 +41880,17 @@
 /* Python wrapper */
 static PyObject *__pyx_pw_15View_dot_MemoryView_1__pyx_unpickle_Enum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum = {"__pyx_unpickle_Enum", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_15View_dot_MemoryView_1__pyx_unpickle_Enum, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_15View_dot_MemoryView_1__pyx_unpickle_Enum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v___pyx_type = 0;
   long __pyx_v___pyx_checksum;
   PyObject *__pyx_v___pyx_state = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__pyx_unpickle_Enum (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_pyx_type,&__pyx_n_s_pyx_checksum,&__pyx_n_s_pyx_state,0};
     PyObject* values[3] = {0,0,0};
     if (unlikely(__pyx_kwds)) {
@@ -41539,148 +41954,155 @@
 }
 
 static PyObject *__pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_v___pyx_PickleError = 0;
   PyObject *__pyx_v___pyx_result = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
-  int __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_t_2;
+  int __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
-  int __pyx_t_6;
+  PyObject *__pyx_t_6 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__pyx_unpickle_Enum", 0);
 
   /* "(tree fragment)":4
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
- *     if __pyx_checksum != 0xb068931:             # <<<<<<<<<<<<<<
+ *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xb068931 = (name))" % __pyx_checksum)
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  */
-  __pyx_t_1 = ((__pyx_v___pyx_checksum != 0xb068931) != 0);
-  if (__pyx_t_1) {
+  __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__29, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_3 = (__pyx_t_2 != 0);
+  if (__pyx_t_3) {
 
     /* "(tree fragment)":5
  *     cdef object __pyx_result
- *     if __pyx_checksum != 0xb068931:
+ *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):
  *         from pickle import PickleError as __pyx_PickleError             # <<<<<<<<<<<<<<
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xb068931 = (name))" % __pyx_checksum)
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  *     __pyx_result = Enum.__new__(__pyx_type)
  */
-    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 5, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 5, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_n_s_PickleError);
     __Pyx_GIVEREF(__pyx_n_s_PickleError);
-    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_PickleError);
-    __pyx_t_3 = __Pyx_Import(__pyx_n_s_pickle, __pyx_t_2, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 5, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_3, __pyx_n_s_PickleError); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 5, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(__pyx_t_2);
-    __pyx_v___pyx_PickleError = __pyx_t_2;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_PickleError);
+    __pyx_t_4 = __Pyx_Import(__pyx_n_s_pickle, __pyx_t_1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 5, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_PickleError); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 5, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_INCREF(__pyx_t_1);
+    __pyx_v___pyx_PickleError = __pyx_t_1;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
     /* "(tree fragment)":6
- *     if __pyx_checksum != 0xb068931:
+ *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):
  *         from pickle import PickleError as __pyx_PickleError
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xb068931 = (name))" % __pyx_checksum)             # <<<<<<<<<<<<<<
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)             # <<<<<<<<<<<<<<
  *     __pyx_result = Enum.__new__(__pyx_type)
  *     if __pyx_state is not None:
  */
-    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 6, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Incompatible_checksums_s_vs_0xb0, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 6, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 6, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_5 = __Pyx_PyString_Format(__pyx_kp_s_Incompatible_checksums_0x_x_vs_0, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 6, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_INCREF(__pyx_v___pyx_PickleError);
-    __pyx_t_2 = __pyx_v___pyx_PickleError; __pyx_t_5 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
-      if (likely(__pyx_t_5)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-        __Pyx_INCREF(__pyx_t_5);
+    __pyx_t_1 = __pyx_v___pyx_PickleError; __pyx_t_6 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
+      if (likely(__pyx_t_6)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_2, function);
+        __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
-    __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
-    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5);
+    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 6, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 6, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(1, 6, __pyx_L1_error)
 
     /* "(tree fragment)":4
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
- *     if __pyx_checksum != 0xb068931:             # <<<<<<<<<<<<<<
+ *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xb068931 = (name))" % __pyx_checksum)
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  */
   }
 
   /* "(tree fragment)":7
  *         from pickle import PickleError as __pyx_PickleError
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xb068931 = (name))" % __pyx_checksum)
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  *     __pyx_result = Enum.__new__(__pyx_type)             # <<<<<<<<<<<<<<
  *     if __pyx_state is not None:
  *         __pyx_unpickle_Enum__set_state(<Enum> __pyx_result, __pyx_state)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_MemviewEnum_type), __pyx_n_s_new); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 7, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = NULL;
-  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
-    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
-    if (likely(__pyx_t_4)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-      __Pyx_INCREF(__pyx_t_4);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_MemviewEnum_type), __pyx_n_s_new); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 7, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_5 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
+    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
+    if (likely(__pyx_t_5)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+      __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_2, function);
+      __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
-  __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v___pyx_type) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v___pyx_type);
-  __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 7, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v___pyx_result = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_v___pyx_type) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v___pyx_type);
+  __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 7, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v___pyx_result = __pyx_t_4;
+  __pyx_t_4 = 0;
 
   /* "(tree fragment)":8
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xb068931 = (name))" % __pyx_checksum)
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  *     __pyx_result = Enum.__new__(__pyx_type)
  *     if __pyx_state is not None:             # <<<<<<<<<<<<<<
  *         __pyx_unpickle_Enum__set_state(<Enum> __pyx_result, __pyx_state)
  *     return __pyx_result
  */
-  __pyx_t_1 = (__pyx_v___pyx_state != Py_None);
-  __pyx_t_6 = (__pyx_t_1 != 0);
-  if (__pyx_t_6) {
+  __pyx_t_3 = (__pyx_v___pyx_state != Py_None);
+  __pyx_t_2 = (__pyx_t_3 != 0);
+  if (__pyx_t_2) {
 
     /* "(tree fragment)":9
  *     __pyx_result = Enum.__new__(__pyx_type)
  *     if __pyx_state is not None:
  *         __pyx_unpickle_Enum__set_state(<Enum> __pyx_result, __pyx_state)             # <<<<<<<<<<<<<<
  *     return __pyx_result
  * cdef __pyx_unpickle_Enum__set_state(Enum __pyx_result, tuple __pyx_state):
  */
-    if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(1, 9, __pyx_L1_error)
-    __pyx_t_3 = __pyx_unpickle_Enum__set_state(((struct __pyx_MemviewEnum_obj *)__pyx_v___pyx_result), ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 9, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(1, 9, __pyx_L1_error)
+    __pyx_t_4 = __pyx_unpickle_Enum__set_state(((struct __pyx_MemviewEnum_obj *)__pyx_v___pyx_result), ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 9, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
     /* "(tree fragment)":8
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xb068931 = (name))" % __pyx_checksum)
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  *     __pyx_result = Enum.__new__(__pyx_type)
  *     if __pyx_state is not None:             # <<<<<<<<<<<<<<
  *         __pyx_unpickle_Enum__set_state(<Enum> __pyx_result, __pyx_state)
  *     return __pyx_result
  */
   }
 
@@ -41700,18 +42122,18 @@
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
 
   /* function exit code */
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
   __Pyx_AddTraceback("View.MemoryView.__pyx_unpickle_Enum", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v___pyx_PickleError);
   __Pyx_XDECREF(__pyx_v___pyx_result);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
@@ -41733,14 +42155,17 @@
   int __pyx_t_2;
   Py_ssize_t __pyx_t_3;
   int __pyx_t_4;
   int __pyx_t_5;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__pyx_unpickle_Enum__set_state", 0);
 
   /* "(tree fragment)":12
  *     return __pyx_result
  * cdef __pyx_unpickle_Enum__set_state(Enum __pyx_result, tuple __pyx_state):
  *     __pyx_result.name = __pyx_state[0]             # <<<<<<<<<<<<<<
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):
@@ -41934,20 +42359,23 @@
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
   0, /*tp_del*/
   0, /*tp_version_tag*/
   #if PY_VERSION_HEX >= 0x030400a1
   0, /*tp_finalize*/
   #endif
-  #if PY_VERSION_HEX >= 0x030800b1
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
   0, /*tp_vectorcall*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
   0, /*tp_print*/
   #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
+  0, /*tp_pypy_flags*/
+  #endif
 };
 
 static struct __pyx_obj_6soapcw_6soapcw___pyx_scope_struct_1_genexpr *__pyx_freelist_6soapcw_6soapcw___pyx_scope_struct_1_genexpr[8];
 static int __pyx_freecount_6soapcw_6soapcw___pyx_scope_struct_1_genexpr = 0;
 
 static PyObject *__pyx_tp_new_6soapcw_6soapcw___pyx_scope_struct_1_genexpr(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
   PyObject *o;
@@ -42040,20 +42468,23 @@
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
   0, /*tp_del*/
   0, /*tp_version_tag*/
   #if PY_VERSION_HEX >= 0x030400a1
   0, /*tp_finalize*/
   #endif
-  #if PY_VERSION_HEX >= 0x030800b1
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
   0, /*tp_vectorcall*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
   0, /*tp_print*/
   #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
+  0, /*tp_pypy_flags*/
+  #endif
 };
 static struct __pyx_vtabstruct_array __pyx_vtable_array;
 
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k) {
   struct __pyx_array_obj *p;
   PyObject *o;
   if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
@@ -42079,17 +42510,17 @@
   if (unlikely(PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE) && Py_TYPE(o)->tp_finalize) && (!PyType_IS_GC(Py_TYPE(o)) || !_PyGC_FINALIZED(o))) {
     if (PyObject_CallFinalizerFromDealloc(o)) return;
   }
   #endif
   {
     PyObject *etype, *eval, *etb;
     PyErr_Fetch(&etype, &eval, &etb);
-    ++Py_REFCNT(o);
+    __Pyx_SET_REFCNT(o, Py_REFCNT(o) + 1);
     __pyx_array___dealloc__(o);
-    --Py_REFCNT(o);
+    __Pyx_SET_REFCNT(o, Py_REFCNT(o) - 1);
     PyErr_Restore(etype, eval, etb);
   }
   Py_CLEAR(p->mode);
   Py_CLEAR(p->_format);
   (*Py_TYPE(o)->tp_free)(o);
 }
 static PyObject *__pyx_sq_item_array(PyObject *o, Py_ssize_t i) {
@@ -42229,20 +42660,23 @@
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
   0, /*tp_del*/
   0, /*tp_version_tag*/
   #if PY_VERSION_HEX >= 0x030400a1
   0, /*tp_finalize*/
   #endif
-  #if PY_VERSION_HEX >= 0x030800b1
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
   0, /*tp_vectorcall*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
   0, /*tp_print*/
   #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
+  0, /*tp_pypy_flags*/
+  #endif
 };
 
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
   struct __pyx_MemviewEnum_obj *p;
   PyObject *o;
   if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
     o = (*t->tp_alloc)(t, 0);
@@ -42348,20 +42782,23 @@
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
   0, /*tp_del*/
   0, /*tp_version_tag*/
   #if PY_VERSION_HEX >= 0x030400a1
   0, /*tp_finalize*/
   #endif
-  #if PY_VERSION_HEX >= 0x030800b1
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
   0, /*tp_vectorcall*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
   0, /*tp_print*/
   #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
+  0, /*tp_pypy_flags*/
+  #endif
 };
 static struct __pyx_vtabstruct_memoryview __pyx_vtable_memoryview;
 
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k) {
   struct __pyx_memoryview_obj *p;
   PyObject *o;
   if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
@@ -42390,17 +42827,17 @@
     if (PyObject_CallFinalizerFromDealloc(o)) return;
   }
   #endif
   PyObject_GC_UnTrack(o);
   {
     PyObject *etype, *eval, *etb;
     PyErr_Fetch(&etype, &eval, &etb);
-    ++Py_REFCNT(o);
+    __Pyx_SET_REFCNT(o, Py_REFCNT(o) + 1);
     __pyx_memoryview___dealloc__(o);
-    --Py_REFCNT(o);
+    __Pyx_SET_REFCNT(o, Py_REFCNT(o) - 1);
     PyErr_Restore(etype, eval, etb);
   }
   Py_CLEAR(p->obj);
   Py_CLEAR(p->_size);
   Py_CLEAR(p->_array_interface);
   (*Py_TYPE(o)->tp_free)(o);
 }
@@ -42609,20 +43046,23 @@
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
   0, /*tp_del*/
   0, /*tp_version_tag*/
   #if PY_VERSION_HEX >= 0x030400a1
   0, /*tp_finalize*/
   #endif
-  #if PY_VERSION_HEX >= 0x030800b1
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
   0, /*tp_vectorcall*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
   0, /*tp_print*/
   #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
+  0, /*tp_pypy_flags*/
+  #endif
 };
 static struct __pyx_vtabstruct__memoryviewslice __pyx_vtable__memoryviewslice;
 
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k) {
   struct __pyx_memoryviewslice_obj *p;
   PyObject *o = __pyx_tp_new_memoryview(t, a, k);
   if (unlikely(!o)) return 0;
@@ -42640,17 +43080,17 @@
     if (PyObject_CallFinalizerFromDealloc(o)) return;
   }
   #endif
   PyObject_GC_UnTrack(o);
   {
     PyObject *etype, *eval, *etb;
     PyErr_Fetch(&etype, &eval, &etb);
-    ++Py_REFCNT(o);
+    __Pyx_SET_REFCNT(o, Py_REFCNT(o) + 1);
     __pyx_memoryviewslice___dealloc__(o);
-    --Py_REFCNT(o);
+    __Pyx_SET_REFCNT(o, Py_REFCNT(o) - 1);
     PyErr_Restore(etype, eval, etb);
   }
   Py_CLEAR(p->from_object);
   PyObject_GC_Track(o);
   __pyx_tp_dealloc_memoryview(o);
 }
 
@@ -42755,20 +43195,23 @@
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
   0, /*tp_del*/
   0, /*tp_version_tag*/
   #if PY_VERSION_HEX >= 0x030400a1
   0, /*tp_finalize*/
   #endif
-  #if PY_VERSION_HEX >= 0x030800b1
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
   0, /*tp_vectorcall*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
   0, /*tp_print*/
   #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
+  0, /*tp_pypy_flags*/
+  #endif
 };
 
 static PyMethodDef __pyx_methods[] = {
   {0, 0, 0, 0}
 };
 
 #if PY_MAJOR_VERSION >= 3
@@ -42818,15 +43261,15 @@
   {&__pyx_kp_s_Can_only_create_a_buffer_that_is, __pyx_k_Can_only_create_a_buffer_that_is, sizeof(__pyx_k_Can_only_create_a_buffer_that_is), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_assign_to_read_only_memor, __pyx_k_Cannot_assign_to_read_only_memor, sizeof(__pyx_k_Cannot_assign_to_read_only_memor), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_create_writable_memory_vi, __pyx_k_Cannot_create_writable_memory_vi, sizeof(__pyx_k_Cannot_create_writable_memory_vi), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_index_with_type_s, __pyx_k_Cannot_index_with_type_s, sizeof(__pyx_k_Cannot_index_with_type_s), 0, 0, 1, 0},
   {&__pyx_kp_u_ERROR_Please_use_a_transition_ma, __pyx_k_ERROR_Please_use_a_transition_ma, sizeof(__pyx_k_ERROR_Please_use_a_transition_ma), 0, 1, 0, 0},
   {&__pyx_n_s_Ellipsis, __pyx_k_Ellipsis, sizeof(__pyx_k_Ellipsis), 0, 0, 1, 1},
   {&__pyx_kp_s_Empty_shape_tuple_for_cython_arr, __pyx_k_Empty_shape_tuple_for_cython_arr, sizeof(__pyx_k_Empty_shape_tuple_for_cython_arr), 0, 0, 1, 0},
-  {&__pyx_kp_s_Incompatible_checksums_s_vs_0xb0, __pyx_k_Incompatible_checksums_s_vs_0xb0, sizeof(__pyx_k_Incompatible_checksums_s_vs_0xb0), 0, 0, 1, 0},
+  {&__pyx_kp_s_Incompatible_checksums_0x_x_vs_0, __pyx_k_Incompatible_checksums_0x_x_vs_0, sizeof(__pyx_k_Incompatible_checksums_0x_x_vs_0), 0, 0, 1, 0},
   {&__pyx_n_s_IndexError, __pyx_k_IndexError, sizeof(__pyx_k_IndexError), 0, 0, 1, 1},
   {&__pyx_kp_s_Indirect_dimensions_not_supporte, __pyx_k_Indirect_dimensions_not_supporte, sizeof(__pyx_k_Indirect_dimensions_not_supporte), 0, 0, 1, 0},
   {&__pyx_kp_s_Invalid_mode_expected_c_or_fortr, __pyx_k_Invalid_mode_expected_c_or_fortr, sizeof(__pyx_k_Invalid_mode_expected_c_or_fortr), 0, 0, 1, 0},
   {&__pyx_kp_s_Invalid_shape_in_axis_d_d, __pyx_k_Invalid_shape_in_axis_d_d, sizeof(__pyx_k_Invalid_shape_in_axis_d_d), 0, 0, 1, 0},
   {&__pyx_n_s_MemoryError, __pyx_k_MemoryError, sizeof(__pyx_k_MemoryError), 0, 0, 1, 1},
   {&__pyx_kp_s_MemoryView_of_r_at_0x_x, __pyx_k_MemoryView_of_r_at_0x_x, sizeof(__pyx_k_MemoryView_of_r_at_0x_x), 0, 0, 1, 0},
   {&__pyx_kp_s_MemoryView_of_r_object, __pyx_k_MemoryView_of_r_object, sizeof(__pyx_k_MemoryView_of_r_object), 0, 0, 1, 0},
@@ -42933,15 +43376,14 @@
   {&__pyx_n_s_idx, __pyx_k_idx, sizeof(__pyx_k_idx), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
   {&__pyx_n_s_ind, __pyx_k_ind, sizeof(__pyx_k_ind), 0, 0, 1, 1},
   {&__pyx_n_s_indicies, __pyx_k_indicies, sizeof(__pyx_k_indicies), 0, 0, 1, 1},
   {&__pyx_n_s_inf, __pyx_k_inf, sizeof(__pyx_k_inf), 0, 0, 1, 1},
   {&__pyx_n_s_init, __pyx_k_init, sizeof(__pyx_k_init), 0, 0, 1, 1},
   {&__pyx_n_s_insert, __pyx_k_insert, sizeof(__pyx_k_insert), 0, 0, 1, 1},
-  {&__pyx_n_s_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 0, 1, 1},
   {&__pyx_n_u_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 1, 0, 1},
   {&__pyx_n_s_int32, __pyx_k_int32, sizeof(__pyx_k_int32), 0, 0, 1, 1},
   {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
   {&__pyx_kp_s_itemsize_0_for_cython_array, __pyx_k_itemsize_0_for_cython_array, sizeof(__pyx_k_itemsize_0_for_cython_array), 0, 0, 1, 0},
   {&__pyx_n_s_itertools, __pyx_k_itertools, sizeof(__pyx_k_itertools), 0, 0, 1, 1},
   {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
   {&__pyx_n_s_j1, __pyx_k_j1, sizeof(__pyx_k_j1), 0, 0, 1, 1},
@@ -43189,22 +43631,22 @@
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
   __pyx_builtin_object = __Pyx_GetBuiltinName(__pyx_n_s_object); if (!__pyx_builtin_object) __PYX_ERR(0, 14, __pyx_L1_error)
   __pyx_builtin_open = __Pyx_GetBuiltinName(__pyx_n_s_open); if (!__pyx_builtin_open) __PYX_ERR(0, 64, __pyx_L1_error)
   __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 139, __pyx_L1_error)
   __pyx_builtin_round = __Pyx_GetBuiltinName(__pyx_n_s_round); if (!__pyx_builtin_round) __PYX_ERR(0, 165, __pyx_L1_error)
   __pyx_builtin_max = __Pyx_GetBuiltinName(__pyx_n_s_max); if (!__pyx_builtin_max) __PYX_ERR(0, 169, __pyx_L1_error)
-  __pyx_builtin_sum = __Pyx_GetBuiltinName(__pyx_n_s_sum); if (!__pyx_builtin_sum) __PYX_ERR(0, 1301, __pyx_L1_error)
-  __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(0, 1369, __pyx_L1_error)
-  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(1, 133, __pyx_L1_error)
-  __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 148, __pyx_L1_error)
+  __pyx_builtin_sum = __Pyx_GetBuiltinName(__pyx_n_s_sum); if (!__pyx_builtin_sum) __PYX_ERR(0, 1303, __pyx_L1_error)
+  __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(0, 1371, __pyx_L1_error)
+  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(1, 134, __pyx_L1_error)
+  __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 149, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 2, __pyx_L1_error)
-  __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 404, __pyx_L1_error)
-  __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(1, 613, __pyx_L1_error)
-  __pyx_builtin_IndexError = __Pyx_GetBuiltinName(__pyx_n_s_IndexError); if (!__pyx_builtin_IndexError) __PYX_ERR(1, 832, __pyx_L1_error)
+  __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 406, __pyx_L1_error)
+  __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(1, 615, __pyx_L1_error)
+  __pyx_builtin_IndexError = __Pyx_GetBuiltinName(__pyx_n_s_IndexError); if (!__pyx_builtin_IndexError) __PYX_ERR(1, 834, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
@@ -43261,110 +43703,110 @@
  * 
  *         tr = np.array(tr).astype('double')
  */
   __pyx_tuple__6 = PyTuple_Pack(1, __pyx_kp_u_Please_make_sure_teh_two_input_d); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 233, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__6);
   __Pyx_GIVEREF(__pyx_tuple__6);
 
-  /* "soapcw/soapcw.pyx":951
+  /* "soapcw/soapcw.pyx":953
  * 
  *         if len(np.shape(tr))<=1:
  *             raise Exception("ERROR: Please use a transition matrix with dimensions larger than one")             # <<<<<<<<<<<<<<
  * 
  *         #np.insert(obs,0,-1e6,axis=1)
  */
-  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_kp_u_ERROR_Please_use_a_transition_ma); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 951, __pyx_L1_error)
+  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_kp_u_ERROR_Please_use_a_transition_ma); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 953, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__7);
   __Pyx_GIVEREF(__pyx_tuple__7);
 
-  /* "soapcw/soapcw.pyx":1011
+  /* "soapcw/soapcw.pyx":1013
  *                         temp = -1e6
  *                         for k in range(n):
  *                             m = list(j[1:])             # <<<<<<<<<<<<<<
  *                             m.append(k)
  *                             if t<length:
  */
-  __pyx_slice__8 = PySlice_New(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__8)) __PYX_ERR(0, 1011, __pyx_L1_error)
+  __pyx_slice__8 = PySlice_New(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__8)) __PYX_ERR(0, 1013, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__8);
   __Pyx_GIVEREF(__pyx_slice__8);
 
-  /* "soapcw/soapcw.pyx":1058
+  /* "soapcw/soapcw.pyx":1060
  *             previous_2 = prev[t][previous][previous_1]
  * 
  *         vit_track = vit_track[::-1]             # <<<<<<<<<<<<<<
  * 
  *         self.vit_track = np.array(vit_track)
  */
-  __pyx_slice__9 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__9)) __PYX_ERR(0, 1058, __pyx_L1_error)
+  __pyx_slice__9 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__9)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__9);
   __Pyx_GIVEREF(__pyx_slice__9);
 
-  /* "soapcw/soapcw.pyx":1304
+  /* "soapcw/soapcw.pyx":1306
  *                 l = len(np.where(np.array(seq) == 0)[0])
  *                 if s > thresh:
  *                     max_seq = np.insert(abspath,0,ind)[:-1]             # <<<<<<<<<<<<<<
  *                     thresh = s
  *                 elif s == thresh and l > thresh2:
  */
-  __pyx_slice__10 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__10)) __PYX_ERR(0, 1304, __pyx_L1_error)
+  __pyx_slice__10 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__10)) __PYX_ERR(0, 1306, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__10);
   __Pyx_GIVEREF(__pyx_slice__10);
 
-  /* "View.MemoryView":133
+  /* "View.MemoryView":134
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(1, 133, __pyx_L1_error)
+  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(1, 134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__11);
   __Pyx_GIVEREF(__pyx_tuple__11);
 
-  /* "View.MemoryView":136
+  /* "View.MemoryView":137
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-  __pyx_tuple__12 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(1, 136, __pyx_L1_error)
+  __pyx_tuple__12 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(1, 137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__12);
   __Pyx_GIVEREF(__pyx_tuple__12);
 
-  /* "View.MemoryView":148
+  /* "View.MemoryView":149
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(1, 148, __pyx_L1_error)
+  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(1, 149, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__13);
   __Pyx_GIVEREF(__pyx_tuple__13);
 
-  /* "View.MemoryView":176
+  /* "View.MemoryView":177
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-  __pyx_tuple__14 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(1, 176, __pyx_L1_error)
+  __pyx_tuple__14 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(1, 177, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__14);
   __Pyx_GIVEREF(__pyx_tuple__14);
 
-  /* "View.MemoryView":192
+  /* "View.MemoryView":193
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(1, 192, __pyx_L1_error)
+  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(1, 193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__15);
   __Pyx_GIVEREF(__pyx_tuple__15);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
@@ -43379,66 +43821,66 @@
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
   __pyx_tuple__17 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__17);
   __Pyx_GIVEREF(__pyx_tuple__17);
 
-  /* "View.MemoryView":418
+  /* "View.MemoryView":420
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(1, 418, __pyx_L1_error)
+  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(1, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__18);
   __Pyx_GIVEREF(__pyx_tuple__18);
 
-  /* "View.MemoryView":495
+  /* "View.MemoryView":497
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(1, 495, __pyx_L1_error)
+  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(1, 497, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__19);
   __Pyx_GIVEREF(__pyx_tuple__19);
 
-  /* "View.MemoryView":520
+  /* "View.MemoryView":522
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(1, 520, __pyx_L1_error)
+  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(1, 522, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__20);
   __Pyx_GIVEREF(__pyx_tuple__20);
 
-  /* "View.MemoryView":570
+  /* "View.MemoryView":572
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(1, 570, __pyx_L1_error)
+  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(1, 572, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__21);
   __Pyx_GIVEREF(__pyx_tuple__21);
 
-  /* "View.MemoryView":577
+  /* "View.MemoryView":579
  *     def suboffsets(self):
  *         if self.view.suboffsets == NULL:
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
-  __pyx_tuple__22 = PyTuple_New(1); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(1, 577, __pyx_L1_error)
+  __pyx_tuple__22 = PyTuple_New(1); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(1, 579, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__22);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyTuple_SET_ITEM(__pyx_tuple__22, 0, __pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_tuple__22);
 
   /* "(tree fragment)":2
@@ -43456,33 +43898,33 @@
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
   __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__24);
   __Pyx_GIVEREF(__pyx_tuple__24);
 
-  /* "View.MemoryView":682
+  /* "View.MemoryView":684
  *         if item is Ellipsis:
  *             if not seen_ellipsis:
  *                 result.extend([slice(None)] * (ndim - len(tup) + 1))             # <<<<<<<<<<<<<<
  *                 seen_ellipsis = True
  *             else:
  */
-  __pyx_slice__25 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__25)) __PYX_ERR(1, 682, __pyx_L1_error)
+  __pyx_slice__25 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__25)) __PYX_ERR(1, 684, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__25);
   __Pyx_GIVEREF(__pyx_slice__25);
 
-  /* "View.MemoryView":703
+  /* "View.MemoryView":705
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(1, 703, __pyx_L1_error)
+  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(1, 705, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__26);
   __Pyx_GIVEREF(__pyx_tuple__26);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
@@ -43496,468 +43938,473 @@
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
   __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__28);
   __Pyx_GIVEREF(__pyx_tuple__28);
+  __pyx_tuple__29 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__29);
+  __Pyx_GIVEREF(__pyx_tuple__29);
 
   /* "soapcw/soapcw.pyx":14
  * from scipy.special import logsumexp
  * 
  * class single_detector(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs, prog = False, lookup_file=None, make_vitmap = True):
  */
-  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 14, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__29);
-  __Pyx_GIVEREF(__pyx_tuple__29);
+  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 14, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__30);
+  __Pyx_GIVEREF(__pyx_tuple__30);
 
   /* "soapcw/soapcw.pyx":16
  * class single_detector(object):
  * 
  *     def __init__(self, tr, obs, prog = False, lookup_file=None, make_vitmap = True):             # <<<<<<<<<<<<<<
  *         '''
  *         initialising viterbi class
  */
-  __pyx_tuple__30 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs, __pyx_n_s_prog, __pyx_n_s_lookup_file, __pyx_n_s_make_vitmap); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 16, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__30);
-  __Pyx_GIVEREF(__pyx_tuple__30);
-  __pyx_codeobj__31 = (PyObject*)__Pyx_PyCode_New(6, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__30, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_init, 16, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__31)) __PYX_ERR(0, 16, __pyx_L1_error)
-  __pyx_tuple__32 = PyTuple_Pack(3, ((PyObject *)Py_False), ((PyObject *)Py_None), ((PyObject *)Py_True)); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 16, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__32);
-  __Pyx_GIVEREF(__pyx_tuple__32);
+  __pyx_tuple__31 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs, __pyx_n_s_prog, __pyx_n_s_lookup_file, __pyx_n_s_make_vitmap); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 16, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__31);
+  __Pyx_GIVEREF(__pyx_tuple__31);
+  __pyx_codeobj__32 = (PyObject*)__Pyx_PyCode_New(6, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_init, 16, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 16, __pyx_L1_error)
+  __pyx_tuple__33 = PyTuple_Pack(3, ((PyObject *)Py_False), ((PyObject *)Py_None), ((PyObject *)Py_True)); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 16, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__33);
+  __Pyx_GIVEREF(__pyx_tuple__33);
 
   /* "soapcw/soapcw.pyx":41
  *     #------------------------------------------------------------------------------------------------
  * 
  *     def get_vitmap(self,log=False):             # <<<<<<<<<<<<<<
  *         """
  *         normalise the viterbi output such that the sum of eah column is 1
  */
-  __pyx_tuple__33 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_log, __pyx_n_s_path_m, __pyx_n_s_i, __pyx_n_s_sump, __pyx_n_s_val); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 41, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__33);
-  __Pyx_GIVEREF(__pyx_tuple__33);
-  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_get_vitmap, 41, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 41, __pyx_L1_error)
-  __pyx_tuple__35 = PyTuple_Pack(1, ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 41, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__35);
-  __Pyx_GIVEREF(__pyx_tuple__35);
+  __pyx_tuple__34 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_log, __pyx_n_s_path_m, __pyx_n_s_i, __pyx_n_s_sump, __pyx_n_s_val); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 41, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__34);
+  __Pyx_GIVEREF(__pyx_tuple__34);
+  __pyx_codeobj__35 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__34, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_get_vitmap, 41, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__35)) __PYX_ERR(0, 41, __pyx_L1_error)
+  __pyx_tuple__36 = PyTuple_Pack(1, ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 41, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__36);
+  __Pyx_GIVEREF(__pyx_tuple__36);
 
   /* "soapcw/soapcw.pyx":60
  *     #--------------------------
  * 
  *     def read_lookup(self,filename):             # <<<<<<<<<<<<<<
  *         """
  *         Read the lookup table for chosen statistic
  */
-  __pyx_tuple__36 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_filename, __pyx_n_s_f1, __pyx_n_s_likelihood, __pyx_n_s_params, __pyx_n_s_ranges, __pyx_n_s_fact); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 60, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__36);
-  __Pyx_GIVEREF(__pyx_tuple__36);
-  __pyx_codeobj__37 = (PyObject*)__Pyx_PyCode_New(2, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__36, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_read_lookup, 60, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__37)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __pyx_tuple__37 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_filename, __pyx_n_s_f1, __pyx_n_s_likelihood, __pyx_n_s_params, __pyx_n_s_ranges, __pyx_n_s_fact); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__37);
+  __Pyx_GIVEREF(__pyx_tuple__37);
+  __pyx_codeobj__38 = (PyObject*)__Pyx_PyCode_New(2, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_read_lookup, 60, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(0, 60, __pyx_L1_error)
 
   /* "soapcw/soapcw.pyx":77
  * 
  * 
  *     def run(self,double[:] tr, double[:, :] obs, lookup_file = None):             # <<<<<<<<<<<<<<
  *         '''
  *         Run the viterbi algorithm for given single set of data and 3x1 transition matrix.
  */
-  __pyx_tuple__38 = PyTuple_Pack(29, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs, __pyx_n_s_lookup_file, __pyx_n_s_shape, __pyx_n_s_V, __pyx_n_s_prev, __pyx_n_s_t, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_pbar, __pyx_n_s_pt, __pyx_n_s_length, __pyx_n_s_width, __pyx_n_s_tr_length, __pyx_n_s_tr_width, __pyx_n_s_logarr, __pyx_n_s_fact, __pyx_n_s_obs_ind, __pyx_n_s_ranges, __pyx_n_s_obs_ind_arr, __pyx_n_s_temp, __pyx_n_s_o, __pyx_n_s_value, __pyx_n_s_max_end_prob, __pyx_n_s_previous, __pyx_n_s_vit_track, __pyx_n_s_genexpr, __pyx_n_s_genexpr); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 77, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__38);
-  __Pyx_GIVEREF(__pyx_tuple__38);
-  __pyx_codeobj__39 = (PyObject*)__Pyx_PyCode_New(4, 0, 29, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__38, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_run, 77, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(0, 77, __pyx_L1_error)
-  __pyx_tuple__40 = PyTuple_Pack(1, ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 77, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__40);
-  __Pyx_GIVEREF(__pyx_tuple__40);
+  __pyx_tuple__39 = PyTuple_Pack(29, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs, __pyx_n_s_lookup_file, __pyx_n_s_shape, __pyx_n_s_V, __pyx_n_s_prev, __pyx_n_s_t, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_pbar, __pyx_n_s_pt, __pyx_n_s_length, __pyx_n_s_width, __pyx_n_s_tr_length, __pyx_n_s_tr_width, __pyx_n_s_logarr, __pyx_n_s_fact, __pyx_n_s_obs_ind, __pyx_n_s_ranges, __pyx_n_s_obs_ind_arr, __pyx_n_s_temp, __pyx_n_s_o, __pyx_n_s_value, __pyx_n_s_max_end_prob, __pyx_n_s_previous, __pyx_n_s_vit_track, __pyx_n_s_genexpr, __pyx_n_s_genexpr); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
+  __pyx_codeobj__40 = (PyObject*)__Pyx_PyCode_New(4, 0, 29, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_run, 77, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 77, __pyx_L1_error)
+  __pyx_tuple__41 = PyTuple_Pack(1, ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__41);
+  __Pyx_GIVEREF(__pyx_tuple__41);
 
   /* "soapcw/soapcw.pyx":190
  * 
  * 
  * class two_detector(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs1, obs2, lookup_file_2det = None, lookup_file_1det = None, prog = False,fractions=None, make_vitmap=True):
  */
-  __pyx_tuple__41 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 190, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__41);
-  __Pyx_GIVEREF(__pyx_tuple__41);
+  __pyx_tuple__42 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
 
   /* "soapcw/soapcw.pyx":192
  * class two_detector(object):
  * 
  *     def __init__(self, tr, obs1, obs2, lookup_file_2det = None, lookup_file_1det = None, prog = False,fractions=None, make_vitmap=True):             # <<<<<<<<<<<<<<
  *         '''
  *         viterbi algorithm for two detectors with an optional line aware statistic
  */
-  __pyx_tuple__42 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_lookup_file_2det, __pyx_n_s_lookup_file_1det, __pyx_n_s_prog, __pyx_n_s_fractions, __pyx_n_s_make_vitmap); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 192, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__42);
-  __Pyx_GIVEREF(__pyx_tuple__42);
-  __pyx_codeobj__43 = (PyObject*)__Pyx_PyCode_New(9, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__42, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_init, 192, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__43)) __PYX_ERR(0, 192, __pyx_L1_error)
-  __pyx_tuple__44 = PyTuple_Pack(5, ((PyObject *)Py_None), ((PyObject *)Py_None), ((PyObject *)Py_False), ((PyObject *)Py_None), ((PyObject *)Py_True)); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 192, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__44);
-  __Pyx_GIVEREF(__pyx_tuple__44);
+  __pyx_tuple__43 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_lookup_file_2det, __pyx_n_s_lookup_file_1det, __pyx_n_s_prog, __pyx_n_s_fractions, __pyx_n_s_make_vitmap); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 192, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__43);
+  __Pyx_GIVEREF(__pyx_tuple__43);
+  __pyx_codeobj__44 = (PyObject*)__Pyx_PyCode_New(9, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_init, 192, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__44)) __PYX_ERR(0, 192, __pyx_L1_error)
+  __pyx_tuple__45 = PyTuple_Pack(5, ((PyObject *)Py_None), ((PyObject *)Py_None), ((PyObject *)Py_False), ((PyObject *)Py_None), ((PyObject *)Py_True)); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 192, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__45);
+  __Pyx_GIVEREF(__pyx_tuple__45);
 
-  /* "soapcw/soapcw.pyx":251
+  /* "soapcw/soapcw.pyx":253
  *     #------------------------------------------------------------------------------------------------
  * 
  *     def get_vitmap(self,log=False):             # <<<<<<<<<<<<<<
  *         """
  *         normalise the viterbi output such that the sum of eah column is 1
  */
-  __pyx_tuple__45 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_log, __pyx_n_s_path_m, __pyx_n_s_i, __pyx_n_s_sump, __pyx_n_s_val); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 251, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__45);
-  __Pyx_GIVEREF(__pyx_tuple__45);
-  __pyx_codeobj__46 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__45, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_get_vitmap, 251, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__46)) __PYX_ERR(0, 251, __pyx_L1_error)
-  __pyx_tuple__47 = PyTuple_Pack(1, ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 251, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__47);
-  __Pyx_GIVEREF(__pyx_tuple__47);
+  __pyx_tuple__46 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_log, __pyx_n_s_path_m, __pyx_n_s_i, __pyx_n_s_sump, __pyx_n_s_val); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 253, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__46);
+  __Pyx_GIVEREF(__pyx_tuple__46);
+  __pyx_codeobj__47 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__46, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_get_vitmap, 253, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__47)) __PYX_ERR(0, 253, __pyx_L1_error)
+  __pyx_tuple__48 = PyTuple_Pack(1, ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 253, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__48);
+  __Pyx_GIVEREF(__pyx_tuple__48);
 
-  /* "soapcw/soapcw.pyx":271
+  /* "soapcw/soapcw.pyx":273
  *     #--------------------------------------------------------
  * 
  *     def read_lookup(self,filename):             # <<<<<<<<<<<<<<
  * 
  *         with open(filename,'rb') as f1:
  */
-  __pyx_tuple__48 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_filename, __pyx_n_s_f1, __pyx_n_s_likelihood, __pyx_n_s_params, __pyx_n_s_ranges, __pyx_n_s_fact); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 271, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__48);
-  __Pyx_GIVEREF(__pyx_tuple__48);
-  __pyx_codeobj__49 = (PyObject*)__Pyx_PyCode_New(2, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__48, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_read_lookup, 271, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__49)) __PYX_ERR(0, 271, __pyx_L1_error)
+  __pyx_tuple__49 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_filename, __pyx_n_s_f1, __pyx_n_s_likelihood, __pyx_n_s_params, __pyx_n_s_ranges, __pyx_n_s_fact); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 273, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__49);
+  __Pyx_GIVEREF(__pyx_tuple__49);
+  __pyx_codeobj__50 = (PyObject*)__Pyx_PyCode_New(2, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__49, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_read_lookup, 273, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__50)) __PYX_ERR(0, 273, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":281
+  /* "soapcw/soapcw.pyx":283
  *         return likelihood, ranges, fact
  * 
  *     def read_lookup_amp(self,filename):             # <<<<<<<<<<<<<<
  * 
  *         with open(filename,'rb') as f1:
  */
-  __pyx_tuple__50 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_filename, __pyx_n_s_f1, __pyx_n_s_likelihood, __pyx_n_s_params, __pyx_n_s_pow_ranges, __pyx_n_s_frac_ranges, __pyx_n_s_pow_fact, __pyx_n_s_frac_fact); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 281, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__50);
-  __Pyx_GIVEREF(__pyx_tuple__50);
-  __pyx_codeobj__51 = (PyObject*)__Pyx_PyCode_New(2, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__50, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_read_lookup_amp, 281, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__51)) __PYX_ERR(0, 281, __pyx_L1_error)
+  __pyx_tuple__51 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_filename, __pyx_n_s_f1, __pyx_n_s_likelihood, __pyx_n_s_params, __pyx_n_s_pow_ranges, __pyx_n_s_frac_ranges, __pyx_n_s_pow_fact, __pyx_n_s_frac_fact); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 283, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__51);
+  __Pyx_GIVEREF(__pyx_tuple__51);
+  __pyx_codeobj__52 = (PyObject*)__Pyx_PyCode_New(2, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__51, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_read_lookup_amp, 283, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__52)) __PYX_ERR(0, 283, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":298
+  /* "soapcw/soapcw.pyx":300
  *     #--------------------------------------------------------
  * 
  *     def run(self,transition, obs1, obs2, lookup_file_1det = None,lookup_file_2det = None):             # <<<<<<<<<<<<<<
  *         """
  *         viterbi algorithm for two detectors with an lookup table for the line veto statistic
  */
-  __pyx_tuple__52 = PyTuple_Pack(55, __pyx_n_s_self, __pyx_n_s_transition, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_lookup_file_1det, __pyx_n_s_lookup_file_2det, __pyx_n_s_tr, __pyx_n_s_shape, __pyx_n_s_length, __pyx_n_s_width, __pyx_n_s_val, __pyx_n_s_prev, __pyx_n_s_det1, __pyx_n_s_det2, __pyx_n_s_tr_len, __pyx_n_s_sep_len, __pyx_n_s_tr_dist, __pyx_n_s_sep_dist, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_t, __pyx_n_s_x, __pyx_n_s_o1, __pyx_n_s_o2, __pyx_n_s_max_pos, __pyx_n_s_indicies, __pyx_n_s_max_val, __pyx_n_s_value, __pyx_n_s_temp, __pyx_n_s_edge_range, __pyx_n_s_logarr_2d, __pyx_n_s_logarr_1d, __pyx_n_s_fact_1d, __pyx_n_s_fact_2d, __pyx_n_s_obs1_ind_1d, __pyx_n_s_obs1_ind_2d, __pyx_n_s_obs1data, __pyx_n_s_obs2data, __pyx_n_s_ranges_1d, __pyx_n_s_obs1_ind_arr_1d, __pyx_n_s_obs2_ind_arr_1d, __pyx_n_s_obs2_ind_1d, __pyx_n_s_logarr, __pyx_n_s_ranges_2d, __pyx_n_s_diag, __pyx_n_s_obs1_ind_arr_2d, __pyx_n_s_obs2_ind_arr_2d, __pyx_n_s_obs2_ind_2d, __pyx_n_s_sumv, __pyx_n_s_pbar, __pyx_n_s_pt, __pyx_n_s_obs1seg, __pyx_n_s_obs2seg); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 298, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__52);
-  __Pyx_GIVEREF(__pyx_tuple__52);
-  __pyx_codeobj__53 = (PyObject*)__Pyx_PyCode_New(6, 0, 55, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__52, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_run, 298, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__53)) __PYX_ERR(0, 298, __pyx_L1_error)
-  __pyx_tuple__54 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 298, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__54);
-  __Pyx_GIVEREF(__pyx_tuple__54);
+  __pyx_tuple__53 = PyTuple_Pack(55, __pyx_n_s_self, __pyx_n_s_transition, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_lookup_file_1det, __pyx_n_s_lookup_file_2det, __pyx_n_s_tr, __pyx_n_s_shape, __pyx_n_s_length, __pyx_n_s_width, __pyx_n_s_val, __pyx_n_s_prev, __pyx_n_s_det1, __pyx_n_s_det2, __pyx_n_s_tr_len, __pyx_n_s_sep_len, __pyx_n_s_tr_dist, __pyx_n_s_sep_dist, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_t, __pyx_n_s_x, __pyx_n_s_o1, __pyx_n_s_o2, __pyx_n_s_max_pos, __pyx_n_s_indicies, __pyx_n_s_max_val, __pyx_n_s_value, __pyx_n_s_temp, __pyx_n_s_edge_range, __pyx_n_s_logarr_2d, __pyx_n_s_logarr_1d, __pyx_n_s_fact_1d, __pyx_n_s_fact_2d, __pyx_n_s_obs1_ind_1d, __pyx_n_s_obs1_ind_2d, __pyx_n_s_obs1data, __pyx_n_s_obs2data, __pyx_n_s_ranges_1d, __pyx_n_s_obs1_ind_arr_1d, __pyx_n_s_obs2_ind_arr_1d, __pyx_n_s_obs2_ind_1d, __pyx_n_s_logarr, __pyx_n_s_ranges_2d, __pyx_n_s_diag, __pyx_n_s_obs1_ind_arr_2d, __pyx_n_s_obs2_ind_arr_2d, __pyx_n_s_obs2_ind_2d, __pyx_n_s_sumv, __pyx_n_s_pbar, __pyx_n_s_pt, __pyx_n_s_obs1seg, __pyx_n_s_obs2seg); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 300, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__53);
+  __Pyx_GIVEREF(__pyx_tuple__53);
+  __pyx_codeobj__54 = (PyObject*)__Pyx_PyCode_New(6, 0, 55, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__53, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_run, 300, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__54)) __PYX_ERR(0, 300, __pyx_L1_error)
+  __pyx_tuple__55 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 300, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__55);
+  __Pyx_GIVEREF(__pyx_tuple__55);
 
-  /* "soapcw/soapcw.pyx":540
+  /* "soapcw/soapcw.pyx":542
  *         self.length = length
  * 
  *     def run_lookup_amp(self,tr1, obs11, obs21,lookup_file = None, fractions = None):             # <<<<<<<<<<<<<<
  *         """
  *         viterbi algorithm for two detectors with an lookup table for the line veto statistic
  */
-  __pyx_tuple__55 = PyTuple_Pack(56, __pyx_n_s_self, __pyx_n_s_tr1, __pyx_n_s_obs11, __pyx_n_s_obs21, __pyx_n_s_lookup_file, __pyx_n_s_fractions, __pyx_n_s_tr, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_shape, __pyx_n_s_length, __pyx_n_s_width, __pyx_n_s_val, __pyx_n_s_prev, __pyx_n_s_det1, __pyx_n_s_det2, __pyx_n_s_tr_len, __pyx_n_s_sep_len, __pyx_n_s_tr_dist, __pyx_n_s_sep_dist, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_t, __pyx_n_s_x, __pyx_n_s_o1, __pyx_n_s_o2, __pyx_n_s_max_pos, __pyx_n_s_indicies, __pyx_n_s_max_val, __pyx_n_s_value, __pyx_n_s_temp, __pyx_n_s_edge_range, __pyx_n_s_fact, __pyx_n_s_fact_frac, __pyx_n_s_likelihood, __pyx_n_s_pow_ranges, __pyx_n_s_frac_ranges, __pyx_n_s_pow_fact, __pyx_n_s_frac_fact, __pyx_n_s_shp, __pyx_n_s_logarr1, __pyx_n_s_logarr, __pyx_n_s_det_order1, __pyx_n_s_det_order, __pyx_n_s_frac_ind1, __pyx_n_s_frac_ind, __pyx_n_s_obs1_ind_arr, __pyx_n_s_obs1_ind, __pyx_n_s_obs2_ind_arr, __pyx_n_s_obs2_ind, __pyx_n_s_pbar, __pyx_n_s_pt, __pyx_n_s_lkl, __pyx_n_s_i); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 540, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__55);
-  __Pyx_GIVEREF(__pyx_tuple__55);
-  __pyx_codeobj__56 = (PyObject*)__Pyx_PyCode_New(6, 0, 56, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__55, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_run_lookup_amp, 540, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__56)) __PYX_ERR(0, 540, __pyx_L1_error)
-  __pyx_tuple__57 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 540, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__57);
-  __Pyx_GIVEREF(__pyx_tuple__57);
+  __pyx_tuple__56 = PyTuple_Pack(56, __pyx_n_s_self, __pyx_n_s_tr1, __pyx_n_s_obs11, __pyx_n_s_obs21, __pyx_n_s_lookup_file, __pyx_n_s_fractions, __pyx_n_s_tr, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_shape, __pyx_n_s_length, __pyx_n_s_width, __pyx_n_s_val, __pyx_n_s_prev, __pyx_n_s_det1, __pyx_n_s_det2, __pyx_n_s_tr_len, __pyx_n_s_sep_len, __pyx_n_s_tr_dist, __pyx_n_s_sep_dist, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_t, __pyx_n_s_x, __pyx_n_s_o1, __pyx_n_s_o2, __pyx_n_s_max_pos, __pyx_n_s_indicies, __pyx_n_s_max_val, __pyx_n_s_value, __pyx_n_s_temp, __pyx_n_s_edge_range, __pyx_n_s_fact, __pyx_n_s_fact_frac, __pyx_n_s_likelihood, __pyx_n_s_pow_ranges, __pyx_n_s_frac_ranges, __pyx_n_s_pow_fact, __pyx_n_s_frac_fact, __pyx_n_s_shp, __pyx_n_s_logarr1, __pyx_n_s_logarr, __pyx_n_s_det_order1, __pyx_n_s_det_order, __pyx_n_s_frac_ind1, __pyx_n_s_frac_ind, __pyx_n_s_obs1_ind_arr, __pyx_n_s_obs1_ind, __pyx_n_s_obs2_ind_arr, __pyx_n_s_obs2_ind, __pyx_n_s_pbar, __pyx_n_s_pt, __pyx_n_s_lkl, __pyx_n_s_i); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 542, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__56);
+  __Pyx_GIVEREF(__pyx_tuple__56);
+  __pyx_codeobj__57 = (PyObject*)__Pyx_PyCode_New(6, 0, 56, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__56, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_run_lookup_amp, 542, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__57)) __PYX_ERR(0, 542, __pyx_L1_error)
+  __pyx_tuple__58 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(0, 542, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__58);
+  __Pyx_GIVEREF(__pyx_tuple__58);
 
-  /* "soapcw/soapcw.pyx":701
+  /* "soapcw/soapcw.pyx":703
  *         self.length = length
  * 
  *     def get_track(self):             # <<<<<<<<<<<<<<
  *         """
  *         Takes in the viterbi data from a run and identifies the track thorugh whcih gives the maximum probability
  */
-  __pyx_tuple__58 = PyTuple_Pack(10, __pyx_n_s_self, __pyx_n_s_previous, __pyx_n_s_vit_trackr, __pyx_n_s_vit_track2, __pyx_n_s_vit_track1, __pyx_n_s_max_prob, __pyx_n_s_max_prob_index, __pyx_n_s_t, __pyx_n_s_i, __pyx_n_s_i); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(0, 701, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__58);
-  __Pyx_GIVEREF(__pyx_tuple__58);
-  __pyx_codeobj__59 = (PyObject*)__Pyx_PyCode_New(1, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__58, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_get_track, 701, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__59)) __PYX_ERR(0, 701, __pyx_L1_error)
+  __pyx_tuple__59 = PyTuple_Pack(10, __pyx_n_s_self, __pyx_n_s_previous, __pyx_n_s_vit_trackr, __pyx_n_s_vit_track2, __pyx_n_s_vit_track1, __pyx_n_s_max_prob, __pyx_n_s_max_prob_index, __pyx_n_s_t, __pyx_n_s_i, __pyx_n_s_i); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(0, 703, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__59);
+  __Pyx_GIVEREF(__pyx_tuple__59);
+  __pyx_codeobj__60 = (PyObject*)__Pyx_PyCode_New(1, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__59, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_get_track, 703, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__60)) __PYX_ERR(0, 703, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":743
+  /* "soapcw/soapcw.pyx":745
  * 
  * 
  * class three_detector(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs1, obs2, obs3, prog = False):
  */
-  __pyx_tuple__60 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 743, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__60);
-  __Pyx_GIVEREF(__pyx_tuple__60);
+  __pyx_tuple__61 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__61)) __PYX_ERR(0, 745, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__61);
+  __Pyx_GIVEREF(__pyx_tuple__61);
 
-  /* "soapcw/soapcw.pyx":745
+  /* "soapcw/soapcw.pyx":747
  * class three_detector(object):
  * 
  *     def __init__(self, tr, obs1, obs2, obs3, prog = False):             # <<<<<<<<<<<<<<
  *         '''
  *         initialising viterbi class
  */
-  __pyx_tuple__61 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_obs3, __pyx_n_s_prog); if (unlikely(!__pyx_tuple__61)) __PYX_ERR(0, 745, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__61);
-  __Pyx_GIVEREF(__pyx_tuple__61);
-  __pyx_codeobj__62 = (PyObject*)__Pyx_PyCode_New(6, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__61, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_init, 745, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__62)) __PYX_ERR(0, 745, __pyx_L1_error)
-  __pyx_tuple__63 = PyTuple_Pack(1, ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__63)) __PYX_ERR(0, 745, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__63);
-  __Pyx_GIVEREF(__pyx_tuple__63);
+  __pyx_tuple__62 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_obs3, __pyx_n_s_prog); if (unlikely(!__pyx_tuple__62)) __PYX_ERR(0, 747, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__62);
+  __Pyx_GIVEREF(__pyx_tuple__62);
+  __pyx_codeobj__63 = (PyObject*)__Pyx_PyCode_New(6, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__62, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_init, 747, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__63)) __PYX_ERR(0, 747, __pyx_L1_error)
+  __pyx_tuple__64 = PyTuple_Pack(1, ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__64)) __PYX_ERR(0, 747, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__64);
+  __Pyx_GIVEREF(__pyx_tuple__64);
 
-  /* "soapcw/soapcw.pyx":758
+  /* "soapcw/soapcw.pyx":760
  *     #--------------------------------------------------------
  * 
  *     def run(self,tr1, obs11, obs21, obs31):             # <<<<<<<<<<<<<<
  *         """
  *         viterbi algorithm for multiple detectors 2 at the moment
  */
-  __pyx_tuple__64 = PyTuple_Pack(41, __pyx_n_s_self, __pyx_n_s_tr1, __pyx_n_s_obs11, __pyx_n_s_obs21, __pyx_n_s_obs31, __pyx_n_s_tr, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_obs3, __pyx_n_s_shape, __pyx_n_s_length, __pyx_n_s_width, __pyx_n_s_val, __pyx_n_s_prev, __pyx_n_s_det1, __pyx_n_s_det2, __pyx_n_s_det3, __pyx_n_s_tr_len, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_t, __pyx_n_s_x, __pyx_n_s_max_pos, __pyx_n_s_indicies, __pyx_n_s_max_val, __pyx_n_s_value, __pyx_n_s_temp, __pyx_n_s_l, __pyx_n_s_pbar, __pyx_n_s_pt, __pyx_n_s_previous, __pyx_n_s_vit_trackr, __pyx_n_s_vit_track1, __pyx_n_s_vit_track2, __pyx_n_s_vit_track3, __pyx_n_s_max_prob, __pyx_n_s_max_prob_index, __pyx_n_s_i, __pyx_n_s_i); if (unlikely(!__pyx_tuple__64)) __PYX_ERR(0, 758, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__64);
-  __Pyx_GIVEREF(__pyx_tuple__64);
-  __pyx_codeobj__65 = (PyObject*)__Pyx_PyCode_New(5, 0, 41, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__64, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_run, 758, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__65)) __PYX_ERR(0, 758, __pyx_L1_error)
+  __pyx_tuple__65 = PyTuple_Pack(41, __pyx_n_s_self, __pyx_n_s_tr1, __pyx_n_s_obs11, __pyx_n_s_obs21, __pyx_n_s_obs31, __pyx_n_s_tr, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_obs3, __pyx_n_s_shape, __pyx_n_s_length, __pyx_n_s_width, __pyx_n_s_val, __pyx_n_s_prev, __pyx_n_s_det1, __pyx_n_s_det2, __pyx_n_s_det3, __pyx_n_s_tr_len, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_t, __pyx_n_s_x, __pyx_n_s_max_pos, __pyx_n_s_indicies, __pyx_n_s_max_val, __pyx_n_s_value, __pyx_n_s_temp, __pyx_n_s_l, __pyx_n_s_pbar, __pyx_n_s_pt, __pyx_n_s_previous, __pyx_n_s_vit_trackr, __pyx_n_s_vit_track1, __pyx_n_s_vit_track2, __pyx_n_s_vit_track3, __pyx_n_s_max_prob, __pyx_n_s_max_prob_index, __pyx_n_s_i, __pyx_n_s_i); if (unlikely(!__pyx_tuple__65)) __PYX_ERR(0, 760, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__65);
+  __Pyx_GIVEREF(__pyx_tuple__65);
+  __pyx_codeobj__66 = (PyObject*)__Pyx_PyCode_New(5, 0, 41, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__65, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_run, 760, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__66)) __PYX_ERR(0, 760, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":913
+  /* "soapcw/soapcw.pyx":915
  *         #return np.array(vit_track1), np.array(vit_track2), np.array(vit_track3), np.array(vit_trackr), np.array(val),np.array(prev), max_prob
  * 
  * class single_detector_mem_n(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs, prog = False):
  */
-  __pyx_tuple__66 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__66)) __PYX_ERR(0, 913, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__66);
-  __Pyx_GIVEREF(__pyx_tuple__66);
+  __pyx_tuple__67 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__67)) __PYX_ERR(0, 915, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__67);
+  __Pyx_GIVEREF(__pyx_tuple__67);
 
-  /* "soapcw/soapcw.pyx":915
+  /* "soapcw/soapcw.pyx":917
  * class single_detector_mem_n(object):
  * 
  *     def __init__(self, tr, obs, prog = False):             # <<<<<<<<<<<<<<
  *         '''
  * 
  */
-  __pyx_tuple__67 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs, __pyx_n_s_prog); if (unlikely(!__pyx_tuple__67)) __PYX_ERR(0, 915, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__67);
-  __Pyx_GIVEREF(__pyx_tuple__67);
-  __pyx_codeobj__68 = (PyObject*)__Pyx_PyCode_New(4, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__67, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_init, 915, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__68)) __PYX_ERR(0, 915, __pyx_L1_error)
-  __pyx_tuple__69 = PyTuple_Pack(1, ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__69)) __PYX_ERR(0, 915, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__69);
-  __Pyx_GIVEREF(__pyx_tuple__69);
+  __pyx_tuple__68 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs, __pyx_n_s_prog); if (unlikely(!__pyx_tuple__68)) __PYX_ERR(0, 917, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__68);
+  __Pyx_GIVEREF(__pyx_tuple__68);
+  __pyx_codeobj__69 = (PyObject*)__Pyx_PyCode_New(4, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__68, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_init, 917, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__69)) __PYX_ERR(0, 917, __pyx_L1_error)
+  __pyx_tuple__70 = PyTuple_Pack(1, ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__70)) __PYX_ERR(0, 917, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__70);
+  __Pyx_GIVEREF(__pyx_tuple__70);
 
-  /* "soapcw/soapcw.pyx":930
+  /* "soapcw/soapcw.pyx":932
  *     #------------------------------------------------------------------------
  * 
  *     def run(self, tr, obs):             # <<<<<<<<<<<<<<
  *         ''' Run viterbi algroithm with memory of n
  *         the amount of memory is determined by the transition matrix
  */
-  __pyx_tuple__70 = PyTuple_Pack(32, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs, __pyx_n_s_range_tr, __pyx_n_s_n, __pyx_n_s_shape, __pyx_n_s_length, __pyx_n_s_dimensions, __pyx_n_s_length_t, __pyx_n_s_width, __pyx_n_s_i, __pyx_n_s_t, __pyx_n_s_k, __pyx_n_s_c, __pyx_n_s_value, __pyx_n_s_temp, __pyx_n_s_val, __pyx_n_s_prev, __pyx_n_s_range_j, __pyx_n_s_j, __pyx_n_s_pbar, __pyx_n_s_obst, __pyx_n_s_valt, __pyx_n_s_pt, __pyx_n_s_cond, __pyx_n_s_b, __pyx_n_s_m, __pyx_n_s_n1, __pyx_n_s_previous, __pyx_n_s_previous_1, __pyx_n_s_vit_track, __pyx_n_s_previous_2); if (unlikely(!__pyx_tuple__70)) __PYX_ERR(0, 930, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__70);
-  __Pyx_GIVEREF(__pyx_tuple__70);
-  __pyx_codeobj__71 = (PyObject*)__Pyx_PyCode_New(3, 0, 32, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__70, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_run, 930, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__71)) __PYX_ERR(0, 930, __pyx_L1_error)
+  __pyx_tuple__71 = PyTuple_Pack(32, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs, __pyx_n_s_range_tr, __pyx_n_s_n, __pyx_n_s_shape, __pyx_n_s_length, __pyx_n_s_dimensions, __pyx_n_s_length_t, __pyx_n_s_width, __pyx_n_s_i, __pyx_n_s_t, __pyx_n_s_k, __pyx_n_s_c, __pyx_n_s_value, __pyx_n_s_temp, __pyx_n_s_val, __pyx_n_s_prev, __pyx_n_s_range_j, __pyx_n_s_j, __pyx_n_s_pbar, __pyx_n_s_obst, __pyx_n_s_valt, __pyx_n_s_pt, __pyx_n_s_cond, __pyx_n_s_b, __pyx_n_s_m, __pyx_n_s_n1, __pyx_n_s_previous, __pyx_n_s_previous_1, __pyx_n_s_vit_track, __pyx_n_s_previous_2); if (unlikely(!__pyx_tuple__71)) __PYX_ERR(0, 932, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__71);
+  __Pyx_GIVEREF(__pyx_tuple__71);
+  __pyx_codeobj__72 = (PyObject*)__Pyx_PyCode_New(3, 0, 32, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__71, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_run, 932, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__72)) __PYX_ERR(0, 932, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":1067
+  /* "soapcw/soapcw.pyx":1069
  *         #return (vit_track,val,prev)
  * 
  * class two_detector_mem_n(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs1, obs2, prog = False):
  */
-  __pyx_tuple__72 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__72)) __PYX_ERR(0, 1067, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__72);
-  __Pyx_GIVEREF(__pyx_tuple__72);
+  __pyx_tuple__73 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__73)) __PYX_ERR(0, 1069, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__73);
+  __Pyx_GIVEREF(__pyx_tuple__73);
 
-  /* "soapcw/soapcw.pyx":1069
+  /* "soapcw/soapcw.pyx":1071
  * class two_detector_mem_n(object):
  * 
  *     def __init__(self, tr, obs1, obs2, prog = False):             # <<<<<<<<<<<<<<
  *         '''
  *         initialising viterbi class
  */
-  __pyx_tuple__73 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_prog); if (unlikely(!__pyx_tuple__73)) __PYX_ERR(0, 1069, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__73);
-  __Pyx_GIVEREF(__pyx_tuple__73);
-  __pyx_codeobj__74 = (PyObject*)__Pyx_PyCode_New(5, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__73, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_init, 1069, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__74)) __PYX_ERR(0, 1069, __pyx_L1_error)
-  __pyx_tuple__75 = PyTuple_Pack(1, ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__75)) __PYX_ERR(0, 1069, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__75);
-  __Pyx_GIVEREF(__pyx_tuple__75);
+  __pyx_tuple__74 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_prog); if (unlikely(!__pyx_tuple__74)) __PYX_ERR(0, 1071, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__74);
+  __Pyx_GIVEREF(__pyx_tuple__74);
+  __pyx_codeobj__75 = (PyObject*)__Pyx_PyCode_New(5, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__74, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_init, 1071, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__75)) __PYX_ERR(0, 1071, __pyx_L1_error)
+  __pyx_tuple__76 = PyTuple_Pack(1, ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__76)) __PYX_ERR(0, 1071, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__76);
+  __Pyx_GIVEREF(__pyx_tuple__76);
 
-  /* "soapcw/soapcw.pyx":1082
+  /* "soapcw/soapcw.pyx":1084
  * 
  * 
  *     def run(self, tr, obs11, obs22):             # <<<<<<<<<<<<<<
  *         ''' Run viterbi algroithm with memory of n
  *         the amount of memory is determined by the transition matrix
  */
-  __pyx_tuple__76 = PyTuple_Pack(42, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs11, __pyx_n_s_obs22, __pyx_n_s_range_tr, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_n, __pyx_n_s_shape, __pyx_n_s_length, __pyx_n_s_dimensions, __pyx_n_s_length_t, __pyx_n_s_width, __pyx_n_s_i, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_j1, __pyx_n_s_n1, __pyx_n_s_b, __pyx_n_s_t, __pyx_n_s_value, __pyx_n_s_temp, __pyx_n_s_val, __pyx_n_s_prev, __pyx_n_s_pos1, __pyx_n_s_pos2, __pyx_n_s_range_j, __pyx_n_s_j, __pyx_n_s_pbar, __pyx_n_s_obs1t, __pyx_n_s_obs2t, __pyx_n_s_valt, __pyx_n_s_pt, __pyx_n_s_cond, __pyx_n_s_c, __pyx_n_s_a, __pyx_n_s_previous, __pyx_n_s_previous_1, __pyx_n_s_vit_track1, __pyx_n_s_vit_track2, __pyx_n_s_vit_trackr, __pyx_n_s_previous_2); if (unlikely(!__pyx_tuple__76)) __PYX_ERR(0, 1082, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__76);
-  __Pyx_GIVEREF(__pyx_tuple__76);
-  __pyx_codeobj__77 = (PyObject*)__Pyx_PyCode_New(4, 0, 42, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__76, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_run, 1082, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__77)) __PYX_ERR(0, 1082, __pyx_L1_error)
+  __pyx_tuple__77 = PyTuple_Pack(42, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs11, __pyx_n_s_obs22, __pyx_n_s_range_tr, __pyx_n_s_obs1, __pyx_n_s_obs2, __pyx_n_s_n, __pyx_n_s_shape, __pyx_n_s_length, __pyx_n_s_dimensions, __pyx_n_s_length_t, __pyx_n_s_width, __pyx_n_s_i, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_j1, __pyx_n_s_n1, __pyx_n_s_b, __pyx_n_s_t, __pyx_n_s_value, __pyx_n_s_temp, __pyx_n_s_val, __pyx_n_s_prev, __pyx_n_s_pos1, __pyx_n_s_pos2, __pyx_n_s_range_j, __pyx_n_s_j, __pyx_n_s_pbar, __pyx_n_s_obs1t, __pyx_n_s_obs2t, __pyx_n_s_valt, __pyx_n_s_pt, __pyx_n_s_cond, __pyx_n_s_c, __pyx_n_s_a, __pyx_n_s_previous, __pyx_n_s_previous_1, __pyx_n_s_vit_track1, __pyx_n_s_vit_track2, __pyx_n_s_vit_trackr, __pyx_n_s_previous_2); if (unlikely(!__pyx_tuple__77)) __PYX_ERR(0, 1084, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__77);
+  __Pyx_GIVEREF(__pyx_tuple__77);
+  __pyx_codeobj__78 = (PyObject*)__Pyx_PyCode_New(4, 0, 42, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__77, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_run, 1084, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__78)) __PYX_ERR(0, 1084, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":1260
+  /* "soapcw/soapcw.pyx":1262
  * ### ----------------------------------------------------------------
  * 
  * class single_detector_gaps(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs,times,tsft):
  */
-  __pyx_tuple__78 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__78)) __PYX_ERR(0, 1260, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__78);
-  __Pyx_GIVEREF(__pyx_tuple__78);
+  __pyx_tuple__79 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__79)) __PYX_ERR(0, 1262, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__79);
+  __Pyx_GIVEREF(__pyx_tuple__79);
 
-  /* "soapcw/soapcw.pyx":1262
+  /* "soapcw/soapcw.pyx":1264
  * class single_detector_gaps(object):
  * 
  *     def __init__(self, tr, obs,times,tsft):             # <<<<<<<<<<<<<<
  *         """
  *         single detector viterbi algorithm where the data can include large gaps in data
  */
-  __pyx_tuple__79 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs, __pyx_n_s_times, __pyx_n_s_tsft); if (unlikely(!__pyx_tuple__79)) __PYX_ERR(0, 1262, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__79);
-  __Pyx_GIVEREF(__pyx_tuple__79);
-  __pyx_codeobj__80 = (PyObject*)__Pyx_PyCode_New(5, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__79, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_init, 1262, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__80)) __PYX_ERR(0, 1262, __pyx_L1_error)
+  __pyx_tuple__80 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_obs, __pyx_n_s_times, __pyx_n_s_tsft); if (unlikely(!__pyx_tuple__80)) __PYX_ERR(0, 1264, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__80);
+  __Pyx_GIVEREF(__pyx_tuple__80);
+  __pyx_codeobj__81 = (PyObject*)__Pyx_PyCode_New(5, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__80, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_init, 1264, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__81)) __PYX_ERR(0, 1264, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":1288
+  /* "soapcw/soapcw.pyx":1290
  *         self.max_end_prob = max(self.vits[-1].V[-1])
  * 
  *     def max_track(self,tr,length,diff,bnd,ind,band_width):             # <<<<<<<<<<<<<<
  *         tr_val = np.arange(len(tr)).astype(int) - np.floor(len(tr)/2).astype(int)
  *         result = [seq for seq in itertools.combinations_with_replacement(tr_val, length) if sum(seq) == diff]
  */
-  __pyx_tuple__81 = PyTuple_Pack(18, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_length, __pyx_n_s_diff, __pyx_n_s_bnd, __pyx_n_s_ind, __pyx_n_s_band_width, __pyx_n_s_tr_val, __pyx_n_s_result, __pyx_n_s_max_seq, __pyx_n_s_thresh, __pyx_n_s_thresh2, __pyx_n_s_seq, __pyx_n_s_abspath, __pyx_n_s_s, __pyx_n_s_l, __pyx_n_s_seq, __pyx_n_s_elem); if (unlikely(!__pyx_tuple__81)) __PYX_ERR(0, 1288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__81);
-  __Pyx_GIVEREF(__pyx_tuple__81);
-  __pyx_codeobj__82 = (PyObject*)__Pyx_PyCode_New(7, 0, 18, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__81, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_max_track, 1288, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__82)) __PYX_ERR(0, 1288, __pyx_L1_error)
+  __pyx_tuple__82 = PyTuple_Pack(18, __pyx_n_s_self, __pyx_n_s_tr, __pyx_n_s_length, __pyx_n_s_diff, __pyx_n_s_bnd, __pyx_n_s_ind, __pyx_n_s_band_width, __pyx_n_s_tr_val, __pyx_n_s_result, __pyx_n_s_max_seq, __pyx_n_s_thresh, __pyx_n_s_thresh2, __pyx_n_s_seq, __pyx_n_s_abspath, __pyx_n_s_s, __pyx_n_s_l, __pyx_n_s_seq, __pyx_n_s_elem); if (unlikely(!__pyx_tuple__82)) __PYX_ERR(0, 1290, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__82);
+  __Pyx_GIVEREF(__pyx_tuple__82);
+  __pyx_codeobj__83 = (PyObject*)__Pyx_PyCode_New(7, 0, 18, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__82, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_max_track, 1290, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__83)) __PYX_ERR(0, 1290, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":1313
+  /* "soapcw/soapcw.pyx":1315
  *         return max_seq,s
  * 
  *     def gap_run(self,viterbi, band_width, diff, tsft, tr):             # <<<<<<<<<<<<<<
  *         length = diff - 1
  *         max_vals = np.zeros(band_width)
  */
-  __pyx_tuple__83 = PyTuple_Pack(19, __pyx_n_s_self, __pyx_n_s_viterbi, __pyx_n_s_band_width, __pyx_n_s_diff, __pyx_n_s_tsft, __pyx_n_s_tr, __pyx_n_s_length, __pyx_n_s_max_vals, __pyx_n_s_max_paths, __pyx_n_s_bnd, __pyx_n_s_low, __pyx_n_s_high, __pyx_n_s_thres, __pyx_n_s_vend, __pyx_n_s_val, __pyx_n_s_ind, __pyx_n_s_j, __pyx_n_s_diff_ind, __pyx_n_s_gaptrack); if (unlikely(!__pyx_tuple__83)) __PYX_ERR(0, 1313, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__83);
-  __Pyx_GIVEREF(__pyx_tuple__83);
-  __pyx_codeobj__84 = (PyObject*)__Pyx_PyCode_New(6, 0, 19, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__83, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_gap_run, 1313, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__84)) __PYX_ERR(0, 1313, __pyx_L1_error)
+  __pyx_tuple__84 = PyTuple_Pack(19, __pyx_n_s_self, __pyx_n_s_viterbi, __pyx_n_s_band_width, __pyx_n_s_diff, __pyx_n_s_tsft, __pyx_n_s_tr, __pyx_n_s_length, __pyx_n_s_max_vals, __pyx_n_s_max_paths, __pyx_n_s_bnd, __pyx_n_s_low, __pyx_n_s_high, __pyx_n_s_thres, __pyx_n_s_vend, __pyx_n_s_val, __pyx_n_s_ind, __pyx_n_s_j, __pyx_n_s_diff_ind, __pyx_n_s_gaptrack); if (unlikely(!__pyx_tuple__84)) __PYX_ERR(0, 1315, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__84);
+  __Pyx_GIVEREF(__pyx_tuple__84);
+  __pyx_codeobj__85 = (PyObject*)__Pyx_PyCode_New(6, 0, 19, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__84, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_gap_run, 1315, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__85)) __PYX_ERR(0, 1315, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":1344
+  /* "soapcw/soapcw.pyx":1346
  *         return max_vals, max_paths
  * 
  *     def find_path(self,prev,end_ind):             # <<<<<<<<<<<<<<
  *         length = len(prev)
  *         previous = prev[-1][end_ind]
  */
-  __pyx_tuple__85 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_prev, __pyx_n_s_end_ind, __pyx_n_s_length, __pyx_n_s_previous, __pyx_n_s_vit_track, __pyx_n_s_t); if (unlikely(!__pyx_tuple__85)) __PYX_ERR(0, 1344, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__85);
-  __Pyx_GIVEREF(__pyx_tuple__85);
-  __pyx_codeobj__86 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__85, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_find_path, 1344, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__86)) __PYX_ERR(0, 1344, __pyx_L1_error)
+  __pyx_tuple__86 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_prev, __pyx_n_s_end_ind, __pyx_n_s_length, __pyx_n_s_previous, __pyx_n_s_vit_track, __pyx_n_s_t); if (unlikely(!__pyx_tuple__86)) __PYX_ERR(0, 1346, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__86);
+  __Pyx_GIVEREF(__pyx_tuple__86);
+  __pyx_codeobj__87 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__86, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_find_path, 1346, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__87)) __PYX_ERR(0, 1346, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":1356
+  /* "soapcw/soapcw.pyx":1358
  * 
  * 
  *     def vit_gaps(self,data1,epochs1,tr,tsft):             # <<<<<<<<<<<<<<
  * 
  *         band_width = len(data1[0])
  */
-  __pyx_tuple__87 = PyTuple_Pack(21, __pyx_n_s_self, __pyx_n_s_data1, __pyx_n_s_epochs1, __pyx_n_s_tr, __pyx_n_s_tsft, __pyx_n_s_band_width, __pyx_n_s_vit, __pyx_n_s_starts, __pyx_n_s_gappaths, __pyx_n_s_gapend, __pyx_n_s_vitstart, __pyx_n_s_max_vals, __pyx_n_s_data, __pyx_n_s_epochs, __pyx_n_s_i, __pyx_n_s_idx, __pyx_n_s_diff, __pyx_n_s_diff_ind, __pyx_n_s_viterbi, __pyx_n_s_max_paths, __pyx_n_s_diff1); if (unlikely(!__pyx_tuple__87)) __PYX_ERR(0, 1356, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__87);
-  __Pyx_GIVEREF(__pyx_tuple__87);
-  __pyx_codeobj__88 = (PyObject*)__Pyx_PyCode_New(5, 0, 21, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__87, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_vit_gaps, 1356, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__88)) __PYX_ERR(0, 1356, __pyx_L1_error)
+  __pyx_tuple__88 = PyTuple_Pack(21, __pyx_n_s_self, __pyx_n_s_data1, __pyx_n_s_epochs1, __pyx_n_s_tr, __pyx_n_s_tsft, __pyx_n_s_band_width, __pyx_n_s_vit, __pyx_n_s_starts, __pyx_n_s_gappaths, __pyx_n_s_gapend, __pyx_n_s_vitstart, __pyx_n_s_max_vals, __pyx_n_s_data, __pyx_n_s_epochs, __pyx_n_s_i, __pyx_n_s_idx, __pyx_n_s_diff, __pyx_n_s_diff_ind, __pyx_n_s_viterbi, __pyx_n_s_max_paths, __pyx_n_s_diff1); if (unlikely(!__pyx_tuple__88)) __PYX_ERR(0, 1358, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__88);
+  __Pyx_GIVEREF(__pyx_tuple__88);
+  __pyx_codeobj__89 = (PyObject*)__Pyx_PyCode_New(5, 0, 21, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__88, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_vit_gaps, 1358, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__89)) __PYX_ERR(0, 1358, __pyx_L1_error)
 
-  /* "soapcw/soapcw.pyx":1440
+  /* "soapcw/soapcw.pyx":1442
  *         return vit,starts, gappaths
  * 
  *     def get_track(self,vit,starts,gappaths,tsft=1):             # <<<<<<<<<<<<<<
  *         vit_track = []
  *         vit_track_time = []
  */
-  __pyx_tuple__89 = PyTuple_Pack(12, __pyx_n_s_self, __pyx_n_s_vit, __pyx_n_s_starts, __pyx_n_s_gappaths, __pyx_n_s_tsft, __pyx_n_s_vit_track, __pyx_n_s_vit_track_time, __pyx_n_s_gpb, __pyx_n_s_gp, __pyx_n_s_v, __pyx_n_s_p1, __pyx_n_s_st); if (unlikely(!__pyx_tuple__89)) __PYX_ERR(0, 1440, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__89);
-  __Pyx_GIVEREF(__pyx_tuple__89);
-  __pyx_codeobj__90 = (PyObject*)__Pyx_PyCode_New(5, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__89, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_get_track, 1440, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__90)) __PYX_ERR(0, 1440, __pyx_L1_error)
-  __pyx_tuple__91 = PyTuple_Pack(1, ((PyObject *)__pyx_int_1)); if (unlikely(!__pyx_tuple__91)) __PYX_ERR(0, 1440, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__91);
-  __Pyx_GIVEREF(__pyx_tuple__91);
+  __pyx_tuple__90 = PyTuple_Pack(12, __pyx_n_s_self, __pyx_n_s_vit, __pyx_n_s_starts, __pyx_n_s_gappaths, __pyx_n_s_tsft, __pyx_n_s_vit_track, __pyx_n_s_vit_track_time, __pyx_n_s_gpb, __pyx_n_s_gp, __pyx_n_s_v, __pyx_n_s_p1, __pyx_n_s_st); if (unlikely(!__pyx_tuple__90)) __PYX_ERR(0, 1442, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__90);
+  __Pyx_GIVEREF(__pyx_tuple__90);
+  __pyx_codeobj__91 = (PyObject*)__Pyx_PyCode_New(5, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__90, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_soapcw_soapcw_pyx, __pyx_n_s_get_track, 1442, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__91)) __PYX_ERR(0, 1442, __pyx_L1_error)
+  __pyx_tuple__92 = PyTuple_Pack(1, ((PyObject *)__pyx_int_1)); if (unlikely(!__pyx_tuple__92)) __PYX_ERR(0, 1442, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__92);
+  __Pyx_GIVEREF(__pyx_tuple__92);
 
-  /* "View.MemoryView":286
+  /* "View.MemoryView":287
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_tuple__92 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__92)) __PYX_ERR(1, 286, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__92);
-  __Pyx_GIVEREF(__pyx_tuple__92);
+  __pyx_tuple__93 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__93)) __PYX_ERR(1, 287, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__93);
+  __Pyx_GIVEREF(__pyx_tuple__93);
 
-  /* "View.MemoryView":287
+  /* "View.MemoryView":288
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_tuple__93 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__93)) __PYX_ERR(1, 287, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__93);
-  __Pyx_GIVEREF(__pyx_tuple__93);
+  __pyx_tuple__94 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__94)) __PYX_ERR(1, 288, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__94);
+  __Pyx_GIVEREF(__pyx_tuple__94);
 
-  /* "View.MemoryView":288
+  /* "View.MemoryView":289
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__94 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__94)) __PYX_ERR(1, 288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__94);
-  __Pyx_GIVEREF(__pyx_tuple__94);
+  __pyx_tuple__95 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__95)) __PYX_ERR(1, 289, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__95);
+  __Pyx_GIVEREF(__pyx_tuple__95);
 
-  /* "View.MemoryView":291
+  /* "View.MemoryView":292
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_tuple__95 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__95)) __PYX_ERR(1, 291, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__95);
-  __Pyx_GIVEREF(__pyx_tuple__95);
+  __pyx_tuple__96 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(1, 292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__96);
+  __Pyx_GIVEREF(__pyx_tuple__96);
 
-  /* "View.MemoryView":292
+  /* "View.MemoryView":293
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__96 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(1, 292, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__96);
-  __Pyx_GIVEREF(__pyx_tuple__96);
+  __pyx_tuple__97 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__97)) __PYX_ERR(1, 293, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__97);
+  __Pyx_GIVEREF(__pyx_tuple__97);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_tuple__97 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__97)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__97);
-  __Pyx_GIVEREF(__pyx_tuple__97);
-  __pyx_codeobj__98 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__97, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__98)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_tuple__98 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__98)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__98);
+  __Pyx_GIVEREF(__pyx_tuple__98);
+  __pyx_codeobj__99 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__98, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__99)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitGlobals(void) {
-  if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
+  if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_float_1_ = PyFloat_FromDouble(1.); if (unlikely(!__pyx_float_1_)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_float_neg_1e6 = PyFloat_FromDouble(-1e6); if (unlikely(!__pyx_float_neg_1e6)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_int_112105877 = PyInt_FromLong(112105877L); if (unlikely(!__pyx_int_112105877)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_int_136983863 = PyInt_FromLong(136983863L); if (unlikely(!__pyx_int_136983863)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_184977713 = PyInt_FromLong(184977713L); if (unlikely(!__pyx_int_184977713)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
@@ -43996,14 +44443,17 @@
   /*--- Function export code ---*/
   __Pyx_RefNannyFinishContext();
   return 0;
 }
 
 static int __Pyx_modinit_type_init_code(void) {
   __Pyx_RefNannyDeclarations
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
   if (PyType_Ready(&__pyx_type_6soapcw_6soapcw___pyx_scope_struct__run) < 0) __PYX_ERR(0, 77, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6soapcw_6soapcw___pyx_scope_struct__run.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6soapcw_6soapcw___pyx_scope_struct__run.tp_dictoffset && __pyx_type_6soapcw_6soapcw___pyx_scope_struct__run.tp_getattro == PyObject_GenericGetAttr)) {
@@ -44016,62 +44466,62 @@
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6soapcw_6soapcw___pyx_scope_struct_1_genexpr.tp_dictoffset && __pyx_type_6soapcw_6soapcw___pyx_scope_struct_1_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6soapcw_6soapcw___pyx_scope_struct_1_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_6soapcw_6soapcw___pyx_scope_struct_1_genexpr = &__pyx_type_6soapcw_6soapcw___pyx_scope_struct_1_genexpr;
   __pyx_vtabptr_array = &__pyx_vtable_array;
   __pyx_vtable_array.get_memview = (PyObject *(*)(struct __pyx_array_obj *))__pyx_array_get_memview;
-  if (PyType_Ready(&__pyx_type___pyx_array) < 0) __PYX_ERR(1, 105, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type___pyx_array) < 0) __PYX_ERR(1, 106, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_array.tp_print = 0;
   #endif
-  if (__Pyx_SetVtable(__pyx_type___pyx_array.tp_dict, __pyx_vtabptr_array) < 0) __PYX_ERR(1, 105, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_array) < 0) __PYX_ERR(1, 105, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type___pyx_array.tp_dict, __pyx_vtabptr_array) < 0) __PYX_ERR(1, 106, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_array) < 0) __PYX_ERR(1, 106, __pyx_L1_error)
   __pyx_array_type = &__pyx_type___pyx_array;
-  if (PyType_Ready(&__pyx_type___pyx_MemviewEnum) < 0) __PYX_ERR(1, 279, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type___pyx_MemviewEnum) < 0) __PYX_ERR(1, 280, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_MemviewEnum.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type___pyx_MemviewEnum.tp_dictoffset && __pyx_type___pyx_MemviewEnum.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type___pyx_MemviewEnum.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_MemviewEnum) < 0) __PYX_ERR(1, 279, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_MemviewEnum) < 0) __PYX_ERR(1, 280, __pyx_L1_error)
   __pyx_MemviewEnum_type = &__pyx_type___pyx_MemviewEnum;
   __pyx_vtabptr_memoryview = &__pyx_vtable_memoryview;
   __pyx_vtable_memoryview.get_item_pointer = (char *(*)(struct __pyx_memoryview_obj *, PyObject *))__pyx_memoryview_get_item_pointer;
   __pyx_vtable_memoryview.is_slice = (PyObject *(*)(struct __pyx_memoryview_obj *, PyObject *))__pyx_memoryview_is_slice;
   __pyx_vtable_memoryview.setitem_slice_assignment = (PyObject *(*)(struct __pyx_memoryview_obj *, PyObject *, PyObject *))__pyx_memoryview_setitem_slice_assignment;
   __pyx_vtable_memoryview.setitem_slice_assign_scalar = (PyObject *(*)(struct __pyx_memoryview_obj *, struct __pyx_memoryview_obj *, PyObject *))__pyx_memoryview_setitem_slice_assign_scalar;
   __pyx_vtable_memoryview.setitem_indexed = (PyObject *(*)(struct __pyx_memoryview_obj *, PyObject *, PyObject *))__pyx_memoryview_setitem_indexed;
   __pyx_vtable_memoryview.convert_item_to_object = (PyObject *(*)(struct __pyx_memoryview_obj *, char *))__pyx_memoryview_convert_item_to_object;
   __pyx_vtable_memoryview.assign_item_from_object = (PyObject *(*)(struct __pyx_memoryview_obj *, char *, PyObject *))__pyx_memoryview_assign_item_from_object;
-  if (PyType_Ready(&__pyx_type___pyx_memoryview) < 0) __PYX_ERR(1, 330, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type___pyx_memoryview) < 0) __PYX_ERR(1, 331, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_memoryview.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type___pyx_memoryview.tp_dictoffset && __pyx_type___pyx_memoryview.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type___pyx_memoryview.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  if (__Pyx_SetVtable(__pyx_type___pyx_memoryview.tp_dict, __pyx_vtabptr_memoryview) < 0) __PYX_ERR(1, 330, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_memoryview) < 0) __PYX_ERR(1, 330, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type___pyx_memoryview.tp_dict, __pyx_vtabptr_memoryview) < 0) __PYX_ERR(1, 331, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_memoryview) < 0) __PYX_ERR(1, 331, __pyx_L1_error)
   __pyx_memoryview_type = &__pyx_type___pyx_memoryview;
   __pyx_vtabptr__memoryviewslice = &__pyx_vtable__memoryviewslice;
   __pyx_vtable__memoryviewslice.__pyx_base = *__pyx_vtabptr_memoryview;
   __pyx_vtable__memoryviewslice.__pyx_base.convert_item_to_object = (PyObject *(*)(struct __pyx_memoryview_obj *, char *))__pyx_memoryviewslice_convert_item_to_object;
   __pyx_vtable__memoryviewslice.__pyx_base.assign_item_from_object = (PyObject *(*)(struct __pyx_memoryview_obj *, char *, PyObject *))__pyx_memoryviewslice_assign_item_from_object;
   __pyx_type___pyx_memoryviewslice.tp_base = __pyx_memoryview_type;
-  if (PyType_Ready(&__pyx_type___pyx_memoryviewslice) < 0) __PYX_ERR(1, 965, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type___pyx_memoryviewslice) < 0) __PYX_ERR(1, 967, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_memoryviewslice.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type___pyx_memoryviewslice.tp_dictoffset && __pyx_type___pyx_memoryviewslice.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type___pyx_memoryviewslice.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  if (__Pyx_SetVtable(__pyx_type___pyx_memoryviewslice.tp_dict, __pyx_vtabptr__memoryviewslice) < 0) __PYX_ERR(1, 965, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_memoryviewslice) < 0) __PYX_ERR(1, 965, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type___pyx_memoryviewslice.tp_dict, __pyx_vtabptr__memoryviewslice) < 0) __PYX_ERR(1, 967, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_memoryviewslice) < 0) __PYX_ERR(1, 967, __pyx_L1_error)
   __pyx_memoryviewslice_type = &__pyx_type___pyx_memoryviewslice;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
@@ -44097,25 +44547,27 @@
   __Pyx_RefNannySetupContext("__Pyx_modinit_function_import_code", 0);
   /*--- Function import code ---*/
   __Pyx_RefNannyFinishContext();
   return 0;
 }
 
 
-#if PY_MAJOR_VERSION < 3
-#ifdef CYTHON_NO_PYINIT_EXPORT
-#define __Pyx_PyMODINIT_FUNC void
-#else
+#ifndef CYTHON_NO_PYINIT_EXPORT
 #define __Pyx_PyMODINIT_FUNC PyMODINIT_FUNC
+#elif PY_MAJOR_VERSION < 3
+#ifdef __cplusplus
+#define __Pyx_PyMODINIT_FUNC extern "C" void
+#else
+#define __Pyx_PyMODINIT_FUNC void
 #endif
 #else
-#ifdef CYTHON_NO_PYINIT_EXPORT
-#define __Pyx_PyMODINIT_FUNC PyObject *
+#ifdef __cplusplus
+#define __Pyx_PyMODINIT_FUNC extern "C" PyObject *
 #else
-#define __Pyx_PyMODINIT_FUNC PyMODINIT_FUNC
+#define __Pyx_PyMODINIT_FUNC PyObject *
 #endif
 #endif
 
 
 #if PY_MAJOR_VERSION < 3
 __Pyx_PyMODINIT_FUNC initsoapcw(void) CYTHON_SMALL_CODE; /*proto*/
 __Pyx_PyMODINIT_FUNC initsoapcw(void)
@@ -44192,14 +44644,17 @@
 #endif
 #endif
 {
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   static PyThread_type_lock __pyx_t_4[8];
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   if (__pyx_m) {
     if (__pyx_m == __pyx_pyinit_module) return 0;
     PyErr_SetString(PyExc_RuntimeError, "Module 'soapcw' has already been imported. Re-initialisation is not supported.");
     return -1;
   }
@@ -44239,19 +44694,17 @@
   if (__pyx_AsyncGen_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
   #ifdef __Pyx_StopAsyncIteration_USED
   if (__pyx_StopAsyncIteration_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
   /*--- Library function declarations ---*/
   /*--- Threads initialization code ---*/
-  #if defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
-  #ifdef WITH_THREAD /* Python build with threading support? */
+  #if defined(WITH_THREAD) && PY_VERSION_HEX < 0x030700F0 && defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
   PyEval_InitThreads();
   #endif
-  #endif
   /*--- Module creation code ---*/
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   __pyx_m = __pyx_pyinit_module;
   Py_INCREF(__pyx_m);
   #else
   #if PY_MAJOR_VERSION < 3
   __pyx_m = Py_InitModule4("soapcw", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
@@ -44262,15 +44715,15 @@
   #endif
   __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) __PYX_ERR(0, 1, __pyx_L1_error)
   Py_INCREF(__pyx_d);
   __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_b)) __PYX_ERR(0, 1, __pyx_L1_error)
   Py_INCREF(__pyx_b);
   __pyx_cython_runtime = PyImport_AddModule((char *) "cython_runtime"); if (unlikely(!__pyx_cython_runtime)) __PYX_ERR(0, 1, __pyx_L1_error)
   Py_INCREF(__pyx_cython_runtime);
-  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
+  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   /*--- Initialize various global constants etc. ---*/
   if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
   if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
   if (__pyx_module_is_main_soapcw__soapcw) {
     if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name_2, __pyx_n_s_main) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -44280,22 +44733,22 @@
     PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
     if (!PyDict_GetItemString(modules, "soapcw.soapcw")) {
       if (unlikely(PyDict_SetItemString(modules, "soapcw.soapcw", __pyx_m) < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
     }
   }
   #endif
   /*--- Builtin init code ---*/
-  if (__Pyx_InitCachedBuiltins() < 0) goto __pyx_L1_error;
+  if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   /*--- Constants init code ---*/
-  if (__Pyx_InitCachedConstants() < 0) goto __pyx_L1_error;
+  if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   /*--- Global type/function init code ---*/
   (void)__Pyx_modinit_global_init_code();
   (void)__Pyx_modinit_variable_export_code();
   (void)__Pyx_modinit_function_export_code();
-  if (unlikely(__Pyx_modinit_type_init_code() != 0)) goto __pyx_L1_error;
+  if (unlikely(__Pyx_modinit_type_init_code() < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
   (void)__Pyx_modinit_type_import_code();
   (void)__Pyx_modinit_variable_import_code();
   (void)__Pyx_modinit_function_import_code();
   /*--- Execution code ---*/
   #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
   if (__Pyx_patch_abc() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
@@ -44417,553 +44870,553 @@
   /* "soapcw/soapcw.pyx":14
  * from scipy.special import logsumexp
  * 
  * class single_detector(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs, prog = False, lookup_file=None, make_vitmap = True):
  */
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__29); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__30); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__29, __pyx_n_s_single_detector, __pyx_n_s_single_detector, (PyObject *) NULL, __pyx_n_s_soapcw_soapcw, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__30, __pyx_n_s_single_detector, __pyx_n_s_single_detector, (PyObject *) NULL, __pyx_n_s_soapcw_soapcw, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
   /* "soapcw/soapcw.pyx":16
  * class single_detector(object):
  * 
  *     def __init__(self, tr, obs, prog = False, lookup_file=None, make_vitmap = True):             # <<<<<<<<<<<<<<
  *         '''
  *         initialising viterbi class
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_15single_detector_1__init__, 0, __pyx_n_s_single_detector___init, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__31)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 16, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_15single_detector_1__init__, 0, __pyx_n_s_single_detector___init, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__32)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__32);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__33);
   if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
   /* "soapcw/soapcw.pyx":41
  *     #------------------------------------------------------------------------------------------------
  * 
  *     def get_vitmap(self,log=False):             # <<<<<<<<<<<<<<
  *         """
  *         normalise the viterbi output such that the sum of eah column is 1
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_15single_detector_3get_vitmap, 0, __pyx_n_s_single_detector_get_vitmap, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__34)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 41, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_15single_detector_3get_vitmap, 0, __pyx_n_s_single_detector_get_vitmap, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__35)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 41, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__35);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__36);
   if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_vitmap, __pyx_t_3) < 0) __PYX_ERR(0, 41, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
   /* "soapcw/soapcw.pyx":60
  *     #--------------------------
  * 
  *     def read_lookup(self,filename):             # <<<<<<<<<<<<<<
  *         """
  *         Read the lookup table for chosen statistic
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_15single_detector_5read_lookup, 0, __pyx_n_s_single_detector_read_lookup, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__37)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_15single_detector_5read_lookup, 0, __pyx_n_s_single_detector_read_lookup, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__38)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 60, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_read_lookup, __pyx_t_3) < 0) __PYX_ERR(0, 60, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
   /* "soapcw/soapcw.pyx":77
  * 
  * 
  *     def run(self,double[:] tr, double[:, :] obs, lookup_file = None):             # <<<<<<<<<<<<<<
  *         '''
  *         Run the viterbi algorithm for given single set of data and 3x1 transition matrix.
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_15single_detector_7run, 0, __pyx_n_s_single_detector_run, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__39)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 77, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_15single_detector_7run, 0, __pyx_n_s_single_detector_run, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__40)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 77, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__40);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__41);
   if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_run, __pyx_t_3) < 0) __PYX_ERR(0, 77, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
   /* "soapcw/soapcw.pyx":14
  * from scipy.special import logsumexp
  * 
  * class single_detector(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs, prog = False, lookup_file=None, make_vitmap = True):
  */
-  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_single_detector, __pyx_tuple__29, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 14, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_single_detector, __pyx_tuple__30, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 14, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_single_detector, __pyx_t_3) < 0) __PYX_ERR(0, 14, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "soapcw/soapcw.pyx":190
  * 
  * 
  * class two_detector(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs1, obs2, lookup_file_2det = None, lookup_file_1det = None, prog = False,fractions=None, make_vitmap=True):
  */
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__41); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__42); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 190, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__41, __pyx_n_s_two_detector, __pyx_n_s_two_detector, (PyObject *) NULL, __pyx_n_s_soapcw_soapcw, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__42, __pyx_n_s_two_detector, __pyx_n_s_two_detector, (PyObject *) NULL, __pyx_n_s_soapcw_soapcw, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 190, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
   /* "soapcw/soapcw.pyx":192
  * class two_detector(object):
  * 
  *     def __init__(self, tr, obs1, obs2, lookup_file_2det = None, lookup_file_1det = None, prog = False,fractions=None, make_vitmap=True):             # <<<<<<<<<<<<<<
  *         '''
  *         viterbi algorithm for two detectors with an optional line aware statistic
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_12two_detector_1__init__, 0, __pyx_n_s_two_detector___init, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__43)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 192, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_12two_detector_1__init__, 0, __pyx_n_s_two_detector___init, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__44)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__44);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__45);
   if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 192, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":251
+  /* "soapcw/soapcw.pyx":253
  *     #------------------------------------------------------------------------------------------------
  * 
  *     def get_vitmap(self,log=False):             # <<<<<<<<<<<<<<
  *         """
  *         normalise the viterbi output such that the sum of eah column is 1
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_12two_detector_3get_vitmap, 0, __pyx_n_s_two_detector_get_vitmap, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__46)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 251, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_12two_detector_3get_vitmap, 0, __pyx_n_s_two_detector_get_vitmap, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__47)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 253, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__47);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_vitmap, __pyx_t_3) < 0) __PYX_ERR(0, 251, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__48);
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_vitmap, __pyx_t_3) < 0) __PYX_ERR(0, 253, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":271
+  /* "soapcw/soapcw.pyx":273
  *     #--------------------------------------------------------
  * 
  *     def read_lookup(self,filename):             # <<<<<<<<<<<<<<
  * 
  *         with open(filename,'rb') as f1:
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_12two_detector_5read_lookup, 0, __pyx_n_s_two_detector_read_lookup, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__49)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 271, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_12two_detector_5read_lookup, 0, __pyx_n_s_two_detector_read_lookup, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__50)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 273, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_read_lookup, __pyx_t_3) < 0) __PYX_ERR(0, 271, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_read_lookup, __pyx_t_3) < 0) __PYX_ERR(0, 273, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":281
+  /* "soapcw/soapcw.pyx":283
  *         return likelihood, ranges, fact
  * 
  *     def read_lookup_amp(self,filename):             # <<<<<<<<<<<<<<
  * 
  *         with open(filename,'rb') as f1:
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_12two_detector_7read_lookup_amp, 0, __pyx_n_s_two_detector_read_lookup_amp, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__51)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 281, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_12two_detector_7read_lookup_amp, 0, __pyx_n_s_two_detector_read_lookup_amp, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__52)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 283, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_read_lookup_amp, __pyx_t_3) < 0) __PYX_ERR(0, 281, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_read_lookup_amp, __pyx_t_3) < 0) __PYX_ERR(0, 283, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":298
+  /* "soapcw/soapcw.pyx":300
  *     #--------------------------------------------------------
  * 
  *     def run(self,transition, obs1, obs2, lookup_file_1det = None,lookup_file_2det = None):             # <<<<<<<<<<<<<<
  *         """
  *         viterbi algorithm for two detectors with an lookup table for the line veto statistic
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_12two_detector_9run, 0, __pyx_n_s_two_detector_run, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__53)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 298, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_12two_detector_9run, 0, __pyx_n_s_two_detector_run, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__54)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 300, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__54);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_run, __pyx_t_3) < 0) __PYX_ERR(0, 298, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__55);
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_run, __pyx_t_3) < 0) __PYX_ERR(0, 300, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":540
+  /* "soapcw/soapcw.pyx":542
  *         self.length = length
  * 
  *     def run_lookup_amp(self,tr1, obs11, obs21,lookup_file = None, fractions = None):             # <<<<<<<<<<<<<<
  *         """
  *         viterbi algorithm for two detectors with an lookup table for the line veto statistic
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_12two_detector_11run_lookup_amp, 0, __pyx_n_s_two_detector_run_lookup_amp, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__56)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_12two_detector_11run_lookup_amp, 0, __pyx_n_s_two_detector_run_lookup_amp, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__57)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 542, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__57);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_run_lookup_amp, __pyx_t_3) < 0) __PYX_ERR(0, 540, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__58);
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_run_lookup_amp, __pyx_t_3) < 0) __PYX_ERR(0, 542, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":701
+  /* "soapcw/soapcw.pyx":703
  *         self.length = length
  * 
  *     def get_track(self):             # <<<<<<<<<<<<<<
  *         """
  *         Takes in the viterbi data from a run and identifies the track thorugh whcih gives the maximum probability
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_12two_detector_13get_track, 0, __pyx_n_s_two_detector_get_track, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__59)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 701, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_12two_detector_13get_track, 0, __pyx_n_s_two_detector_get_track, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__60)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 703, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_track, __pyx_t_3) < 0) __PYX_ERR(0, 701, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_track, __pyx_t_3) < 0) __PYX_ERR(0, 703, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
   /* "soapcw/soapcw.pyx":190
  * 
  * 
  * class two_detector(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs1, obs2, lookup_file_2det = None, lookup_file_1det = None, prog = False,fractions=None, make_vitmap=True):
  */
-  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_two_detector, __pyx_tuple__41, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_two_detector, __pyx_tuple__42, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 190, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_two_detector, __pyx_t_3) < 0) __PYX_ERR(0, 190, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":743
+  /* "soapcw/soapcw.pyx":745
  * 
  * 
  * class three_detector(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs1, obs2, obs3, prog = False):
  */
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__60); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__61); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 745, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__60, __pyx_n_s_three_detector, __pyx_n_s_three_detector, (PyObject *) NULL, __pyx_n_s_soapcw_soapcw, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__61, __pyx_n_s_three_detector, __pyx_n_s_three_detector, (PyObject *) NULL, __pyx_n_s_soapcw_soapcw, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 745, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "soapcw/soapcw.pyx":745
+  /* "soapcw/soapcw.pyx":747
  * class three_detector(object):
  * 
  *     def __init__(self, tr, obs1, obs2, obs3, prog = False):             # <<<<<<<<<<<<<<
  *         '''
  *         initialising viterbi class
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_14three_detector_1__init__, 0, __pyx_n_s_three_detector___init, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__62)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 745, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_14three_detector_1__init__, 0, __pyx_n_s_three_detector___init, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__63)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 747, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__63);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 745, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__64);
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 747, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":758
+  /* "soapcw/soapcw.pyx":760
  *     #--------------------------------------------------------
  * 
  *     def run(self,tr1, obs11, obs21, obs31):             # <<<<<<<<<<<<<<
  *         """
  *         viterbi algorithm for multiple detectors 2 at the moment
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_14three_detector_3run, 0, __pyx_n_s_three_detector_run, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__65)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 758, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_14three_detector_3run, 0, __pyx_n_s_three_detector_run, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__66)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 760, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_run, __pyx_t_3) < 0) __PYX_ERR(0, 758, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_run, __pyx_t_3) < 0) __PYX_ERR(0, 760, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":743
+  /* "soapcw/soapcw.pyx":745
  * 
  * 
  * class three_detector(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs1, obs2, obs3, prog = False):
  */
-  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_three_detector, __pyx_tuple__60, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_three_detector, __pyx_tuple__61, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 745, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_three_detector, __pyx_t_3) < 0) __PYX_ERR(0, 743, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_three_detector, __pyx_t_3) < 0) __PYX_ERR(0, 745, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":913
+  /* "soapcw/soapcw.pyx":915
  *         #return np.array(vit_track1), np.array(vit_track2), np.array(vit_track3), np.array(vit_trackr), np.array(val),np.array(prev), max_prob
  * 
  * class single_detector_mem_n(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs, prog = False):
  */
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__66); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 913, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__67); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 915, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__66, __pyx_n_s_single_detector_mem_n, __pyx_n_s_single_detector_mem_n, (PyObject *) NULL, __pyx_n_s_soapcw_soapcw, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 913, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__67, __pyx_n_s_single_detector_mem_n, __pyx_n_s_single_detector_mem_n, (PyObject *) NULL, __pyx_n_s_soapcw_soapcw, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 915, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "soapcw/soapcw.pyx":915
+  /* "soapcw/soapcw.pyx":917
  * class single_detector_mem_n(object):
  * 
  *     def __init__(self, tr, obs, prog = False):             # <<<<<<<<<<<<<<
  *         '''
  * 
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_21single_detector_mem_n_1__init__, 0, __pyx_n_s_single_detector_mem_n___init, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__68)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 915, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_21single_detector_mem_n_1__init__, 0, __pyx_n_s_single_detector_mem_n___init, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__69)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 917, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__69);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 915, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__70);
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 917, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":930
+  /* "soapcw/soapcw.pyx":932
  *     #------------------------------------------------------------------------
  * 
  *     def run(self, tr, obs):             # <<<<<<<<<<<<<<
  *         ''' Run viterbi algroithm with memory of n
  *         the amount of memory is determined by the transition matrix
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_21single_detector_mem_n_3run, 0, __pyx_n_s_single_detector_mem_n_run, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__71)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 930, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_21single_detector_mem_n_3run, 0, __pyx_n_s_single_detector_mem_n_run, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__72)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 932, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_run, __pyx_t_3) < 0) __PYX_ERR(0, 930, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_run, __pyx_t_3) < 0) __PYX_ERR(0, 932, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":913
+  /* "soapcw/soapcw.pyx":915
  *         #return np.array(vit_track1), np.array(vit_track2), np.array(vit_track3), np.array(vit_trackr), np.array(val),np.array(prev), max_prob
  * 
  * class single_detector_mem_n(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs, prog = False):
  */
-  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_single_detector_mem_n, __pyx_tuple__66, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 913, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_single_detector_mem_n, __pyx_tuple__67, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 915, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_single_detector_mem_n, __pyx_t_3) < 0) __PYX_ERR(0, 913, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_single_detector_mem_n, __pyx_t_3) < 0) __PYX_ERR(0, 915, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1067
+  /* "soapcw/soapcw.pyx":1069
  *         #return (vit_track,val,prev)
  * 
  * class two_detector_mem_n(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs1, obs2, prog = False):
  */
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__72); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__73); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1069, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__72, __pyx_n_s_two_detector_mem_n, __pyx_n_s_two_detector_mem_n, (PyObject *) NULL, __pyx_n_s_soapcw_soapcw, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__73, __pyx_n_s_two_detector_mem_n, __pyx_n_s_two_detector_mem_n, (PyObject *) NULL, __pyx_n_s_soapcw_soapcw, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1069, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "soapcw/soapcw.pyx":1069
+  /* "soapcw/soapcw.pyx":1071
  * class two_detector_mem_n(object):
  * 
  *     def __init__(self, tr, obs1, obs2, prog = False):             # <<<<<<<<<<<<<<
  *         '''
  *         initialising viterbi class
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_18two_detector_mem_n_1__init__, 0, __pyx_n_s_two_detector_mem_n___init, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__74)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1069, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_18two_detector_mem_n_1__init__, 0, __pyx_n_s_two_detector_mem_n___init, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__75)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1071, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__75);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 1069, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__76);
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 1071, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":1082
+  /* "soapcw/soapcw.pyx":1084
  * 
  * 
  *     def run(self, tr, obs11, obs22):             # <<<<<<<<<<<<<<
  *         ''' Run viterbi algroithm with memory of n
  *         the amount of memory is determined by the transition matrix
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_18two_detector_mem_n_3run, 0, __pyx_n_s_two_detector_mem_n_run, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__77)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1082, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_18two_detector_mem_n_3run, 0, __pyx_n_s_two_detector_mem_n_run, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__78)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1084, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_run, __pyx_t_3) < 0) __PYX_ERR(0, 1082, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_run, __pyx_t_3) < 0) __PYX_ERR(0, 1084, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":1067
+  /* "soapcw/soapcw.pyx":1069
  *         #return (vit_track,val,prev)
  * 
  * class two_detector_mem_n(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs1, obs2, prog = False):
  */
-  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_two_detector_mem_n, __pyx_tuple__72, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_two_detector_mem_n, __pyx_tuple__73, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1069, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_two_detector_mem_n, __pyx_t_3) < 0) __PYX_ERR(0, 1067, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_two_detector_mem_n, __pyx_t_3) < 0) __PYX_ERR(0, 1069, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "soapcw/soapcw.pyx":1260
+  /* "soapcw/soapcw.pyx":1262
  * ### ----------------------------------------------------------------
  * 
  * class single_detector_gaps(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs,times,tsft):
  */
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__78); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1260, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__79); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1262, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__78, __pyx_n_s_single_detector_gaps, __pyx_n_s_single_detector_gaps, (PyObject *) NULL, __pyx_n_s_soapcw_soapcw, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1260, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__79, __pyx_n_s_single_detector_gaps, __pyx_n_s_single_detector_gaps, (PyObject *) NULL, __pyx_n_s_soapcw_soapcw, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1262, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "soapcw/soapcw.pyx":1262
+  /* "soapcw/soapcw.pyx":1264
  * class single_detector_gaps(object):
  * 
  *     def __init__(self, tr, obs,times,tsft):             # <<<<<<<<<<<<<<
  *         """
  *         single detector viterbi algorithm where the data can include large gaps in data
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_1__init__, 0, __pyx_n_s_single_detector_gaps___init, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__80)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1262, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_1__init__, 0, __pyx_n_s_single_detector_gaps___init, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__81)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1264, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 1262, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 1264, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":1288
+  /* "soapcw/soapcw.pyx":1290
  *         self.max_end_prob = max(self.vits[-1].V[-1])
  * 
  *     def max_track(self,tr,length,diff,bnd,ind,band_width):             # <<<<<<<<<<<<<<
  *         tr_val = np.arange(len(tr)).astype(int) - np.floor(len(tr)/2).astype(int)
  *         result = [seq for seq in itertools.combinations_with_replacement(tr_val, length) if sum(seq) == diff]
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_3max_track, 0, __pyx_n_s_single_detector_gaps_max_track, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__82)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1288, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_3max_track, 0, __pyx_n_s_single_detector_gaps_max_track, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__83)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1290, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_max_track, __pyx_t_3) < 0) __PYX_ERR(0, 1288, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_max_track, __pyx_t_3) < 0) __PYX_ERR(0, 1290, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":1313
+  /* "soapcw/soapcw.pyx":1315
  *         return max_seq,s
  * 
  *     def gap_run(self,viterbi, band_width, diff, tsft, tr):             # <<<<<<<<<<<<<<
  *         length = diff - 1
  *         max_vals = np.zeros(band_width)
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_5gap_run, 0, __pyx_n_s_single_detector_gaps_gap_run, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__84)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1313, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_5gap_run, 0, __pyx_n_s_single_detector_gaps_gap_run, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__85)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1315, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_gap_run, __pyx_t_3) < 0) __PYX_ERR(0, 1313, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_gap_run, __pyx_t_3) < 0) __PYX_ERR(0, 1315, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":1344
+  /* "soapcw/soapcw.pyx":1346
  *         return max_vals, max_paths
  * 
  *     def find_path(self,prev,end_ind):             # <<<<<<<<<<<<<<
  *         length = len(prev)
  *         previous = prev[-1][end_ind]
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_7find_path, 0, __pyx_n_s_single_detector_gaps_find_path, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__86)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1344, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_7find_path, 0, __pyx_n_s_single_detector_gaps_find_path, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__87)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1346, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_find_path, __pyx_t_3) < 0) __PYX_ERR(0, 1344, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_find_path, __pyx_t_3) < 0) __PYX_ERR(0, 1346, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":1356
+  /* "soapcw/soapcw.pyx":1358
  * 
  * 
  *     def vit_gaps(self,data1,epochs1,tr,tsft):             # <<<<<<<<<<<<<<
  * 
  *         band_width = len(data1[0])
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_9vit_gaps, 0, __pyx_n_s_single_detector_gaps_vit_gaps, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__88)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1356, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_9vit_gaps, 0, __pyx_n_s_single_detector_gaps_vit_gaps, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__89)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1358, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_vit_gaps, __pyx_t_3) < 0) __PYX_ERR(0, 1356, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_vit_gaps, __pyx_t_3) < 0) __PYX_ERR(0, 1358, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":1440
+  /* "soapcw/soapcw.pyx":1442
  *         return vit,starts, gappaths
  * 
  *     def get_track(self,vit,starts,gappaths,tsft=1):             # <<<<<<<<<<<<<<
  *         vit_track = []
  *         vit_track_time = []
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_11get_track, 0, __pyx_n_s_single_detector_gaps_get_track, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__90)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1440, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6soapcw_6soapcw_20single_detector_gaps_11get_track, 0, __pyx_n_s_single_detector_gaps_get_track, NULL, __pyx_n_s_soapcw_soapcw, __pyx_d, ((PyObject *)__pyx_codeobj__91)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1442, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__91);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_track, __pyx_t_3) < 0) __PYX_ERR(0, 1440, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__92);
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_track, __pyx_t_3) < 0) __PYX_ERR(0, 1442, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "soapcw/soapcw.pyx":1260
+  /* "soapcw/soapcw.pyx":1262
  * ### ----------------------------------------------------------------
  * 
  * class single_detector_gaps(object):             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, tr, obs,times,tsft):
  */
-  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_single_detector_gaps, __pyx_tuple__78, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1260, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_single_detector_gaps, __pyx_tuple__79, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1262, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_single_detector_gaps, __pyx_t_3) < 0) __PYX_ERR(0, 1260, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_single_detector_gaps, __pyx_t_3) < 0) __PYX_ERR(0, 1262, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "soapcw/soapcw.pyx":1
  * # cython: language_level=3             # <<<<<<<<<<<<<<
  * from __future__ import division
  * import numpy as np
  */
   __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "View.MemoryView":209
+  /* "View.MemoryView":210
  *         info.obj = self
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_array_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  *     def __dealloc__(array self):
  */
-  __pyx_t_1 = __pyx_capsule_create(((void *)(&__pyx_array_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 209, __pyx_L1_error)
+  __pyx_t_1 = __pyx_capsule_create(((void *)(&__pyx_array_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 210, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem((PyObject *)__pyx_array_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_1) < 0) __PYX_ERR(1, 209, __pyx_L1_error)
+  if (PyDict_SetItem((PyObject *)__pyx_array_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_1) < 0) __PYX_ERR(1, 210, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_array_type);
 
-  /* "View.MemoryView":286
+  /* "View.MemoryView":287
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__92, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 286, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__93, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 287, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(generic);
   __Pyx_DECREF_SET(generic, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "View.MemoryView":287
+  /* "View.MemoryView":288
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__93, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 287, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__94, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(strided);
   __Pyx_DECREF_SET(strided, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "View.MemoryView":288
+  /* "View.MemoryView":289
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__94, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 288, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__95, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(indirect);
   __Pyx_DECREF_SET(indirect, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "View.MemoryView":291
+  /* "View.MemoryView":292
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__95, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 291, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__96, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 292, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(contiguous);
   __Pyx_DECREF_SET(contiguous, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "View.MemoryView":292
+  /* "View.MemoryView":293
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__96, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 292, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__97, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 293, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(indirect_contiguous);
   __Pyx_DECREF_SET(indirect_contiguous, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "View.MemoryView":316
+  /* "View.MemoryView":317
  * 
  * DEF THREAD_LOCKS_PREALLOCATED = 8
  * cdef int __pyx_memoryview_thread_locks_used = 0             # <<<<<<<<<<<<<<
  * cdef PyThread_type_lock[THREAD_LOCKS_PREALLOCATED] __pyx_memoryview_thread_locks = [
  *     PyThread_allocate_lock(),
  */
   __pyx_memoryview_thread_locks_used = 0;
 
-  /* "View.MemoryView":317
+  /* "View.MemoryView":318
  * DEF THREAD_LOCKS_PREALLOCATED = 8
  * cdef int __pyx_memoryview_thread_locks_used = 0
  * cdef PyThread_type_lock[THREAD_LOCKS_PREALLOCATED] __pyx_memoryview_thread_locks = [             # <<<<<<<<<<<<<<
  *     PyThread_allocate_lock(),
  *     PyThread_allocate_lock(),
  */
   __pyx_t_4[0] = PyThread_allocate_lock();
@@ -44972,37 +45425,37 @@
   __pyx_t_4[3] = PyThread_allocate_lock();
   __pyx_t_4[4] = PyThread_allocate_lock();
   __pyx_t_4[5] = PyThread_allocate_lock();
   __pyx_t_4[6] = PyThread_allocate_lock();
   __pyx_t_4[7] = PyThread_allocate_lock();
   memcpy(&(__pyx_memoryview_thread_locks[0]), __pyx_t_4, sizeof(__pyx_memoryview_thread_locks[0]) * (8));
 
-  /* "View.MemoryView":549
+  /* "View.MemoryView":551
  *         info.obj = self
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_memoryview_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 549, __pyx_L1_error)
+  __pyx_t_1 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 551, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem((PyObject *)__pyx_memoryview_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_1) < 0) __PYX_ERR(1, 549, __pyx_L1_error)
+  if (PyDict_SetItem((PyObject *)__pyx_memoryview_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_1) < 0) __PYX_ERR(1, 551, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_memoryview_type);
 
-  /* "View.MemoryView":995
+  /* "View.MemoryView":997
  *         return self.from_object
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_memoryview_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 995, __pyx_L1_error)
+  __pyx_t_1 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem((PyObject *)__pyx_memoryviewslice_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_1) < 0) __PYX_ERR(1, 995, __pyx_L1_error)
+  if (PyDict_SetItem((PyObject *)__pyx_memoryviewslice_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_1) < 0) __PYX_ERR(1, 997, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_memoryviewslice_type);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
@@ -45150,15 +45603,15 @@
         while (*name && (**name != key)) name++;
         if (*name) {
             values[name-argnames] = value;
             continue;
         }
         name = first_kw_arg;
         #if PY_MAJOR_VERSION < 3
-        if (likely(PyString_CheckExact(key)) || likely(PyString_Check(key))) {
+        if (likely(PyString_Check(key))) {
             while (*name) {
                 if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
                         && _PyString_Eq(**name, key)) {
                     values[name-argnames] = value;
                     break;
                 }
                 name++;
@@ -45177,15 +45630,15 @@
             }
         } else
         #endif
         if (likely(PyUnicode_Check(key))) {
             while (*name) {
                 int cmp = (**name == key) ? 0 :
                 #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
-                    (PyUnicode_GET_SIZE(**name) != PyUnicode_GET_SIZE(key)) ? 1 :
+                    (__Pyx_PyUnicode_GET_LENGTH(**name) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
                 #endif
                     PyUnicode_Compare(**name, key);
                 if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
                 if (cmp == 0) {
                     values[name-argnames] = value;
                     break;
                 }
@@ -45193,15 +45646,15 @@
             }
             if (*name) continue;
             else {
                 PyObject*** argname = argnames;
                 while (argname != first_kw_arg) {
                     int cmp = (**argname == key) ? 0 :
                     #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
-                        (PyUnicode_GET_SIZE(**argname) != PyUnicode_GET_SIZE(key)) ? 1 :
+                        (__Pyx_PyUnicode_GET_LENGTH(**argname) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
                     #endif
                         PyUnicode_Compare(**argname, key);
                     if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
                     if (cmp == 0) goto arg_passed_twice;
                     argname++;
                 }
             }
@@ -45451,15 +45904,15 @@
 #endif
 #endif
 
 /* PyObjectCall */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
     PyObject *result;
-    ternaryfunc call = func->ob_type->tp_call;
+    ternaryfunc call = Py_TYPE(func)->tp_call;
     if (unlikely(!call))
         return PyObject_Call(func, arg, kw);
     if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
         return NULL;
     result = (*call)(func, arg, kw);
     Py_LeaveRecursiveCall();
     if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
@@ -45538,15 +45991,15 @@
         return __Pyx_PyFunction_FastCall(func, &arg, 1);
     }
 #endif
     if (likely(PyCFunction_Check(func))) {
         if (likely(PyCFunction_GET_FLAGS(func) & METH_O)) {
             return __Pyx_PyObject_CallMethO(func, arg);
 #if CYTHON_FAST_PYCCALL
-        } else if (PyCFunction_GET_FLAGS(func) & METH_FASTCALL) {
+        } else if (__Pyx_PyFastCFunction_Check(func)) {
             return __Pyx_PyCFunction_FastCall(func, &arg, 1);
 #endif
         }
     }
     return __Pyx__PyObject_CallOneArg(func, arg);
 }
 #else
@@ -45717,28 +46170,28 @@
                             "BaseException");
             goto bad;
         }
         PyException_SetCause(value, fixed_cause);
     }
     PyErr_SetObject(type, value);
     if (tb) {
-#if CYTHON_COMPILING_IN_PYPY
-        PyObject *tmp_type, *tmp_value, *tmp_tb;
-        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
-        Py_INCREF(tb);
-        PyErr_Restore(tmp_type, tmp_value, tb);
-        Py_XDECREF(tmp_tb);
-#else
+#if CYTHON_FAST_THREAD_STATE
         PyThreadState *tstate = __Pyx_PyThreadState_Current;
         PyObject* tmp_tb = tstate->curexc_traceback;
         if (tb != tmp_tb) {
             Py_INCREF(tb);
             tstate->curexc_traceback = tb;
             Py_XDECREF(tmp_tb);
         }
+#else
+        PyObject *tmp_type, *tmp_value, *tmp_tb;
+        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
+        Py_INCREF(tb);
+        PyErr_Restore(tmp_type, tmp_value, tb);
+        Py_XDECREF(tmp_tb);
 #endif
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
@@ -45747,15 +46200,15 @@
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
 #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(func)) {
         return __Pyx_PyFunction_FastCall(func, NULL, 0);
     }
 #endif
-#ifdef __Pyx_CyFunction_USED
+#if defined(__Pyx_CyFunction_USED) && defined(NDEBUG)
     if (likely(PyCFunction_Check(func) || __Pyx_CyFunction_Check(func)))
 #else
     if (likely(PyCFunction_Check(func)))
 #endif
     {
         if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
             return __Pyx_PyObject_CallMethO(func, NULL);
@@ -45942,18 +46395,16 @@
 
 /* UnpackItemEndCheck */
 static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
     if (unlikely(retval)) {
         Py_DECREF(retval);
         __Pyx_RaiseTooManyValuesError(expected);
         return -1;
-    } else {
-        return __Pyx_IterFinish();
     }
-    return 0;
+    return __Pyx_IterFinish();
 }
 
 /* GetTopmostException */
 #if CYTHON_USE_EXC_INFO_STACK
 static _PyErr_StackItem *
 __Pyx_PyErr_GetTopmostException(PyThreadState *tstate)
 {
@@ -46204,15 +46655,15 @@
     if (likely(Py_SIZE(n) == -1)) {
         return PyLong_FromLong(((PyLongObject*)n)->ob_digit[0]);
     }
 #if CYTHON_COMPILING_IN_CPYTHON
     {
         PyObject *copy = _PyLong_Copy((PyLongObject*)n);
         if (likely(copy)) {
-            Py_SIZE(copy) = -(Py_SIZE(copy));
+            __Pyx_SET_SIZE(copy, -Py_SIZE(copy));
         }
         return copy;
     }
 #else
     return PyNumber_Negative(n);
 #endif
 }
@@ -46327,15 +46778,15 @@
                         __Pyx_memviewslice *memviewslice,
                         int memview_is_new_reference)
 {
     __Pyx_RefNannyDeclarations
     int i, retval=-1;
     Py_buffer *buf = &memview->view;
     __Pyx_RefNannySetupContext("init_memviewslice", 0);
-    if (memviewslice->memview || memviewslice->data) {
+    if (unlikely(memviewslice->memview || memviewslice->data)) {
         PyErr_SetString(PyExc_ValueError,
             "memviewslice is already initialized!");
         goto fail;
     }
     if (buf->strides) {
         for (i = 0; i < ndim; i++) {
             memviewslice->strides[i] = buf->strides[i];
@@ -46372,15 +46823,15 @@
 }
 #ifndef Py_NO_RETURN
 #define Py_NO_RETURN
 #endif
 static void __pyx_fatalerror(const char *fmt, ...) Py_NO_RETURN {
     va_list vargs;
     char msg[200];
-#ifdef HAVE_STDARG_PROTOTYPES
+#if PY_VERSION_HEX >= 0x030A0000 || defined(HAVE_STDARG_PROTOTYPES)
     va_start(vargs, fmt);
 #else
     va_start(vargs);
 #endif
     vsnprintf(msg, 200, fmt, vargs);
     va_end(vargs);
     Py_FatalError(msg);
@@ -46406,46 +46857,44 @@
     return result;
 }
 static CYTHON_INLINE void
 __Pyx_INC_MEMVIEW(__Pyx_memviewslice *memslice, int have_gil, int lineno)
 {
     int first_time;
     struct __pyx_memoryview_obj *memview = memslice->memview;
-    if (!memview || (PyObject *) memview == Py_None)
+    if (unlikely(!memview || (PyObject *) memview == Py_None))
         return;
-    if (__pyx_get_slice_count(memview) < 0)
+    if (unlikely(__pyx_get_slice_count(memview) < 0))
         __pyx_fatalerror("Acquisition count is %d (line %d)",
                          __pyx_get_slice_count(memview), lineno);
     first_time = __pyx_add_acquisition_count(memview) == 0;
-    if (first_time) {
+    if (unlikely(first_time)) {
         if (have_gil) {
             Py_INCREF((PyObject *) memview);
         } else {
             PyGILState_STATE _gilstate = PyGILState_Ensure();
             Py_INCREF((PyObject *) memview);
             PyGILState_Release(_gilstate);
         }
     }
 }
 static CYTHON_INLINE void __Pyx_XDEC_MEMVIEW(__Pyx_memviewslice *memslice,
                                              int have_gil, int lineno) {
     int last_time;
     struct __pyx_memoryview_obj *memview = memslice->memview;
-    if (!memview ) {
-        return;
-    } else if ((PyObject *) memview == Py_None) {
+    if (unlikely(!memview || (PyObject *) memview == Py_None)) {
         memslice->memview = NULL;
         return;
     }
-    if (__pyx_get_slice_count(memview) <= 0)
+    if (unlikely(__pyx_get_slice_count(memview) <= 0))
         __pyx_fatalerror("Acquisition count is %d (line %d)",
                          __pyx_get_slice_count(memview), lineno);
     last_time = __pyx_sub_acquisition_count(memview) == 1;
     memslice->data = NULL;
-    if (last_time) {
+    if (unlikely(last_time)) {
         if (have_gil) {
             Py_CLEAR(memslice->memview);
         } else {
             PyGILState_STATE _gilstate = PyGILState_Ensure();
             Py_CLEAR(memslice->memview);
             PyGILState_Release(_gilstate);
         }
@@ -46569,15 +47018,15 @@
 #endif
     return __Pyx_SetItemInt_Generic(o, PyInt_FromSsize_t(i), v);
 }
 
 /* ObjectGetItem */
   #if CYTHON_USE_TYPE_SLOTS
 static PyObject *__Pyx_PyObject_GetIndex(PyObject *obj, PyObject* index) {
-    PyObject *runerr;
+    PyObject *runerr = NULL;
     Py_ssize_t key_value;
     PySequenceMethods *m = Py_TYPE(obj)->tp_as_sequence;
     if (unlikely(!(m && m->sq_item))) {
         PyErr_Format(PyExc_TypeError, "'%.200s' object is not subscriptable", Py_TYPE(obj)->tp_name);
         return NULL;
     }
     key_value = __Pyx_PyIndex_AsSsize_t(index);
@@ -47048,15 +47497,15 @@
         ps2 = PyBytes_AS_STRING(s2);
         if (ps1[0] != ps2[0]) {
             return (equals == Py_NE);
         } else if (length == 1) {
             return (equals == Py_EQ);
         } else {
             int result;
-#if CYTHON_USE_UNICODE_INTERNALS
+#if CYTHON_USE_UNICODE_INTERNALS && (PY_VERSION_HEX < 0x030B0000)
             Py_hash_t hash1, hash2;
             hash1 = ((PyBytesObject*)s1)->ob_shash;
             hash2 = ((PyBytesObject*)s2)->ob_shash;
             if (hash1 != hash2 && hash1 != -1 && hash2 != -1) {
                 return (equals == Py_NE);
             }
 #endif
@@ -47177,15 +47626,15 @@
     #if PY_MAJOR_VERSION < 3
     Py_XDECREF(owned_ref);
     #endif
     return (equals == Py_NE);
 #endif
 }
 
-/* None */
+/* DivInt[Py_ssize_t] */
   static CYTHON_INLINE Py_ssize_t __Pyx_div_Py_ssize_t(Py_ssize_t a, Py_ssize_t b) {
     Py_ssize_t q = a / b;
     Py_ssize_t r = a - q*b;
     q -= ((r != 0) & ((r ^ b) < 0));
     return q;
 }
 
@@ -47220,17 +47669,17 @@
             start += length;
             if (start < 0)
                 start = 0;
         }
         if (stop < 0)
             stop += length;
     }
+    if (unlikely(stop <= start))
+        return __Pyx_NewRef(__pyx_empty_unicode);
     length = stop - start;
-    if (unlikely(length <= 0))
-        return PyUnicode_FromUnicode(NULL, 0);
     cstring += start;
     if (decode_func) {
         return decode_func(cstring, length, errors);
     } else {
         return PyUnicode_Decode(cstring, length, encoding, errors);
     }
 }
@@ -47354,15 +47803,15 @@
         goto bad;
     empty_dict = PyDict_New();
     if (!empty_dict)
         goto bad;
     {
         #if PY_MAJOR_VERSION >= 3
         if (level == -1) {
-            if (strchr(__Pyx_MODULE_NAME, '.')) {
+            if ((1) && (strchr(__Pyx_MODULE_NAME, '.'))) {
                 module = PyImport_ImportModuleLevelObject(
                     name, global_dict, empty_dict, list, 1);
                 if (!module) {
                     if (!PyErr_ExceptionMatches(PyExc_ImportError))
                         goto bad;
                     PyErr_Clear();
                 }
@@ -47489,15 +47938,15 @@
     if (likely(PyExceptionClass_Check(err))) {
         return __Pyx_inner_PyErr_GivenExceptionMatches2(err, exc_type1, exc_type2);
     }
     return (PyErr_GivenExceptionMatches(err, exc_type1) || PyErr_GivenExceptionMatches(err, exc_type2));
 }
 #endif
 
-/* None */
+/* DivInt[long] */
   static CYTHON_INLINE long __Pyx_div_long(long a, long b) {
     long q = a / b;
     long r = a - q*b;
     q -= ((r != 0) & ((r ^ b) < 0));
     return q;
 }
 
@@ -47597,14 +48046,36 @@
     Py_DECREF(ob);
     return 0;
 bad:
     Py_XDECREF(ob);
     return -1;
 }
 
+/* PyObjectGetAttrStrNoError */
+  static void __Pyx_PyObject_GetAttrStr_ClearAttributeError(void) {
+    __Pyx_PyThreadState_declare
+    __Pyx_PyThreadState_assign
+    if (likely(__Pyx_PyErr_ExceptionMatches(PyExc_AttributeError)))
+        __Pyx_PyErr_Clear();
+}
+static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStrNoError(PyObject* obj, PyObject* attr_name) {
+    PyObject *result;
+#if CYTHON_COMPILING_IN_CPYTHON && CYTHON_USE_TYPE_SLOTS && PY_VERSION_HEX >= 0x030700B1
+    PyTypeObject* tp = Py_TYPE(obj);
+    if (likely(tp->tp_getattro == PyObject_GenericGetAttr)) {
+        return _PyObject_GenericGetAttrWithDict(obj, attr_name, NULL, 1);
+    }
+#endif
+    result = __Pyx_PyObject_GetAttrStr(obj, attr_name);
+    if (unlikely(!result)) {
+        __Pyx_PyObject_GetAttrStr_ClearAttributeError();
+    }
+    return result;
+}
+
 /* SetupReduce */
   static int __Pyx_setup_reduce_is_named(PyObject* meth, PyObject* name) {
   int ret;
   PyObject *name_attr;
   name_attr = __Pyx_PyObject_GetAttrStr(meth, __pyx_n_s_name_2);
   if (likely(name_attr)) {
       ret = PyObject_RichCompareBool(name_attr, name, Py_EQ);
@@ -47617,61 +48088,89 @@
   }
   Py_XDECREF(name_attr);
   return ret;
 }
 static int __Pyx_setup_reduce(PyObject* type_obj) {
     int ret = 0;
     PyObject *object_reduce = NULL;
+    PyObject *object_getstate = NULL;
     PyObject *object_reduce_ex = NULL;
     PyObject *reduce = NULL;
     PyObject *reduce_ex = NULL;
     PyObject *reduce_cython = NULL;
     PyObject *setstate = NULL;
     PyObject *setstate_cython = NULL;
+    PyObject *getstate = NULL;
 #if CYTHON_USE_PYTYPE_LOOKUP
-    if (_PyType_Lookup((PyTypeObject*)type_obj, __pyx_n_s_getstate)) goto GOOD;
+    getstate = _PyType_Lookup((PyTypeObject*)type_obj, __pyx_n_s_getstate);
 #else
-    if (PyObject_HasAttr(type_obj, __pyx_n_s_getstate)) goto GOOD;
+    getstate = __Pyx_PyObject_GetAttrStrNoError(type_obj, __pyx_n_s_getstate);
+    if (!getstate && PyErr_Occurred()) {
+        goto __PYX_BAD;
+    }
 #endif
+    if (getstate) {
 #if CYTHON_USE_PYTYPE_LOOKUP
-    object_reduce_ex = _PyType_Lookup(&PyBaseObject_Type, __pyx_n_s_reduce_ex); if (!object_reduce_ex) goto BAD;
+        object_getstate = _PyType_Lookup(&PyBaseObject_Type, __pyx_n_s_getstate);
 #else
-    object_reduce_ex = __Pyx_PyObject_GetAttrStr((PyObject*)&PyBaseObject_Type, __pyx_n_s_reduce_ex); if (!object_reduce_ex) goto BAD;
+        object_getstate = __Pyx_PyObject_GetAttrStrNoError((PyObject*)&PyBaseObject_Type, __pyx_n_s_getstate);
+        if (!object_getstate && PyErr_Occurred()) {
+            goto __PYX_BAD;
+        }
 #endif
-    reduce_ex = __Pyx_PyObject_GetAttrStr(type_obj, __pyx_n_s_reduce_ex); if (unlikely(!reduce_ex)) goto BAD;
+        if (object_getstate != getstate) {
+            goto __PYX_GOOD;
+        }
+    }
+#if CYTHON_USE_PYTYPE_LOOKUP
+    object_reduce_ex = _PyType_Lookup(&PyBaseObject_Type, __pyx_n_s_reduce_ex); if (!object_reduce_ex) goto __PYX_BAD;
+#else
+    object_reduce_ex = __Pyx_PyObject_GetAttrStr((PyObject*)&PyBaseObject_Type, __pyx_n_s_reduce_ex); if (!object_reduce_ex) goto __PYX_BAD;
+#endif
+    reduce_ex = __Pyx_PyObject_GetAttrStr(type_obj, __pyx_n_s_reduce_ex); if (unlikely(!reduce_ex)) goto __PYX_BAD;
     if (reduce_ex == object_reduce_ex) {
 #if CYTHON_USE_PYTYPE_LOOKUP
-        object_reduce = _PyType_Lookup(&PyBaseObject_Type, __pyx_n_s_reduce); if (!object_reduce) goto BAD;
+        object_reduce = _PyType_Lookup(&PyBaseObject_Type, __pyx_n_s_reduce); if (!object_reduce) goto __PYX_BAD;
 #else
-        object_reduce = __Pyx_PyObject_GetAttrStr((PyObject*)&PyBaseObject_Type, __pyx_n_s_reduce); if (!object_reduce) goto BAD;
+        object_reduce = __Pyx_PyObject_GetAttrStr((PyObject*)&PyBaseObject_Type, __pyx_n_s_reduce); if (!object_reduce) goto __PYX_BAD;
 #endif
-        reduce = __Pyx_PyObject_GetAttrStr(type_obj, __pyx_n_s_reduce); if (unlikely(!reduce)) goto BAD;
+        reduce = __Pyx_PyObject_GetAttrStr(type_obj, __pyx_n_s_reduce); if (unlikely(!reduce)) goto __PYX_BAD;
         if (reduce == object_reduce || __Pyx_setup_reduce_is_named(reduce, __pyx_n_s_reduce_cython)) {
-            reduce_cython = __Pyx_PyObject_GetAttrStr(type_obj, __pyx_n_s_reduce_cython); if (unlikely(!reduce_cython)) goto BAD;
-            ret = PyDict_SetItem(((PyTypeObject*)type_obj)->tp_dict, __pyx_n_s_reduce, reduce_cython); if (unlikely(ret < 0)) goto BAD;
-            ret = PyDict_DelItem(((PyTypeObject*)type_obj)->tp_dict, __pyx_n_s_reduce_cython); if (unlikely(ret < 0)) goto BAD;
+            reduce_cython = __Pyx_PyObject_GetAttrStrNoError(type_obj, __pyx_n_s_reduce_cython);
+            if (likely(reduce_cython)) {
+                ret = PyDict_SetItem(((PyTypeObject*)type_obj)->tp_dict, __pyx_n_s_reduce, reduce_cython); if (unlikely(ret < 0)) goto __PYX_BAD;
+                ret = PyDict_DelItem(((PyTypeObject*)type_obj)->tp_dict, __pyx_n_s_reduce_cython); if (unlikely(ret < 0)) goto __PYX_BAD;
+            } else if (reduce == object_reduce || PyErr_Occurred()) {
+                goto __PYX_BAD;
+            }
             setstate = __Pyx_PyObject_GetAttrStr(type_obj, __pyx_n_s_setstate);
             if (!setstate) PyErr_Clear();
             if (!setstate || __Pyx_setup_reduce_is_named(setstate, __pyx_n_s_setstate_cython)) {
-                setstate_cython = __Pyx_PyObject_GetAttrStr(type_obj, __pyx_n_s_setstate_cython); if (unlikely(!setstate_cython)) goto BAD;
-                ret = PyDict_SetItem(((PyTypeObject*)type_obj)->tp_dict, __pyx_n_s_setstate, setstate_cython); if (unlikely(ret < 0)) goto BAD;
-                ret = PyDict_DelItem(((PyTypeObject*)type_obj)->tp_dict, __pyx_n_s_setstate_cython); if (unlikely(ret < 0)) goto BAD;
+                setstate_cython = __Pyx_PyObject_GetAttrStrNoError(type_obj, __pyx_n_s_setstate_cython);
+                if (likely(setstate_cython)) {
+                    ret = PyDict_SetItem(((PyTypeObject*)type_obj)->tp_dict, __pyx_n_s_setstate, setstate_cython); if (unlikely(ret < 0)) goto __PYX_BAD;
+                    ret = PyDict_DelItem(((PyTypeObject*)type_obj)->tp_dict, __pyx_n_s_setstate_cython); if (unlikely(ret < 0)) goto __PYX_BAD;
+                } else if (!setstate || PyErr_Occurred()) {
+                    goto __PYX_BAD;
+                }
             }
             PyType_Modified((PyTypeObject*)type_obj);
         }
     }
-    goto GOOD;
-BAD:
+    goto __PYX_GOOD;
+__PYX_BAD:
     if (!PyErr_Occurred())
         PyErr_Format(PyExc_RuntimeError, "Unable to initialize pickling for %s", ((PyTypeObject*)type_obj)->tp_name);
     ret = -1;
-GOOD:
+__PYX_GOOD:
 #if !CYTHON_USE_PYTYPE_LOOKUP
     Py_XDECREF(object_reduce);
     Py_XDECREF(object_reduce_ex);
+    Py_XDECREF(object_getstate);
+    Py_XDECREF(getstate);
 #endif
     Py_XDECREF(reduce);
     Py_XDECREF(reduce_ex);
     Py_XDECREF(reduce_cython);
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
@@ -47751,15 +48250,15 @@
     return cached_type;
 bad:
     Py_XDECREF(cached_type);
     cached_type = NULL;
     goto done;
 }
 
-/* CythonFunction */
+/* CythonFunctionShared */
   #include <structmember.h>
 static PyObject *
 __Pyx_CyFunction_get_doc(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *closure)
 {
     if (unlikely(op->func_doc == NULL)) {
         if (op->func.m_ml->ml_doc) {
 #if PY_MAJOR_VERSION >= 3
@@ -48044,32 +48543,32 @@
     {(char *) "__module__", T_OBJECT, offsetof(PyCFunctionObject, m_module), PY_WRITE_RESTRICTED, 0},
     {0, 0, 0,  0, 0}
 };
 static PyObject *
 __Pyx_CyFunction_reduce(__pyx_CyFunctionObject *m, CYTHON_UNUSED PyObject *args)
 {
 #if PY_MAJOR_VERSION >= 3
-    return PyUnicode_FromString(m->func.m_ml->ml_name);
+    Py_INCREF(m->func_qualname);
+    return m->func_qualname;
 #else
     return PyString_FromString(m->func.m_ml->ml_name);
 #endif
 }
 static PyMethodDef __pyx_CyFunction_methods[] = {
     {"__reduce__", (PyCFunction)__Pyx_CyFunction_reduce, METH_VARARGS, 0},
     {0, 0, 0, 0}
 };
 #if PY_VERSION_HEX < 0x030500A0
 #define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func_weakreflist)
 #else
 #define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func.m_weakreflist)
 #endif
-static PyObject *__Pyx_CyFunction_New(PyTypeObject *type, PyMethodDef *ml, int flags, PyObject* qualname,
-                                      PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
-    __pyx_CyFunctionObject *op = PyObject_GC_New(__pyx_CyFunctionObject, type);
-    if (op == NULL)
+static PyObject *__Pyx_CyFunction_Init(__pyx_CyFunctionObject *op, PyMethodDef *ml, int flags, PyObject* qualname,
+                                       PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
+    if (unlikely(op == NULL))
         return NULL;
     op->flags = flags;
     __Pyx_CyFunction_weakreflist(op) = NULL;
     op->func.m_ml = ml;
     op->func.m_self = (PyObject *) op;
     Py_XINCREF(closure);
     op->func_closure = closure;
@@ -48082,20 +48581,20 @@
     op->func_doc = NULL;
     op->func_classobj = NULL;
     op->func_globals = globals;
     Py_INCREF(op->func_globals);
     Py_XINCREF(code);
     op->func_code = code;
     op->defaults_pyobjects = 0;
+    op->defaults_size = 0;
     op->defaults = NULL;
     op->defaults_tuple = NULL;
     op->defaults_kwdict = NULL;
     op->defaults_getter = NULL;
     op->func_annotations = NULL;
-    PyObject_GC_Track(op);
     return (PyObject *) op;
 }
 static int
 __Pyx_CyFunction_clear(__pyx_CyFunctionObject *m)
 {
     Py_CLEAR(m->func_closure);
     Py_CLEAR(m->func.m_module);
@@ -48150,26 +48649,28 @@
         for (i = 0; i < m->defaults_pyobjects; i++)
             Py_VISIT(pydefaults[i]);
     }
     return 0;
 }
 static PyObject *__Pyx_CyFunction_descr_get(PyObject *func, PyObject *obj, PyObject *type)
 {
+#if PY_MAJOR_VERSION < 3
     __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
     if (m->flags & __Pyx_CYFUNCTION_STATICMETHOD) {
         Py_INCREF(func);
         return func;
     }
     if (m->flags & __Pyx_CYFUNCTION_CLASSMETHOD) {
         if (type == NULL)
             type = (PyObject *)(Py_TYPE(obj));
         return __Pyx_PyMethod_New(func, type, (PyObject *)(Py_TYPE(type)));
     }
     if (obj == Py_None)
         obj = NULL;
+#endif
     return __Pyx_PyMethod_New(func, obj, type);
 }
 static PyObject*
 __Pyx_CyFunction_repr(__pyx_CyFunctionObject *op)
 {
 #if PY_MAJOR_VERSION >= 3
     return PyUnicode_FromFormat("<cyfunction %U at %p>",
@@ -48246,14 +48747,22 @@
         argc = PyTuple_GET_SIZE(args);
         new_args = PyTuple_GetSlice(args, 1, argc);
         if (unlikely(!new_args))
             return NULL;
         self = PyTuple_GetItem(args, 0);
         if (unlikely(!self)) {
             Py_DECREF(new_args);
+#if PY_MAJOR_VERSION > 2
+            PyErr_Format(PyExc_TypeError,
+                         "unbound method %.200S() needs an argument",
+                         cyfunc->func_qualname);
+#else
+            PyErr_SetString(PyExc_TypeError,
+                            "unbound method needs an argument");
+#endif
             return NULL;
         }
         result = __Pyx_CyFunction_CallMethod(func, self, new_args, kw);
         Py_DECREF(new_args);
     } else {
         result = __Pyx_CyFunction_Call(func, args, kw);
     }
@@ -48314,20 +48823,26 @@
     0,
     0,
     0,
     0,
 #if PY_VERSION_HEX >= 0x030400a1
     0,
 #endif
-#if PY_VERSION_HEX >= 0x030800b1
+#if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
     0,
 #endif
 #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
     0,
 #endif
+#if PY_VERSION_HEX >= 0x030C0000
+    0,
+#endif
+#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
+    0,
+#endif
 };
 static int __pyx_CyFunction_init(void) {
     __pyx_CyFunctionType = __Pyx_FetchCommonType(&__pyx_CyFunctionType_type);
     if (unlikely(__pyx_CyFunctionType == NULL)) {
         return -1;
     }
     return 0;
@@ -48335,14 +48850,15 @@
 static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *func, size_t size, int pyobjects) {
     __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
     m->defaults = PyObject_Malloc(size);
     if (unlikely(!m->defaults))
         return PyErr_NoMemory();
     memset(m->defaults, 0, size);
     m->defaults_pyobjects = pyobjects;
+    m->defaults_size = size;
     return m->defaults;
 }
 static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *func, PyObject *tuple) {
     __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
     m->defaults_tuple = tuple;
     Py_INCREF(tuple);
 }
@@ -48353,14 +48869,27 @@
 }
 static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *func, PyObject *dict) {
     __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
     m->func_annotations = dict;
     Py_INCREF(dict);
 }
 
+/* CythonFunction */
+  static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml, int flags, PyObject* qualname,
+                                      PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
+    PyObject *op = __Pyx_CyFunction_Init(
+        PyObject_GC_New(__pyx_CyFunctionObject, __pyx_CyFunctionType),
+        ml, flags, qualname, closure, module, globals, code
+    );
+    if (likely(op)) {
+        PyObject_GC_Track(op);
+    }
+    return op;
+}
+
 /* Py3ClassCreate */
   static PyObject *__Pyx_Py3MetaclassPrepare(PyObject *metaclass, PyObject *bases, PyObject *name,
                                            PyObject *qualname, PyObject *mkw, PyObject *modname, PyObject *doc) {
     PyObject *ns;
     if (metaclass) {
         PyObject *prep = __Pyx_PyObject_GetAttrStr(metaclass, __pyx_n_s_prepare);
         if (prep) {
@@ -48422,15 +48951,15 @@
     }
     Py_XDECREF(owned_metaclass);
     return result;
 }
 
 /* CLineInTraceback */
   #ifndef CYTHON_CLINE_IN_TRACEBACK
-static int __Pyx_CLineForTraceback(PyThreadState *tstate, int c_line) {
+static int __Pyx_CLineForTraceback(CYTHON_UNUSED PyThreadState *tstate, int c_line) {
     PyObject *use_cline;
     PyObject *ptype, *pvalue, *ptraceback;
 #if CYTHON_COMPILING_IN_CPYTHON
     PyObject **cython_runtime_dict;
 #endif
     if (unlikely(!__pyx_cython_runtime)) {
         return c_line;
@@ -48452,15 +48981,15 @@
       } else {
         PyErr_Clear();
         use_cline = NULL;
       }
     }
     if (!use_cline) {
         c_line = 0;
-        PyObject_SetAttr(__pyx_cython_runtime, __pyx_n_s_cline_in_traceback, Py_False);
+        (void) PyObject_SetAttr(__pyx_cython_runtime, __pyx_n_s_cline_in_traceback, Py_False);
     }
     else if (use_cline == Py_False || (use_cline != Py_True && PyObject_Not(use_cline) != 0)) {
         c_line = 0;
     }
     __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
     return c_line;
 }
@@ -48526,15 +49055,15 @@
         entries[pos].code_object = code_object;
         Py_DECREF(tmp);
         return;
     }
     if (__pyx_code_cache.count == __pyx_code_cache.max_count) {
         int new_max = __pyx_code_cache.max_count + 64;
         entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Realloc(
-            __pyx_code_cache.entries, (size_t)new_max*sizeof(__Pyx_CodeObjectCacheEntry));
+            __pyx_code_cache.entries, ((size_t)new_max) * sizeof(__Pyx_CodeObjectCacheEntry));
         if (unlikely(!entries)) {
             return;
         }
         __pyx_code_cache.entries = entries;
         __pyx_code_cache.max_count = new_max;
     }
     for (i=__pyx_code_cache.count; i>pos; i--) {
@@ -48546,41 +49075,48 @@
     Py_INCREF(code_object);
 }
 
 /* AddTraceback */
   #include "compile.h"
 #include "frameobject.h"
 #include "traceback.h"
+#if PY_VERSION_HEX >= 0x030b00a6
+  #ifndef Py_BUILD_CORE
+    #define Py_BUILD_CORE 1
+  #endif
+  #include "internal/pycore_frame.h"
+#endif
 static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
             const char *funcname, int c_line,
             int py_line, const char *filename) {
-    PyCodeObject *py_code = 0;
-    PyObject *py_srcfile = 0;
-    PyObject *py_funcname = 0;
+    PyCodeObject *py_code = NULL;
+    PyObject *py_funcname = NULL;
     #if PY_MAJOR_VERSION < 3
+    PyObject *py_srcfile = NULL;
     py_srcfile = PyString_FromString(filename);
-    #else
-    py_srcfile = PyUnicode_FromString(filename);
-    #endif
     if (!py_srcfile) goto bad;
+    #endif
     if (c_line) {
         #if PY_MAJOR_VERSION < 3
         py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
+        if (!py_funcname) goto bad;
         #else
         py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
+        if (!py_funcname) goto bad;
+        funcname = PyUnicode_AsUTF8(py_funcname);
+        if (!funcname) goto bad;
         #endif
     }
     else {
         #if PY_MAJOR_VERSION < 3
         py_funcname = PyString_FromString(funcname);
-        #else
-        py_funcname = PyUnicode_FromString(funcname);
+        if (!py_funcname) goto bad;
         #endif
     }
-    if (!py_funcname) goto bad;
+    #if PY_MAJOR_VERSION < 3
     py_code = __Pyx_PyCode_New(
         0,
         0,
         0,
         0,
         0,
         __pyx_empty_bytes, /*PyObject *code,*/
@@ -48591,34 +49127,49 @@
         __pyx_empty_tuple, /*PyObject *cellvars,*/
         py_srcfile,   /*PyObject *filename,*/
         py_funcname,  /*PyObject *name,*/
         py_line,
         __pyx_empty_bytes  /*PyObject *lnotab*/
     );
     Py_DECREF(py_srcfile);
-    Py_DECREF(py_funcname);
+    #else
+    py_code = PyCode_NewEmpty(filename, funcname, py_line);
+    #endif
+    Py_XDECREF(py_funcname);  // XDECREF since it's only set on Py3 if cline
     return py_code;
 bad:
-    Py_XDECREF(py_srcfile);
     Py_XDECREF(py_funcname);
+    #if PY_MAJOR_VERSION < 3
+    Py_XDECREF(py_srcfile);
+    #endif
     return NULL;
 }
 static void __Pyx_AddTraceback(const char *funcname, int c_line,
                                int py_line, const char *filename) {
     PyCodeObject *py_code = 0;
     PyFrameObject *py_frame = 0;
     PyThreadState *tstate = __Pyx_PyThreadState_Current;
+    PyObject *ptype, *pvalue, *ptraceback;
     if (c_line) {
         c_line = __Pyx_CLineForTraceback(tstate, c_line);
     }
     py_code = __pyx_find_code_object(c_line ? -c_line : py_line);
     if (!py_code) {
+        __Pyx_ErrFetchInState(tstate, &ptype, &pvalue, &ptraceback);
         py_code = __Pyx_CreateCodeObjectForTraceback(
             funcname, c_line, py_line, filename);
-        if (!py_code) goto bad;
+        if (!py_code) {
+            /* If the code object creation fails, then we should clear the
+               fetched exception references and propagate the new exception */
+            Py_XDECREF(ptype);
+            Py_XDECREF(pvalue);
+            Py_XDECREF(ptraceback);
+            goto bad;
+        }
+        __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
         __pyx_insert_code_object(c_line ? -c_line : py_line, py_code);
     }
     py_frame = PyFrame_New(
         tstate,            /*PyThreadState *tstate,*/
         py_code,           /*PyCodeObject *code,*/
         __pyx_d,    /*PyObject *globals,*/
         0                  /*PyObject *locals*/
@@ -49058,24 +49609,23 @@
   ctx->is_complex = 0;
   return 0;
 }
 static PyObject *
 __pyx_buffmt_parse_array(__Pyx_BufFmt_Context* ctx, const char** tsp)
 {
     const char *ts = *tsp;
-    int i = 0, number;
-    int ndim = ctx->head->field->type->ndim;
-;
+    int i = 0, number, ndim;
     ++ts;
     if (ctx->new_count != 1) {
         PyErr_SetString(PyExc_ValueError,
                         "Cannot handle repeated arrays in format string");
         return NULL;
     }
     if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
+    ndim = ctx->head->field->type->ndim;
     while (*ts && *ts != ')') {
         switch (*ts) {
             case ' ': case '\f': case '\r': case '\n': case '\t': case '\v':  continue;
             default:  break;
         }
         number = __Pyx_BufFmt_ExpectNumber(&ts);
         if (number == -1) return NULL;
@@ -49197,16 +49747,16 @@
           return NULL;
         }
         CYTHON_FALLTHROUGH;
       case '?': case 'c': case 'b': case 'B': case 'h': case 'H': case 'i': case 'I':
       case 'l': case 'L': case 'q': case 'Q':
       case 'f': case 'd': case 'g':
       case 'O': case 'p':
-        if (ctx->enc_type == *ts && got_Z == ctx->is_complex &&
-            ctx->enc_packmode == ctx->new_packmode) {
+        if ((ctx->enc_type == *ts) && (got_Z == ctx->is_complex) &&
+            (ctx->enc_packmode == ctx->new_packmode) && (!ctx->is_valid_array)) {
           ctx->enc_count += ctx->new_count;
           ctx->new_count = 1;
           got_Z = 0;
           ++ts;
           break;
         }
         CYTHON_FALLTHROUGH;
@@ -49284,72 +49834,72 @@
 __pyx_check_strides(Py_buffer *buf, int dim, int ndim, int spec)
 {
     if (buf->shape[dim] <= 1)
         return 1;
     if (buf->strides) {
         if (spec & __Pyx_MEMVIEW_CONTIG) {
             if (spec & (__Pyx_MEMVIEW_PTR|__Pyx_MEMVIEW_FULL)) {
-                if (buf->strides[dim] != sizeof(void *)) {
+                if (unlikely(buf->strides[dim] != sizeof(void *))) {
                     PyErr_Format(PyExc_ValueError,
                                  "Buffer is not indirectly contiguous "
                                  "in dimension %d.", dim);
                     goto fail;
                 }
-            } else if (buf->strides[dim] != buf->itemsize) {
+            } else if (unlikely(buf->strides[dim] != buf->itemsize)) {
                 PyErr_SetString(PyExc_ValueError,
                                 "Buffer and memoryview are not contiguous "
                                 "in the same dimension.");
                 goto fail;
             }
         }
         if (spec & __Pyx_MEMVIEW_FOLLOW) {
             Py_ssize_t stride = buf->strides[dim];
             if (stride < 0)
                 stride = -stride;
-            if (stride < buf->itemsize) {
+            if (unlikely(stride < buf->itemsize)) {
                 PyErr_SetString(PyExc_ValueError,
                                 "Buffer and memoryview are not contiguous "
                                 "in the same dimension.");
                 goto fail;
             }
         }
     } else {
-        if (spec & __Pyx_MEMVIEW_CONTIG && dim != ndim - 1) {
+        if (unlikely(spec & __Pyx_MEMVIEW_CONTIG && dim != ndim - 1)) {
             PyErr_Format(PyExc_ValueError,
                          "C-contiguous buffer is not contiguous in "
                          "dimension %d", dim);
             goto fail;
-        } else if (spec & (__Pyx_MEMVIEW_PTR)) {
+        } else if (unlikely(spec & (__Pyx_MEMVIEW_PTR))) {
             PyErr_Format(PyExc_ValueError,
                          "C-contiguous buffer is not indirect in "
                          "dimension %d", dim);
             goto fail;
-        } else if (buf->suboffsets) {
+        } else if (unlikely(buf->suboffsets)) {
             PyErr_SetString(PyExc_ValueError,
                             "Buffer exposes suboffsets but no strides");
             goto fail;
         }
     }
     return 1;
 fail:
     return 0;
 }
 static int
 __pyx_check_suboffsets(Py_buffer *buf, int dim, CYTHON_UNUSED int ndim, int spec)
 {
     if (spec & __Pyx_MEMVIEW_DIRECT) {
-        if (buf->suboffsets && buf->suboffsets[dim] >= 0) {
+        if (unlikely(buf->suboffsets && buf->suboffsets[dim] >= 0)) {
             PyErr_Format(PyExc_ValueError,
                          "Buffer not compatible with direct access "
                          "in dimension %d.", dim);
             goto fail;
         }
     }
     if (spec & __Pyx_MEMVIEW_PTR) {
-        if (!buf->suboffsets || (buf->suboffsets[dim] < 0)) {
+        if (unlikely(!buf->suboffsets || (buf->suboffsets[dim] < 0))) {
             PyErr_Format(PyExc_ValueError,
                          "Buffer is not indirectly accessible "
                          "in dimension %d.", dim);
             goto fail;
         }
     }
     return 1;
@@ -49359,28 +49909,25 @@
 static int
 __pyx_verify_contig(Py_buffer *buf, int ndim, int c_or_f_flag)
 {
     int i;
     if (c_or_f_flag & __Pyx_IS_F_CONTIG) {
         Py_ssize_t stride = 1;
         for (i = 0; i < ndim; i++) {
-            if (stride * buf->itemsize != buf->strides[i] &&
-                    buf->shape[i] > 1)
-            {
+            if (unlikely(stride * buf->itemsize != buf->strides[i]  &&  buf->shape[i] > 1)) {
                 PyErr_SetString(PyExc_ValueError,
                     "Buffer not fortran contiguous.");
                 goto fail;
             }
             stride = stride * buf->shape[i];
         }
     } else if (c_or_f_flag & __Pyx_IS_C_CONTIG) {
         Py_ssize_t stride = 1;
         for (i = ndim - 1; i >- 1; i--) {
-            if (stride * buf->itemsize != buf->strides[i] &&
-                    buf->shape[i] > 1) {
+            if (unlikely(stride * buf->itemsize != buf->strides[i]  &&  buf->shape[i] > 1)) {
                 PyErr_SetString(PyExc_ValueError,
                     "Buffer not C contiguous.");
                 goto fail;
             }
             stride = stride * buf->shape[i];
         }
     }
@@ -49413,44 +49960,46 @@
         memview = (struct __pyx_memoryview_obj *) __pyx_memoryview_new(
                                             original_obj, buf_flags, 0, dtype);
         new_memview = memview;
         if (unlikely(!memview))
             goto fail;
     }
     buf = &memview->view;
-    if (buf->ndim != ndim) {
+    if (unlikely(buf->ndim != ndim)) {
         PyErr_Format(PyExc_ValueError,
                 "Buffer has wrong number of dimensions (expected %d, got %d)",
                 ndim, buf->ndim);
         goto fail;
     }
     if (new_memview) {
         __Pyx_BufFmt_Init(&ctx, stack, dtype);
-        if (!__Pyx_BufFmt_CheckString(&ctx, buf->format)) goto fail;
+        if (unlikely(!__Pyx_BufFmt_CheckString(&ctx, buf->format))) goto fail;
     }
-    if ((unsigned) buf->itemsize != dtype->size) {
+    if (unlikely((unsigned) buf->itemsize != dtype->size)) {
         PyErr_Format(PyExc_ValueError,
                      "Item size of buffer (%" CYTHON_FORMAT_SSIZE_T "u byte%s) "
                      "does not match size of '%s' (%" CYTHON_FORMAT_SSIZE_T "u byte%s)",
                      buf->itemsize,
                      (buf->itemsize > 1) ? "s" : "",
                      dtype->name,
                      dtype->size,
                      (dtype->size > 1) ? "s" : "");
         goto fail;
     }
-    for (i = 0; i < ndim; i++) {
-        spec = axes_specs[i];
-        if (!__pyx_check_strides(buf, i, ndim, spec))
-            goto fail;
-        if (!__pyx_check_suboffsets(buf, i, ndim, spec))
+    if (buf->len > 0) {
+        for (i = 0; i < ndim; i++) {
+            spec = axes_specs[i];
+            if (unlikely(!__pyx_check_strides(buf, i, ndim, spec)))
+                goto fail;
+            if (unlikely(!__pyx_check_suboffsets(buf, i, ndim, spec)))
+                goto fail;
+        }
+        if (unlikely(buf->strides && !__pyx_verify_contig(buf, ndim, c_or_f_flag)))
             goto fail;
     }
-    if (buf->strides && !__pyx_verify_contig(buf, ndim, c_or_f_flag))
-        goto fail;
     if (unlikely(__Pyx_init_memviewslice(memview, ndim, memviewslice,
                                          new_memview != NULL) == -1)) {
         goto fail;
     }
     retval = 0;
     goto no_fail;
 fail:
@@ -49503,57 +50052,49 @@
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
-/* CIntToPy */
-    static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
-    const long neg_one = (long) ((long) 0 - (long) 1), const_zero = (long) 0;
-    const int is_unsigned = neg_one > const_zero;
-    if (is_unsigned) {
-        if (sizeof(long) < sizeof(long)) {
-            return PyInt_FromLong((long) value);
-        } else if (sizeof(long) <= sizeof(unsigned long)) {
-            return PyLong_FromUnsignedLong((unsigned long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
-            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
-#endif
-        }
-    } else {
-        if (sizeof(long) <= sizeof(long)) {
-            return PyInt_FromLong((long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
-            return PyLong_FromLongLong((PY_LONG_LONG) value);
-#endif
-        }
-    }
-    {
-        int one = 1; int little = (int)*(unsigned char *)&one;
-        unsigned char *bytes = (unsigned char *)&value;
-        return _PyLong_FromByteArray(bytes, sizeof(long),
-                                     little, !is_unsigned);
-    }
-}
-
 /* MemviewDtypeToObject */
     static CYTHON_INLINE PyObject *__pyx_memview_get_double(const char *itemp) {
     return (PyObject *) PyFloat_FromDouble(*(double *) itemp);
 }
 static CYTHON_INLINE int __pyx_memview_set_double(const char *itemp, PyObject *obj) {
     double value = __pyx_PyFloat_AsDouble(obj);
     if ((value == (double)-1) && PyErr_Occurred())
         return 0;
     *(double *) itemp = value;
     return 1;
 }
 
+/* ObjectToMemviewSlice */
+    static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_int(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
+    }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 2,
+                                                 &__Pyx_TypeInfo_int, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
+
 /* CIntFromPyVerify */
     #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
     __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
 #define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
     __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
 #define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
     {\
@@ -49568,43 +50109,116 @@
                 else\
                     goto raise_overflow;\
             }\
         }\
         return (target_type) value;\
     }
 
-/* CIntToPy */
-    static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
-    const int neg_one = (int) ((int) 0 - (int) 1), const_zero = (int) 0;
-    const int is_unsigned = neg_one > const_zero;
-    if (is_unsigned) {
-        if (sizeof(int) < sizeof(long)) {
-            return PyInt_FromLong((long) value);
-        } else if (sizeof(int) <= sizeof(unsigned long)) {
-            return PyLong_FromUnsignedLong((unsigned long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
-            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
-#endif
-        }
-    } else {
-        if (sizeof(int) <= sizeof(long)) {
-            return PyInt_FromLong((long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
-            return PyLong_FromLongLong((PY_LONG_LONG) value);
-#endif
-        }
+/* ObjectToMemviewSlice */
+    static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_int(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
     }
-    {
-        int one = 1; int little = (int)*(unsigned char *)&one;
-        unsigned char *bytes = (unsigned char *)&value;
-        return _PyLong_FromByteArray(bytes, sizeof(int),
-                                     little, !is_unsigned);
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 1,
+                                                 &__Pyx_TypeInfo_int, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
+
+/* MemviewDtypeToObject */
+    static CYTHON_INLINE PyObject *__pyx_memview_get_int(const char *itemp) {
+    return (PyObject *) __Pyx_PyInt_From_int(*(int *) itemp);
+}
+static CYTHON_INLINE int __pyx_memview_set_int(const char *itemp, PyObject *obj) {
+    int value = __Pyx_PyInt_As_int(obj);
+    if ((value == (int)-1) && PyErr_Occurred())
+        return 0;
+    *(int *) itemp = value;
+    return 1;
+}
+
+/* ObjectToMemviewSlice */
+    static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
+    }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 3,
+                                                 &__Pyx_TypeInfo_double, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
+
+/* ObjectToMemviewSlice */
+    static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
     }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 4,
+                                                 &__Pyx_TypeInfo_double, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
+
+/* ObjectToMemviewSlice */
+    static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_long(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
+    }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 1,
+                                                 &__Pyx_TypeInfo_long, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
 }
 
 /* MemviewDtypeToObject */
     static CYTHON_INLINE PyObject *__pyx_memview_get_long(const char *itemp) {
     return (PyObject *) __Pyx_PyInt_From_long(*(long *) itemp);
 }
 static CYTHON_INLINE int __pyx_memview_set_long(const char *itemp, PyObject *obj) {
@@ -49629,15 +50243,15 @@
     Py_buffer *buf = &from_memview->view;
     PyObject *shape_tuple = NULL;
     PyObject *temp_int = NULL;
     struct __pyx_array_obj *array_obj = NULL;
     struct __pyx_memoryview_obj *memview_obj = NULL;
     __Pyx_RefNannySetupContext("__pyx_memoryview_copy_new_contig", 0);
     for (i = 0; i < ndim; i++) {
-        if (from_mvs->suboffsets[i] >= 0) {
+        if (unlikely(from_mvs->suboffsets[i] >= 0)) {
             PyErr_Format(PyExc_ValueError, "Cannot copy memoryview slice with "
                                            "indirect dimensions (axis %d)", i);
             goto fail;
         }
     }
     shape_tuple = PyTuple_New(ndim);
     if (unlikely(!shape_tuple)) {
@@ -49678,17 +50292,62 @@
     __Pyx_XDECREF(shape_tuple);
     __Pyx_XDECREF(temp_int);
     __Pyx_XDECREF(array_obj);
     __Pyx_RefNannyFinishContext();
     return new_mvs;
 }
 
+/* CIntToPy */
+    static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const long neg_one = (long) -1, const_zero = (long) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
+    const int is_unsigned = neg_one > const_zero;
+    if (is_unsigned) {
+        if (sizeof(long) < sizeof(long)) {
+            return PyInt_FromLong((long) value);
+        } else if (sizeof(long) <= sizeof(unsigned long)) {
+            return PyLong_FromUnsignedLong((unsigned long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
+            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
+#endif
+        }
+    } else {
+        if (sizeof(long) <= sizeof(long)) {
+            return PyInt_FromLong((long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
+            return PyLong_FromLongLong((PY_LONG_LONG) value);
+#endif
+        }
+    }
+    {
+        int one = 1; int little = (int)*(unsigned char *)&one;
+        unsigned char *bytes = (unsigned char *)&value;
+        return _PyLong_FromByteArray(bytes, sizeof(long),
+                                     little, !is_unsigned);
+    }
+}
+
 /* CIntFromPy */
     static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
-    const int neg_one = (int) ((int) 0 - (int) 1), const_zero = (int) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const int neg_one = (int) -1, const_zero = (int) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
         if (sizeof(int) < sizeof(long)) {
             __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
@@ -49731,15 +50390,15 @@
                         } else if (8 * sizeof(int) >= 4 * PyLong_SHIFT) {
                             return (int) (((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                         }
                     }
                     break;
             }
 #endif
-#if CYTHON_COMPILING_IN_CPYTHON
+#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A7
             if (unlikely(Py_SIZE(x) < 0)) {
                 goto raise_neg_overflow;
             }
 #else
             {
                 int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                 if (unlikely(result < 0))
@@ -49867,17 +50526,62 @@
     return (int) -1;
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to int");
     return (int) -1;
 }
 
+/* CIntToPy */
+    static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const int neg_one = (int) -1, const_zero = (int) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
+    const int is_unsigned = neg_one > const_zero;
+    if (is_unsigned) {
+        if (sizeof(int) < sizeof(long)) {
+            return PyInt_FromLong((long) value);
+        } else if (sizeof(int) <= sizeof(unsigned long)) {
+            return PyLong_FromUnsignedLong((unsigned long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
+            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
+#endif
+        }
+    } else {
+        if (sizeof(int) <= sizeof(long)) {
+            return PyInt_FromLong((long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
+            return PyLong_FromLongLong((PY_LONG_LONG) value);
+#endif
+        }
+    }
+    {
+        int one = 1; int little = (int)*(unsigned char *)&one;
+        unsigned char *bytes = (unsigned char *)&value;
+        return _PyLong_FromByteArray(bytes, sizeof(int),
+                                     little, !is_unsigned);
+    }
+}
+
 /* CIntFromPy */
     static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
-    const long neg_one = (long) ((long) 0 - (long) 1), const_zero = (long) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const long neg_one = (long) -1, const_zero = (long) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
         if (sizeof(long) < sizeof(long)) {
             __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
@@ -49920,15 +50624,15 @@
                         } else if (8 * sizeof(long) >= 4 * PyLong_SHIFT) {
                             return (long) (((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                         }
                     }
                     break;
             }
 #endif
-#if CYTHON_COMPILING_IN_CPYTHON
+#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A7
             if (unlikely(Py_SIZE(x) < 0)) {
                 goto raise_neg_overflow;
             }
 #else
             {
                 int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                 if (unlikely(result < 0))
@@ -50058,15 +50762,22 @@
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to long");
     return (long) -1;
 }
 
 /* CIntFromPy */
     static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *x) {
-    const char neg_one = (char) ((char) 0 - (char) 1), const_zero = (char) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const char neg_one = (char) -1, const_zero = (char) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
         if (sizeof(char) < sizeof(long)) {
             __PYX_VERIFY_RETURN_INT(char, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
@@ -50109,15 +50820,15 @@
                         } else if (8 * sizeof(char) >= 4 * PyLong_SHIFT) {
                             return (char) (((((((((char)digits[3]) << PyLong_SHIFT) | (char)digits[2]) << PyLong_SHIFT) | (char)digits[1]) << PyLong_SHIFT) | (char)digits[0]));
                         }
                     }
                     break;
             }
 #endif
-#if CYTHON_COMPILING_IN_CPYTHON
+#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A7
             if (unlikely(Py_SIZE(x) < 0)) {
                 goto raise_neg_overflow;
             }
 #else
             {
                 int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                 if (unlikely(result < 0))
@@ -50248,14 +50959,20 @@
         "can't convert negative value to char");
     return (char) -1;
 }
 
 /* CoroutineBase */
     #include <structmember.h>
 #include <frameobject.h>
+#if PY_VERSION_HEX >= 0x030b00a6
+  #ifndef Py_BUILD_CORE
+    #define Py_BUILD_CORE 1
+  #endif
+  #include "internal/pycore_frame.h"
+#endif
 #define __Pyx_Coroutine_Undelegate(gen) Py_CLEAR((gen)->yieldfrom)
 static int __Pyx_PyGen__FetchStopIterationValue(CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject **pvalue) {
     PyObject *et, *ev, *tb;
     PyObject *value = NULL;
     __Pyx_ErrFetch(&et, &ev, &tb);
     if (!et) {
         Py_XDECREF(tb);
@@ -50419,17 +51136,21 @@
     exc_state = &self->gi_exc_state;
     if (exc_state->exc_type) {
         #if CYTHON_COMPILING_IN_PYPY || CYTHON_COMPILING_IN_PYSTON
         #else
         if (exc_state->exc_traceback) {
             PyTracebackObject *tb = (PyTracebackObject *) exc_state->exc_traceback;
             PyFrameObject *f = tb->tb_frame;
-            Py_XINCREF(tstate->frame);
             assert(f->f_back == NULL);
+            #if PY_VERSION_HEX >= 0x030B00A1
+            f->f_back = PyThreadState_GetFrame(tstate);
+            #else
+            Py_XINCREF(tstate->frame);
             f->f_back = tstate->frame;
+            #endif
         }
         #endif
     }
 #if CYTHON_USE_EXC_INFO_STACK
     exc_state->previous_item = tstate->exc_info;
     tstate->exc_info = exc_state;
 #else
@@ -50474,14 +51195,38 @@
                 exc = __Pyx_PyExc_StopAsyncIteration;
             #endif
             __Pyx_PyErr_SetNone(exc);
         }
     }
     return retval;
 }
+#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x03030000 && (defined(__linux__) || PY_VERSION_HEX >= 0x030600B3)
+static CYTHON_INLINE
+PyObject *__Pyx_PyGen_Send(PyGenObject *gen, PyObject *arg) {
+#if PY_VERSION_HEX <= 0x030A00A1
+    return _PyGen_Send(gen, arg);
+#else
+    PyObject *result;
+    if (PyIter_Send((PyObject*)gen, arg ? arg : Py_None, &result) == PYGEN_RETURN) {
+        if (PyAsyncGen_CheckExact(gen)) {
+            assert(result == Py_None);
+            PyErr_SetNone(PyExc_StopAsyncIteration);
+        }
+        else if (result == Py_None) {
+            PyErr_SetNone(PyExc_StopIteration);
+        }
+        else {
+            _PyGen_SetStopIterationValue(result);
+        }
+        Py_CLEAR(result);
+    }
+    return result;
+#endif
+}
+#endif
 static CYTHON_INLINE
 PyObject *__Pyx_Coroutine_FinishDelegation(__pyx_CoroutineObject *gen) {
     PyObject *ret;
     PyObject *val = NULL;
     __Pyx_Coroutine_Undelegate(gen);
     __Pyx_PyGen__FetchStopIterationValue(__Pyx_PyThreadState_Current, &val);
     ret = __Pyx_Coroutine_SendEx(gen, val, 0);
@@ -50510,20 +51255,20 @@
         #ifdef __Pyx_AsyncGen_USED
         if (__pyx_PyAsyncGenASend_CheckExact(yf)) {
             ret = __Pyx_async_gen_asend_send(yf, value);
         } else
         #endif
         #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x03030000 && (defined(__linux__) || PY_VERSION_HEX >= 0x030600B3)
         if (PyGen_CheckExact(yf)) {
-            ret = _PyGen_Send((PyGenObject*)yf, value == Py_None ? NULL : value);
+            ret = __Pyx_PyGen_Send((PyGenObject*)yf, value == Py_None ? NULL : value);
         } else
         #endif
         #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x03050000 && defined(PyCoro_CheckExact) && (defined(__linux__) || PY_VERSION_HEX >= 0x030600B3)
         if (PyCoro_CheckExact(yf)) {
-            ret = _PyGen_Send((PyGenObject*)yf, value == Py_None ? NULL : value);
+            ret = __Pyx_PyGen_Send((PyGenObject*)yf, value == Py_None ? NULL : value);
         } else
         #endif
         {
             if (value == Py_None)
                 ret = Py_TYPE(yf)->tp_iternext(yf);
             else
                 ret = __Pyx_PyObject_CallMethod1(yf, __pyx_n_s_send, value);
@@ -50599,15 +51344,15 @@
         #ifdef __Pyx_Generator_USED
         if (__Pyx_Generator_CheckExact(yf)) {
             ret = __Pyx_Generator_Next(yf);
         } else
         #endif
         #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x03030000 && (defined(__linux__) || PY_VERSION_HEX >= 0x030600B3)
         if (PyGen_CheckExact(yf)) {
-            ret = _PyGen_Send((PyGenObject*)yf, NULL);
+            ret = __Pyx_PyGen_Send((PyGenObject*)yf, NULL);
         } else
         #endif
         #ifdef __Pyx_Coroutine_USED
         if (__Pyx_Coroutine_Check(yf)) {
             ret = __Pyx_Coroutine_Send(yf, Py_None);
         } else
         #endif
@@ -50759,14 +51504,15 @@
     __Pyx_Coroutine_ExceptionClear(&gen->gi_exc_state);
 #ifdef __Pyx_AsyncGen_USED
     if (__Pyx_AsyncGen_CheckExact(self)) {
         Py_CLEAR(((__pyx_PyAsyncGenObject*)gen)->ag_finalizer);
     }
 #endif
     Py_CLEAR(gen->gi_code);
+    Py_CLEAR(gen->gi_frame);
     Py_CLEAR(gen->gi_name);
     Py_CLEAR(gen->gi_qualname);
     Py_CLEAR(gen->gi_modulename);
     return 0;
 }
 static void __Pyx_Coroutine_dealloc(PyObject *self) {
     __pyx_CoroutineObject *gen = (__pyx_CoroutineObject *) self;
@@ -50775,15 +51521,15 @@
         PyObject_ClearWeakRefs(self);
     if (gen->resume_label >= 0) {
         PyObject_GC_Track(self);
 #if PY_VERSION_HEX >= 0x030400a1 && CYTHON_USE_TP_FINALIZE
         if (PyObject_CallFinalizerFromDealloc(self))
 #else
         Py_TYPE(gen)->tp_del(self);
-        if (self->ob_refcnt > 0)
+        if (Py_REFCNT(self) > 0)
 #endif
         {
             return;
         }
         PyObject_GC_UnTrack(self);
     }
 #ifdef __Pyx_AsyncGen_USED
@@ -50802,15 +51548,15 @@
     __pyx_CoroutineObject *gen = (__pyx_CoroutineObject *) self;
     __Pyx_PyThreadState_declare
     if (gen->resume_label < 0) {
         return;
     }
 #if !CYTHON_USE_TP_FINALIZE
     assert(self->ob_refcnt == 0);
-    self->ob_refcnt = 1;
+    __Pyx_SET_REFCNT(self, 1);
 #endif
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&error_type, &error_value, &error_traceback);
 #ifdef __Pyx_AsyncGen_USED
     if (__Pyx_AsyncGen_CheckExact(self)) {
         __pyx_PyAsyncGenObject *agen = (__pyx_PyAsyncGenObject*)self;
         PyObject *finalizer = agen->ag_finalizer;
@@ -50869,25 +51615,25 @@
                 PyErr_WriteUnraisable(self);
         } else {
             Py_DECREF(res);
         }
     }
     __Pyx_ErrRestore(error_type, error_value, error_traceback);
 #if !CYTHON_USE_TP_FINALIZE
-    assert(self->ob_refcnt > 0);
+    assert(Py_REFCNT(self) > 0);
     if (--self->ob_refcnt == 0) {
         return;
     }
     {
-        Py_ssize_t refcnt = self->ob_refcnt;
+        Py_ssize_t refcnt = Py_REFCNT(self);
         _Py_NewReference(self);
-        self->ob_refcnt = refcnt;
+        __Pyx_SET_REFCNT(self, refcnt);
     }
 #if CYTHON_COMPILING_IN_CPYTHON
-    assert(PyType_IS_GC(self->ob_type) &&
+    assert(PyType_IS_GC(Py_TYPE(self)) &&
            _Py_AS_GC(self)->gc.gc_refs != _PyGC_REFS_UNTRACKED);
     _Py_DEC_REFTOTAL;
 #endif
 #ifdef COUNT_ALLOCS
     --Py_TYPE(self)->tp_frees;
     --Py_TYPE(self)->tp_allocs;
 #endif
@@ -50945,14 +51691,35 @@
     }
     tmp = self->gi_qualname;
     Py_INCREF(value);
     self->gi_qualname = value;
     Py_XDECREF(tmp);
     return 0;
 }
+static PyObject *
+__Pyx_Coroutine_get_frame(__pyx_CoroutineObject *self, CYTHON_UNUSED void *context)
+{
+    PyObject *frame = self->gi_frame;
+    if (!frame) {
+        if (unlikely(!self->gi_code)) {
+            Py_RETURN_NONE;
+        }
+        frame = (PyObject *) PyFrame_New(
+            PyThreadState_Get(),            /*PyThreadState *tstate,*/
+            (PyCodeObject*) self->gi_code,  /*PyCodeObject *code,*/
+            __pyx_d,                 /*PyObject *globals,*/
+            0                               /*PyObject *locals*/
+        );
+        if (unlikely(!frame))
+            return NULL;
+        self->gi_frame = frame;
+    }
+    Py_INCREF(frame);
+    return frame;
+}
 static __pyx_CoroutineObject *__Pyx__Coroutine_New(
             PyTypeObject* type, __pyx_coroutine_body_t body, PyObject *code, PyObject *closure,
             PyObject *name, PyObject *qualname, PyObject *module_name) {
     __pyx_CoroutineObject *gen = PyObject_GC_New(__pyx_CoroutineObject, type);
     if (unlikely(!gen))
         return NULL;
     return __Pyx__Coroutine_NewInit(gen, body, code, closure, name, qualname, module_name);
@@ -50978,14 +51745,15 @@
     gen->gi_qualname = qualname;
     Py_XINCREF(name);
     gen->gi_name = name;
     Py_XINCREF(module_name);
     gen->gi_modulename = module_name;
     Py_XINCREF(code);
     gen->gi_code = code;
+    gen->gi_frame = NULL;
     PyObject_GC_Track(gen);
     return gen;
 }
 
 /* PatchModuleWithCoroutine */
     static PyObject* __Pyx_Coroutine_patch_module(PyObject* module, const char* py_code) {
 #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
@@ -51101,14 +51869,16 @@
     {0, 0, 0, 0, 0}
 };
 static PyGetSetDef __pyx_Generator_getsets[] = {
     {(char *) "__name__", (getter)__Pyx_Coroutine_get_name, (setter)__Pyx_Coroutine_set_name,
      (char*) PyDoc_STR("name of the generator"), 0},
     {(char *) "__qualname__", (getter)__Pyx_Coroutine_get_qualname, (setter)__Pyx_Coroutine_set_qualname,
      (char*) PyDoc_STR("qualified name of the generator"), 0},
+    {(char *) "gi_frame", (getter)__Pyx_Coroutine_get_frame, NULL,
+     (char*) PyDoc_STR("Frame of the generator"), 0},
     {0, 0, 0, 0, 0}
 };
 static PyTypeObject __pyx_GeneratorType_type = {
     PyVarObject_HEAD_INIT(0, 0)
     "generator",
     sizeof(__pyx_CoroutineObject),
     0,
@@ -51160,153 +51930,66 @@
 #endif
     0,
 #if CYTHON_USE_TP_FINALIZE
     __Pyx_Coroutine_del,
 #elif PY_VERSION_HEX >= 0x030400a1
     0,
 #endif
-#if PY_VERSION_HEX >= 0x030800b1
+#if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
     0,
 #endif
 #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
     0,
 #endif
+#if PY_VERSION_HEX >= 0x030C0000
+    0,
+#endif
+#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
+    0,
+#endif
 };
 static int __pyx_Generator_init(void) {
     __pyx_GeneratorType_type.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
     __pyx_GeneratorType_type.tp_iter = PyObject_SelfIter;
     __pyx_GeneratorType = __Pyx_FetchCommonType(&__pyx_GeneratorType_type);
     if (unlikely(!__pyx_GeneratorType)) {
         return -1;
     }
     return 0;
 }
 
-/* ObjectToMemviewSlice */
-    static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_long(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
-                                                 PyBUF_RECORDS_RO | writable_flag, 2,
-                                                 &__Pyx_TypeInfo_long, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
-/* ObjectToMemviewSlice */
-    static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_int(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
-                                                 PyBUF_RECORDS_RO | writable_flag, 2,
-                                                 &__Pyx_TypeInfo_int, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
-/* ObjectToMemviewSlice */
-    static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_long(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
-                                                 PyBUF_RECORDS_RO | writable_flag, 1,
-                                                 &__Pyx_TypeInfo_long, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
-/* ObjectToMemviewSlice */
-    static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
-                                                 PyBUF_RECORDS_RO | writable_flag, 3,
-                                                 &__Pyx_TypeInfo_double, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
-/* ObjectToMemviewSlice */
-    static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
-                                                 PyBUF_RECORDS_RO | writable_flag, 4,
-                                                 &__Pyx_TypeInfo_double, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
 /* CheckBinaryVersion */
     static int __Pyx_check_binary_version(void) {
-    char ctversion[4], rtversion[4];
-    PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
-    PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
-    if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
+    char ctversion[5];
+    int same=1, i, found_dot;
+    const char* rt_from_call = Py_GetVersion();
+    PyOS_snprintf(ctversion, 5, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
+    found_dot = 0;
+    for (i = 0; i < 4; i++) {
+        if (!ctversion[i]) {
+            same = (rt_from_call[i] < '0' || rt_from_call[i] > '9');
+            break;
+        }
+        if (rt_from_call[i] != ctversion[i]) {
+            same = 0;
+            break;
+        }
+    }
+    if (!same) {
+        char rtversion[5] = {'\0'};
         char message[200];
+        for (i=0; i<4; ++i) {
+            if (rt_from_call[i] == '.') {
+                if (found_dot) break;
+                found_dot = 1;
+            } else if (rt_from_call[i] < '0' || rt_from_call[i] > '9') {
+                break;
+            }
+            rtversion[i] = rt_from_call[i];
+        }
         PyOS_snprintf(message, sizeof(message),
                       "compiletime version %s of module '%.100s' "
                       "does not match runtime version %s",
                       ctversion, __Pyx_MODULE_NAME, rtversion);
         return PyErr_WarnEx(NULL, message, 1);
     }
     return 0;
@@ -51556,14 +52239,31 @@
   }
   x = PyNumber_Index(b);
   if (!x) return -1;
   ival = PyInt_AsSsize_t(x);
   Py_DECREF(x);
   return ival;
 }
+static CYTHON_INLINE Py_hash_t __Pyx_PyIndex_AsHash_t(PyObject* o) {
+  if (sizeof(Py_hash_t) == sizeof(Py_ssize_t)) {
+    return (Py_hash_t) __Pyx_PyIndex_AsSsize_t(o);
+#if PY_MAJOR_VERSION < 3
+  } else if (likely(PyInt_CheckExact(o))) {
+    return PyInt_AS_LONG(o);
+#endif
+  } else {
+    Py_ssize_t ival;
+    PyObject *x;
+    x = PyNumber_Index(o);
+    if (!x) return -1;
+    ival = PyInt_AsLong(x);
+    Py_DECREF(x);
+    return ival;
+  }
+}
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b) {
   return b ? __Pyx_NewRef(Py_True) : __Pyx_NewRef(Py_False);
 }
 static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
     return PyInt_FromSize_t(ival);
 }
```

### Comparing `soapcw-0.1.3/soapcw/cnn/pytorch/load_models.py` & `soapcw-0.1.5/soapcw/cnn/pytorch/load_models.py`

 * *Files identical despite different names*

### Comparing `soapcw-0.1.3/soapcw/cnn/pytorch/models/cnn.py` & `soapcw-0.1.5/soapcw/cnn/pytorch/models/cnn.py`

 * *Files identical despite different names*

### Comparing `soapcw-0.1.3/soapcw/cnn/pytorch/models/combined_cnn.py` & `soapcw-0.1.5/soapcw/cnn/pytorch/models/combined_cnn.py`

 * *Files identical despite different names*

### Comparing `soapcw-0.1.3/soapcw/tools/tools.py` & `soapcw-0.1.5/soapcw/tools/tools.py`

 * *Files 2% similar despite different names*

```diff
@@ -198,14 +198,15 @@
 def ft_power(track):
     f0 = 2./86164.09
     fs = 1./1800
     w = np.exp(-2*np.pi*1j*f0*np.arange(len(track))/fs)
     power = np.abs(np.sum(track*w))**2
 
 def fft_stat(data,paths):
+    """ Statistic taking the fft of the track at 1 siderial day"""
     path = [i for i in paths for j in range(48)]
     power = []
     for i,j in enumerate(path[:len(data)]):
         power.append(data[i][j])
     f0 = 1./86164.09
     f1 = 1./85000
     f2 = 1./89000
```

### Comparing `soapcw-0.1.3/soapcw/tools/plots.py` & `soapcw-0.1.5/soapcw/tools/plots.py`

 * *Files identical despite different names*

### Comparing `soapcw-0.1.3/soapcw/line_aware_stat/gen_lookup_python.py` & `soapcw-0.1.5/soapcw/line_aware_stat/gen_lookup_python.py`

 * *Files 1% similar despite different names*

```diff
@@ -22,16 +22,18 @@
         self.N = N
         self.kN = self.k*self.N
         
         if ndet == 1:
             self.signoiseline,self.signoise,self.sigline,self.sig,self.noise,self.line = self.gen_lookup_one_det(powers,approx=approx,signal_prior_width=signal_prior_width,line_prior_width=line_prior_width,noise_line_model_ratio=noise_line_model_ratio)
         elif ndet == 2:
             self.signoiseline,self.signoise,self.sigline,self.sig,self.noise,self.line = self.gen_lookup_two_det(powers,powers,approx=approx,signal_prior_width=signal_prior_width,line_prior_width=line_prior_width,noise_line_model_ratio=noise_line_model_ratio)
-            
-    def chi2_sig(self,lamb,gs,pv):
+        else:
+            raise Exception("This currently only works for 1 or 2 detectors")    
+        
+    def chi2_sig(self,lamb: np.array,gs: float,pv: float) -> np.array:
         """
         returns the likelihood of two powers multiplied by the prior on the snr**2
         args
         -------
         lamb: float
             snr^2
         g1: float
```

### Comparing `soapcw-0.1.3/soapcw/line_aware_stat/gen_lookup.pyx` & `soapcw-0.1.5/soapcw/line_aware_stat/gen_lookup.pyx`

 * *Files 19% similar despite different names*

```diff
@@ -4,14 +4,15 @@
 from sys import stdout
 import scipy.special as sp
 try:
     from scipy.misc import logsumexp
 except:
     from scipy.special import logsumexp
 from libc.math cimport log,exp,sqrt
+from libc.stdio cimport printf
 import os
 #import integrals
 cwd = os.getcwd()
 
 
 cdef extern from "integrals.h":
     double integral_signal_1det(double g, double logfrac, int k, int N, double pv)
@@ -19,42 +20,45 @@
     double integral_signal_2det(double g1, double g2, double logfrac, int k, int N, double pv)
     double integral_line_2det(double g1, double g2,  double logfrac, int k, int N, double pv)
     double ch2_noise_2det(double g1, double g2, int k, int N) 
 
 
 class LineAwareStatistic:
 
-    def __init__(self,powers, k = 2, N = 48, pvs = 1, pvl = 5, ratio = 1):
+    def __init__(self,powers, ndet = 2, k = 2, N = 48, signal_prior_width = 1, line_prior_width = 5, noise_line_model_ratio = 1):
 
-        if len(np.shape(powers)) == 1:
-            self.signoiseline,self.sig,self.line,self.noise = self.gen_lookup_one_det(powers,pvs=pvs,pvl=pvl,ratio=ratio,k=k,N=N)
-        if np.shape(powers)[0] == 2:
-            self.signoiseline,self.sig,self.line,self.noise = self.gen_lookup_two_det(powers[0],powers[1],pvs=pvs,pvl=pvl,ratio=ratio,k=k,N=N)
+        if ndet == 1:
+            self.signoiseline,self.sig,self.line,self.noise = self.gen_lookup_one_det(powers,signal_prior_width=signal_prior_width,line_prior_width=line_prior_width,noise_line_model_ratio=noise_line_model_ratio,k=k,N=N)
+        elif ndet == 2:
+            print(powers)
+            self.signoiseline,self.sig,self.line,self.noise = self.gen_lookup_two_det(powers,powers,signal_prior_width=signal_prior_width,line_prior_width=line_prior_width,noise_line_model_ratio=noise_line_model_ratio,k=k,N=N)
+        else:
+            raise Exception("This currently only works for 1 or 2 detectors")
     
-    def bayes_2det(self,g1,g2,logfrac,k,N,pvs,pvl,ratio):
+    def bayes_2det(self,g1,g2,logfrac,k,N,signal_prior_width,line_prior_width,noise_line_model_ratio):
         """
         calculate the bayes factor for signal noise and line
         args
         -----------
         g1: float
             power in det 1
         g2: float
             power in det 2
         logfrac: float
             fraction of duty cycle and noise in each detector
         k: int
             number of degrees of freedom
         N: int
         number of sfts summed over
-        pvs: float
+        signal_prior_width: float
         width of prior on signal
-        pvl: float
+        line_prior_width: float
         width of prior on line
-        ratio: float
-        ratio of the prior on noise model vs line
+        noise_line_model_ratio: float
+        noise_line_model_ratio of the prior on noise model vs line
         returns
         ---------
         b1: float
         bayes factor including all signal,line and noise
         sig_int: float
         marginalised likelihood for signal
         line_int:
@@ -62,41 +66,41 @@
         noise: float
         noise likelihood
         """
         cdef double sig_int
         cdef double line_int
         cdef double noise
         cdef double b1
-        sig_int = integral_signal_2det(g1,g2,logfrac,k,N,pvs)
-        line_int = integral_line_2det(g1,g2,logfrac,k,N,pvl)
+        sig_int = integral_signal_2det(g1,g2,logfrac,k,N,signal_prior_width)
+        line_int = integral_line_2det(g1,g2,logfrac,k,N,line_prior_width)
         noise = ch2_noise_2det(g1,g2,k,N)
-        b1 = sig_int/(ratio*line_int + noise)
+        b1 = sig_int/(noise_line_model_ratio*line_int + noise)
         return [b1,sig_int,line_int,noise]
     
-    def bayes_1det(self,g,logfrac,k,N,pvs,pvl,ratio):
+    def bayes_1det(self,g,logfrac,k,N,signal_prior_width,line_prior_width,noise_line_model_ratio):
         """
         calculate the bayes factor for signal noise and line
         args
         -----------
         g1: float
         power in det 1
         g2: float
         power in det 2
         logfrac: float
         fraction of duty cycle and noise in each detector
         k: int
         number of degrees of freedom
         N: int
         number of sfts summed over
-        pvs: float
+        signal_prior_width: float
         width of prior on signal
-        pvl: float
+        line_prior_width: float
         width of prior on line
-        ratio: float
-        ratio of the prior on noise model vs line
+        noise_line_model_ratio: float
+        noise_line_model_ratio of the prior on noise model vs line
         returns
         ---------
         b1: float
         bayes factor including all signal,line and noise
         sig_int: float
         marginalised likelihood for signal
         line_int:
@@ -104,34 +108,34 @@
         noise: float
         noise likelihood
         """
         cdef double sig_int
         cdef double line_int
         cdef double noise
         cdef double b1
-        sig_int = integral_signal_1det(g,logfrac,k,N,pvs)
-        line_int = integral_signal_1det(g,logfrac,k,N,pvl)
+        sig_int = integral_signal_1det(g,logfrac,k,N,signal_prior_width)
+        line_int = integral_signal_1det(g,logfrac,k,N,line_prior_width)
         noise = ch2_noise_1det(g,k,N)
-        b1 = sig_int/(ratio*line_int + noise)
+        b1 = sig_int/(noise_line_model_ratio*line_int + noise)
         return [b1,sig_int,line_int,noise]
     
-    def gen_lookup_one_det(self,x,pvs=1,pvl=1,ratio=1,k=2,N=48):
+    def gen_lookup_one_det(self,x,signal_prior_width=1,line_prior_width=1,noise_line_model_ratio=1,k=2,N=48):
         """
         calculates the odds ratio for given values of power and ratio.
         args
         --------
         x: array
         array of the SFT power in detector 1
         n1: array
         array of the ratios of the duty cycle and noise psds, \frac{f_{1} S_{2}}{f_{2} S_{1}}
-        pvs: float
+        signal_prior_width: float
         width on prior for signal model
-        pvl: float
+        line_prior_width: float
         width on prior for line model
-        ratio: float
+        noise_line_model_ratio: float
         ratio of the priors on the line and signal models
         k: int
         number of degrees of freedom
         N: int
         number of summed distributions, i.e. SFTs 
         returns
         ----------
@@ -148,41 +152,41 @@
         cdef double[:] xc = x
         cdef double[:] odds = np.zeros((len(x)))
         cdef double[:] signal = np.zeros((len(x)))
         cdef double[:] line = np.zeros((len(x)))
         cdef double[:] noise = np.zeros((len(x)))
         cdef double n1 = 0.
         for i in range(len(x)):
-            ig = self.bayes_1det(xc[i],n1,k,N,pvs,pvl,ratio)
+            ig = self.bayes_1det(xc[i],n1,k,N,signal_prior_width,line_prior_width,noise_line_model_ratio)
             odds[i] = ig[0]
             signal[i] = ig[1]
             line[i] = ig[2]
             noise[i] = ig[3]
             
         return np.array(odds),np.array(signal),np.array(line),np.array(noise)
 
 
-    def gen_lookup_two_det(self,x,y,pvs=1,pvl=1,ratio=1,k=2,N=48):
+    def gen_lookup_two_det(self,x,y,signal_prior_width=1,line_prior_width=1,noise_line_model_ratio=1,k=2,N=48):
         """
         calculates the odds ratio for given values of power and ratio for two detectors.
         args
         --------
         x: array
         array of the SFT power in detector 1
         y: array
         array of SFT power in detector 2
         n1: array
         array of the ratios of the duty cycle and noise psds, \frac{f_{1} S_{2}}{f_{2} S_{1}}
         int_type: string
         which statistic to use ("chi2" only option for now)
-        pvs: float
+        signal_prior_width: float
         width on prior for signal model
-        pvl: float
+        line_prior_width: float
         width on prior for line model
-        ratio: float
+        noise_line_model_ratio: float
         ratio of the priors on the line and signal models
         k: int
         number of degrees of freedom
         N: int
         number of summed distributions, i.e. SFTs 
         returns
         ----------
@@ -192,70 +196,73 @@
         array of signal likelihoods
         line: array
         array of line likelihoods
         noise: array
         array of noise likelihoods
         
         """
+        
         cdef int i
         cdef int j
         cdef double[:] xc = x
         cdef double[:] yc = y
         cdef double[:, :] odds = np.zeros((len(x),len(y)))
         cdef double[:, :] signal = np.zeros((len(x),len(y)))
         cdef double[:, :] line = np.zeros((len(x),len(y)))
         cdef double[:, :] noise = np.zeros((len(x),len(y)))
         cdef double n1 = 0.
         for i in range(len(x)):
             for j in range(len(y)):
-                ig = self.bayes_2det(xc[i],yc[j],n1,k,N,pvs,pvl,ratio)
+                ig = self.bayes_2det(xc[i],yc[j],n1,k,N,signal_prior_width,line_prior_width,noise_line_model_ratio)
                 odds[i,j] = ig[0]
                 signal[i,j] = ig[1]
                 line[i,j] = ig[2]
                 noise[i,j] = ig[3]
                 
         return np.array(odds),np.array(signal),np.array(line),np.array(noise)
 
 
 class LineAwareAmpStatistic(LineAwareStatistic):
 
-    def __init__(self,powers, fractions=None,ndet = 2, k = 2, N = 48, pvs = 1, pvl = 5, ratio = 1):
+    def __init__(self,powers, fractions=None, ndet = 2, k = 2, N = 48, signal_prior_width = 1, line_prior_width = 5, noise_line_model_ratio = 1):
 
-        self.ndet = 2
-        self.pvs = pvs
-        self.pvl = pvl
-        self.ratio = ratio
+        self.ndet = ndet
+        self.signal_prior_width = signal_prior_width
+        self.line_prior_width = line_prior_width
+        self.noise_line_model_ratio = noise_line_model_ratio
         self.k = k
         self.N = N
         
         if ndet == 1:
-            self.signoiseline,self.sig,self.line,self.noise = self.gen_lookup_one_det_amp(powers,pvs=pvs,pvl=pvl,ratio=ratio)
-        if ndet == 2:
-            self.signoiseline,self.sig,self.line,self.noise = self.gen_lookup_two_det_amp(powers,powers,fractions,pvs=pvs,pvl=pvl,ratio=ratio)
-    
-    def gen_lookup_two_det_amp(self,x,y,n1,pvs=1,pvl=1,ratio=1,k=2,N=48):
+            self.signoiseline,self.sig,self.line,self.noise = self.gen_lookup_one_det_amp(powers,signal_prior_width=signal_prior_width,line_prior_width=line_prior_width,noise_line_model_ratio=noise_line_model_ratio)
+        elif ndet == 2:
+            self.signoiseline,self.sig,self.line,self.noise = self.gen_lookup_two_det_amp(powers,powers,fractions,signal_prior_width=signal_prior_width,line_prior_width=line_prior_width,noise_line_model_ratio=noise_line_model_ratio)
+        else:
+            raise Exception("Currently only works for 1 or two detectors")
+            
+    def gen_lookup_two_det_amp(self,x,y,n1,signal_prior_width=1,line_prior_width=1,noise_line_model_ratio=1,k=2,N=48):
         """
         calculates the odds ratio in ch_integrals_approx_noise for given values of power and ratio.
         args
         --------
         x: array
         array of the SFT power in detector 1
         y: array
         array of SFT power in detector 2
         n1: array
         array of the ratios of the duty cycle and noise psds, \frac{f_{1} S_{2}}{f_{2} S_{1}} (f is fraction of summed sfts which are real data, S is noise psd)
         int_type: string
         which statistic to use ("chi2" only option for now)
         approx: bool
         choose whether to use trapz or quad to complete integrals
-        pvs: float
+        signal_prior_width: float
         width on prior for signal model
-        pvl: float
+        line_prior_width: float
         width on prior for line model
-        ratio: float
+        noise_line_model_ratio: float
         ratio of the priors on the line and signal models
         k: int
         number of degrees of freedom for chi2 dist (default = 2)
         N: int
         number of summed sfts (default = 48)
         returns
         ----------
@@ -283,15 +290,15 @@
         cdef double[:, :, :] line = np.zeros((len(n1),len(x),len(y)))
         cdef double[:, :, :] noise = np.zeros((len(n1),len(x),len(y)))
         #cdef double[:, :, :] val4 = np.zeros((len(x),len(y),len(n1)))
         #cdef double[:, :, :] val5 = np.zeros((len(x),len(y),len(n1)))
         for i in range(len(x)):
             for j in range(len(y)):
                 for l in range(len(n1)):
-                    ig = self.bayes_2det(xc[i],yc[j],n1c[l],self.k,self.N,pvs,pvl,ratio)
+                    ig = self.bayes_2det(xc[i],yc[j],n1c[l],self.k,self.N,signal_prior_width,line_prior_width,noise_line_model_ratio)
                     odds[l,i,j] = ig[0]
                     signal[l,i,j] = ig[1]
                     line[l,i,j] = ig[2]
                     noise[l,i,j] = ig[3]
                     #val4[i,j,k] = ig[4]
                     #val5[i,j,k] = ig[5]
```

### Comparing `soapcw-0.1.3/soapcw/__init__.py` & `soapcw-0.1.5/soapcw/__init__.py`

 * *Files 0% similar despite different names*

```diff
@@ -4,15 +4,14 @@
 
 __author__ = """Joe Bayley"""
 __email__ = 'joseph.bayley@glasgow.ac.uk'
 __version__ = '0.1.0'
 from .soapcw import single_detector, two_detector, three_detector, single_detector_gaps
 from .tools import tools, plots
 from .cnn import __init__
-
 from .line_aware_stat import __init__
 from .cw import __init__
 
 #try:
 #    from .lookup_table import gen_lookup_python, save_lookup, gen_lookup
 #except:
 #    from .lookup_table import gen_lookup_python, save_lookup
```

### Comparing `soapcw-0.1.3/soapcw/soapcw.pyx` & `soapcw-0.1.5/soapcw/soapcw.pyx`

 * *Files 0% similar despite different names*

```diff
@@ -95,15 +95,15 @@
         prev: array
             previous positions of paths for each bin
         '''
         
         # find shape of the observation and create empty array for citerbi matrix and previous track positions
         shape = np.shape(obs)
         cdef double[:, :] V = np.zeros(shape)
-        cdef long[:, :] prev = np.zeros(shape,dtype=np.int)
+        cdef int[:, :] prev = np.zeros(shape,dtype=np.int32)
         
         # defining variables
         cdef int t,i,j         # indexes
         cdef double pbar = 0   # progress bar
         cdef double pt
         
         # finding length and width of observation
@@ -164,15 +164,15 @@
                 if pt>pbar:
                     stdout.write('\r{} %'.format(round(pt)))
                     stdout.flush()
                     pbar+=100./len(obs)
     
         cdef double max_end_prob = max(V[length-1][i] for i in range(width))
         cdef int previous
-        cdef long[:] vit_track = np.zeros(length,dtype=np.int)
+        cdef int[:] vit_track = np.zeros(length,dtype=np.int32)
         
                         
         for i in range(width):
             if V[length-1][i] == max_end_prob:
                 vit_track[length-1] = i # appends maximum path value from final step
                 previous = prev[length-1][i]
                 break
@@ -195,17 +195,17 @@
         uses S = \frac{p(ss \mid x)}{p(nn \mid x)+p(ns \mid x)+p(sn \mid x)}
         [currently configured for averaging over 48 SFT need to change to correctly use any]
         Args
         ---------
         tr1: array
             transition matrix
         obs11: array
-            observation from detector 1
+            observation from detector 1 (float64 array)
         obs21: array
-            observation from detector 2 
+            observation from detector 2 (float64 array)
         lookup_file_1det: string (optional)
             filepath of lookup table for the one detector case
         lookup_file_2det: string ( optional)
             filepath of lookup table for the two detector case
         prog: bool (optional)
             show progress bar if True 
         fractions: array (optional)
@@ -229,14 +229,16 @@
 
         if len(np.shape(obs1)) < 2 or len(np.shape(obs1)) < 2:
             raise Exception("Please input 2D array for observation data")
         if np.shape(obs1) != np.shape(obs2):
             raise Exception("Please make sure teh two input data have the same dimensions")
 
         tr = np.array(tr).astype('double')
+        obs1 = np.array(obs1).astype('double')
+        obs2 = np.array(obs2).astype('double')
         self.prog = prog
 
         if fractions is not None and lookup_file_2det is not None:
             self.run_lookup_amp(tr, obs1, obs2,lookup_file=lookup_file_2det,fractions=fractions)
         else:
             self.run(tr, obs1, obs2,lookup_file_1det=lookup_file_1det, lookup_file_2det=lookup_file_2det)
             
@@ -324,17 +326,17 @@
         
         shape = np.shape(obs1)
         
         cdef int length = min(len(obs1),len(obs2))
         cdef int width = len(obs1[0])
         
         cdef double[:, :] val = np.ones(shape)*-1e6
-        cdef long[:, :] prev = np.zeros(shape,dtype = np.int)
-        cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
-        cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)
+        cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)
+        cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
+        cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)
         
         cdef int tr_len = len(tr)
         cdef int sep_len = len(tr[0])
         cdef int tr_dist = int(len(tr)/2. - 0.5)
         cdef int sep_dist = int(len(tr)/2. - 0.5)
         
         cdef int i
@@ -563,17 +565,17 @@
         
         shape = np.shape(obs1)
         
         cdef int length = min(len(obs1),len(obs2))
         cdef int width = len(obs1[0])
         
         cdef double[:, :] val = np.ones(shape)*-1e6
-        cdef long[:, :] prev = np.zeros(shape,dtype = np.int)
-        cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
-        cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)
+        cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)
+        cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
+        cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)
         
         cdef int tr_len = len(tr)
         cdef int sep_len = len(tr[0])
         cdef int tr_dist = int(len(tr)/2. - 0.5)
         cdef int sep_dist = int(len(tr)/2. - 0.5)
         
         cdef int i
@@ -794,18 +796,18 @@
 
         shape = np.shape(obs1)
         
         cdef int length = min(len(obs1),len(obs2),len(obs3))
         cdef int width = len(obs1[0])
         
         cdef double[:, :] val = np.ones(shape)*-1e6
-        cdef long[:, :] prev = np.zeros(shape,dtype = np.int)
-        cdef long[:, :] det1 = np.zeros(shape,dtype = np.int)
-        cdef long[:, :] det2 = np.zeros(shape,dtype = np.int)
-        cdef long[:, :] det3 = np.zeros(shape,dtype = np.int)
+        cdef int[:, :] prev = np.zeros(shape,dtype = np.int32)
+        cdef int[:, :] det1 = np.zeros(shape,dtype = np.int32)
+        cdef int[:, :] det2 = np.zeros(shape,dtype = np.int32)
+        cdef int[:, :] det3 = np.zeros(shape,dtype = np.int32)
         
         cdef int tr_len = len(tr)
         
         cdef int i
         cdef int j
         cdef int k
         cdef int m
@@ -1340,15 +1342,15 @@
             max_vals[bnd] = gaptrack[1] + val + length*2
     
         return max_vals, max_paths
 
     def find_path(self,prev,end_ind):
         length = len(prev)
         previous = prev[-1][end_ind]
-        vit_track =  np.zeros(length,dtype=np.int)
+        vit_track =  np.zeros(length,dtype=np.int32)
         vit_track[-1] = end_ind
         for t in range(length-2,-1,-1):
             vit_track[t] = previous # insert previous step
             previous = prev[t][previous]
         
         return vit_track
```

### Comparing `soapcw-0.1.3/soapcw.egg-info/SOURCES.txt` & `soapcw-0.1.5/soapcw.egg-info/SOURCES.txt`

 * *Files 27% similar despite different names*

```diff
@@ -10,36 +10,47 @@
 docs/authors.rst
 docs/conf.py
 docs/contributing.rst
 docs/history.rst
 docs/index.rst
 docs/installation.rst
 docs/make.bat
-docs/modules.rst
 docs/readme.rst
-docs/soapcw.cnn.pytorch.models.rst
-docs/soapcw.cnn.pytorch.rst
-docs/soapcw.cnn.rst
-docs/soapcw.cw.rst
-docs/soapcw.line_aware_stat.rst
-docs/soapcw.rst
-docs/soapcw.tools.rst
+docs/pipeline_usage/index.rst
+docs/pipeline_usage/run_pipeline.rst
 docs/usage/index.rst
+pipeline/__init__.py
+pipeline/make_dag_files_astro.py
+pipeline/make_dag_files_lines.py
+pipeline/make_html_page.py
+pipeline/run_full_soap_astro.py
+pipeline/run_full_soap_lines.py
+pipeline/soap_config_parser.py
+pipeline/css/general.css
+pipeline/scripts/table_scripts.js
 soapcw/__init__.py
 soapcw/cli.py
+soapcw/soap_config_parser.py
 soapcw/soapcw.c
 soapcw/soapcw.pyx
 soapcw.egg-info/PKG-INFO
 soapcw.egg-info/SOURCES.txt
 soapcw.egg-info/dependency_links.txt
 soapcw.egg-info/entry_points.txt
 soapcw.egg-info/not-zip-safe
 soapcw.egg-info/requires.txt
 soapcw.egg-info/top_level.txt
 soapcw/cnn/__init__.py
+soapcw/cnn/cnn_data_dag_gen.py
+soapcw/cnn/cnn_data_gen.py
+soapcw/cnn/generate_gaussian_train_data.py
+soapcw/cnn/generate_test_data.py
+soapcw/cnn/generate_train_data.py
+soapcw/cnn/narrowband_sfts.py
+soapcw/cnn/train_model.py
 soapcw/cnn/pytorch/__init__.py
 soapcw/cnn/pytorch/load_models.py
 soapcw/cnn/pytorch/models/__init__.py
 soapcw/cnn/pytorch/models/cnn.py
 soapcw/cnn/pytorch/models/combined_cnn.py
 soapcw/cw/__init__.py
 soapcw/cw/generate_data.py
@@ -53,8 +64,10 @@
 soapcw/line_aware_stat/gen_lookup_python.py
 soapcw/line_aware_stat/save_lookup.py
 soapcw/tools/__init__.py
 soapcw/tools/plots.py
 soapcw/tools/tools.py
 tests/SNR_injections.ipynb
 tests/__init__.py
+tests/test_cwload.py
+tests/test_line_aware_stat.py
 tests/test_soap.py
```

### Comparing `soapcw-0.1.3/CONTRIBUTING.rst` & `soapcw-0.1.5/CONTRIBUTING.rst`

 * *Files 2% similar despite different names*

```diff
@@ -11,15 +11,15 @@
 
 Types of Contributions
 ----------------------
 
 Report Bugs
 ~~~~~~~~~~~
 
-Report bugs at https://git.ligo.org/joseph.bayley/soap/issues.
+Report bugs at https://git.ligo.org/joseph.bayley/soapcw/issues.
 
 If you are reporting a bug, please include:
 
 * Your operating system name and version.
 * Any details about your local setup that might be helpful in troubleshooting.
 * Detailed steps to reproduce the bug.
 
@@ -41,15 +41,15 @@
 soap could always use more documentation, whether as part of the
 official soap docs, in docstrings, or even on the web in blog posts,
 articles, and such.
 
 Submit Feedback
 ~~~~~~~~~~~~~~~
 
-The best way to send feedback is to file an issue at https://git.ligo.org/joseph.bayley/soap/issues.
+The best way to send feedback is to file an issue at https://git.ligo.org/joseph.bayley/soapcw/issues.
 
 If you are proposing a feature:
 
 * Explain in detail how it would work.
 * Keep the scope as narrow as possible, to make it easier to implement.
 * Remember that this is a volunteer-driven project, and that contributions
   are welcome :)
@@ -58,15 +58,15 @@
 ------------
 
 Ready to contribute? Here's how to set up `soap` for local development.
 
 1. Fork the `soap` repo on GitHub.
 2. Clone your fork locally::
 
-    $ git clone git@github.com:your_name_here/soap.git
+    $ git clone git@github.com:your_name_here/soapcw.git
 
 3. Install your local copy into a virtualenv. Assuming you have virtualenvwrapper installed, this is how you set up your fork for local development::
 
     $ mkvirtualenv soap
     $ cd soap/
     $ python setup.py develop
```

### Comparing `soapcw-0.1.3/LICENSE` & `soapcw-0.1.5/LICENSE`

 * *Files identical despite different names*

